[
  {
    "lr": 0.1,
    "cv_n_folds": 5,
    "p": 0.5,
    "prune_method": "prune_by_noise_rate",
    "epochs": 30,
    "use_prior": true,
    "batch_size": 128,
    "psx_calculation_method": "signatures",
    "accuracy": [
      0.936,
      0.924,
      0.92,
      0.932,
      0.932,
      0.932,
      0.928,
      0.908,
      0.904,
      0.924,
      0.924,
      0.932,
      0.928,
      0.932,
      0.92,
      0.928,
      0.928,
      0.924,
      0.928,
      0.908,
      0.932,
      0.924,
      0.924,
      0.924,
      0.928,
      0.936,
      0.92,
      0.92,
      0.92,
      0.924
    ],
    "mean_accuracy": 0.9248000000000001,
    "std_accuracy": 0.007747747169784044,
    "precision": [
      0.941954926624738,
      0.9324681328842217,
      0.9255765199161425,
      0.937030259460166,
      0.938752052545156,
      0.938752052545156,
      0.9337657232704403,
      0.9159566739317087,
      0.9128245892951776,
      0.9324681328842217,
      0.9305418719211822,
      0.937030259460166,
      0.9337657232704403,
      0.938752052545156,
      0.9293852676205617,
      0.9355900948366702,
      0.9355900948366702,
      0.9305418719211822,
      0.9355900948366702,
      0.9159566739317087,
      0.938752052545156,
      0.9324681328842217,
      0.9305418719211822,
      0.9305418719211822,
      0.9337657232704403,
      0.941954926624738,
      0.9273577449947312,
      0.9273577449947312,
      0.9273577449947312,
      0.9305418719211822
    ],
    "mean_precision": 0.9317644251536611,
    "std_precision": 0.007153572688237168,
    "recall": [
      0.9331022085259373,
      0.9203903441191577,
      0.9170518746789933,
      0.9293143297380586,
      0.9288649203903441,
      0.9288649203903441,
      0.9250770416024654,
      0.9043400102722137,
      0.9001027221366205,
      0.9203903441191577,
      0.9208397534668722,
      0.9293143297380586,
      0.9250770416024654,
      0.9288649203903441,
      0.9161530559835644,
      0.9246276322547509,
      0.9246276322547509,
      0.9208397534668722,
      0.9246276322547509,
      0.9043400102722137,
      0.9288649203903441,
      0.9203903441191577,
      0.9208397534668722,
      0.9208397534668722,
      0.9250770416024654,
      0.9331022085259373,
      0.916602465331279,
      0.916602465331279,
      0.916602465331279,
      0.9208397534668722
    ],
    "mean_recall": 0.9215523882896764,
    "std_recall": 0.007984788523637563,
    "f1-score": [
      0.9353002070393375,
      0.922963395449164,
      0.9191252587991718,
      0.9313131313131313,
      0.9311974874941316,
      0.9311974874941316,
      0.9272127329192548,
      0.9067451629121457,
      0.9025974025974026,
      0.922963395449164,
      0.923103074258147,
      0.9313131313131313,
      0.9272127329192548,
      0.9311974874941316,
      0.9188311688311688,
      0.927085358740035,
      0.927085358740035,
      0.923103074258147,
      0.927085358740035,
      0.9067451629121457,
      0.9311974874941316,
      0.922963395449164,
      0.923103074258147,
      0.923103074258147,
      0.9272127329192548,
      0.9353002070393375,
      0.9189837319333722,
      0.9189837319333722,
      0.9189837319333722,
      0.923103074258147
    ],
    "mean_f1": 0.9238770603716571,
    "std_f1": 0.007911979247206024
  }
]











/Users/asedova/PycharmProjects/venvs/virtualenv_diffbot_corpus/bin/python3 /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cleanlab_training_tutorial.py --path_to_data /Users/asedova/PycharmProjects/01_knodle/data_from_minio/spam/processed
/Users/asedova/PycharmProjects/venvs/virtualenv_diffbot_corpus/lib/python3.7/site-packages/pandas/compat/__init__.py:120: UserWarning: Could not import the lzma module. Your installed Python is incomplete. Attempting to use lzma compression will result in a RuntimeError.
  warnings.warn(msg)
2021-10-11 11:16:11,218 root         INFO     Initalized logger
======================================
Parameters: seed = None lr = 0.1 cv_n_folds = 5 iterations = 50 prune_method = prune_by_noise_rate epochs = 30 batch_size = 128 psx_calculation_method = signatures p = 0.5 use_prior = True
======================================
2021-10-11 11:16:13,332 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:16:13,332 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:16:13,332 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:16:13,391 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:16:13,398 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:13,408 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1139, samples in test set: 243
2021-10-11 11:16:13,417 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1158, samples in test set: 224
2021-10-11 11:16:13,425 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1075, samples in test set: 307
2021-10-11 11:16:13,434 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 937, samples in test set: 445
2021-10-11 11:16:13,444 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1219, samples in test set: 163
5it [00:06,  1.21s/it]
Prior: 129.1
2021-10-11 11:16:19,507 knodle.trainer.cleanlab.cleanlab INFO     [[0.05456152 0.94543848]
 [0.06326834 0.93673166]
 [0.04014546 0.95985454]
 [0.00402511 0.99597489]
 [0.87915444 0.12084556]
 [0.03134584 0.96865416]
 [0.82602348 0.17397652]
 [0.89737438 0.10262562]
 [0.98684612 0.01315388]
 [0.70785562 0.29214438]]
2021-10-11 11:16:19,551 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 114 out of 1382
2021-10-11 11:16:19,551 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:19,551 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:16:19,551 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:21,137 knodle.trainer.trainer INFO     Train avg loss: 0.032830824470147485
2021-10-11 11:16:21,137 knodle.trainer.trainer INFO     Train avg accuracy: 0.9920969805934213
2021-10-11 11:16:21,137 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:21,137 knodle.trainer.trainer INFO     Training done
2021-10-11 11:16:21,137 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:21,137 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:16:21,145 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:21,150 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1119, samples in test set: 263
2021-10-11 11:16:21,157 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1247, samples in test set: 135
2021-10-11 11:16:21,164 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 906, samples in test set: 476
2021-10-11 11:16:21,169 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1139, samples in test set: 243
2021-10-11 11:16:21,177 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1117, samples in test set: 265
5it [00:06,  1.20s/it]
Prior: 129.1
2021-10-11 11:16:27,196 knodle.trainer.cleanlab.cleanlab INFO     [[0.01144032 0.98855968]
 [0.01079801 0.98920199]
 [0.         1.        ]
 [0.         1.        ]
 [0.9073355  0.0926645 ]
 [0.         1.        ]
 [0.86473092 0.13526908]
 [0.93359519 0.06640481]
 [0.98559337 0.01440663]
 [0.70650245 0.29349755]]
2021-10-11 11:16:27,237 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:16:27,238 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:27,238 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:16:27,238 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:28,816 knodle.trainer.trainer INFO     Train avg loss: 0.0022768989358816975
2021-10-11 11:16:28,816 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:16:28,816 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:28,816 knodle.trainer.trainer INFO     Training done
2021-10-11 11:16:28,816 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:28,816 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:16:28,816 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 346.38it/s]
2021-10-11 11:16:28,828 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:16:28,828 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:16:28,828 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.936
Precision is: 0.941954926624738
Recall is: 0.9331022085259373
F1 is: 0.9353002070393375
{'0': {'precision': 0.9027777777777778, 'recall': 0.9848484848484849, 'f1-score': 0.9420289855072465, 'support': 132}, '1': {'precision': 0.9811320754716981, 'recall': 0.8813559322033898, 'f1-score': 0.9285714285714285, 'support': 118}, 'accuracy': 0.936, 'macro avg': {'precision': 0.941954926624738, 'recall': 0.9331022085259373, 'f1-score': 0.9353002070393375, 'support': 250}, 'weighted avg': {'precision': 0.9397610062893081, 'recall': 0.936, 'f1-score': 0.9356770186335404, 'support': 250}}
2021-10-11 11:16:28,880 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:16:28,890 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:28,895 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 949, samples in test set: 433
2021-10-11 11:16:28,900 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1220, samples in test set: 162
2021-10-11 11:16:28,908 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1222, samples in test set: 160
2021-10-11 11:16:28,913 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1129, samples in test set: 253
2021-10-11 11:16:28,922 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1008, samples in test set: 374
5it [00:05,  1.17s/it]
2021-10-11 11:16:34,772 knodle.trainer.cleanlab.cleanlab INFO     [[0.08286212 0.91713788]
 [0.03754385 0.96245615]
 [0.05620364 0.94379636]
 [0.00878206 0.99121794]
 [0.87808923 0.12191077]
 [0.02681391 0.97318609]
 [0.82768833 0.17231167]
 [0.894555   0.105445  ]
 [0.98624822 0.01375178]
 [0.72928585 0.27071415]]
Prior: 129.09999999999997
2021-10-11 11:16:34,809 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 106 out of 1382
2021-10-11 11:16:34,809 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:34,809 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:16:34,809 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:36,222 knodle.trainer.trainer INFO     Train avg loss: 0.03250822232979716
2021-10-11 11:16:36,222 knodle.trainer.trainer INFO     Train avg accuracy: 0.9914108919374871
2021-10-11 11:16:36,222 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:36,222 knodle.trainer.trainer INFO     Training done
2021-10-11 11:16:36,222 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:36,222 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:16:36,231 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:36,235 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1176, samples in test set: 206
2021-10-11 11:16:36,238 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1177, samples in test set: 205
2021-10-11 11:16:36,242 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 959, samples in test set: 423
2021-10-11 11:16:36,251 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1175, samples in test set: 207
2021-10-11 11:16:36,270 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1041, samples in test set: 341
5it [00:05,  1.11s/it]
2021-10-11 11:16:41,816 knodle.trainer.cleanlab.cleanlab INFO     [[0.01281867 0.98718133]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.92738129 0.07261871]
 [0.         1.        ]
 [0.85790734 0.14209266]
 [0.93359519 0.06640481]
 [0.98559337 0.01440663]
 [0.7411748  0.2588252 ]]
Prior: 129.09999999999997
2021-10-11 11:16:41,848 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:16:41,849 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:41,849 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:16:41,849 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:43,129 knodle.trainer.trainer INFO     Train avg loss: 0.0022555866183459083
2021-10-11 11:16:43,129 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:16:43,129 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:43,129 knodle.trainer.trainer INFO     Training done
2021-10-11 11:16:43,129 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:43,129 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:16:43,129 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 331.19it/s]
2021-10-11 11:16:43,144 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:16:43,144 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:16:43,144 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.924
Precision is: 0.9324681328842217
Recall is: 0.9203903441191577
F1 is: 0.922963395449164
{'0': {'precision': 0.8843537414965986, 'recall': 0.9848484848484849, 'f1-score': 0.9318996415770608, 'support': 132}, '1': {'precision': 0.9805825242718447, 'recall': 0.8559322033898306, 'f1-score': 0.914027149321267, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9324681328842217, 'recall': 0.9203903441191577, 'f1-score': 0.922963395449164, 'support': 250}, 'weighted avg': {'precision': 0.9297737269665148, 'recall': 0.924, 'f1-score': 0.9234638252323262, 'support': 250}}
2021-10-11 11:16:43,205 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:16:43,215 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:43,223 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1177, samples in test set: 205
2021-10-11 11:16:43,228 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1216, samples in test set: 166
2021-10-11 11:16:43,235 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1128, samples in test set: 254
2021-10-11 11:16:43,242 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 860, samples in test set: 522
2021-10-11 11:16:43,255 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1147, samples in test set: 235
5it [00:05,  1.11s/it]
Prior: 129.1
2021-10-11 11:16:48,820 knodle.trainer.cleanlab.cleanlab INFO     [[0.11176844 0.88823156]
 [0.0583562  0.9416438 ]
 [0.12568617 0.87431383]
 [0.00512934 0.99487066]
 [0.93355151 0.06644849]
 [0.00943032 0.99056968]
 [0.84608125 0.15391875]
 [0.91585974 0.08414026]
 [0.98624822 0.01375178]
 [0.80913463 0.19086537]]
2021-10-11 11:16:48,864 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 106 out of 1382
2021-10-11 11:16:48,864 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:48,864 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:16:48,864 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:50,351 knodle.trainer.trainer INFO     Train avg loss: 0.03407941864817544
2021-10-11 11:16:50,351 knodle.trainer.trainer INFO     Train avg accuracy: 0.9908775251923186
2021-10-11 11:16:50,351 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:50,351 knodle.trainer.trainer INFO     Training done
2021-10-11 11:16:50,352 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:50,352 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:16:50,382 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:50,385 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1042, samples in test set: 340
2021-10-11 11:16:50,389 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 797, samples in test set: 585
2021-10-11 11:16:50,399 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1262, samples in test set: 120
2021-10-11 11:16:50,408 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1194, samples in test set: 188
2021-10-11 11:16:50,420 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1233, samples in test set: 149
5it [00:05,  1.11s/it]
2021-10-11 11:16:55,954 knodle.trainer.cleanlab.cleanlab INFO     [[0.02258916 0.97741084]
 [0.0135575  0.9864425 ]
 [0.04401132 0.95598868]
 [0.         1.        ]
 [0.93287883 0.06712117]
 [0.         1.        ]
 [0.85825732 0.14174268]
 [0.93952419 0.06047581]
 [0.99296421 0.00703579]
 [0.77816834 0.22183166]]
Prior: 129.1
2021-10-11 11:16:55,991 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 21 out of 1382
2021-10-11 11:16:55,991 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:55,991 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:16:55,991 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:57,415 knodle.trainer.trainer INFO     Train avg loss: 0.005349560675147749
2021-10-11 11:16:57,415 knodle.trainer.trainer INFO     Train avg accuracy: 0.9993547607551921
2021-10-11 11:16:57,415 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:57,416 knodle.trainer.trainer INFO     Training done
2021-10-11 11:16:57,416 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:16:57,416 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:16:57,424 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:16:57,427 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1167, samples in test set: 215
2021-10-11 11:16:57,431 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1252, samples in test set: 130
2021-10-11 11:16:57,434 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 871, samples in test set: 511
2021-10-11 11:16:57,439 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 972, samples in test set: 410
2021-10-11 11:16:57,448 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1266, samples in test set: 116
5it [00:05,  1.10s/it]
Prior: 129.10000000000002
2021-10-11 11:17:02,949 knodle.trainer.cleanlab.cleanlab INFO     [[0.01222931 0.98777069]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.90655681 0.09344319]
 [0.         1.        ]
 [0.87218052 0.12781948]
 [0.92619901 0.07380099]
 [0.98559337 0.01440663]
 [0.74410527 0.25589473]]
2021-10-11 11:17:03,003 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:17:03,003 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:03,004 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:03,004 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:04,486 knodle.trainer.trainer INFO     Train avg loss: 0.0010546082865348027
2021-10-11 11:17:04,486 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:17:04,486 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:04,486 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:04,486 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:04,486 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:17:04,486 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 389.41it/s]
2021-10-11 11:17:04,499 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:17:04,499 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:17:04,499 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.92
Precision is: 0.9255765199161425
Recall is: 0.9170518746789933
F1 is: 0.9191252587991718
{'0': {'precision': 0.8888888888888888, 'recall': 0.9696969696969697, 'f1-score': 0.927536231884058, 'support': 132}, '1': {'precision': 0.9622641509433962, 'recall': 0.864406779661017, 'f1-score': 0.9107142857142857, 'support': 118}, 'accuracy': 0.92, 'macro avg': {'precision': 0.9255765199161425, 'recall': 0.9170518746789933, 'f1-score': 0.9191252587991718, 'support': 250}, 'weighted avg': {'precision': 0.9235220125786163, 'recall': 0.92, 'f1-score': 0.9195962732919254, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:17:04,556 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:17:04,569 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:04,573 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1184, samples in test set: 198
2021-10-11 11:17:04,579 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1139, samples in test set: 243
2021-10-11 11:17:04,588 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1134, samples in test set: 248
2021-10-11 11:17:04,598 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1078, samples in test set: 304
2021-10-11 11:17:04,603 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 993, samples in test set: 389
5it [00:05,  1.14s/it]
2021-10-11 11:17:10,288 knodle.trainer.cleanlab.cleanlab INFO     [[0.09506079 0.90493921]
 [0.06148169 0.93851831]
 [0.07922037 0.92077963]
 [0.004912   0.995088  ]
 [0.90372519 0.09627481]
 [0.01831732 0.98168268]
 [0.80620404 0.19379596]
 [0.90470478 0.09529522]
 [0.98684612 0.01315388]
 [0.79984046 0.20015954]]
Prior: 129.1
2021-10-11 11:17:10,324 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 119 out of 1382
2021-10-11 11:17:10,324 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:10,324 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:10,324 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:11,751 knodle.trainer.trainer INFO     Train avg loss: 0.032510655598404506
2021-10-11 11:17:11,752 knodle.trainer.trainer INFO     Train avg accuracy: 0.9911913248625669
2021-10-11 11:17:11,752 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:11,752 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:11,752 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:11,752 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:17:11,792 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:11,797 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1188, samples in test set: 194
2021-10-11 11:17:11,807 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1245, samples in test set: 137
2021-10-11 11:17:11,812 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 924, samples in test set: 458
2021-10-11 11:17:11,817 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 975, samples in test set: 407
2021-10-11 11:17:11,828 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1196, samples in test set: 186
5it [00:06,  1.35s/it]
2021-10-11 11:17:18,577 knodle.trainer.cleanlab.cleanlab INFO     [[0.0109123  0.9890877 ]
 [0.01119427 0.98880573]
 [0.01948042 0.98051958]
 [0.         1.        ]
 [0.88972158 0.11027842]
 [0.         1.        ]
 [0.87148205 0.12851795]
 [0.92669599 0.07330401]
 [0.98655381 0.01344619]
 [0.67351157 0.32648843]]
Prior: 129.10000000000002
2021-10-11 11:17:18,624 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:17:18,624 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:18,624 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:18,624 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:20,182 knodle.trainer.trainer INFO     Train avg loss: 0.0022458890119609848
2021-10-11 11:17:20,182 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:17:20,182 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:20,182 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:20,182 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:20,182 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:17:20,182 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 369.71it/s]
2021-10-11 11:17:20,201 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:17:20,201 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:17:20,201 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.932
Precision is: 0.937030259460166
Recall is: 0.9293143297380586
F1 is: 0.9313131313131313
{'0': {'precision': 0.9020979020979021, 'recall': 0.9772727272727273, 'f1-score': 0.9381818181818181, 'support': 132}, '1': {'precision': 0.9719626168224299, 'recall': 0.8813559322033898, 'f1-score': 0.9244444444444444, 'support': 118}, 'accuracy': 0.932, 'macro avg': {'precision': 0.937030259460166, 'recall': 0.9293143297380586, 'f1-score': 0.9313131313131313, 'support': 250}, 'weighted avg': {'precision': 0.9350740474478793, 'recall': 0.932, 'f1-score': 0.9316977777777776, 'support': 250}}
2021-10-11 11:17:20,261 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:17:20,271 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:20,275 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1207, samples in test set: 175
2021-10-11 11:17:20,279 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1065, samples in test set: 317
2021-10-11 11:17:20,283 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1234, samples in test set: 148
2021-10-11 11:17:20,292 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1025, samples in test set: 357
2021-10-11 11:17:20,303 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 997, samples in test set: 385
5it [00:06,  1.35s/it]
2021-10-11 11:17:27,052 knodle.trainer.cleanlab.cleanlab INFO     [[0.07961527 0.92038473]
 [0.09490251 0.90509749]
 [0.13203395 0.86796605]
 [0.01932053 0.98067947]
 [0.90097448 0.09902552]
 [0.00570655 0.99429345]
 [0.83296318 0.16703682]
 [0.93952419 0.06047581]
 [0.98147719 0.01852281]
 [0.75805798 0.24194202]]
Prior: 129.10000000000002
2021-10-11 11:17:27,106 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 120 out of 1382
2021-10-11 11:17:27,106 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:27,106 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:27,106 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:28,745 knodle.trainer.trainer INFO     Train avg loss: 0.03416925689106751
2021-10-11 11:17:28,745 knodle.trainer.trainer INFO     Train avg accuracy: 0.9904996657010281
2021-10-11 11:17:28,745 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:28,745 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:28,745 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:28,745 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:17:28,752 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:28,755 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1258, samples in test set: 124
2021-10-11 11:17:28,760 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1053, samples in test set: 329
2021-10-11 11:17:28,765 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1047, samples in test set: 335
2021-10-11 11:17:28,772 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1203, samples in test set: 179
2021-10-11 11:17:28,779 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 967, samples in test set: 415
5it [00:06,  1.28s/it]
Prior: 129.10000000000002
2021-10-11 11:17:35,174 knodle.trainer.cleanlab.cleanlab INFO     [[0.01313518 0.98686482]
 [0.00628956 0.99371044]
 [0.01264155 0.98735845]
 [0.         1.        ]
 [0.92495113 0.07504887]
 [0.         1.        ]
 [0.85774929 0.14225071]
 [0.94058517 0.05941483]
 [0.992621   0.007379  ]
 [0.76256378 0.23743622]]
2021-10-11 11:17:35,250 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 18 out of 1382
2021-10-11 11:17:35,251 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:35,251 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:35,251 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:36,941 knodle.trainer.trainer INFO     Train avg loss: 0.00502429443277475
2021-10-11 11:17:36,941 knodle.trainer.trainer INFO     Train avg accuracy: 0.9993306223190193
2021-10-11 11:17:36,941 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:36,941 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:36,942 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:36,942 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:17:36,958 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:36,964 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1137, samples in test set: 245
2021-10-11 11:17:36,972 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1165, samples in test set: 217
2021-10-11 11:17:36,977 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1025, samples in test set: 357
2021-10-11 11:17:36,991 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1076, samples in test set: 306
2021-10-11 11:17:37,005 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1125, samples in test set: 257
5it [00:05,  1.07s/it]
2021-10-11 11:17:42,360 knodle.trainer.cleanlab.cleanlab INFO     [[0.01329937 0.98670063]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.91931254 0.08068746]
 [0.         1.        ]
 [0.87671605 0.12328395]
 [0.94194322 0.05805678]
 [0.98524199 0.01475801]
 [0.75452275 0.24547725]]
Prior: 129.1
2021-10-11 11:17:42,396 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:17:42,397 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:42,397 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:42,397 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:43,661 knodle.trainer.trainer INFO     Train avg loss: 0.0010531799449712378
2021-10-11 11:17:43,661 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:17:43,661 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:43,661 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:43,661 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:43,661 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:17:43,661 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 450.37it/s]
2021-10-11 11:17:43,670 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:17:43,670 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:17:43,670 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.932
Precision is: 0.938752052545156
Recall is: 0.9288649203903441
F1 is: 0.9311974874941316
{'0': {'precision': 0.896551724137931, 'recall': 0.9848484848484849, 'f1-score': 0.9386281588447654, 'support': 132}, '1': {'precision': 0.9809523809523809, 'recall': 0.8728813559322034, 'f1-score': 0.9237668161434978, 'support': 118}, 'accuracy': 0.932, 'macro avg': {'precision': 0.938752052545156, 'recall': 0.9288649203903441, 'f1-score': 0.9311974874941316, 'support': 250}, 'weighted avg': {'precision': 0.9363888341543514, 'recall': 0.932, 'f1-score': 0.931613605089767, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:17:43,713 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:17:43,721 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:43,724 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1196, samples in test set: 186
2021-10-11 11:17:43,730 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1022, samples in test set: 360
2021-10-11 11:17:43,734 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1035, samples in test set: 347
2021-10-11 11:17:43,739 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1153, samples in test set: 229
2021-10-11 11:17:43,754 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1122, samples in test set: 260
5it [00:05,  1.09s/it]
2021-10-11 11:17:49,217 knodle.trainer.cleanlab.cleanlab INFO     [[0.06108801 0.93891199]
 [0.05045837 0.94954163]
 [0.05776485 0.94223515]
 [0.00942465 0.99057535]
 [0.89409771 0.10590229]
 [0.01503753 0.98496247]
 [0.84006008 0.15993992]
 [0.91585974 0.08414026]
 [0.98624822 0.01375178]
 [0.71568008 0.28431992]]
Prior: 129.1
2021-10-11 11:17:49,251 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 122 out of 1382
2021-10-11 11:17:49,252 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:49,252 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:49,252 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:50,427 knodle.trainer.trainer INFO     Train avg loss: 0.03331204209349711
2021-10-11 11:17:50,428 knodle.trainer.trainer INFO     Train avg accuracy: 0.9909355503140075
2021-10-11 11:17:50,428 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:50,428 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:50,428 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:50,428 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:17:50,455 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:50,458 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1124, samples in test set: 258
2021-10-11 11:17:50,462 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 999, samples in test set: 383
2021-10-11 11:17:50,466 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1026, samples in test set: 356
2021-10-11 11:17:50,469 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1210, samples in test set: 172
2021-10-11 11:17:50,476 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1169, samples in test set: 213
5it [00:04,  1.03it/s]
2021-10-11 11:17:55,322 knodle.trainer.cleanlab.cleanlab INFO     [[0.01251705 0.98748295]
 [0.00554625 0.99445375]
 [0.         1.        ]
 [0.         1.        ]
 [0.91335267 0.08664733]
 [0.         1.        ]
 [0.85866115 0.14133885]
 [0.94308159 0.05691841]
 [0.98524199 0.01475801]
 [0.7499225  0.2500775 ]]
Prior: 129.09999999999997
2021-10-11 11:17:55,358 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:17:55,358 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:55,358 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:17:55,358 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:56,587 knodle.trainer.trainer INFO     Train avg loss: 0.002327516857026653
2021-10-11 11:17:56,587 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:17:56,587 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:56,587 knodle.trainer.trainer INFO     Training done
2021-10-11 11:17:56,587 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:17:56,587 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:17:56,587 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 393.02it/s]
2021-10-11 11:17:56,598 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:17:56,599 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:17:56,599 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.932
Precision is: 0.938752052545156
Recall is: 0.9288649203903441
F1 is: 0.9311974874941316
{'0': {'precision': 0.896551724137931, 'recall': 0.9848484848484849, 'f1-score': 0.9386281588447654, 'support': 132}, '1': {'precision': 0.9809523809523809, 'recall': 0.8728813559322034, 'f1-score': 0.9237668161434978, 'support': 118}, 'accuracy': 0.932, 'macro avg': {'precision': 0.938752052545156, 'recall': 0.9288649203903441, 'f1-score': 0.9311974874941316, 'support': 250}, 'weighted avg': {'precision': 0.9363888341543514, 'recall': 0.932, 'f1-score': 0.931613605089767, 'support': 250}}
2021-10-11 11:17:56,637 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:17:56,646 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:17:56,656 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1154, samples in test set: 228
2021-10-11 11:17:56,664 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1153, samples in test set: 229
2021-10-11 11:17:56,670 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 998, samples in test set: 384
2021-10-11 11:17:56,678 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 976, samples in test set: 406
2021-10-11 11:17:56,686 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1247, samples in test set: 135
5it [00:04,  1.03it/s]
2021-10-11 11:18:01,557 knodle.trainer.cleanlab.cleanlab INFO     [[0.06875865 0.93124135]
 [0.04614108 0.95385892]
 [0.07749819 0.92250181]
 [0.01063515 0.98936485]
 [0.90338739 0.09661261]
 [0.00642296 0.99357704]
 [0.85082454 0.14917546]
 [0.87193358 0.12806642]
 [0.99342306 0.00657694]
 [0.77887109 0.22112891]]
Prior: 129.10000000000002
2021-10-11 11:18:01,586 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 115 out of 1382
2021-10-11 11:18:01,586 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:01,586 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:01,586 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:02,783 knodle.trainer.trainer INFO     Train avg loss: 0.03280429782726887
2021-10-11 11:18:02,783 knodle.trainer.trainer INFO     Train avg accuracy: 0.991208964586258
2021-10-11 11:18:02,783 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:02,783 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:02,783 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:02,783 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:18:02,790 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:02,798 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1178, samples in test set: 204
2021-10-11 11:18:02,807 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1267, samples in test set: 115
2021-10-11 11:18:02,811 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1144, samples in test set: 238
2021-10-11 11:18:02,814 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 816, samples in test set: 566
2021-10-11 11:18:02,818 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1123, samples in test set: 259
5it [00:04,  1.01it/s]
2021-10-11 11:18:07,763 knodle.trainer.cleanlab.cleanlab INFO     [[0.0130546  0.9869454 ]
 [0.0061625  0.9938375 ]
 [0.         1.        ]
 [0.         1.        ]
 [0.91938781 0.08061219]
 [0.         1.        ]
 [0.88204313 0.11795687]
 [0.95063199 0.04936801]
 [0.98524199 0.01475801]
 [0.77316659 0.22683341]]
Prior: 129.1
2021-10-11 11:18:07,804 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:18:07,804 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:07,804 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:07,804 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:09,057 knodle.trainer.trainer INFO     Train avg loss: 0.0022897675800997988
2021-10-11 11:18:09,057 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:18:09,057 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:09,057 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:09,057 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:09,057 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:18:09,058 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 446.32it/s]
2021-10-11 11:18:09,066 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:18:09,066 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:18:09,066 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.928
Precision is: 0.9337657232704403
Recall is: 0.9250770416024654
F1 is: 0.9272127329192548
{'0': {'precision': 0.8958333333333334, 'recall': 0.9772727272727273, 'f1-score': 0.9347826086956522, 'support': 132}, '1': {'precision': 0.9716981132075472, 'recall': 0.8728813559322034, 'f1-score': 0.9196428571428572, 'support': 118}, 'accuracy': 0.928, 'macro avg': {'precision': 0.9337657232704403, 'recall': 0.9250770416024654, 'f1-score': 0.9272127329192548, 'support': 250}, 'weighted avg': {'precision': 0.9316415094339623, 'recall': 0.928, 'f1-score': 0.9276366459627329, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:18:09,117 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:18:09,155 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:09,159 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1018, samples in test set: 364
2021-10-11 11:18:09,163 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1087, samples in test set: 295
2021-10-11 11:18:09,166 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1157, samples in test set: 225
2021-10-11 11:18:09,169 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1048, samples in test set: 334
2021-10-11 11:18:09,176 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1218, samples in test set: 164
5it [00:05,  1.04s/it]
2021-10-11 11:18:14,381 knodle.trainer.cleanlab.cleanlab INFO     [[0.09655389 0.90344611]
 [0.06257309 0.93742691]
 [0.07639107 0.92360893]
 [0.00865098 0.99134902]
 [0.89967152 0.10032848]
 [0.02567948 0.97432052]
 [0.84793889 0.15206111]
 [0.91462239 0.08537761]
 [0.99296421 0.00703579]
 [0.76383214 0.23616786]]
Prior: 129.1
2021-10-11 11:18:14,422 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 111 out of 1382
2021-10-11 11:18:14,422 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:14,422 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:14,423 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:15,784 knodle.trainer.trainer INFO     Train avg loss: 0.033756901088848025
2021-10-11 11:18:15,784 knodle.trainer.trainer INFO     Train avg accuracy: 0.9901018455173031
2021-10-11 11:18:15,784 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:15,784 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:15,784 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:15,784 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:18:15,792 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:15,798 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1061, samples in test set: 321
2021-10-11 11:18:15,804 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1042, samples in test set: 340
2021-10-11 11:18:15,813 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1282, samples in test set: 100
2021-10-11 11:18:15,819 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 922, samples in test set: 460
2021-10-11 11:18:15,825 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1221, samples in test set: 161
5it [00:05,  1.05s/it]
2021-10-11 11:18:21,108 knodle.trainer.cleanlab.cleanlab INFO     [[0.02488771 0.97511229]
 [0.00622538 0.99377462]
 [0.         1.        ]
 [0.         1.        ]
 [0.91064494 0.08935506]
 [0.00299134 0.99700866]
 [0.88878864 0.11121136]
 [0.9552031  0.0447969 ]
 [0.99159613 0.00840387]
 [0.74114254 0.25885746]]
Prior: 129.1
2021-10-11 11:18:21,142 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 7 out of 1382
2021-10-11 11:18:21,142 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:21,142 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:21,142 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:22,417 knodle.trainer.trainer INFO     Train avg loss: 0.0037744651830783392
2021-10-11 11:18:22,417 knodle.trainer.trainer INFO     Train avg accuracy: 0.9997038398728226
2021-10-11 11:18:22,417 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:22,417 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:22,417 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:22,417 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:18:22,425 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:22,430 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1043, samples in test set: 339
2021-10-11 11:18:22,434 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1197, samples in test set: 185
2021-10-11 11:18:22,438 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1050, samples in test set: 332
2021-10-11 11:18:22,447 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1100, samples in test set: 282
2021-10-11 11:18:22,456 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1138, samples in test set: 244
5it [00:05,  1.01s/it]
2021-10-11 11:18:27,532 knodle.trainer.cleanlab.cleanlab INFO     [[0.02026571 0.97973429]
 [0.00604047 0.99395953]
 [0.         1.        ]
 [0.         1.        ]
 [0.90723887 0.09276113]
 [0.         1.        ]
 [0.87519513 0.12480487]
 [0.91764996 0.08235004]
 [0.99224259 0.00775741]
 [0.74658813 0.25341187]]
Prior: 129.10000000000002
2021-10-11 11:18:27,570 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:18:27,570 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:27,570 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:27,570 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:28,768 knodle.trainer.trainer INFO     Train avg loss: 0.0010714855493984719
2021-10-11 11:18:28,768 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:18:28,768 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:28,768 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:28,768 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:28,768 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:18:28,768 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 501.47it/s]
2021-10-11 11:18:28,776 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:18:28,776 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:18:28,776 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.908
Precision is: 0.9159566739317087
Recall is: 0.9043400102722137
F1 is: 0.9067451629121457
{'0': {'precision': 0.8707482993197279, 'recall': 0.9696969696969697, 'f1-score': 0.9175627240143368, 'support': 132}, '1': {'precision': 0.9611650485436893, 'recall': 0.8389830508474576, 'f1-score': 0.8959276018099547, 'support': 118}, 'accuracy': 0.908, 'macro avg': {'precision': 0.9159566739317087, 'recall': 0.9043400102722137, 'f1-score': 0.9067451629121457, 'support': 250}, 'weighted avg': {'precision': 0.9134250049534377, 'recall': 0.908, 'f1-score': 0.9073509463338685, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:18:28,821 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:18:28,827 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:28,831 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1039, samples in test set: 343
2021-10-11 11:18:28,837 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 934, samples in test set: 448
2021-10-11 11:18:28,841 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1061, samples in test set: 321
2021-10-11 11:18:28,845 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1237, samples in test set: 145
2021-10-11 11:18:28,852 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1257, samples in test set: 125
5it [00:04,  1.01it/s]
2021-10-11 11:18:33,799 knodle.trainer.cleanlab.cleanlab INFO     [[0.10186751 0.89813249]
 [0.07501077 0.92498923]
 [0.14303678 0.85696322]
 [0.00475095 0.99524905]
 [0.90680599 0.09319401]
 [0.03238241 0.96761759]
 [0.86818616 0.13181384]
 [0.91706175 0.08293825]
 [0.98655381 0.01344619]
 [0.80958849 0.19041151]]
Prior: 129.10000000000002
2021-10-11 11:18:33,831 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 133 out of 1382
2021-10-11 11:18:33,831 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:33,831 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:33,831 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:35,082 knodle.trainer.trainer INFO     Train avg loss: 0.0355055596305509
2021-10-11 11:18:35,083 knodle.trainer.trainer INFO     Train avg accuracy: 0.9912089644056378
2021-10-11 11:18:35,083 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:35,083 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:35,083 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:35,083 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:18:35,089 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:35,097 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1189, samples in test set: 193
2021-10-11 11:18:35,105 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1277, samples in test set: 105
2021-10-11 11:18:35,110 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 965, samples in test set: 417
2021-10-11 11:18:35,114 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1055, samples in test set: 327
2021-10-11 11:18:35,118 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1042, samples in test set: 340
5it [00:04,  1.03it/s]
2021-10-11 11:18:39,973 knodle.trainer.cleanlab.cleanlab INFO     [[0.02837199 0.97162801]
 [0.00642197 0.99357803]
 [0.16390422 0.83609578]
 [0.         1.        ]
 [0.93471777 0.06528223]
 [0.         1.        ]
 [0.89957041 0.10042959]
 [0.94160956 0.05839044]
 [0.99224259 0.00775741]
 [0.80438257 0.19561743]]
Prior: 129.09999999999997
2021-10-11 11:18:40,010 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 12 out of 1382
2021-10-11 11:18:40,010 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:40,010 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:40,010 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:41,310 knodle.trainer.trainer INFO     Train avg loss: 0.004673980419157129
2021-10-11 11:18:41,310 knodle.trainer.trainer INFO     Train avg accuracy: 0.9995678289370103
2021-10-11 11:18:41,310 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:41,310 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:41,310 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:41,310 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:18:41,318 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:41,323 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1135, samples in test set: 247
2021-10-11 11:18:41,327 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1096, samples in test set: 286
2021-10-11 11:18:41,335 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1080, samples in test set: 302
2021-10-11 11:18:41,339 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1034, samples in test set: 348
2021-10-11 11:18:41,347 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1183, samples in test set: 199
5it [00:04,  1.06it/s]
2021-10-11 11:18:46,062 knodle.trainer.cleanlab.cleanlab INFO     [[0.01390784 0.98609216]
 [0.01208094 0.98791906]
 [0.19805093 0.80194907]
 [0.         1.        ]
 [0.93553774 0.06446226]
 [0.         1.        ]
 [0.90926395 0.09073605]
 [0.9552031  0.0447969 ]
 [0.992621   0.007379  ]
 [0.78922039 0.21077961]]
Prior: 129.10000000000002
2021-10-11 11:18:46,091 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:18:46,091 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:46,091 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:46,091 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:47,292 knodle.trainer.trainer INFO     Train avg loss: 0.0011503325094412446
2021-10-11 11:18:47,292 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:18:47,292 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:47,292 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:47,292 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:47,292 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:18:47,292 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 385.81it/s]
2021-10-11 11:18:47,301 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:18:47,301 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:18:47,301 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.904
Precision is: 0.9128245892951776
Recall is: 0.9001027221366205
F1 is: 0.9025974025974026
{'0': {'precision': 0.8648648648648649, 'recall': 0.9696969696969697, 'f1-score': 0.9142857142857143, 'support': 132}, '1': {'precision': 0.9607843137254902, 'recall': 0.8305084745762712, 'f1-score': 0.890909090909091, 'support': 118}, 'accuracy': 0.904, 'macro avg': {'precision': 0.9128245892951776, 'recall': 0.9001027221366205, 'f1-score': 0.9025974025974026, 'support': 250}, 'weighted avg': {'precision': 0.9101388447270801, 'recall': 0.904, 'f1-score': 0.9032519480519482, 'support': 250}}
2021-10-11 11:18:47,341 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:18:47,349 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:47,353 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1239, samples in test set: 143
2021-10-11 11:18:47,360 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1194, samples in test set: 188
2021-10-11 11:18:47,365 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1184, samples in test set: 198
2021-10-11 11:18:47,369 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 964, samples in test set: 418
2021-10-11 11:18:47,374 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 947, samples in test set: 435
5it [00:04,  1.02it/s]
2021-10-11 11:18:52,274 knodle.trainer.cleanlab.cleanlab INFO     [[0.07841504 0.92158496]
 [0.0965972  0.9034028 ]
 [0.0742691  0.9257309 ]
 [0.0101687  0.9898313 ]
 [0.90868306 0.09131694]
 [0.01997293 0.98002707]
 [0.81307324 0.18692676]
 [0.87594706 0.12405294]
 [0.993563   0.006437  ]
 [0.74781203 0.25218797]]
Prior: 129.1
2021-10-11 11:18:52,309 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 117 out of 1382
2021-10-11 11:18:52,309 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:52,309 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:52,309 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:53,512 knodle.trainer.trainer INFO     Train avg loss: 0.03262572784936338
2021-10-11 11:18:53,512 knodle.trainer.trainer INFO     Train avg accuracy: 0.9914814504710111
2021-10-11 11:18:53,512 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:53,512 knodle.trainer.trainer INFO     Training done
2021-10-11 11:18:53,512 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:53,512 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:18:53,520 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:18:53,526 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 910, samples in test set: 472
2021-10-11 11:18:53,530 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1134, samples in test set: 248
2021-10-11 11:18:53,533 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1257, samples in test set: 125
2021-10-11 11:18:53,541 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1211, samples in test set: 171
2021-10-11 11:18:53,546 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1016, samples in test set: 366
5it [00:06,  1.21s/it]
2021-10-11 11:18:59,582 knodle.trainer.cleanlab.cleanlab INFO     [[0.01144032 0.98855968]
 [0.01079801 0.98920199]
 [0.         1.        ]
 [0.         1.        ]
 [0.8948596  0.1051404 ]
 [0.         1.        ]
 [0.8371641  0.1628359 ]
 [0.9032387  0.0967613 ]
 [0.98487304 0.01512696]
 [0.71524276 0.28475724]]
Prior: 129.09999999999997
2021-10-11 11:18:59,621 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:18:59,621 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:59,621 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:59,622 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:00,975 knodle.trainer.trainer INFO     Train avg loss: 0.002274615389196146
2021-10-11 11:19:00,975 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:19:00,975 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:00,975 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:00,975 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:00,976 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:19:00,976 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 463.36it/s]
2021-10-11 11:19:00,985 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:19:00,985 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:19:00,986 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.924
Precision is: 0.9324681328842217
Recall is: 0.9203903441191577
F1 is: 0.922963395449164
{'0': {'precision': 0.8843537414965986, 'recall': 0.9848484848484849, 'f1-score': 0.9318996415770608, 'support': 132}, '1': {'precision': 0.9805825242718447, 'recall': 0.8559322033898306, 'f1-score': 0.914027149321267, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9324681328842217, 'recall': 0.9203903441191577, 'f1-score': 0.922963395449164, 'support': 250}, 'weighted avg': {'precision': 0.9297737269665148, 'recall': 0.924, 'f1-score': 0.9234638252323262, 'support': 250}}
2021-10-11 11:19:01,037 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:19:01,064 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:01,067 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1072, samples in test set: 310
2021-10-11 11:19:01,071 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1006, samples in test set: 376
2021-10-11 11:19:01,078 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1218, samples in test set: 164
2021-10-11 11:19:01,081 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1190, samples in test set: 192
2021-10-11 11:19:01,084 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1042, samples in test set: 340
5it [00:05,  1.13s/it]
2021-10-11 11:19:06,722 knodle.trainer.cleanlab.cleanlab INFO     [[0.10132853 0.89867147]
 [0.0968393  0.9031607 ]
 [0.1071423  0.8928577 ]
 [0.01053847 0.98946153]
 [0.89044591 0.10955409]
 [0.03015657 0.96984343]
 [0.86219462 0.13780538]
 [0.92320532 0.07679468]
 [0.98026918 0.01973082]
 [0.78478758 0.21521242]]
Prior: 129.10000000000002
2021-10-11 11:19:06,751 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 121 out of 1382
2021-10-11 11:19:06,751 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:06,751 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:06,752 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:07,872 knodle.trainer.trainer INFO     Train avg loss: 0.03375627421632859
2021-10-11 11:19:07,872 knodle.trainer.trainer INFO     Train avg accuracy: 0.9914280671061891
2021-10-11 11:19:07,872 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:07,872 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:07,872 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:07,872 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:19:07,879 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:07,882 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1194, samples in test set: 188
2021-10-11 11:19:07,885 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 943, samples in test set: 439
2021-10-11 11:19:07,892 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1137, samples in test set: 245
2021-10-11 11:19:07,897 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1084, samples in test set: 298
2021-10-11 11:19:07,905 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1170, samples in test set: 212
5it [00:04,  1.15it/s]
2021-10-11 11:19:12,250 knodle.trainer.cleanlab.cleanlab INFO     [[0.02594999 0.97405001]
 [0.01298059 0.98701941]
 [0.03427805 0.96572195]
 [0.         1.        ]
 [0.9288716  0.0711284 ]
 [0.         1.        ]
 [0.87138165 0.12861835]
 [0.95680299 0.04319701]
 [0.99296421 0.00703579]
 [0.74835407 0.25164593]]
Prior: 129.1
2021-10-11 11:19:12,276 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 16 out of 1382
2021-10-11 11:19:12,277 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:12,277 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:12,277 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:13,299 knodle.trainer.trainer INFO     Train avg loss: 0.004335660763635216
2021-10-11 11:19:13,300 knodle.trainer.trainer INFO     Train avg accuracy: 0.9995084112340753
2021-10-11 11:19:13,300 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:13,300 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:13,300 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:13,300 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:19:13,306 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:13,310 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 846, samples in test set: 536
2021-10-11 11:19:13,313 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1197, samples in test set: 185
2021-10-11 11:19:13,317 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1063, samples in test set: 319
2021-10-11 11:19:13,324 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1165, samples in test set: 217
2021-10-11 11:19:13,330 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1257, samples in test set: 125
5it [00:04,  1.23it/s]
2021-10-11 11:19:17,412 knodle.trainer.cleanlab.cleanlab INFO     [[0.00371361 0.99628639]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.89870216 0.10129784]
 [0.         1.        ]
 [0.8521113  0.1478887 ]
 [0.92259096 0.07740904]
 [0.98559337 0.01440663]
 [0.72376533 0.27623467]]
Prior: 129.1
2021-10-11 11:19:17,438 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:19:17,438 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:17,438 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:17,438 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:18,404 knodle.trainer.trainer INFO     Train avg loss: 0.0010132556414288103
2021-10-11 11:19:18,405 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:19:18,405 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:18,405 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:18,405 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:18,405 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:19:18,405 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 571.90it/s]
2021-10-11 11:19:18,413 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:19:18,413 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:19:18,413 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.924
Precision is: 0.9305418719211822
Recall is: 0.9208397534668722
F1 is: 0.923103074258147
{'0': {'precision': 0.8896551724137931, 'recall': 0.9772727272727273, 'f1-score': 0.9314079422382672, 'support': 132}, '1': {'precision': 0.9714285714285714, 'recall': 0.864406779661017, 'f1-score': 0.9147982062780269, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9305418719211822, 'recall': 0.9208397534668722, 'f1-score': 0.923103074258147, 'support': 250}, 'weighted avg': {'precision': 0.9282522167487685, 'recall': 0.924, 'f1-score': 0.9235681468650336, 'support': 250}}
2021-10-11 11:19:18,447 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:19:18,453 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:18,458 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 897, samples in test set: 485
2021-10-11 11:19:18,461 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1107, samples in test set: 275
2021-10-11 11:19:18,467 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1234, samples in test set: 148
2021-10-11 11:19:18,470 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1208, samples in test set: 174
2021-10-11 11:19:18,474 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1082, samples in test set: 300
5it [00:04,  1.03it/s]
2021-10-11 11:19:23,328 knodle.trainer.cleanlab.cleanlab INFO     [[0.09506079 0.90493921]
 [0.05284223 0.94715777]
 [0.07981157 0.92018843]
 [0.01756411 0.98243589]
 [0.91825087 0.08174913]
 [0.01862389 0.98137611]
 [0.82621588 0.17378412]
 [0.90750759 0.09249241]
 [0.98068899 0.01931101]
 [0.78112751 0.21887249]]
Prior: 129.1
2021-10-11 11:19:23,356 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 126 out of 1382
2021-10-11 11:19:23,356 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:23,356 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:23,356 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:24,533 knodle.trainer.trainer INFO     Train avg loss: 0.03299991253297776
2021-10-11 11:19:24,533 knodle.trainer.trainer INFO     Train avg accuracy: 0.9907118054953489
2021-10-11 11:19:24,533 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:24,533 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:24,534 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:24,534 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:19:24,540 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:24,544 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1065, samples in test set: 317
2021-10-11 11:19:24,550 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 824, samples in test set: 558
2021-10-11 11:19:24,553 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1216, samples in test set: 166
2021-10-11 11:19:24,561 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1196, samples in test set: 186
2021-10-11 11:19:24,568 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1227, samples in test set: 155
5it [00:05,  1.14s/it]
Prior: 129.10000000000002
2021-10-11 11:19:30,280 knodle.trainer.cleanlab.cleanlab INFO     [[0.01937977 0.98062023]
 [0.01634163 0.98365837]
 [0.         1.        ]
 [0.         1.        ]
 [0.92601347 0.07398653]
 [0.         1.        ]
 [0.82097079 0.17902921]
 [0.93842463 0.06157537]
 [0.99243652 0.00756348]
 [0.72745492 0.27254508]]
2021-10-11 11:19:30,331 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 11 out of 1382
2021-10-11 11:19:30,331 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:30,331 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:30,331 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:32,486 knodle.trainer.trainer INFO     Train avg loss: 0.0041935708615435
2021-10-11 11:19:32,486 knodle.trainer.trainer INFO     Train avg accuracy: 0.9995678289370103
2021-10-11 11:19:32,486 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:32,486 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:32,486 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:32,486 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:19:32,516 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:32,520 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1104, samples in test set: 278
2021-10-11 11:19:32,523 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 999, samples in test set: 383
2021-10-11 11:19:32,526 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1216, samples in test set: 166
2021-10-11 11:19:32,529 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1216, samples in test set: 166
2021-10-11 11:19:32,536 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 993, samples in test set: 389
5it [00:06,  1.31s/it]
Prior: 129.09999999999997
2021-10-11 11:19:39,123 knodle.trainer.cleanlab.cleanlab INFO     [[0.0042473  0.9957527 ]
 [0.01184636 0.98815364]
 [0.         1.        ]
 [0.         1.        ]
 [0.90723887 0.09276113]
 [0.         1.        ]
 [0.88296783 0.11703217]
 [0.93249212 0.06750788]
 [0.98407689 0.01592311]
 [0.75339671 0.24660329]]
2021-10-11 11:19:39,194 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:19:39,195 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:39,195 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:39,195 knodle.trainer.trainer INFO     ======================================
Accuracy is: 0.932
Precision is: 0.937030259460166
Recall is: 0.9293143297380586
F1 is: 0.9313131313131313
{'0': {'precision': 0.9020979020979021, 'recall': 0.9772727272727273, 'f1-score': 0.9381818181818181, 'support': 132}, '1': {'precision': 0.9719626168224299, 'recall': 0.8813559322033898, 'f1-score': 0.9244444444444444, 'support': 118}, 'accuracy': 0.932, 'macro avg': {'precision': 0.937030259460166, 'recall': 0.9293143297380586, 'f1-score': 0.9313131313131313, 'support': 250}, 'weighted avg': {'precision': 0.9350740474478793, 'recall': 0.932, 'f1-score': 0.9316977777777776, 'support': 250}}
2021-10-11 11:19:41,597 knodle.trainer.trainer INFO     Train avg loss: 0.0010437356001189487
2021-10-11 11:19:41,597 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:19:41,597 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:41,597 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:41,597 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:41,598 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:19:41,598 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 276.06it/s]
2021-10-11 11:19:41,619 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:19:41,619 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:19:41,619 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:19:41,711 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:19:41,724 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:41,749 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1127, samples in test set: 255
2021-10-11 11:19:41,777 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1055, samples in test set: 327
2021-10-11 11:19:41,795 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1185, samples in test set: 197
2021-10-11 11:19:41,813 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1077, samples in test set: 305
2021-10-11 11:19:41,829 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1084, samples in test set: 298
5it [00:07,  1.50s/it]
2021-10-11 11:19:49,321 knodle.trainer.cleanlab.cleanlab INFO     [[0.066845   0.933155  ]
 [0.04270613 0.95729387]
 [0.10070386 0.89929614]
 [0.01473599 0.98526401]
 [0.90983994 0.09016006]
 [0.00879666 0.99120334]
 [0.86317196 0.13682804]
 [0.91015023 0.08984977]
 [0.98684612 0.01315388]
 [0.79031691 0.20968309]]
Prior: 129.1
2021-10-11 11:19:49,373 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 124 out of 1382
2021-10-11 11:19:49,373 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:49,373 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:49,373 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:50,890 knodle.trainer.trainer INFO     Train avg loss: 0.03377943192749765
2021-10-11 11:19:50,890 knodle.trainer.trainer INFO     Train avg accuracy: 0.9905813648845211
2021-10-11 11:19:50,890 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:50,890 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:50,890 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:50,890 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:19:50,898 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:50,903 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1053, samples in test set: 329
2021-10-11 11:19:50,909 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1162, samples in test set: 220
2021-10-11 11:19:50,913 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1102, samples in test set: 280
2021-10-11 11:19:50,922 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1172, samples in test set: 210
2021-10-11 11:19:50,932 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1039, samples in test set: 343
5it [00:06,  1.23s/it]
Prior: 129.1
2021-10-11 11:19:57,092 knodle.trainer.cleanlab.cleanlab INFO     [[0.02086176 0.97913824]
 [0.01208094 0.98791906]
 [0.02640679 0.97359321]
 [0.         1.        ]
 [0.92338983 0.07661017]
 [0.         1.        ]
 [0.86389592 0.13610408]
 [0.93439912 0.06560088]
 [0.98592841 0.01407159]
 [0.76577659 0.23422341]]
2021-10-11 11:19:57,167 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 10 out of 1382
2021-10-11 11:19:57,167 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:57,168 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:19:57,168 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:59,061 knodle.trainer.trainer INFO     Train avg loss: 0.003456914221522201
2021-10-11 11:19:59,061 knodle.trainer.trainer INFO     Train avg accuracy: 0.9997159090909091
2021-10-11 11:19:59,061 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:59,061 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:59,061 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:59,061 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:19:59,072 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:59,079 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 901, samples in test set: 481
2021-10-11 11:19:59,083 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1095, samples in test set: 287
2021-10-11 11:19:59,089 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1125, samples in test set: 257
2021-10-11 11:19:59,093 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1178, samples in test set: 204
2021-10-11 11:19:59,105 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1229, samples in test set: 153
5it [00:05,  1.06s/it]
2021-10-11 11:20:04,415 knodle.trainer.cleanlab.cleanlab INFO     [[0.00375291 0.99624709]
 [0.00564896 0.99435104]
 [0.         1.        ]
 [0.         1.        ]
 [0.8948596  0.1051404 ]
 [0.         1.        ]
 [0.84250814 0.15749186]
 [0.91040621 0.08959379]
 [0.98559337 0.01440663]
 [0.71491165 0.28508835]]
Prior: 129.09999999999997
2021-10-11 11:20:04,444 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:20:04,444 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:04,444 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:04,444 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:05,837 knodle.trainer.trainer INFO     Train avg loss: 0.0010664052564551998
2021-10-11 11:20:05,837 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:20:05,837 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:05,837 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:05,837 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:05,838 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:20:05,838 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 296.11it/s]
2021-10-11 11:20:05,850 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:20:05,850 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:20:05,850 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.928
Precision is: 0.9337657232704403
Recall is: 0.9250770416024654
F1 is: 0.9272127329192548
{'0': {'precision': 0.8958333333333334, 'recall': 0.9772727272727273, 'f1-score': 0.9347826086956522, 'support': 132}, '1': {'precision': 0.9716981132075472, 'recall': 0.8728813559322034, 'f1-score': 0.9196428571428572, 'support': 118}, 'accuracy': 0.928, 'macro avg': {'precision': 0.9337657232704403, 'recall': 0.9250770416024654, 'f1-score': 0.9272127329192548, 'support': 250}, 'weighted avg': {'precision': 0.9316415094339623, 'recall': 0.928, 'f1-score': 0.9276366459627329, 'support': 250}}
2021-10-11 11:20:05,894 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:20:05,905 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:05,910 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1069, samples in test set: 313
2021-10-11 11:20:05,915 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1098, samples in test set: 284
2021-10-11 11:20:05,920 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1024, samples in test set: 358
2021-10-11 11:20:05,931 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1230, samples in test set: 152
2021-10-11 11:20:05,939 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1107, samples in test set: 275
5it [00:05,  1.18s/it]
2021-10-11 11:20:11,861 knodle.trainer.cleanlab.cleanlab INFO     [[0.10912303 0.89087697]
 [0.07733505 0.92266495]
 [0.0742691  0.9257309 ]
 [0.0045639  0.9954361 ]
 [0.8646456  0.1353544 ]
 [0.02776985 0.97223015]
 [0.83404083 0.16595917]
 [0.8821497  0.1178503 ]
 [0.9873942  0.0126058 ]
 [0.69623578 0.30376422]]
Prior: 129.1
2021-10-11 11:20:11,913 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 119 out of 1382
2021-10-11 11:20:11,913 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:11,913 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:11,913 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:13,432 knodle.trainer.trainer INFO     Train avg loss: 0.03347386229769184
2021-10-11 11:20:13,432 knodle.trainer.trainer INFO     Train avg accuracy: 0.9904806332154708
2021-10-11 11:20:13,432 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:13,432 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:13,432 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:13,432 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:20:13,439 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:13,444 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1078, samples in test set: 304
2021-10-11 11:20:13,449 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1124, samples in test set: 258
2021-10-11 11:20:13,458 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1171, samples in test set: 211
2021-10-11 11:20:13,466 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1219, samples in test set: 163
2021-10-11 11:20:13,471 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 936, samples in test set: 446
5it [00:05,  1.06s/it]
2021-10-11 11:20:18,796 knodle.trainer.cleanlab.cleanlab INFO     [[0.01209034 0.98790966]
 [0.00575554 0.99424446]
 [0.01007039 0.98992961]
 [0.         1.        ]
 [0.92890476 0.07109524]
 [0.         1.        ]
 [0.81017537 0.18982463]
 [0.9219667  0.0780333 ]
 [0.98524199 0.01475801]
 [0.7517931  0.2482069 ]]
Prior: 129.09999999999997
2021-10-11 11:20:18,827 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:20:18,828 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:18,828 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:18,828 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:20,214 knodle.trainer.trainer INFO     Train avg loss: 0.0023091911117786145
2021-10-11 11:20:20,214 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:20:20,214 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:20,214 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:20,214 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:20,214 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:20:20,214 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 473.16it/s]
2021-10-11 11:20:20,225 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:20:20,226 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:20:20,226 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.932
Precision is: 0.938752052545156
Recall is: 0.9288649203903441
F1 is: 0.9311974874941316
{'0': {'precision': 0.896551724137931, 'recall': 0.9848484848484849, 'f1-score': 0.9386281588447654, 'support': 132}, '1': {'precision': 0.9809523809523809, 'recall': 0.8728813559322034, 'f1-score': 0.9237668161434978, 'support': 118}, 'accuracy': 0.932, 'macro avg': {'precision': 0.938752052545156, 'recall': 0.9288649203903441, 'f1-score': 0.9311974874941316, 'support': 250}, 'weighted avg': {'precision': 0.9363888341543514, 'recall': 0.932, 'f1-score': 0.931613605089767, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:20:20,277 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:20:20,284 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:20,289 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1067, samples in test set: 315
2021-10-11 11:20:20,294 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 820, samples in test set: 562
2021-10-11 11:20:20,297 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1139, samples in test set: 243
2021-10-11 11:20:20,305 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1227, samples in test set: 155
2021-10-11 11:20:20,313 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1275, samples in test set: 107
5it [00:05,  1.19s/it]
2021-10-11 11:20:26,279 knodle.trainer.cleanlab.cleanlab INFO     [[0.08991123 0.91008877]
 [0.05358877 0.94641123]
 [0.11883056 0.88116944]
 [0.01233225 0.98766775]
 [0.90107331 0.09892669]
 [0.02747599 0.97252401]
 [0.7838347  0.2161653 ]
 [0.90968946 0.09031054]
 [0.96482103 0.03517897]
 [0.72769801 0.27230199]]
Prior: 129.1
2021-10-11 11:20:26,318 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 112 out of 1382
2021-10-11 11:20:26,318 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:26,319 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:26,319 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:27,738 knodle.trainer.trainer INFO     Train avg loss: 0.033572023467753426
2021-10-11 11:20:27,738 knodle.trainer.trainer INFO     Train avg accuracy: 0.9917112298084028
2021-10-11 11:20:27,738 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:27,738 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:27,738 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:27,739 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:20:27,745 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:27,749 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1187, samples in test set: 195
2021-10-11 11:20:27,755 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 915, samples in test set: 467
2021-10-11 11:20:27,764 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1234, samples in test set: 148
2021-10-11 11:20:27,768 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1009, samples in test set: 373
2021-10-11 11:20:27,776 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1183, samples in test set: 199
5it [00:04,  1.21it/s]
2021-10-11 11:20:31,922 knodle.trainer.cleanlab.cleanlab INFO     [[0.00810628 0.99189372]
 [0.01312016 0.98687984]
 [0.10333092 0.89666908]
 [0.         1.        ]
 [0.91888335 0.08111665]
 [0.         1.        ]
 [0.88145774 0.11854226]
 [0.94035263 0.05964737]
 [0.98624822 0.01375178]
 [0.69047551 0.30952449]]
Prior: 129.09999999999997
2021-10-11 11:20:31,947 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:20:31,947 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:31,947 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:31,947 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:32,938 knodle.trainer.trainer INFO     Train avg loss: 0.0023463670954559784
2021-10-11 11:20:32,938 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:20:32,938 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:32,938 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:32,938 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:32,938 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:20:32,938 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 546.45it/s]
2021-10-11 11:20:32,946 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:20:32,946 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:20:32,947 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.92
Precision is: 0.9293852676205617
Recall is: 0.9161530559835644
F1 is: 0.9188311688311688
{'0': {'precision': 0.8783783783783784, 'recall': 0.9848484848484849, 'f1-score': 0.9285714285714285, 'support': 132}, '1': {'precision': 0.9803921568627451, 'recall': 0.847457627118644, 'f1-score': 0.909090909090909, 'support': 118}, 'accuracy': 0.92, 'macro avg': {'precision': 0.9293852676205617, 'recall': 0.9161530559835644, 'f1-score': 0.9188311688311688, 'support': 250}, 'weighted avg': {'precision': 0.9265288818229994, 'recall': 0.92, 'f1-score': 0.9193766233766232, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:20:32,979 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:20:33,001 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:33,005 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1022, samples in test set: 360
2021-10-11 11:20:33,007 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1150, samples in test set: 232
2021-10-11 11:20:33,010 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1239, samples in test set: 143
2021-10-11 11:20:33,013 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1001, samples in test set: 381
2021-10-11 11:20:33,020 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1116, samples in test set: 266
5it [00:04,  1.03it/s]
Prior: 129.1
2021-10-11 11:20:37,895 knodle.trainer.cleanlab.cleanlab INFO     [[0.08145068 0.91854932]
 [0.06725375 0.93274625]
 [0.05796613 0.94203387]
 [0.01250969 0.98749031]
 [0.87896881 0.12103119]
 [0.02714091 0.97285909]
 [0.79147589 0.20852411]
 [0.91040621 0.08959379]
 [0.97983072 0.02016928]
 [0.75254537 0.24745463]]
2021-10-11 11:20:37,936 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 116 out of 1382
2021-10-11 11:20:37,936 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:37,936 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:37,936 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:39,066 knodle.trainer.trainer INFO     Train avg loss: 0.03214065257219993
2021-10-11 11:20:39,067 knodle.trainer.trainer INFO     Train avg accuracy: 0.9921977122624716
2021-10-11 11:20:39,067 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:39,067 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:39,067 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:39,067 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:20:39,072 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:39,076 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1233, samples in test set: 149
2021-10-11 11:20:39,079 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 935, samples in test set: 447
2021-10-11 11:20:39,085 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1213, samples in test set: 169
2021-10-11 11:20:39,089 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1118, samples in test set: 264
2021-10-11 11:20:39,097 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1029, samples in test set: 353
5it [00:04,  1.13it/s]
2021-10-11 11:20:43,543 knodle.trainer.cleanlab.cleanlab INFO     [[0.01202203 0.98797797]
 [0.00570175 0.99429825]
 [0.01212557 0.98787443]
 [0.         1.        ]
 [0.90655681 0.09344319]
 [0.         1.        ]
 [0.86821371 0.13178629]
 [0.92697261 0.07302739]
 [0.98592841 0.01407159]
 [0.7235054  0.2764946 ]]
Prior: 129.1
2021-10-11 11:20:43,571 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:20:43,571 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:43,571 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:43,571 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:44,657 knodle.trainer.trainer INFO     Train avg loss: 0.0022537201440145237
2021-10-11 11:20:44,657 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:20:44,657 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:44,657 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:44,657 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:44,657 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:20:44,657 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 537.94it/s]
2021-10-11 11:20:44,668 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:20:44,668 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:20:44,668 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.928
Precision is: 0.9355900948366702
Recall is: 0.9246276322547509
F1 is: 0.927085358740035
{'0': {'precision': 0.8904109589041096, 'recall': 0.9848484848484849, 'f1-score': 0.935251798561151, 'support': 132}, '1': {'precision': 0.9807692307692307, 'recall': 0.864406779661017, 'f1-score': 0.918918918918919, 'support': 118}, 'accuracy': 0.928, 'macro avg': {'precision': 0.9355900948366702, 'recall': 0.9246276322547509, 'f1-score': 0.927085358740035, 'support': 250}, 'weighted avg': {'precision': 0.9330600632244468, 'recall': 0.928, 'f1-score': 0.9275426793700174, 'support': 250}}
2021-10-11 11:20:44,709 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:20:44,716 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:44,720 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1174, samples in test set: 208
2021-10-11 11:20:44,725 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 973, samples in test set: 409
2021-10-11 11:20:44,730 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1081, samples in test set: 301
2021-10-11 11:20:44,738 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1024, samples in test set: 358
2021-10-11 11:20:44,748 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1276, samples in test set: 106
5it [00:05,  1.04s/it]
2021-10-11 11:20:49,942 knodle.trainer.cleanlab.cleanlab INFO     [[0.09429996 0.90570004]
 [0.06536653 0.93463347]
 [0.06601698 0.93398302]
 [0.         1.        ]
 [0.89472435 0.10527565]
 [0.02093936 0.97906064]
 [0.84527115 0.15472885]
 [0.92977003 0.07022997]
 [1.         0.        ]
 [0.79443832 0.20556168]]
Prior: 129.1
2021-10-11 11:20:49,987 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 128 out of 1382
2021-10-11 11:20:49,987 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:49,987 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:49,987 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:51,345 knodle.trainer.trainer INFO     Train avg loss: 0.03337152921241905
2021-10-11 11:20:51,345 knodle.trainer.trainer INFO     Train avg accuracy: 0.9904332847306222
2021-10-11 11:20:51,345 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:51,346 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:51,346 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:51,346 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:20:51,358 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:51,365 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1195, samples in test set: 187
2021-10-11 11:20:51,371 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1010, samples in test set: 372
2021-10-11 11:20:51,376 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1039, samples in test set: 343
2021-10-11 11:20:51,383 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1102, samples in test set: 280
2021-10-11 11:20:51,389 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1182, samples in test set: 200
5it [00:05,  1.04s/it]
2021-10-11 11:20:56,621 knodle.trainer.cleanlab.cleanlab INFO     [[0.02149393 0.97850607]
 [0.00693281 0.99306719]
 [0.         1.        ]
 [0.         1.        ]
 [0.92284262 0.07715738]
 [0.         1.        ]
 [0.87990817 0.12009183]
 [0.93842463 0.06157537]
 [0.99224259 0.00775741]
 [0.76679198 0.23320802]]
Prior: 129.10000000000002
2021-10-11 11:20:56,665 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 7 out of 1382
2021-10-11 11:20:56,665 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:56,665 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:20:56,665 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:58,071 knodle.trainer.trainer INFO     Train avg loss: 0.0034710700179196217
2021-10-11 11:20:58,071 knodle.trainer.trainer INFO     Train avg accuracy: 0.9997038398728226
2021-10-11 11:20:58,071 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:58,071 knodle.trainer.trainer INFO     Training done
2021-10-11 11:20:58,071 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:20:58,071 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:20:58,079 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:20:58,085 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1028, samples in test set: 354
2021-10-11 11:20:58,090 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1091, samples in test set: 291
2021-10-11 11:20:58,096 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1119, samples in test set: 263
2021-10-11 11:20:58,107 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1088, samples in test set: 294
2021-10-11 11:20:58,119 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1202, samples in test set: 180
5it [00:05,  1.01s/it]
2021-10-11 11:21:03,170 knodle.trainer.cleanlab.cleanlab INFO     [[0.01169175 0.98830825]
 [0.00564896 0.99435104]
 [0.         1.        ]
 [0.         1.        ]
 [0.91187693 0.08812307]
 [0.         1.        ]
 [0.87500646 0.12499354]
 [0.93952419 0.06047581]
 [0.98448517 0.01551483]
 [0.73667948 0.26332052]]
Prior: 129.09999999999997
2021-10-11 11:21:03,209 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:21:03,210 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:03,210 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:03,210 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:04,352 knodle.trainer.trainer INFO     Train avg loss: 0.0010393024655940915
2021-10-11 11:21:04,352 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:21:04,352 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:04,352 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:04,352 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:04,352 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:21:04,352 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 464.36it/s]
2021-10-11 11:21:04,362 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:21:04,363 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:21:04,363 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.928
Precision is: 0.9355900948366702
Recall is: 0.9246276322547509
F1 is: 0.927085358740035
{'0': {'precision': 0.8904109589041096, 'recall': 0.9848484848484849, 'f1-score': 0.935251798561151, 'support': 132}, '1': {'precision': 0.9807692307692307, 'recall': 0.864406779661017, 'f1-score': 0.918918918918919, 'support': 118}, 'accuracy': 0.928, 'macro avg': {'precision': 0.9355900948366702, 'recall': 0.9246276322547509, 'f1-score': 0.927085358740035, 'support': 250}, 'weighted avg': {'precision': 0.9330600632244468, 'recall': 0.928, 'f1-score': 0.9275426793700174, 'support': 250}}
2021-10-11 11:21:04,400 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:21:04,425 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:04,429 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1174, samples in test set: 208
2021-10-11 11:21:04,432 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 939, samples in test set: 443
2021-10-11 11:21:04,436 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1253, samples in test set: 129
2021-10-11 11:21:04,439 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1177, samples in test set: 205
2021-10-11 11:21:04,447 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 985, samples in test set: 397
5it [00:05,  1.06s/it]
2021-10-11 11:21:09,762 knodle.trainer.cleanlab.cleanlab INFO     [[0.07265997 0.92734003]
 [0.07022591 0.92977409]
 [0.11184052 0.88815948]
 [0.01288035 0.98711965]
 [0.90487818 0.09512182]
 [0.0347743  0.9652257 ]
 [0.81110789 0.18889211]
 [0.91334809 0.08665191]
 [0.98068899 0.01931101]
 [0.72587659 0.27412341]]
Prior: 129.1
2021-10-11 11:21:09,813 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 124 out of 1382
2021-10-11 11:21:09,813 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:09,813 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:09,813 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:11,363 knodle.trainer.trainer INFO     Train avg loss: 0.0332788092634556
2021-10-11 11:21:11,364 knodle.trainer.trainer INFO     Train avg accuracy: 0.9918124254905816
2021-10-11 11:21:11,364 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:11,364 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:11,364 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:11,364 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:21:11,373 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:11,376 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1123, samples in test set: 259
2021-10-11 11:21:11,380 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1144, samples in test set: 238
2021-10-11 11:21:11,385 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1049, samples in test set: 333
2021-10-11 11:21:11,396 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1237, samples in test set: 145
2021-10-11 11:21:11,406 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 975, samples in test set: 407
5it [00:05,  1.08s/it]
Prior: 129.1
2021-10-11 11:21:16,799 knodle.trainer.cleanlab.cleanlab INFO     [[0.01202203 0.98797797]
 [0.01184636 0.98815364]
 [0.03961019 0.96038981]
 [0.         1.        ]
 [0.89721249 0.10278751]
 [0.         1.        ]
 [0.89568281 0.10431719]
 [0.94075839 0.05924161]
 [0.98592841 0.01407159]
 [0.72848729 0.27151271]]
2021-10-11 11:21:16,840 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 10 out of 1382
2021-10-11 11:21:16,840 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:16,840 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:16,840 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:18,449 knodle.trainer.trainer INFO     Train avg loss: 0.0035819991906244075
2021-10-11 11:21:18,449 knodle.trainer.trainer INFO     Train avg accuracy: 0.9997038398728226
2021-10-11 11:21:18,449 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:18,449 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:18,449 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:18,450 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:21:18,459 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:18,462 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1164, samples in test set: 218
2021-10-11 11:21:18,466 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1261, samples in test set: 121
2021-10-11 11:21:18,471 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1038, samples in test set: 344
2021-10-11 11:21:18,480 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1007, samples in test set: 375
2021-10-11 11:21:18,488 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1058, samples in test set: 324
5it [00:05,  1.02s/it]
Prior: 129.1
2021-10-11 11:21:23,607 knodle.trainer.cleanlab.cleanlab INFO     [[0.01297499 0.98702501]
 [0.00642197 0.99357803]
 [0.         1.        ]
 [0.         1.        ]
 [0.90994136 0.09005864]
 [0.         1.        ]
 [0.84946561 0.15053439]
 [0.92962815 0.07037185]
 [0.99243652 0.00756348]
 [0.75452275 0.24547725]]
2021-10-11 11:21:23,644 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:21:23,645 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:23,645 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:23,645 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:24,892 knodle.trainer.trainer INFO     Train avg loss: 0.001062751327955277
2021-10-11 11:21:24,892 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:21:24,892 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:24,892 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:24,892 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:24,893 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:21:24,893 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 382.17it/s]
2021-10-11 11:21:24,904 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:21:24,905 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:21:24,905 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.924
Precision is: 0.9305418719211822
Recall is: 0.9208397534668722
F1 is: 0.923103074258147
{'0': {'precision': 0.8896551724137931, 'recall': 0.9772727272727273, 'f1-score': 0.9314079422382672, 'support': 132}, '1': {'precision': 0.9714285714285714, 'recall': 0.864406779661017, 'f1-score': 0.9147982062780269, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9305418719211822, 'recall': 0.9208397534668722, 'f1-score': 0.923103074258147, 'support': 250}, 'weighted avg': {'precision': 0.9282522167487685, 'recall': 0.924, 'f1-score': 0.9235681468650336, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:21:24,957 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:21:24,965 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:24,968 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 984, samples in test set: 398
2021-10-11 11:21:24,972 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1140, samples in test set: 242
2021-10-11 11:21:24,976 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1212, samples in test set: 170
2021-10-11 11:21:24,980 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1144, samples in test set: 238
2021-10-11 11:21:24,989 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1048, samples in test set: 334
5it [00:04,  1.03it/s]
2021-10-11 11:21:29,872 knodle.trainer.cleanlab.cleanlab INFO     [[0.09594392 0.90405608]
 [0.09351708 0.90648292]
 [0.05545426 0.94454574]
 [0.02264124 0.97735876]
 [0.89341447 0.10658553]
 [0.04121398 0.95878602]
 [0.85076913 0.14923087]
 [0.87904838 0.12095162]
 [0.97937233 0.02062767]
 [0.74561743 0.25438257]]
Prior: 129.1
2021-10-11 11:21:29,902 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 122 out of 1382
2021-10-11 11:21:29,903 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:29,903 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:29,903 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:31,053 knodle.trainer.trainer INFO     Train avg loss: 0.033063844908875505
2021-10-11 11:21:31,053 knodle.trainer.trainer INFO     Train avg accuracy: 0.9900201459725698
2021-10-11 11:21:31,053 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:31,053 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:31,053 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:31,053 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:21:31,060 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:31,064 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1224, samples in test set: 158
2021-10-11 11:21:31,075 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1208, samples in test set: 174
2021-10-11 11:21:31,080 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1065, samples in test set: 317
2021-10-11 11:21:31,085 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1168, samples in test set: 214
2021-10-11 11:21:31,094 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 863, samples in test set: 519
5it [00:04,  1.00it/s]
2021-10-11 11:21:36,098 knodle.trainer.cleanlab.cleanlab INFO     [[0.00849461 0.99150539]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.92668303 0.07331697]
 [0.         1.        ]
 [0.86249098 0.13750902]
 [0.91764996 0.08235004]
 [0.98559337 0.01440663]
 [0.77916966 0.22083034]]
Prior: 129.1
2021-10-11 11:21:36,127 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:21:36,128 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:36,128 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:36,128 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:37,288 knodle.trainer.trainer INFO     Train avg loss: 0.0022935555117190682
2021-10-11 11:21:37,289 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:21:37,289 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:37,289 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:37,289 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:37,289 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:21:37,289 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 491.05it/s]
2021-10-11 11:21:37,299 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:21:37,299 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:21:37,299 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.928
Precision is: 0.9355900948366702
Recall is: 0.9246276322547509
F1 is: 0.927085358740035
{'0': {'precision': 0.8904109589041096, 'recall': 0.9848484848484849, 'f1-score': 0.935251798561151, 'support': 132}, '1': {'precision': 0.9807692307692307, 'recall': 0.864406779661017, 'f1-score': 0.918918918918919, 'support': 118}, 'accuracy': 0.928, 'macro avg': {'precision': 0.9355900948366702, 'recall': 0.9246276322547509, 'f1-score': 0.927085358740035, 'support': 250}, 'weighted avg': {'precision': 0.9330600632244468, 'recall': 0.928, 'f1-score': 0.9275426793700174, 'support': 250}}
2021-10-11 11:21:37,337 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:21:37,358 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:37,362 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1164, samples in test set: 218
2021-10-11 11:21:37,366 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1121, samples in test set: 261
2021-10-11 11:21:37,369 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1009, samples in test set: 373
2021-10-11 11:21:37,377 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1144, samples in test set: 238
2021-10-11 11:21:37,385 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1090, samples in test set: 292
5it [00:05,  1.11s/it]
2021-10-11 11:21:42,933 knodle.trainer.cleanlab.cleanlab INFO     [[0.0950258  0.9049742 ]
 [0.04128412 0.95871588]
 [0.14043611 0.85956389]
 [0.01884929 0.98115071]
 [0.90691391 0.09308609]
 [0.0237773  0.9762227 ]
 [0.86862998 0.13137002]
 [0.93402639 0.06597361]
 [0.98026918 0.01973082]
 [0.72341228 0.27658772]]
Prior: 129.1
2021-10-11 11:21:42,980 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 117 out of 1382
2021-10-11 11:21:42,980 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:42,980 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:42,980 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:44,527 knodle.trainer.trainer INFO     Train avg loss: 0.03528327755065577
2021-10-11 11:21:44,528 knodle.trainer.trainer INFO     Train avg accuracy: 0.990196542487
2021-10-11 11:21:44,528 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:44,528 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:44,528 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:44,528 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:21:44,540 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:44,544 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1213, samples in test set: 169
2021-10-11 11:21:44,550 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 872, samples in test set: 510
2021-10-11 11:21:44,556 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1142, samples in test set: 240
2021-10-11 11:21:44,569 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1064, samples in test set: 318
2021-10-11 11:21:44,586 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1237, samples in test set: 145
5it [00:05,  1.19s/it]
2021-10-11 11:21:50,523 knodle.trainer.cleanlab.cleanlab INFO     [[0.01409205 0.98590795]
 [0.00564896 0.99435104]
 [0.16975794 0.83024206]
 [0.         1.        ]
 [0.94014219 0.05985781]
 [0.         1.        ]
 [0.89111674 0.10888326]
 [0.95601759 0.04398241]
 [0.992621   0.007379  ]
 [0.77967411 0.22032589]]
Prior: 129.10000000000002
2021-10-11 11:21:50,575 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 12 out of 1382
2021-10-11 11:21:50,575 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:50,576 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:50,576 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:52,470 knodle.trainer.trainer INFO     Train avg loss: 0.0047968391060942035
2021-10-11 11:21:52,470 knodle.trainer.trainer INFO     Train avg accuracy: 0.9995381199952328
2021-10-11 11:21:52,470 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:52,470 knodle.trainer.trainer INFO     Training done
2021-10-11 11:21:52,470 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:52,470 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:21:52,479 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:21:52,485 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1073, samples in test set: 309
2021-10-11 11:21:52,494 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1056, samples in test set: 326
2021-10-11 11:21:52,518 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1122, samples in test set: 260
2021-10-11 11:21:52,561 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1196, samples in test set: 186
2021-10-11 11:21:52,613 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1081, samples in test set: 301
5it [00:06,  1.22s/it]
Prior: 129.1
Accuracy is: 0.908
Precision is: 0.9159566739317087
Recall is: 0.9043400102722137
F1 is: 0.9067451629121457
{'0': {'precision': 0.8707482993197279, 'recall': 0.9696969696969697, 'f1-score': 0.9175627240143368, 'support': 132}, '1': {'precision': 0.9611650485436893, 'recall': 0.8389830508474576, 'f1-score': 0.8959276018099547, 'support': 118}, 'accuracy': 0.908, 'macro avg': {'precision': 0.9159566739317087, 'recall': 0.9043400102722137, 'f1-score': 0.9067451629121457, 'support': 250}, 'weighted avg': {'precision': 0.9134250049534377, 'recall': 0.908, 'f1-score': 0.9073509463338685, 'support': 250}}
2021-10-11 11:21:58,712 knodle.trainer.cleanlab.cleanlab INFO     [[0.02136445 0.97863555]
 [0.         1.        ]
 [0.23766111 0.76233889]
 [0.         1.        ]
 [0.91497985 0.08502015]
 [0.         1.        ]
 [0.91105555 0.08894445]
 [0.95601759 0.04398241]
 [0.97839006 0.02160994]
 [0.74459397 0.25540603]]
2021-10-11 11:21:58,746 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:21:58,746 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:21:58,746 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:21:58,746 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:00,058 knodle.trainer.trainer INFO     Train avg loss: 0.001117548931594656
2021-10-11 11:22:00,058 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:22:00,058 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:00,058 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:00,058 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:00,059 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:22:00,059 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 345.31it/s]
2021-10-11 11:22:00,070 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:22:00,070 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:22:00,070 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:22:00,118 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:22:00,126 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:00,130 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1129, samples in test set: 253
2021-10-11 11:22:00,133 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1229, samples in test set: 153
2021-10-11 11:22:00,137 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1169, samples in test set: 213
2021-10-11 11:22:00,142 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 992, samples in test set: 390
2021-10-11 11:22:00,148 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1009, samples in test set: 373
5it [00:04,  1.09it/s]
Prior: 129.09999999999997
2021-10-11 11:22:04,766 knodle.trainer.cleanlab.cleanlab INFO     [[0.10622363 0.89377637]
 [0.05631578 0.94368422]
 [0.09472001 0.90527999]
 [0.01347944 0.98652056]
 [0.88899399 0.11100601]
 [0.03410812 0.96589188]
 [0.82122545 0.17877455]
 [0.88576792 0.11423208]
 [0.9747884  0.0252116 ]
 [0.73192416 0.26807584]]
2021-10-11 11:22:04,816 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 124 out of 1382
2021-10-11 11:22:04,817 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:04,817 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:04,817 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:05,974 knodle.trainer.trainer INFO     Train avg loss: 0.03288078879457758
2021-10-11 11:22:05,974 knodle.trainer.trainer INFO     Train avg accuracy: 0.9906946299654064
2021-10-11 11:22:05,974 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:05,974 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:05,974 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:05,974 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:22:05,981 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:05,986 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 791, samples in test set: 591
2021-10-11 11:22:05,990 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1194, samples in test set: 188
2021-10-11 11:22:05,995 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1146, samples in test set: 236
2021-10-11 11:22:06,005 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1169, samples in test set: 213
2021-10-11 11:22:06,013 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1228, samples in test set: 154
5it [00:04,  1.21it/s]
2021-10-11 11:22:10,165 knodle.trainer.cleanlab.cleanlab INFO     [[0.01156467 0.98843533]
 [0.00564896 0.99435104]
 [0.         1.        ]
 [0.         1.        ]
 [0.91616069 0.08383931]
 [0.         1.        ]
 [0.85482232 0.14517768]
 [0.93209734 0.06790266]
 [0.98524199 0.01475801]
 [0.75016267 0.24983733]]
2021-10-11 11:22:10,189 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:22:10,190 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:10,190 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:10,190 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:11,193 knodle.trainer.trainer INFO     Train avg loss: 0.0022946996810126376
2021-10-11 11:22:11,193 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:22:11,194 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:11,194 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:11,194 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:11,194 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:22:11,194 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 547.20it/s]
2021-10-11 11:22:11,202 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:22:11,202 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:22:11,202 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:22:11,234 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:22:11,241 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:11,246 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1097, samples in test set: 285
2021-10-11 11:22:11,252 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1122, samples in test set: 260
2021-10-11 11:22:11,257 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1063, samples in test set: 319
2021-10-11 11:22:11,265 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1152, samples in test set: 230
2021-10-11 11:22:11,272 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1094, samples in test set: 288
2it [00:01,  1.24it/s]Prior: 129.09999999999997
Accuracy is: 0.932
Precision is: 0.938752052545156
Recall is: 0.9288649203903441
F1 is: 0.9311974874941316
{'0': {'precision': 0.896551724137931, 'recall': 0.9848484848484849, 'f1-score': 0.9386281588447654, 'support': 132}, '1': {'precision': 0.9809523809523809, 'recall': 0.8728813559322034, 'f1-score': 0.9237668161434978, 'support': 118}, 'accuracy': 0.932, 'macro avg': {'precision': 0.938752052545156, 'recall': 0.9288649203903441, 'f1-score': 0.9311974874941316, 'support': 250}, 'weighted avg': {'precision': 0.9363888341543514, 'recall': 0.932, 'f1-score': 0.931613605089767, 'support': 250}}
5it [00:04,  1.10it/s]
Prior: 129.09999999999997
2021-10-11 11:22:15,832 knodle.trainer.cleanlab.cleanlab INFO     [[0.06864191 0.93135809]
 [0.06896642 0.93103358]
 [0.07201852 0.92798148]
 [0.00999338 0.99000662]
 [0.90527994 0.09472006]
 [0.00613101 0.99386899]
 [0.83125872 0.16874128]
 [0.91936559 0.08063441]
 [0.97983072 0.02016928]
 [0.80918162 0.19081838]]
2021-10-11 11:22:15,867 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 119 out of 1382
2021-10-11 11:22:15,868 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:15,868 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:15,868 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:17,160 knodle.trainer.trainer INFO     Train avg loss: 0.032470375556272996
2021-10-11 11:22:17,161 knodle.trainer.trainer INFO     Train avg accuracy: 0.9914169266368404
2021-10-11 11:22:17,161 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:17,161 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:17,161 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:17,161 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:22:17,172 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:17,177 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1081, samples in test set: 301
2021-10-11 11:22:17,181 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 917, samples in test set: 465
2021-10-11 11:22:17,186 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1265, samples in test set: 117
2021-10-11 11:22:17,190 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1230, samples in test set: 152
2021-10-11 11:22:17,196 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1035, samples in test set: 347
5it [00:04,  1.09it/s]
Prior: 129.1
2021-10-11 11:22:21,797 knodle.trainer.cleanlab.cleanlab INFO     [[0.00365618 0.99634382]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.90468794 0.09531206]
 [0.         1.        ]
 [0.84527115 0.15472885]
 [0.92977003 0.07022997]
 [0.99182327 0.00817673]
 [0.6995556  0.3004444 ]]
2021-10-11 11:22:21,826 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:22:21,827 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:21,827 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:21,827 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:23,490 knodle.trainer.trainer INFO     Train avg loss: 0.0022508390628817408
2021-10-11 11:22:23,490 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:22:23,490 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:23,490 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:23,490 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:23,490 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:22:23,491 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 343.99it/s]
2021-10-11 11:22:23,505 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:22:23,505 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:22:23,505 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:22:23,554 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:22:23,562 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:23,569 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 972, samples in test set: 410
2021-10-11 11:22:23,573 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1213, samples in test set: 169
2021-10-11 11:22:23,579 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1170, samples in test set: 212
2021-10-11 11:22:23,590 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1216, samples in test set: 166
2021-10-11 11:22:23,601 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 957, samples in test set: 425
0it [00:00, ?it/s]Accuracy is: 0.924
Precision is: 0.9324681328842217
Recall is: 0.9203903441191577
F1 is: 0.922963395449164
{'0': {'precision': 0.8843537414965986, 'recall': 0.9848484848484849, 'f1-score': 0.9318996415770608, 'support': 132}, '1': {'precision': 0.9805825242718447, 'recall': 0.8559322033898306, 'f1-score': 0.914027149321267, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9324681328842217, 'recall': 0.9203903441191577, 'f1-score': 0.922963395449164, 'support': 250}, 'weighted avg': {'precision': 0.9297737269665148, 'recall': 0.924, 'f1-score': 0.9234638252323262, 'support': 250}}
5it [00:06,  1.23s/it]
Prior: 129.1
2021-10-11 11:22:29,736 knodle.trainer.cleanlab.cleanlab INFO     [[0.08364383 0.91635617]
 [0.04534435 0.95465565]
 [0.11426015 0.88573985]
 [0.00471232 0.99528768]
 [0.90372519 0.09627481]
 [0.04071137 0.95928863]
 [0.80767349 0.19232651]
 [0.90193112 0.09806888]
 [1.         0.        ]
 [0.70834279 0.29165721]]
2021-10-11 11:22:29,779 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 127 out of 1382
2021-10-11 11:22:29,779 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:29,780 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:29,780 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:31,252 knodle.trainer.trainer INFO     Train avg loss: 0.0339299505809322
2021-10-11 11:22:31,252 knodle.trainer.trainer INFO     Train avg accuracy: 0.9909954320300708
2021-10-11 11:22:31,252 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:31,252 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:31,253 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:31,253 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:22:31,281 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:31,285 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 997, samples in test set: 385
2021-10-11 11:22:31,290 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1187, samples in test set: 195
2021-10-11 11:22:31,294 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1146, samples in test set: 236
2021-10-11 11:22:31,305 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1248, samples in test set: 134
2021-10-11 11:22:31,311 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 950, samples in test set: 432
5it [00:06,  1.27s/it]
2021-10-11 11:22:37,677 knodle.trainer.cleanlab.cleanlab INFO     [[0.01602937 0.98397063]
 [0.01173245 0.98826755]
 [0.03792465 0.96207535]
 [0.         1.        ]
 [0.90516213 0.09483787]
 [0.         1.        ]
 [0.88221762 0.11778238]
 [0.93952419 0.06047581]
 [0.98592841 0.01407159]
 [0.72124695 0.27875305]]
2021-10-11 11:22:37,745 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 10 out of 1382
2021-10-11 11:22:37,745 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:37,746 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:37,746 knodle.trainer.trainer INFO     ======================================
Prior: 129.1
2021-10-11 11:22:39,240 knodle.trainer.trainer INFO     Train avg loss: 0.003769083294460099
2021-10-11 11:22:39,240 knodle.trainer.trainer INFO     Train avg accuracy: 0.9996388516642831
2021-10-11 11:22:39,240 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:39,240 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:39,240 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:39,240 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:22:39,250 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:39,255 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1167, samples in test set: 215
2021-10-11 11:22:39,259 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1066, samples in test set: 316
2021-10-11 11:22:39,264 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1207, samples in test set: 175
2021-10-11 11:22:39,274 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 959, samples in test set: 423
2021-10-11 11:22:39,283 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1129, samples in test set: 253
5it [00:05,  1.11s/it]
2021-10-11 11:22:44,851 knodle.trainer.cleanlab.cleanlab INFO     [[0.01338301 0.98661699]
 [0.00628956 0.99371044]
 [0.         1.        ]
 [0.         1.        ]
 [0.90372519 0.09627481]
 [0.         1.        ]
 [0.86923989 0.13076011]
 [0.95435788 0.04564212]
 [0.99224259 0.00775741]
 [0.71472397 0.28527603]]
Prior: 129.09999999999997
2021-10-11 11:22:44,895 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:22:44,896 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:44,896 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:44,896 knodle.trainer.trainer INFO     ======================================
Accuracy is: 0.924
Precision is: 0.9305418719211822
Recall is: 0.9208397534668722
F1 is: 0.923103074258147
{'0': {'precision': 0.8896551724137931, 'recall': 0.9772727272727273, 'f1-score': 0.9314079422382672, 'support': 132}, '1': {'precision': 0.9714285714285714, 'recall': 0.864406779661017, 'f1-score': 0.9147982062780269, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9305418719211822, 'recall': 0.9208397534668722, 'f1-score': 0.923103074258147, 'support': 250}, 'weighted avg': {'precision': 0.9282522167487685, 'recall': 0.924, 'f1-score': 0.9235681468650336, 'support': 250}}
2021-10-11 11:22:46,335 knodle.trainer.trainer INFO     Train avg loss: 0.0010872353395715245
2021-10-11 11:22:46,335 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:22:46,335 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:46,335 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:46,335 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:46,335 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:22:46,336 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 366.62it/s]
2021-10-11 11:22:46,349 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:22:46,349 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:22:46,349 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:22:46,398 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:22:46,407 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:46,412 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1107, samples in test set: 275
2021-10-11 11:22:46,416 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1094, samples in test set: 288
2021-10-11 11:22:46,421 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1157, samples in test set: 225
2021-10-11 11:22:46,430 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1183, samples in test set: 199
2021-10-11 11:22:46,441 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 987, samples in test set: 395
5it [00:04,  1.06it/s]
Prior: 129.1
2021-10-11 11:22:51,186 knodle.trainer.cleanlab.cleanlab INFO     [[0.1122056  0.8877944 ]
 [0.06045913 0.93954087]
 [0.10070386 0.89929614]
 [0.         1.        ]
 [0.89926368 0.10073632]
 [0.02462578 0.97537422]
 [0.88016924 0.11983076]
 [0.91275621 0.08724379]
 [0.98684612 0.01315388]
 [0.77343972 0.22656028]]
2021-10-11 11:22:51,215 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 95 out of 1382
2021-10-11 11:22:51,215 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:51,215 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:51,215 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:52,502 knodle.trainer.trainer INFO     Train avg loss: 0.03317787997622157
2021-10-11 11:22:52,502 knodle.trainer.trainer INFO     Train avg accuracy: 0.9916587750116984
2021-10-11 11:22:52,502 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:52,502 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:52,502 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:52,502 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:22:52,509 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:52,513 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1064, samples in test set: 318
2021-10-11 11:22:52,516 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1084, samples in test set: 298
2021-10-11 11:22:52,519 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1176, samples in test set: 206
2021-10-11 11:22:52,522 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1056, samples in test set: 326
2021-10-11 11:22:52,530 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1148, samples in test set: 234
5it [00:05,  1.06s/it]
Prior: 129.09999999999997
2021-10-11 11:22:57,829 knodle.trainer.cleanlab.cleanlab INFO     [[0.02216562 0.97783438]
 [0.00628956 0.99371044]
 [0.02763501 0.97236499]
 [0.         1.        ]
 [0.9324028  0.0675972 ]
 [0.         1.        ]
 [0.86461226 0.13538774]
 [0.94075839 0.05924161]
 [0.98559337 0.01440663]
 [0.76185114 0.23814886]]
2021-10-11 11:22:57,861 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 19 out of 1382
2021-10-11 11:22:57,861 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:57,861 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:57,861 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:59,614 knodle.trainer.trainer INFO     Train avg loss: 0.0048456729160424195
2021-10-11 11:22:59,614 knodle.trainer.trainer INFO     Train avg accuracy: 0.9995265151515151
2021-10-11 11:22:59,614 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:59,614 knodle.trainer.trainer INFO     Training done
2021-10-11 11:22:59,614 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:59,614 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:22:59,623 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:22:59,627 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1160, samples in test set: 222
2021-10-11 11:22:59,632 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1101, samples in test set: 281
2021-10-11 11:22:59,640 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1258, samples in test set: 124
2021-10-11 11:22:59,646 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 930, samples in test set: 452
2021-10-11 11:22:59,653 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1079, samples in test set: 303
5it [00:09,  1.91s/it]
2021-10-11 11:23:09,232 knodle.trainer.cleanlab.cleanlab INFO     [[0.01259112 0.98740888]
 [0.012325   0.987675  ]
 [0.         1.        ]
 [0.         1.        ]
 [0.91235673 0.08764327]
 [0.         1.        ]
 [0.86389592 0.13610408]
 [0.94816359 0.05183641]
 [0.98524199 0.01475801]
 [0.75528897 0.24471103]]
Prior: 129.09999999999997
2021-10-11 11:23:09,303 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:23:09,303 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:09,303 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:23:09,303 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:11,469 knodle.trainer.trainer INFO     Train avg loss: 0.0010305309870146274
2021-10-11 11:23:11,469 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:23:11,469 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:11,469 knodle.trainer.trainer INFO     Training done
2021-10-11 11:23:11,469 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:11,469 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:23:11,469 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 311.38it/s]
2021-10-11 11:23:11,485 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:23:11,486 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:23:11,486 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.924
Precision is: 0.9305418719211822
Recall is: 0.9208397534668722
F1 is: 0.923103074258147
{'0': {'precision': 0.8896551724137931, 'recall': 0.9772727272727273, 'f1-score': 0.9314079422382672, 'support': 132}, '1': {'precision': 0.9714285714285714, 'recall': 0.864406779661017, 'f1-score': 0.9147982062780269, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9305418719211822, 'recall': 0.9208397534668722, 'f1-score': 0.923103074258147, 'support': 250}, 'weighted avg': {'precision': 0.9282522167487685, 'recall': 0.924, 'f1-score': 0.9235681468650336, 'support': 250}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:23:11,567 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:23:11,582 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:23:11,589 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1091, samples in test set: 291
2021-10-11 11:23:11,594 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1256, samples in test set: 126
2021-10-11 11:23:11,601 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1020, samples in test set: 362
2021-10-11 11:23:11,614 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 936, samples in test set: 446
2021-10-11 11:23:11,627 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1225, samples in test set: 157
5it [00:09,  1.92s/it]
Prior: 129.1
2021-10-11 11:23:21,225 knodle.trainer.cleanlab.cleanlab INFO     [[0.08735218 0.91264782]
 [0.06944086 0.93055914]
 [0.05749866 0.94250134]
 [0.0296154  0.9703846 ]
 [0.91352358 0.08647642]
 [0.02685436 0.97314564]
 [0.83667511 0.16332489]
 [0.88835235 0.11164765]
 [0.97425199 0.02574801]
 [0.76539193 0.23460807]]
2021-10-11 11:23:21,289 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 127 out of 1382
2021-10-11 11:23:21,289 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:21,289 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:23:21,289 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:23,541 knodle.trainer.trainer INFO     Train avg loss: 0.03320181307481658
2021-10-11 11:23:23,542 knodle.trainer.trainer INFO     Train avg accuracy: 0.9904639222405173
2021-10-11 11:23:23,542 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:23,542 knodle.trainer.trainer INFO     Training done
2021-10-11 11:23:23,542 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:23,542 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:23:23,555 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:23:23,560 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1141, samples in test set: 241
2021-10-11 11:23:23,567 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1157, samples in test set: 225
2021-10-11 11:23:23,572 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1093, samples in test set: 289
2021-10-11 11:23:23,584 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 967, samples in test set: 415
2021-10-11 11:23:23,596 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1170, samples in test set: 212
5it [00:07,  1.46s/it]
2021-10-11 11:23:30,910 knodle.trainer.cleanlab.cleanlab INFO     [[0.00379305 0.99620695]
 [0.00530511 0.99469489]
 [0.         1.        ]
 [0.         1.        ]
 [0.91174809 0.08825191]
 [0.         1.        ]
 [0.82807906 0.17192094]
 [0.9032387  0.0967613 ]
 [0.98524199 0.01475801]
 [0.71075584 0.28924416]]
Prior: 129.1
2021-10-11 11:23:30,950 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 4 out of 1382
2021-10-11 11:23:30,950 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:30,950 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:23:30,950 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:32,423 knodle.trainer.trainer INFO     Train avg loss: 0.0032526305158777783
2021-10-11 11:23:32,423 knodle.trainer.trainer INFO     Train avg accuracy: 0.9998519198461012
2021-10-11 11:23:32,423 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:32,423 knodle.trainer.trainer INFO     Training done
2021-10-11 11:23:32,423 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:32,423 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:23:32,432 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:23:32,441 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1256, samples in test set: 126
2021-10-11 11:23:32,446 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1074, samples in test set: 308
2021-10-11 11:23:32,451 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1195, samples in test set: 187
2021-10-11 11:23:32,455 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1198, samples in test set: 184
2021-10-11 11:23:32,462 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 805, samples in test set: 577
5it [00:05,  1.18s/it]
Prior: 129.09999999999997
2021-10-11 11:23:38,377 knodle.trainer.cleanlab.cleanlab INFO     [[0.01432929 0.98567071]
 [0.00554625 0.99445375]
 [0.00990255 0.99009745]
 [0.         1.        ]
 [0.89870216 0.10129784]
 [0.         1.        ]
 [0.859614   0.140386  ]
 [0.90871576 0.09128424]
 [0.98524199 0.01475801]
 [0.6922165  0.3077835 ]]
2021-10-11 11:23:38,447 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:23:38,449 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:38,449 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:23:38,450 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:40,010 knodle.trainer.trainer INFO     Train avg loss: 0.001086344711119168
2021-10-11 11:23:40,010 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:23:40,010 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:40,010 knodle.trainer.trainer INFO     Training done
2021-10-11 11:23:40,010 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:40,010 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:23:40,010 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 473.61it/s]
2021-10-11 11:23:40,020 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:23:40,020 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:23:40,020 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.928
Precision is: 0.9337657232704403
Recall is: 0.9250770416024654
F1 is: 0.9272127329192548
{'0': {'precision': 0.8958333333333334, 'recall': 0.9772727272727273, 'f1-score': 0.9347826086956522, 'support': 132}, '1': {'precision': 0.9716981132075472, 'recall': 0.8728813559322034, 'f1-score': 0.9196428571428572, 'support': 118}, 'accuracy': 0.928, 'macro avg': {'precision': 0.9337657232704403, 'recall': 0.9250770416024654, 'f1-score': 0.9272127329192548, 'support': 250}, 'weighted avg': {'precision': 0.9316415094339623, 'recall': 0.928, 'f1-score': 0.9276366459627329, 'support': 250}}
2021-10-11 11:23:40,072 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:23:40,107 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:23:40,111 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1211, samples in test set: 171
2021-10-11 11:23:40,115 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1170, samples in test set: 212
2021-10-11 11:23:40,118 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 885, samples in test set: 497
2021-10-11 11:23:40,123 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1243, samples in test set: 139
2021-10-11 11:23:40,131 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1019, samples in test set: 363
5it [00:06,  1.21s/it]
2021-10-11 11:23:46,204 knodle.trainer.cleanlab.cleanlab INFO     [[0.07466313 0.92533687]
 [0.05042046 0.94957954]
 [0.08102083 0.91897917]
 [0.00942465 0.99057535]
 [0.91317328 0.08682672]
 [0.01735325 0.98264675]
 [0.823465   0.176535  ]
 [0.91684576 0.08315424]
 [0.97425199 0.02574801]
 [0.76877627 0.23122373]]
Prior: 129.1
2021-10-11 11:23:46,244 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 112 out of 1382
2021-10-11 11:23:46,244 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:46,244 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:23:46,244 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:48,348 knodle.trainer.trainer INFO     Train avg loss: 0.03352735569827598
2021-10-11 11:23:48,348 knodle.trainer.trainer INFO     Train avg accuracy: 0.9903687608964515
2021-10-11 11:23:48,348 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:48,348 knodle.trainer.trainer INFO     Training done
2021-10-11 11:23:48,348 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:48,348 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:23:48,374 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:23:48,410 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 983, samples in test set: 399
2021-10-11 11:23:48,440 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1227, samples in test set: 155
2021-10-11 11:23:48,477 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1119, samples in test set: 263
2021-10-11 11:23:48,508 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1118, samples in test set: 264
2021-10-11 11:23:48,546 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1081, samples in test set: 301
5it [00:09,  1.98s/it]
2021-10-11 11:23:58,436 knodle.trainer.cleanlab.cleanlab INFO     [[0.00792514 0.99207486]
 [0.00575554 0.99424446]
 [0.02376611 0.97623389]
 [0.         1.        ]
 [0.90791105 0.09208895]
 [0.         1.        ]
 [0.86069347 0.13930653]
 [0.93610103 0.06389897]
 [0.98524199 0.01475801]
 [0.74986624 0.25013376]]
Prior: 129.1
2021-10-11 11:23:58,497 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:23:58,497 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:58,497 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:23:58,497 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:00,229 knodle.trainer.trainer INFO     Train avg loss: 0.0023548400179468883
2021-10-11 11:24:00,229 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:24:00,229 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:00,229 knodle.trainer.trainer INFO     Training done
2021-10-11 11:24:00,229 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:00,229 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:24:00,229 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 227.60it/s]
2021-10-11 11:24:00,248 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:24:00,248 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:24:00,248 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.936
Precision is: 0.941954926624738
Recall is: 0.9331022085259373
F1 is: 0.9353002070393375
{'0': {'precision': 0.9027777777777778, 'recall': 0.9848484848484849, 'f1-score': 0.9420289855072465, 'support': 132}, '1': {'precision': 0.9811320754716981, 'recall': 0.8813559322033898, 'f1-score': 0.9285714285714285, 'support': 118}, 'accuracy': 0.936, 'macro avg': {'precision': 0.941954926624738, 'recall': 0.9331022085259373, 'f1-score': 0.9353002070393375, 'support': 250}, 'weighted avg': {'precision': 0.9397610062893081, 'recall': 0.936, 'f1-score': 0.9356770186335404, 'support': 250}}
2021-10-11 11:24:00,323 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:24:00,334 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:24:00,342 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1131, samples in test set: 251
2021-10-11 11:24:00,348 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1081, samples in test set: 301
2021-10-11 11:24:00,354 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1214, samples in test set: 168
2021-10-11 11:24:00,370 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1084, samples in test set: 298
2021-10-11 11:24:00,398 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1018, samples in test set: 364
5it [00:08,  1.64s/it]
2021-10-11 11:24:08,629 knodle.trainer.cleanlab.cleanlab INFO     [[0.08002356 0.91997644]
 [0.05764607 0.94235393]
 [0.11426015 0.88573985]
 [0.00990796 0.99009204]
 [0.90348146 0.09651854]
 [0.01501724 0.98498276]
 [0.88540915 0.11459085]
 [0.92619901 0.07380099]
 [0.97983072 0.02016928]
 [0.75272949 0.24727051]]
Prior: 129.10000000000002
2021-10-11 11:24:08,695 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 108 out of 1382
2021-10-11 11:24:08,696 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:08,696 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:24:08,696 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:10,716 knodle.trainer.trainer INFO     Train avg loss: 0.0340189349117943
2021-10-11 11:24:10,716 knodle.trainer.trainer INFO     Train avg accuracy: 0.9902025770057332
2021-10-11 11:24:10,716 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:10,716 knodle.trainer.trainer INFO     Training done
2021-10-11 11:24:10,716 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:10,716 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:24:10,729 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:24:10,733 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1203, samples in test set: 179
2021-10-11 11:24:10,737 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1132, samples in test set: 250
2021-10-11 11:24:10,741 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1105, samples in test set: 277
2021-10-11 11:24:10,750 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1209, samples in test set: 173
2021-10-11 11:24:10,756 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 879, samples in test set: 503
5it [00:07,  1.59s/it]
Prior: 129.10000000000002
2021-10-11 11:24:18,729 knodle.trainer.cleanlab.cleanlab INFO     [[0.01773249 0.98226751]
 [0.00649029 0.99350971]
 [0.02330011 0.97669989]
 [0.         1.        ]
 [0.93050162 0.06949838]
 [0.         1.        ]
 [0.88348163 0.11651837]
 [0.94308159 0.05691841]
 [0.992621   0.007379  ]
 [0.75043938 0.24956062]]
2021-10-11 11:24:18,793 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 17 out of 1382
2021-10-11 11:24:18,794 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:18,794 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:24:18,794 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:20,973 knodle.trainer.trainer INFO     Train avg loss: 0.004684088997556968
2021-10-11 11:24:20,973 knodle.trainer.trainer INFO     Train avg accuracy: 0.9994610627492269
2021-10-11 11:24:20,973 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:20,973 knodle.trainer.trainer INFO     Training done
2021-10-11 11:24:20,973 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:20,973 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:24:20,988 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:24:20,995 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1181, samples in test set: 201
2021-10-11 11:24:21,014 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1247, samples in test set: 135
2021-10-11 11:24:21,021 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1159, samples in test set: 223
2021-10-11 11:24:21,027 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1028, samples in test set: 354
2021-10-11 11:24:21,036 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 913, samples in test set: 469
5it [00:10,  2.14s/it]
2021-10-11 11:24:31,750 knodle.trainer.cleanlab.cleanlab INFO     [[0.01229999 0.98770001]
 [0.00559713 0.99440287]
 [0.         1.        ]
 [0.         1.        ]
 [0.90857356 0.09142644]
 [0.         1.        ]
 [0.85670552 0.14329448]
 [0.93226709 0.06773291]
 [0.98448517 0.01551483]
 [0.73949456 0.26050544]]
Prior: 129.10000000000005
2021-10-11 11:24:31,835 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:24:31,835 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:31,835 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:24:31,835 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:34,087 knodle.trainer.trainer INFO     Train avg loss: 0.0010543220060891612
2021-10-11 11:24:34,087 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:24:34,087 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:34,087 knodle.trainer.trainer INFO     Training done
2021-10-11 11:24:34,087 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:34,088 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:24:34,088 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 161.61it/s]
Accuracy is: 0.92
Precision is: 0.9273577449947312
Recall is: 0.916602465331279
F1 is: 0.9189837319333722
{'0': {'precision': 0.8835616438356164, 'recall': 0.9772727272727273, 'f1-score': 0.9280575539568345, 'support': 132}, '1': {'precision': 0.9711538461538461, 'recall': 0.8559322033898306, 'f1-score': 0.9099099099099099, 'support': 118}, 'accuracy': 0.92, 'macro avg': {'precision': 0.9273577449947312, 'recall': 0.916602465331279, 'f1-score': 0.9189837319333722, 'support': 250}, 'weighted avg': {'precision': 0.9249051633298209, 'recall': 0.92, 'f1-score': 0.9194918659666861, 'support': 250}}
2021-10-11 11:24:34,110 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:24:34,110 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:24:34,111 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:24:34,194 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:24:34,235 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:24:34,241 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1089, samples in test set: 293
2021-10-11 11:24:34,248 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1160, samples in test set: 222
2021-10-11 11:24:34,253 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 979, samples in test set: 403
2021-10-11 11:24:34,266 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1191, samples in test set: 191
2021-10-11 11:24:34,278 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1109, samples in test set: 273
5it [00:10,  2.04s/it]
2021-10-11 11:24:44,490 knodle.trainer.cleanlab.cleanlab INFO     [[0.11687325 0.88312675]
 [0.08562633 0.91437367]
 [0.10374096 0.89625904]
 [0.01981592 0.98018408]
 [0.92375035 0.07624965]
 [0.02725169 0.97274831]
 [0.80959533 0.19040467]
 [0.95731119 0.04268881]
 [0.97425199 0.02574801]
 [0.82880893 0.17119107]]
Prior: 129.09999999999997
2021-10-11 11:24:44,623 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 124 out of 1382
2021-10-11 11:24:44,624 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:44,624 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:24:44,624 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:46,673 knodle.trainer.trainer INFO     Train avg loss: 0.0336484009978559
2021-10-11 11:24:46,673 knodle.trainer.trainer INFO     Train avg accuracy: 0.9913161946065497
2021-10-11 11:24:46,673 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:46,673 knodle.trainer.trainer INFO     Training done
2021-10-11 11:24:46,673 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:46,673 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:24:46,683 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:24:46,687 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 966, samples in test set: 416
2021-10-11 11:24:46,691 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1175, samples in test set: 207
2021-10-11 11:24:46,702 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1127, samples in test set: 255
2021-10-11 11:24:46,713 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1250, samples in test set: 132
2021-10-11 11:24:46,717 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1010, samples in test set: 372
5it [00:06,  1.33s/it]
2021-10-11 11:24:53,394 knodle.trainer.cleanlab.cleanlab INFO     [[0.02244619 0.97755381]
 [0.         1.        ]
 [0.0132034  0.9867966 ]
 [0.         1.        ]
 [0.94057282 0.05942718]
 [0.         1.        ]
 [0.86252509 0.13747491]
 [0.94522946 0.05477054]
 [0.99296421 0.00703579]
 [0.77529982 0.22470018]]
Prior: 129.1
2021-10-11 11:24:53,452 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 22 out of 1382
2021-10-11 11:24:53,452 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:53,452 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:24:53,452 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:55,378 knodle.trainer.trainer INFO     Train avg loss: 0.005308183558306401
2021-10-11 11:24:55,378 knodle.trainer.trainer INFO     Train avg accuracy: 0.9993784349976165
2021-10-11 11:24:55,378 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:55,378 knodle.trainer.trainer INFO     Training done
2021-10-11 11:24:55,378 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:24:55,378 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:24:55,389 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:24:55,394 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1060, samples in test set: 322
2021-10-11 11:24:55,400 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1005, samples in test set: 377
2021-10-11 11:24:55,405 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1127, samples in test set: 255
2021-10-11 11:24:55,420 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1232, samples in test set: 150
2021-10-11 11:24:55,426 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1104, samples in test set: 278
5it [00:06,  1.29s/it]
2021-10-11 11:25:01,899 knodle.trainer.cleanlab.cleanlab INFO     [[0.01274191 0.98725809]
 [0.         1.        ]
 [0.         1.        ]
 [0.         1.        ]
 [0.90987039 0.09012961]
 [0.         1.        ]
 [0.87279503 0.12720497]
 [0.96205439 0.03794561]
 [0.99224259 0.00775741]
 [0.73329282 0.26670718]]
Prior: 129.10000000000002
2021-10-11 11:25:01,953 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:25:01,954 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:01,954 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:01,954 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:03,567 knodle.trainer.trainer INFO     Train avg loss: 0.0010250031717904755
2021-10-11 11:25:03,567 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:25:03,567 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:03,567 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:03,567 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:03,567 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:25:03,567 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 276.82it/s]
2021-10-11 11:25:03,582 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:25:03,582 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:25:03,583 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.92
Precision is: 0.9273577449947312
Recall is: 0.916602465331279
F1 is: 0.9189837319333722
{'0': {'precision': 0.8835616438356164, 'recall': 0.9772727272727273, 'f1-score': 0.9280575539568345, 'support': 132}, '1': {'precision': 0.9711538461538461, 'recall': 0.8559322033898306, 'f1-score': 0.9099099099099099, 'support': 118}, 'accuracy': 0.92, 'macro avg': {'precision': 0.9273577449947312, 'recall': 0.916602465331279, 'f1-score': 0.9189837319333722, 'support': 250}, 'weighted avg': {'precision': 0.9249051633298209, 'recall': 0.92, 'f1-score': 0.9194918659666861, 'support': 250}}
2021-10-11 11:25:03,649 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:25:03,687 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:25:03,697 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1252, samples in test set: 130
2021-10-11 11:25:03,702 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 957, samples in test set: 425
2021-10-11 11:25:03,707 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 930, samples in test set: 452
2021-10-11 11:25:03,711 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1162, samples in test set: 220
2021-10-11 11:25:03,714 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1227, samples in test set: 155
5it [00:07,  1.48s/it]
2021-10-11 11:25:11,111 knodle.trainer.cleanlab.cleanlab INFO     [[0.07802297 0.92197703]
 [0.07094042 0.92905958]
 [0.12292816 0.87707184]
 [0.0185477  0.9814523 ]
 [0.90631721 0.09368279]
 [0.01415747 0.98584253]
 [0.85823068 0.14176932]
 [0.90884805 0.09115195]
 [0.98068899 0.01931101]
 [0.75299204 0.24700796]]
Prior: 129.1
2021-10-11 11:25:11,160 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 118 out of 1382
2021-10-11 11:25:11,160 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:11,160 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:11,160 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:13,482 knodle.trainer.trainer INFO     Train avg loss: 0.03283009656465075
2021-10-11 11:25:13,482 knodle.trainer.trainer INFO     Train avg accuracy: 0.9915348334745927
2021-10-11 11:25:13,482 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:13,482 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:13,482 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:13,482 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:25:13,495 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:25:13,500 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1194, samples in test set: 188
2021-10-11 11:25:13,505 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1065, samples in test set: 317
2021-10-11 11:25:13,510 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1192, samples in test set: 190
2021-10-11 11:25:13,522 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1044, samples in test set: 338
2021-10-11 11:25:13,538 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1033, samples in test set: 349
5it [00:07,  1.46s/it]
2021-10-11 11:25:20,856 knodle.trainer.cleanlab.cleanlab INFO     [[0.01209034 0.98790966]
 [0.01151109 0.98848891]
 [0.         1.        ]
 [0.         1.        ]
 [0.92228753 0.07771247]
 [0.         1.        ]
 [0.87519513 0.12480487]
 [0.91626426 0.08373574]
 [0.98487304 0.01512696]
 [0.72357303 0.27642697]]
Prior: 129.1
2021-10-11 11:25:20,907 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 10 out of 1382
2021-10-11 11:25:20,907 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:20,907 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:20,907 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:22,439 knodle.trainer.trainer INFO     Train avg loss: 0.0034906068464007345
2021-10-11 11:25:22,439 knodle.trainer.trainer INFO     Train avg accuracy: 0.9997159090909091
2021-10-11 11:25:22,439 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:22,439 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:22,439 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:22,440 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:25:22,452 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:25:22,463 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1265, samples in test set: 117
2021-10-11 11:25:22,467 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1232, samples in test set: 150
2021-10-11 11:25:22,476 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1212, samples in test set: 170
2021-10-11 11:25:22,482 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1022, samples in test set: 360
2021-10-11 11:25:22,489 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 797, samples in test set: 585
5it [00:07,  1.49s/it]
Prior: 129.1
2021-10-11 11:25:29,951 knodle.trainer.cleanlab.cleanlab INFO     [[0.01313518 0.98686482]
 [0.01271016 0.98728984]
 [0.         1.        ]
 [0.         1.        ]
 [0.91159461 0.08840539]
 [0.         1.        ]
 [0.88353061 0.11646939]
 [0.94160956 0.05839044]
 [0.98624822 0.01375178]
 [0.7337851  0.2662149 ]]
2021-10-11 11:25:30,012 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:25:30,013 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:30,013 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:30,013 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:31,453 knodle.trainer.trainer INFO     Train avg loss: 0.0010325429442507976
2021-10-11 11:25:31,453 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:25:31,453 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:31,453 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:31,453 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:31,453 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:25:31,453 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 318.67it/s]
2021-10-11 11:25:31,468 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:25:31,468 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:25:31,468 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.92
Precision is: 0.9273577449947312
Recall is: 0.916602465331279
F1 is: 0.9189837319333722
{'0': {'precision': 0.8835616438356164, 'recall': 0.9772727272727273, 'f1-score': 0.9280575539568345, 'support': 132}, '1': {'precision': 0.9711538461538461, 'recall': 0.8559322033898306, 'f1-score': 0.9099099099099099, 'support': 118}, 'accuracy': 0.92, 'macro avg': {'precision': 0.9273577449947312, 'recall': 0.916602465331279, 'f1-score': 0.9189837319333722, 'support': 250}, 'weighted avg': {'precision': 0.9249051633298209, 'recall': 0.92, 'f1-score': 0.9194918659666861, 'support': 250}}
2021-10-11 11:25:31,535 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:25:31,546 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:25:31,552 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 1111, samples in test set: 271
2021-10-11 11:25:31,557 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1243, samples in test set: 139
2021-10-11 11:25:31,561 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1205, samples in test set: 177
2021-10-11 11:25:31,565 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1043, samples in test set: 339
2021-10-11 11:25:31,571 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 926, samples in test set: 456
5it [00:05,  1.19s/it]
2021-10-11 11:25:37,518 knodle.trainer.cleanlab.cleanlab INFO     [[0.07545742 0.92454258]
 [0.09306421 0.90693579]
 [0.11466106 0.88533894]
 [0.01053847 0.98946153]
 [0.90863332 0.09136668]
 [0.01846934 0.98153066]
 [0.85512768 0.14487232]
 [0.92779008 0.07220992]
 [0.98712599 0.01287401]
 [0.77945718 0.22054282]]
Prior: 129.1
2021-10-11 11:25:37,565 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 119 out of 1382
2021-10-11 11:25:37,566 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:37,566 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:37,566 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:39,110 knodle.trainer.trainer INFO     Train avg loss: 0.033839814519425006
2021-10-11 11:25:39,110 knodle.trainer.trainer INFO     Train avg accuracy: 0.990599004608212
2021-10-11 11:25:39,110 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:39,110 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:39,110 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:39,111 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:25:39,118 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:25:39,124 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 914, samples in test set: 468
2021-10-11 11:25:39,128 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1220, samples in test set: 162
2021-10-11 11:25:39,132 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 1196, samples in test set: 186
2021-10-11 11:25:39,141 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1033, samples in test set: 349
2021-10-11 11:25:39,151 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1165, samples in test set: 217
5it [00:05,  1.19s/it]
2021-10-11 11:25:45,104 knodle.trainer.cleanlab.cleanlab INFO     [[0.02789381 0.97210619]
 [0.01051875 0.98948125]
 [0.02922063 0.97077937]
 [0.         1.        ]
 [0.93176765 0.06823235]
 [0.00314344 0.99685656]
 [0.8136716  0.1863284 ]
 [0.92977003 0.07022997]
 [0.99279669 0.00720331]
 [0.71360988 0.28639012]]
Prior: 129.10000000000002
2021-10-11 11:25:45,150 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 18 out of 1382
2021-10-11 11:25:45,151 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:45,151 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:45,151 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:46,569 knodle.trainer.trainer INFO     Train avg loss: 0.004712659018960866
2021-10-11 11:25:46,569 knodle.trainer.trainer INFO     Train avg accuracy: 0.9993663657795299
2021-10-11 11:25:46,569 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:46,569 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:46,569 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:46,570 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 2
2021-10-11 11:25:46,580 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:25:46,586 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 108, rules in test set: 27, samples in training set: 978, samples in test set: 404
2021-10-11 11:25:46,591 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 108, rules in test set: 27, samples in training set: 1245, samples in test set: 137
2021-10-11 11:25:46,598 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 108, rules in test set: 27, samples in training set: 913, samples in test set: 469
2021-10-11 11:25:46,610 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 108, rules in test set: 27, samples in training set: 1201, samples in test set: 181
2021-10-11 11:25:46,622 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 108, rules in test set: 27, samples in training set: 1191, samples in test set: 191
5it [00:07,  1.54s/it]
Prior: 129.1
2021-10-11 11:25:54,365 knodle.trainer.cleanlab.cleanlab INFO     [[0.01372838 0.98627162]
 [0.01245077 0.98754923]
 [0.         1.        ]
 [0.         1.        ]
 [0.93143017 0.06856983]
 [0.         1.        ]
 [0.8530076  0.1469924 ]
 [0.95161935 0.04838065]
 [0.98524199 0.01475801]
 [0.78375094 0.21624906]]
2021-10-11 11:25:54,471 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 1382
2021-10-11 11:25:54,472 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:54,472 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:25:54,472 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:56,627 knodle.trainer.trainer INFO     Train avg loss: 0.0010371767489811068
2021-10-11 11:25:56,628 knodle.trainer.trainer INFO     Train avg accuracy: 1.0
2021-10-11 11:25:56,628 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:56,628 knodle.trainer.trainer INFO     Training done
2021-10-11 11:25:56,628 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:25:56,628 knodle.trainer.cleanlab.cleanlab INFO     No more iterations since the labels do not change anymore.
2021-10-11 11:25:56,628 root         INFO     Training is done.
100%|██████████| 2/2 [00:00<00:00, 318.38it/s]
Accuracy is: 0.924
Precision is: 0.9305418719211822
Recall is: 0.9208397534668722
F1 is: 0.923103074258147
{'0': {'precision': 0.8896551724137931, 'recall': 0.9772727272727273, 'f1-score': 0.9314079422382672, 'support': 132}, '1': {'precision': 0.9714285714285714, 'recall': 0.864406779661017, 'f1-score': 0.9147982062780269, 'support': 118}, 'accuracy': 0.924, 'macro avg': {'precision': 0.9305418719211822, 'recall': 0.9208397534668722, 'f1-score': 0.923103074258147, 'support': 250}, 'weighted avg': {'precision': 0.9282522167487685, 'recall': 0.924, 'f1-score': 0.9235681468650336, 'support': 250}}
======================================
Result: {'lr': 0.1, 'cv_n_folds': 5, 'p': 0.5, 'prune_method': 'prune_by_noise_rate', 'epochs': 30, 'use_prior': True, 'batch_size': 128, 'psx_calculation_method': 'signatures', 'accuracy': [0.936, 0.924, 0.92, 0.932, 0.932, 0.932, 0.928, 0.908, 0.904, 0.924, 0.924, 0.932, 0.928, 0.932, 0.92, 0.928, 0.928, 0.924, 0.928, 0.908, 0.932, 0.924, 0.924, 0.924, 0.928, 0.936, 0.92, 0.92, 0.92, 0.924], 'mean_accuracy': 0.9248000000000001, 'std_accuracy': 0.007747747169784044, 'precision': [0.941954926624738, 0.9324681328842217, 0.9255765199161425, 0.937030259460166, 0.938752052545156, 0.938752052545156, 0.9337657232704403, 0.9159566739317087, 0.9128245892951776, 0.9324681328842217, 0.9305418719211822, 0.937030259460166, 0.9337657232704403, 0.938752052545156, 0.9293852676205617, 0.9355900948366702, 0.9355900948366702, 0.9305418719211822, 0.9355900948366702, 0.9159566739317087, 0.938752052545156, 0.9324681328842217, 0.9305418719211822, 0.9305418719211822, 0.9337657232704403, 0.941954926624738, 0.9273577449947312, 0.9273577449947312, 0.9273577449947312, 0.9305418719211822], 'mean_precision': 0.9317644251536611, 'std_precision': 0.007153572688237168, 'recall': [0.9331022085259373, 0.9203903441191577, 0.9170518746789933, 0.9293143297380586, 0.9288649203903441, 0.9288649203903441, 0.9250770416024654, 0.9043400102722137, 0.9001027221366205, 0.9203903441191577, 0.9208397534668722, 0.9293143297380586, 0.9250770416024654, 0.9288649203903441, 0.9161530559835644, 0.9246276322547509, 0.9246276322547509, 0.9208397534668722, 0.9246276322547509, 0.9043400102722137, 0.9288649203903441, 0.9203903441191577, 0.9208397534668722, 0.9208397534668722, 0.9250770416024654, 0.9331022085259373, 0.916602465331279, 0.916602465331279, 0.916602465331279, 0.9208397534668722], 'mean_recall': 0.9215523882896764, 'std_recall': 0.007984788523637563, 'f1-score': [0.9353002070393375, 0.922963395449164, 0.9191252587991718, 0.9313131313131313, 0.9311974874941316, 0.9311974874941316, 0.9272127329192548, 0.9067451629121457, 0.9025974025974026, 0.922963395449164, 0.923103074258147, 0.9313131313131313, 0.9272127329192548, 0.9311974874941316, 0.9188311688311688, 0.927085358740035, 0.927085358740035, 0.923103074258147, 0.927085358740035, 0.9067451629121457, 0.9311974874941316, 0.922963395449164, 0.923103074258147, 0.923103074258147, 0.9272127329192548, 0.9353002070393375, 0.9189837319333722, 0.9189837319333722, 0.9189837319333722, 0.923103074258147], 'mean_f1': 0.9238770603716571, 'std_f1': 0.007911979247206024}
======================================

Process finished with exit code 0
