[
    {
        "lr": 0.1,
         "cv_n_folds": 5,
         "prune_method": "prune_by_noise_rate",
         "epochs": 100,
         "batch_size": 128,
         "psx_calculation_method": "signatures",
         "accuracy": [0.3232136245834876, 0.33469085523880043, 0.35690485005553496, 0.3746760459089226, 0.359496482784154,
                      0.29359496482784153, 0.332469455757127, 0.33469085523880043, 0.3646797482413921, 0.31617919289152163,
                      0.32395409107737877, 0.322843391336542, 0.3683820807108478, 0.3383931877082562, 0.3920770085153647,
                      0.32395409107737877, 0.3661606812291744, 0.33024805627545356, 0.2987782302850796, 0.32432432432432434,
                      0.3320992225101814, 0.3250647908182155, 0.3261754905590522, 0.3546834505738615, 0.30322102924842653,
                      0.3047019622362088, 0.322843391336542, 0.33802295446131064, 0.335061088485746, 0.322843391336542],
         "mean_accuracy": 0.33481426632111566, "std_accuracy": 0.023303170433785537,
         "precision": [0.5188746409121663, 0.5190910474866357, 0.520219924756499, 0.5236187035095602, 0.5221206946944175,
                       0.5173721081048472, 0.5195368637978253, 0.5198851714669311, 0.5206545179800393, 0.517731853687625,
                       0.5173668441939475, 0.5155660377358491, 0.5212131103002494, 0.5173221870907988, 0.5232808061966678,
                       0.5214546866000551, 0.5216200945725088, 0.51441833478387, 0.5147665842594926, 0.522337615501579,
                       0.5178847009590896, 0.516740979445168, 0.5193474758324382, 0.5168682735354105, 0.5164014105475797,
                       0.5201048618010556, 0.5179986119749712, 0.518828001960944, 0.5199429949749828, 0.5179986119749712],
         "mean_precision": 0.5190189250212726, "std_precision": 0.0023924515218776404,
         "recall": [0.5503007607695632, 0.55235879207972, 0.5581643247477341, 0.5699222603612824, 0.5637583272676217,
                    0.5425600505455446, 0.5532427848821527, 0.5544510007500545, 0.5603008716150558, 0.5464747438545412,
                    0.5465190820515284, 0.5417305567769086, 0.5623145647282253, 0.5480958591818863, 0.5710177833118416,
                    0.5569801254032005, 0.563198557530658, 0.5394813169922446, 0.5370103862226443, 0.5592737033848518,
                    0.548856998230167, 0.5450309813151448, 0.551911715260099, 0.5485872741984947, 0.5415190266287822,
                    0.5506933385553876, 0.5480071827879119, 0.5520789072112383, 0.5546523700613715, 0.5480071827879119],
         "mean_recall": 0.5522166943164589,
        "std_recall": 0.00854821406179133,
         "f1-score": [0.29768074085200713, 0.3059108086901273, 0.32162025580018344, 0.33471130965792384, 0.3239919331504693,
                      0.2754877217607245, 0.30446222790470284, 0.30612870700720807, 0.32701289951619555,
                      0.29231457779650283, 0.29782829059391, 0.2965702143425588, 0.3296811265310873, 0.30800632827458463,
                      0.34599056937654543, 0.2988584474885845, 0.32833196795128783, 0.30149517583530294, 0.278849981674138,
                      0.29934412187907805, 0.30375218479258614, 0.29845905061104405, 0.29992742676027134,
                      0.3190339680019186, 0.2825006492846577, 0.28439490230202236, 0.2971934708986655, 0.3081779998510174,
                      0.30640606233914786, 0.2971934708986655],
        "mean_f1": 0.3057105530607706,
         "std_f1": 0.016753648160521207}
]




: 0.22269654927072216
100%|██████████| 22/22 [00:00<00:00, 195.80it/s]
2021-10-11 09:15:15,216 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22589825684809675
100%|██████████| 22/22 [00:00<00:00, 200.78it/s]
2021-10-11 09:15:15,758 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 216.58it/s]
2021-10-11 09:15:16,300 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2248310209889719
100%|██████████| 22/22 [00:00<00:00, 208.73it/s]
2021-10-11 09:15:16,809 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 236.15it/s]
2021-10-11 09:15:17,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2088224831020989
100%|██████████| 22/22 [00:00<00:00, 211.42it/s]
2021-10-11 09:15:17,843 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 202.66it/s]
2021-10-11 09:15:18,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 222.19it/s]
2021-10-11 09:15:18,893 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 225.91it/s]
2021-10-11 09:15:19,406 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 222.19it/s]
2021-10-11 09:15:19,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 224.99it/s]
2021-10-11 09:15:20,420 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 217.63it/s]
2021-10-11 09:15:20,958 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 198.26it/s]
2021-10-11 09:15:21,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 197.81it/s]
2021-10-11 09:15:22,035 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 206.46it/s]
2021-10-11 09:15:22,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 221.56it/s]
2021-10-11 09:15:23,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 215.83it/s]
2021-10-11 09:15:23,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 210.48it/s]
2021-10-11 09:15:24,111 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24439701173959444
100%|██████████| 22/22 [00:00<00:00, 217.31it/s]
2021-10-11 09:15:24,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 187.73it/s]
2021-10-11 09:15:25,155 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 222.84it/s]
2021-10-11 09:15:25,670 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 206.64it/s]
2021-10-11 09:15:26,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 208.92it/s]
2021-10-11 09:15:26,743 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 197.99it/s]
2021-10-11 09:15:27,299 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 197.66it/s]
2021-10-11 09:15:27,846 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 189.05it/s]
2021-10-11 09:15:28,402 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 209.23it/s]
2021-10-11 09:15:28,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 195.05it/s]
2021-10-11 09:15:29,496 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 214.38it/s]
2021-10-11 09:15:30,034 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 218.96it/s]
2021-10-11 09:15:30,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 201.16it/s]
2021-10-11 09:15:31,082 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23692636072572038
100%|██████████| 22/22 [00:00<00:00, 205.68it/s]
2021-10-11 09:15:31,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 209.34it/s]
2021-10-11 09:15:32,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 213.86it/s]
2021-10-11 09:15:32,696 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 196.34it/s]
2021-10-11 09:15:33,223 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 195.96it/s]
2021-10-11 09:15:33,782 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23977232301672002
100%|██████████| 22/22 [00:00<00:00, 207.78it/s]
2021-10-11 09:15:34,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2408395588758449
100%|██████████| 22/22 [00:00<00:00, 209.49it/s]
2021-10-11 09:15:34,863 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 231.99it/s]
2021-10-11 09:15:35,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 210.64it/s]
2021-10-11 09:15:35,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 213.85it/s]
2021-10-11 09:15:36,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 204.03it/s]
2021-10-11 09:15:36,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 202.39it/s]
2021-10-11 09:15:37,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 200.71it/s]
2021-10-11 09:15:37,946 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 195.03it/s]
2021-10-11 09:15:38,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 203.60it/s]
2021-10-11 09:15:39,041 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 201.32it/s]
2021-10-11 09:15:39,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 216.43it/s]
2021-10-11 09:15:40,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 198.73it/s]
2021-10-11 09:15:40,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 235.55it/s]
2021-10-11 09:15:41,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 225.51it/s]
2021-10-11 09:15:41,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 225.40it/s]
2021-10-11 09:15:42,125 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 235.80it/s]
2021-10-11 09:15:42,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 238.18it/s]
2021-10-11 09:15:43,058 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23692636072572038
100%|██████████| 22/22 [00:00<00:00, 233.56it/s]
2021-10-11 09:15:43,525 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 241.64it/s]
2021-10-11 09:15:43,999 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 236.15it/s]
2021-10-11 09:15:44,490 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 235.31it/s]
2021-10-11 09:15:44,973 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 221.11it/s]
2021-10-11 09:15:45,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 222.52it/s]
2021-10-11 09:15:45,961 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 232.67it/s]
2021-10-11 09:15:46,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 203.82it/s]
2021-10-11 09:15:46,954 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 216.22it/s]
2021-10-11 09:15:47,481 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 213.68it/s]
2021-10-11 09:15:47,967 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 219.33it/s]
2021-10-11 09:15:48,463 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 238.54it/s]
2021-10-11 09:15:48,946 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 239.68it/s]
2021-10-11 09:15:49,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 198.14it/s]
2021-10-11 09:15:49,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 205.24it/s]
2021-10-11 09:15:50,537 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 211.40it/s]
2021-10-11 09:15:51,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 206.59it/s]
2021-10-11 09:15:51,596 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 226.47it/s]
2021-10-11 09:15:52,129 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 223.68it/s]
2021-10-11 09:15:52,631 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 226.09it/s]
2021-10-11 09:15:53,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 209.31it/s]
2021-10-11 09:15:53,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 198.00it/s]
2021-10-11 09:15:54,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 207.78it/s]
2021-10-11 09:15:54,704 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 216.74it/s]
2021-10-11 09:15:55,251 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 243.35it/s]
2021-10-11 09:15:55,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 241.72it/s]
2021-10-11 09:15:56,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 235.40it/s]
2021-10-11 09:15:56,651 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 235.28it/s]
2021-10-11 09:15:57,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 201.19it/s]
2021-10-11 09:15:57,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 208.64it/s]
2021-10-11 09:15:58,210 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 205.20it/s]
2021-10-11 09:15:58,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 209.87it/s]
2021-10-11 09:15:59,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 205.99it/s]
2021-10-11 09:15:59,830 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 225.88it/s]
2021-10-11 09:16:00,405 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 217.07it/s]
2021-10-11 09:16:00,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 218.61it/s]
2021-10-11 09:16:01,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 212.10it/s]
2021-10-11 09:16:01,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 212.60it/s]
2021-10-11 09:16:02,487 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 222.94it/s]
2021-10-11 09:16:03,029 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 186.91it/s]
2021-10-11 09:16:03,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 166.73it/s]
2021-10-11 09:16:04,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 197.61it/s]
2021-10-11 09:16:04,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 222.94it/s]
2021-10-11 09:16:05,687 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 218.79it/s]
2021-10-11 09:16:06,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 216.40it/s]
2021-10-11 09:16:06,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
2021-10-11 09:16:06,692 knodle.trainer.trainer INFO     Train avg loss: 0.1342696102712717
2021-10-11 09:16:06,692 knodle.trainer.trainer INFO     Train avg accuracy: 0.9398642767137956
2021-10-11 09:16:06,692 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:16:06,692 knodle.trainer.trainer INFO     Training done
2021-10-11 09:16:06,692 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 156.43it/s]
2021-10-11 09:16:06,841 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9411764705882353, 'recall': 0.25639069057611596, 'f1-score': 0.4029985007496252, 'support': 2621}, '1': {'precision': 0.07057701478302336, 'recall': 0.7789473684210526, 'f1-score': 0.1294271972015741, 'support': 190}, 'accuracy': 0.2917111348274635, 'macro avg': {'precision': 0.5058767426856293, 'recall': 0.5176690294985843, 'f1-score': 0.26621284897559966, 'support': 2811}, 'weighted avg': {'precision': 0.8823312565708072, 'recall': 0.2917111348274635, 'f1-score': 0.38450737742193764, 'support': 2811}}, Dev loss: 3.341834306716919, denoising continues.
2021-10-11 09:16:06,842 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:16:06,864 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:16:07,222 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3159, samples in test set: 2575
2021-10-11 09:16:07,656 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4859, samples in test set: 875
2021-10-11 09:16:08,181 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5600, samples in test set: 134
2021-10-11 09:16:08,593 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4157, samples in test set: 1577
2021-10-11 09:16:08,844 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5161, samples in test set: 573
5it [02:38, 31.77s/it]
2021-10-11 09:18:47,807 knodle.trainer.cleanlab.cleanlab INFO     [[0.02016743 0.97983257]
 [0.00197239 0.99802761]
 [0.10487288 0.89512712]
 [0.10691824 0.89308176]
 [0.95848881 0.04151119]
 [0.99595142 0.00404858]
 [1.         0.        ]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 09:18:47,920 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 32 out of 5734
2021-10-11 09:18:47,921 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:18:47,921 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:18:47,921 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 136.93it/s]
2021-10-11 09:18:48,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3411597296335824
100%|██████████| 22/22 [00:00<00:00, 199.78it/s]
2021-10-11 09:18:49,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 196.49it/s]
2021-10-11 09:18:49,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 212.21it/s]
2021-10-11 09:18:50,097 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33938100320170755
100%|██████████| 22/22 [00:00<00:00, 200.85it/s]
2021-10-11 09:18:50,644 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 187.59it/s]
2021-10-11 09:18:51,180 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 212.69it/s]
2021-10-11 09:18:51,724 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 211.88it/s]
2021-10-11 09:18:52,228 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 218.61it/s]
2021-10-11 09:18:52,740 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 200.03it/s]
2021-10-11 09:18:53,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 217.81it/s]
2021-10-11 09:18:53,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 213.60it/s]
2021-10-11 09:18:54,370 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 221.11it/s]
2021-10-11 09:18:54,910 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 190.11it/s]
2021-10-11 09:18:55,493 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 219.04it/s]
2021-10-11 09:18:56,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3561010316613305
100%|██████████| 22/22 [00:00<00:00, 206.66it/s]
2021-10-11 09:18:56,534 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 170.02it/s]
2021-10-11 09:18:57,098 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34614016364283173
100%|██████████| 22/22 [00:00<00:00, 188.61it/s]
2021-10-11 09:18:57,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 166.19it/s]
2021-10-11 09:18:58,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 172.92it/s]
2021-10-11 09:18:58,903 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 178.11it/s]
2021-10-11 09:18:59,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 187.49it/s]
2021-10-11 09:19:00,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 204.80it/s]
2021-10-11 09:19:00,613 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 99.50it/s]
2021-10-11 09:19:01,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 234.37it/s]
2021-10-11 09:19:01,757 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 209.51it/s]
2021-10-11 09:19:02,257 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 181.73it/s]
2021-10-11 09:19:02,827 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 183.61it/s]
2021-10-11 09:19:03,390 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 212.09it/s]
2021-10-11 09:19:03,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 216.16it/s]
2021-10-11 09:19:04,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34614016364283173
100%|██████████| 22/22 [00:00<00:00, 217.90it/s]
2021-10-11 09:19:04,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2504446816079687
100%|██████████| 22/22 [00:00<00:00, 219.99it/s]
2021-10-11 09:19:05,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 217.36it/s]
2021-10-11 09:19:05,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 204.54it/s]
2021-10-11 09:19:06,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 221.60it/s]
2021-10-11 09:19:06,996 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 218.38it/s]
2021-10-11 09:19:07,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 205.83it/s]
2021-10-11 09:19:08,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35645677694770544
100%|██████████| 22/22 [00:00<00:00, 210.93it/s]
2021-10-11 09:19:08,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 218.33it/s]
2021-10-11 09:19:09,027 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 212.81it/s]
2021-10-11 09:19:09,551 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 219.89it/s]
2021-10-11 09:19:10,053 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 206.93it/s]
2021-10-11 09:19:10,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 220.27it/s]
2021-10-11 09:19:11,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 215.72it/s]
2021-10-11 09:19:11,600 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 214.40it/s]
2021-10-11 09:19:12,101 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 220.53it/s]
2021-10-11 09:19:12,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 209.12it/s]
2021-10-11 09:19:13,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 207.78it/s]
2021-10-11 09:19:13,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 221.72it/s]
2021-10-11 09:19:14,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 215.26it/s]
2021-10-11 09:19:14,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 199.72it/s]
2021-10-11 09:19:15,159 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 225.79it/s]
2021-10-11 09:19:15,672 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 216.23it/s]
2021-10-11 09:19:16,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 210.35it/s]
2021-10-11 09:19:16,647 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 222.38it/s]
2021-10-11 09:19:17,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 230.33it/s]
2021-10-11 09:19:17,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 198.55it/s]
2021-10-11 09:19:18,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36108146567057986
100%|██████████| 22/22 [00:00<00:00, 221.25it/s]
2021-10-11 09:19:18,681 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 222.72it/s]
2021-10-11 09:19:19,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 221.26it/s]
2021-10-11 09:19:19,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 222.15it/s]
2021-10-11 09:19:20,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 222.67it/s]
2021-10-11 09:19:20,672 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 220.77it/s]
2021-10-11 09:19:21,172 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 205.06it/s]
2021-10-11 09:19:21,686 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 212.95it/s]
2021-10-11 09:19:22,185 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 213.81it/s]
2021-10-11 09:19:22,686 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 196.32it/s]
2021-10-11 09:19:23,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 222.99it/s]
2021-10-11 09:19:23,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 232.92it/s]
2021-10-11 09:19:24,178 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 223.41it/s]
2021-10-11 09:19:24,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 214.24it/s]
2021-10-11 09:19:25,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 227.50it/s]
2021-10-11 09:19:25,636 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 223.05it/s]
2021-10-11 09:19:26,150 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 212.37it/s]
2021-10-11 09:19:26,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 213.04it/s]
2021-10-11 09:19:27,129 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 224.92it/s]
2021-10-11 09:19:27,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 214.97it/s]
2021-10-11 09:19:28,132 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 223.69it/s]
2021-10-11 09:19:28,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 233.63it/s]
2021-10-11 09:19:29,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 221.43it/s]
2021-10-11 09:19:29,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 217.93it/s]
2021-10-11 09:19:30,117 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 229.81it/s]
2021-10-11 09:19:30,634 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 214.59it/s]
2021-10-11 09:19:31,116 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 214.16it/s]
2021-10-11 09:19:31,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 194.56it/s]
2021-10-11 09:19:32,126 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 226.26it/s]
2021-10-11 09:19:32,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 217.14it/s]
2021-10-11 09:19:33,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 222.24it/s]
2021-10-11 09:19:33,633 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 224.21it/s]
2021-10-11 09:19:34,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 216.93it/s]
2021-10-11 09:19:34,623 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 216.97it/s]
2021-10-11 09:19:35,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 221.43it/s]
2021-10-11 09:19:35,617 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 204.19it/s]
2021-10-11 09:19:36,126 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 191.90it/s]
2021-10-11 09:19:36,647 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 233.67it/s]
2021-10-11 09:19:37,155 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 175.22it/s]
2021-10-11 09:19:37,736 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 162.42it/s]
2021-10-11 09:19:38,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 180.13it/s]
2021-10-11 09:19:38,904 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 184.22it/s]
2021-10-11 09:19:39,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 171.90it/s]
2021-10-11 09:19:40,062 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
2021-10-11 09:19:40,063 knodle.trainer.trainer INFO     Train avg loss: 0.13102132013688486
2021-10-11 09:19:40,064 knodle.trainer.trainer INFO     Train avg accuracy: 0.9419249384933046
2021-10-11 09:19:40,064 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:19:40,064 knodle.trainer.trainer INFO     Training done
2021-10-11 09:19:40,064 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 153.35it/s]
2021-10-11 09:19:40,215 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.8160126209259033). Denoising stops.
2021-10-11 09:19:40,215 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 74.51it/s]
2021-10-11 09:19:40,521 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 09:19:40,521 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 09:19:40,521 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.35690485005553496
Precision is: 0.520219924756499
Recall is: 0.5581643247477341
F1 is: 0.32162025580018344
{'0': {'precision': 0.947242206235012, 'recall': 0.31816351188078934, 'f1-score': 0.476334036780223, 'support': 2483}, '1': {'precision': 0.09319764327798608, 'recall': 0.7981651376146789, 'f1-score': 0.16690647482014387, 'support': 218}, 'accuracy': 0.35690485005553496, 'macro avg': {'precision': 0.520219924756499, 'recall': 0.5581643247477341, 'f1-score': 0.32162025580018344, 'support': 2701}, 'weighted avg': {'precision': 0.8783115454706167, 'recall': 0.35690485005553496, 'f1-score': 0.4513598759111756, 'support': 2701}}
2021-10-11 09:19:41,072 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 09:19:41,094 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:19:41,213 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5301, samples in test set: 433
2021-10-11 09:19:41,319 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5471, samples in test set: 263
2021-10-11 09:19:41,466 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3490, samples in test set: 2244
2021-10-11 09:19:41,877 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5452, samples in test set: 282
2021-10-11 09:19:42,423 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3222, samples in test set: 2512
5it [02:31, 30.30s/it]
2021-10-11 09:22:14,017 knodle.trainer.cleanlab.cleanlab INFO     [[0.23978996 0.76021004]
 [0.2061657  0.7938343 ]
 [0.11633282 0.88366718]
 [0.04516129 0.95483871]
 [0.76657303 0.23342697]
 [0.94675926 0.05324074]
 [0.68432203 0.31567797]
 [0.05769231 0.94230769]
 [0.0625     0.9375    ]]
2021-10-11 09:22:14,106 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 184 out of 5734
2021-10-11 09:22:14,108 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:22:14,108 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:22:14,108 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 141.12it/s]
2021-10-11 09:22:14,643 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 215.61it/s]
2021-10-11 09:22:15,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 227.33it/s]
2021-10-11 09:22:15,647 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 227.07it/s]
2021-10-11 09:22:16,135 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 217.41it/s]
2021-10-11 09:22:16,628 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 226.98it/s]
2021-10-11 09:22:17,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22340803984347207
100%|██████████| 22/22 [00:00<00:00, 232.55it/s]
2021-10-11 09:22:17,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 231.82it/s]
2021-10-11 09:22:18,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 231.13it/s]
2021-10-11 09:22:18,563 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 235.74it/s]
2021-10-11 09:22:19,043 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 225.04it/s]
2021-10-11 09:22:19,528 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20739950195659906
100%|██████████| 22/22 [00:00<00:00, 239.98it/s]
2021-10-11 09:22:20,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20739950195659906
100%|██████████| 22/22 [00:00<00:00, 223.90it/s]
2021-10-11 09:22:20,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 223.90it/s]
2021-10-11 09:22:21,015 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22696549270722163
100%|██████████| 22/22 [00:00<00:00, 227.40it/s]
2021-10-11 09:22:21,527 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 237.31it/s]
2021-10-11 09:22:22,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 230.75it/s]
2021-10-11 09:22:22,500 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 230.52it/s]
2021-10-11 09:22:22,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 238.60it/s]
2021-10-11 09:22:23,470 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 236.81it/s]
2021-10-11 09:22:23,950 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2294557097118463
100%|██████████| 22/22 [00:00<00:00, 237.36it/s]
2021-10-11 09:22:24,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 238.91it/s]
2021-10-11 09:22:24,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 239.77it/s]
2021-10-11 09:22:25,398 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 232.74it/s]
2021-10-11 09:22:25,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 235.23it/s]
2021-10-11 09:22:26,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 233.14it/s]
2021-10-11 09:22:26,857 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22340803984347207
100%|██████████| 22/22 [00:00<00:00, 236.96it/s]
2021-10-11 09:22:27,340 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 235.31it/s]
2021-10-11 09:22:27,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 215.45it/s]
2021-10-11 09:22:28,302 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20846673781572395
100%|██████████| 22/22 [00:00<00:00, 221.05it/s]
2021-10-11 09:22:28,786 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 237.61it/s]
2021-10-11 09:22:29,275 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 222.99it/s]
2021-10-11 09:22:29,762 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 232.70it/s]
2021-10-11 09:22:30,258 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 232.15it/s]
2021-10-11 09:22:30,751 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 233.44it/s]
2021-10-11 09:22:31,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 231.62it/s]
2021-10-11 09:22:31,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 232.92it/s]
2021-10-11 09:22:32,185 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3244397011739594
100%|██████████| 22/22 [00:00<00:00, 236.31it/s]
2021-10-11 09:22:32,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22518676627534684
100%|██████████| 22/22 [00:00<00:00, 242.26it/s]
2021-10-11 09:22:33,129 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 230.97it/s]
2021-10-11 09:22:33,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2216293134115973
100%|██████████| 22/22 [00:00<00:00, 224.42it/s]
2021-10-11 09:22:34,093 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3561010316613305
100%|██████████| 22/22 [00:00<00:00, 233.38it/s]
2021-10-11 09:22:34,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 223.63it/s]
2021-10-11 09:22:35,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 223.45it/s]
2021-10-11 09:22:35,568 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 230.14it/s]
2021-10-11 09:22:36,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34863038064745644
100%|██████████| 22/22 [00:00<00:00, 228.00it/s]
2021-10-11 09:22:36,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 229.42it/s]
2021-10-11 09:22:37,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 239.08it/s]
2021-10-11 09:22:37,476 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 241.63it/s]
2021-10-11 09:22:37,948 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 238.28it/s]
2021-10-11 09:22:38,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 228.09it/s]
2021-10-11 09:22:38,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2408395588758449
100%|██████████| 22/22 [00:00<00:00, 232.84it/s]
2021-10-11 09:22:39,380 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 235.01it/s]
2021-10-11 09:22:39,862 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2376378512984703
100%|██████████| 22/22 [00:00<00:00, 237.17it/s]
2021-10-11 09:22:40,339 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 234.15it/s]
2021-10-11 09:22:40,822 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 237.27it/s]
2021-10-11 09:22:41,290 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 224.18it/s]
2021-10-11 09:22:41,772 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 236.07it/s]
2021-10-11 09:22:42,246 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 215.55it/s]
2021-10-11 09:22:42,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 185.34it/s]
2021-10-11 09:22:43,228 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 231.15it/s]
2021-10-11 09:22:43,706 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23087869085734614
100%|██████████| 22/22 [00:00<00:00, 243.89it/s]
2021-10-11 09:22:44,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 242.07it/s]
2021-10-11 09:22:44,648 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 241.87it/s]
2021-10-11 09:22:45,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 229.10it/s]
2021-10-11 09:22:45,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 232.38it/s]
2021-10-11 09:22:46,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 216.78it/s]
2021-10-11 09:22:46,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 242.67it/s]
2021-10-11 09:22:47,058 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 232.13it/s]
2021-10-11 09:22:47,533 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 234.29it/s]
2021-10-11 09:22:48,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
100%|██████████| 22/22 [00:00<00:00, 239.57it/s]
2021-10-11 09:22:48,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 206.58it/s]
2021-10-11 09:22:48,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 226.12it/s]
2021-10-11 09:22:49,486 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 237.38it/s]
2021-10-11 09:22:49,976 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 237.69it/s]
2021-10-11 09:22:50,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 243.23it/s]
2021-10-11 09:22:50,939 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 239.30it/s]
2021-10-11 09:22:51,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 237.30it/s]
2021-10-11 09:22:51,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 233.98it/s]
2021-10-11 09:22:52,370 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 203.80it/s]
2021-10-11 09:22:52,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 238.04it/s]
2021-10-11 09:22:53,381 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21629313411597295
100%|██████████| 22/22 [00:00<00:00, 233.57it/s]
2021-10-11 09:22:53,877 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 224.39it/s]
2021-10-11 09:22:54,362 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 227.63it/s]
2021-10-11 09:22:54,842 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 232.43it/s]
2021-10-11 09:22:55,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 233.65it/s]
2021-10-11 09:22:55,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 235.12it/s]
2021-10-11 09:22:56,303 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 233.77it/s]
2021-10-11 09:22:56,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 239.47it/s]
2021-10-11 09:22:57,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 239.83it/s]
2021-10-11 09:22:57,726 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 240.00it/s]
2021-10-11 09:22:58,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 235.90it/s]
2021-10-11 09:22:58,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 241.16it/s]
2021-10-11 09:22:59,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 234.52it/s]
2021-10-11 09:22:59,623 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 233.86it/s]
2021-10-11 09:23:00,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 220.55it/s]
2021-10-11 09:23:00,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 225.97it/s]
2021-10-11 09:23:01,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 240.99it/s]
2021-10-11 09:23:01,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 239.53it/s]
2021-10-11 09:23:02,110 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 238.29it/s]
2021-10-11 09:23:02,592 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
2021-10-11 09:23:02,593 knodle.trainer.trainer INFO     Train avg loss: 0.16048911813108457
2021-10-11 09:23:02,593 knodle.trainer.trainer INFO     Train avg accuracy: 0.9277215071386762
2021-10-11 09:23:02,593 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:23:02,593 knodle.trainer.trainer INFO     Training done
2021-10-11 09:23:02,594 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 132.16it/s]
2021-10-11 09:23:02,768 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9409221902017291, 'recall': 0.2491415490270889, 'f1-score': 0.39396681749622925, 'support': 2621}, '1': {'precision': 0.07038261691072271, 'recall': 0.7842105263157895, 'f1-score': 0.129172084958821, 'support': 190}, 'accuracy': 0.28530771967271434, 'macro avg': {'precision': 0.5056524035562259, 'recall': 0.5166760376714392, 'f1-score': 0.2615694512275251, 'support': 2811}, 'weighted avg': {'precision': 0.8820810237395121, 'recall': 0.28530771967271434, 'f1-score': 0.37606891668438025, 'support': 2811}}, Dev loss: 3.3340859413146973, denoising continues.
2021-10-11 09:23:02,768 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:23:02,796 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:23:03,170 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3805, samples in test set: 1929
2021-10-11 09:23:03,470 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4909, samples in test set: 825
2021-10-11 09:23:03,907 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3638, samples in test set: 2096
2021-10-11 09:23:04,491 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5191, samples in test set: 543
2021-10-11 09:23:04,805 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5393, samples in test set: 341
5it [02:22, 28.51s/it]
2021-10-11 09:25:27,454 knodle.trainer.cleanlab.cleanlab INFO     [[0.07148121 0.92851879]
 [0.00929368 0.99070632]
 [0.09166667 0.90833333]
 [0.01321586 0.98678414]
 [0.9761236  0.0238764 ]
 [0.99544627 0.00455373]
 [0.91393443 0.08606557]
 [0.05       0.95      ]
 [0.07142857 0.92857143]]
2021-10-11 09:25:27,553 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 83 out of 5734
2021-10-11 09:25:27,554 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:25:27,554 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:25:27,554 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 97.43it/s]
2021-10-11 09:25:28,123 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3774457488438278
100%|██████████| 22/22 [00:00<00:00, 216.24it/s]
2021-10-11 09:25:28,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.4044823906083244
100%|██████████| 22/22 [00:00<00:00, 222.93it/s]
2021-10-11 09:25:29,123 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3550337958022056
100%|██████████| 22/22 [00:00<00:00, 220.35it/s]
2021-10-11 09:25:29,626 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37139807897545357
100%|██████████| 22/22 [00:00<00:00, 223.91it/s]
2021-10-11 09:25:30,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.4101743151903237
100%|██████████| 22/22 [00:00<00:00, 226.55it/s]
2021-10-11 09:25:30,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3696193525435788
100%|██████████| 22/22 [00:00<00:00, 225.83it/s]
2021-10-11 09:25:31,104 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37780149413020275
100%|██████████| 22/22 [00:00<00:00, 218.86it/s]
2021-10-11 09:25:31,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38918534329420135
100%|██████████| 22/22 [00:00<00:00, 226.91it/s]
2021-10-11 09:25:32,077 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36926360725720386
100%|██████████| 22/22 [00:00<00:00, 212.61it/s]
2021-10-11 09:25:32,554 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 242.47it/s]
2021-10-11 09:25:33,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36357168267520457
100%|██████████| 22/22 [00:00<00:00, 224.32it/s]
2021-10-11 09:25:33,505 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35716826752045533
100%|██████████| 22/22 [00:00<00:00, 228.81it/s]
2021-10-11 09:25:33,966 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3898968338669513
100%|██████████| 22/22 [00:00<00:00, 104.81it/s]
2021-10-11 09:25:34,575 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3703308431163287
100%|██████████| 22/22 [00:00<00:00, 223.85it/s]
2021-10-11 09:25:35,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3614372109569548
100%|██████████| 22/22 [00:00<00:00, 222.17it/s]
2021-10-11 09:25:35,506 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39701173959445035
100%|██████████| 22/22 [00:00<00:00, 238.29it/s]
2021-10-11 09:25:35,961 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3493418712202063
100%|██████████| 22/22 [00:00<00:00, 243.35it/s]
2021-10-11 09:25:36,419 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3795802205620776
100%|██████████| 22/22 [00:00<00:00, 222.09it/s]
2021-10-11 09:25:36,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3525435787975809
100%|██████████| 22/22 [00:00<00:00, 238.63it/s]
2021-10-11 09:25:37,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37104233368907863
100%|██████████| 22/22 [00:00<00:00, 229.76it/s]
2021-10-11 09:25:37,812 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 217.58it/s]
2021-10-11 09:25:38,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3489861259338314
100%|██████████| 22/22 [00:00<00:00, 235.48it/s]
2021-10-11 09:25:38,772 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3671291355389541
100%|██████████| 22/22 [00:00<00:00, 222.90it/s]
2021-10-11 09:25:39,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 210.05it/s]
2021-10-11 09:25:39,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36748488082532904
100%|██████████| 22/22 [00:00<00:00, 216.57it/s]
2021-10-11 09:25:40,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35218783351120597
100%|██████████| 22/22 [00:00<00:00, 225.69it/s]
2021-10-11 09:25:40,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3493418712202063
100%|██████████| 22/22 [00:00<00:00, 209.39it/s]
2021-10-11 09:25:41,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 206.26it/s]
2021-10-11 09:25:41,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3646389185343294
100%|██████████| 22/22 [00:00<00:00, 225.71it/s]
2021-10-11 09:25:42,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 238.94it/s]
2021-10-11 09:25:42,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 204.23it/s]
2021-10-11 09:25:43,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38847385272145146
100%|██████████| 22/22 [00:00<00:00, 232.02it/s]
2021-10-11 09:25:43,832 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 194.59it/s]
2021-10-11 09:25:44,380 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 205.81it/s]
2021-10-11 09:25:44,915 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36890786197082887
100%|██████████| 22/22 [00:00<00:00, 198.61it/s]
2021-10-11 09:25:45,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 211.87it/s]
2021-10-11 09:25:45,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35538954108858056
100%|██████████| 22/22 [00:00<00:00, 212.30it/s]
2021-10-11 09:25:46,457 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 215.33it/s]
2021-10-11 09:25:46,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 222.29it/s]
2021-10-11 09:25:47,427 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34436143721095697
100%|██████████| 22/22 [00:00<00:00, 233.47it/s]
2021-10-11 09:25:47,905 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 195.36it/s]
2021-10-11 09:25:48,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 199.80it/s]
2021-10-11 09:25:48,999 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34863038064745644
100%|██████████| 22/22 [00:00<00:00, 206.18it/s]
2021-10-11 09:25:49,546 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 199.99it/s]
2021-10-11 09:25:50,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3753112771255781
100%|██████████| 22/22 [00:00<00:00, 216.67it/s]
2021-10-11 09:25:50,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 182.04it/s]
2021-10-11 09:25:51,181 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36535040910707933
100%|██████████| 22/22 [00:00<00:00, 202.82it/s]
2021-10-11 09:25:51,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37780149413020275
100%|██████████| 22/22 [00:00<00:00, 198.43it/s]
2021-10-11 09:25:52,366 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 206.01it/s]
2021-10-11 09:25:52,896 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 200.39it/s]
2021-10-11 09:25:53,432 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3703308431163287
100%|██████████| 22/22 [00:00<00:00, 199.92it/s]
2021-10-11 09:25:53,978 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3557452863749555
100%|██████████| 22/22 [00:00<00:00, 192.52it/s]
2021-10-11 09:25:54,511 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3368907861970829
100%|██████████| 22/22 [00:00<00:00, 190.74it/s]
2021-10-11 09:25:55,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3792244752757026
100%|██████████| 22/22 [00:00<00:00, 213.17it/s]
2021-10-11 09:25:55,566 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3408039843472074
100%|██████████| 22/22 [00:00<00:00, 227.53it/s]
2021-10-11 09:25:56,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33475631447883314
100%|██████████| 22/22 [00:00<00:00, 226.31it/s]
2021-10-11 09:25:56,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 238.80it/s]
2021-10-11 09:25:57,073 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3582355033795802
100%|██████████| 22/22 [00:00<00:00, 195.13it/s]
2021-10-11 09:25:57,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 198.51it/s]
2021-10-11 09:25:58,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 195.63it/s]
2021-10-11 09:25:58,686 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34756314478833156
100%|██████████| 22/22 [00:00<00:00, 187.12it/s]
2021-10-11 09:25:59,217 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3411597296335824
100%|██████████| 22/22 [00:00<00:00, 186.10it/s]
2021-10-11 09:25:59,776 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3504091070793312
100%|██████████| 22/22 [00:00<00:00, 64.48it/s]
2021-10-11 09:26:00,867 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3447171824973319
100%|██████████| 22/22 [00:00<00:00, 202.03it/s]
2021-10-11 09:26:01,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3525435787975809
100%|██████████| 22/22 [00:00<00:00, 197.84it/s]
2021-10-11 09:26:02,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 217.48it/s]
2021-10-11 09:26:02,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36036997509783
100%|██████████| 22/22 [00:00<00:00, 199.91it/s]
2021-10-11 09:26:03,259 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36036997509783
100%|██████████| 22/22 [00:00<00:00, 191.44it/s]
2021-10-11 09:26:03,785 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34507292778370685
100%|██████████| 22/22 [00:00<00:00, 212.83it/s]
2021-10-11 09:26:04,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 206.44it/s]
2021-10-11 09:26:04,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3660618996798292
100%|██████████| 22/22 [00:00<00:00, 216.03it/s]
2021-10-11 09:26:05,384 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3557452863749555
100%|██████████| 22/22 [00:00<00:00, 217.74it/s]
2021-10-11 09:26:05,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34827463536108144
100%|██████████| 22/22 [00:00<00:00, 199.73it/s]
2021-10-11 09:26:06,411 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 202.24it/s]
2021-10-11 09:26:06,967 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 194.58it/s]
2021-10-11 09:26:07,534 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3546780505158307
100%|██████████| 22/22 [00:00<00:00, 163.59it/s]
2021-10-11 09:26:08,080 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35645677694770544
100%|██████████| 22/22 [00:00<00:00, 203.03it/s]
2021-10-11 09:26:08,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.368196371398079
100%|██████████| 22/22 [00:00<00:00, 215.90it/s]
2021-10-11 09:26:09,187 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 217.62it/s]
2021-10-11 09:26:09,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35432230522945574
100%|██████████| 22/22 [00:00<00:00, 217.13it/s]
2021-10-11 09:26:10,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3528993240839559
100%|██████████| 22/22 [00:00<00:00, 207.55it/s]
2021-10-11 09:26:10,776 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 199.44it/s]
2021-10-11 09:26:11,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3657061543934543
100%|██████████| 22/22 [00:00<00:00, 187.82it/s]
2021-10-11 09:26:11,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34293845606545714
100%|██████████| 22/22 [00:00<00:00, 209.66it/s]
2021-10-11 09:26:12,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 206.61it/s]
2021-10-11 09:26:13,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33724653148345785
100%|██████████| 22/22 [00:00<00:00, 196.48it/s]
2021-10-11 09:26:13,547 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 207.34it/s]
2021-10-11 09:26:14,089 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 192.74it/s]
2021-10-11 09:26:14,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 202.24it/s]
2021-10-11 09:26:15,174 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 208.21it/s]
2021-10-11 09:26:15,707 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3511205976520811
100%|██████████| 22/22 [00:00<00:00, 212.60it/s]
2021-10-11 09:26:16,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 190.48it/s]
2021-10-11 09:26:16,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 204.13it/s]
2021-10-11 09:26:17,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 198.98it/s]
2021-10-11 09:26:17,879 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 203.33it/s]
2021-10-11 09:26:18,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 185.25it/s]
2021-10-11 09:26:18,960 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34863038064745644
100%|██████████| 22/22 [00:00<00:00, 198.95it/s]
2021-10-11 09:26:19,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3614372109569548
100%|██████████| 22/22 [00:00<00:00, 190.99it/s]
2021-10-11 09:26:20,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35965848452508004
100%|██████████| 22/22 [00:00<00:00, 196.91it/s]
2021-10-11 09:26:20,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3489861259338314
2021-10-11 09:26:20,598 knodle.trainer.trainer INFO     Train avg loss: 0.1268368198482527
2021-10-11 09:26:20,598 knodle.trainer.trainer INFO     Train avg accuracy: 0.9429095517132019
2021-10-11 09:26:20,599 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:26:20,599 knodle.trainer.trainer INFO     Training done
2021-10-11 09:26:20,599 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 142.49it/s]
2021-10-11 09:26:20,762 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.69876766204834). Denoising stops.
2021-10-11 09:26:20,762 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 70.58it/s]
2021-10-11 09:26:21,082 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 09:26:21,082 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 09:26:21,082 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.3746760459089226
Precision is: 0.5236187035095602
Recall is: 0.5699222603612824
F1 is: 0.33471130965792384
{'0': {'precision': 0.9511363636363637, 'recall': 0.33709222714458315, 'f1-score': 0.4977698483496878, 'support': 2483}, '1': {'precision': 0.09610104338275673, 'recall': 0.8027522935779816, 'f1-score': 0.17165277096615988, 'support': 218}, 'accuracy': 0.3746760459089226, 'macro avg': {'precision': 0.5236187035095602, 'recall': 0.5699222603612824, 'f1-score': 0.33471130965792384, 'support': 2701}, 'weighted avg': {'precision': 0.8821257380105635, 'recall': 0.3746760459089226, 'f1-score': 0.4714486625408729, 'support': 2701}}
2021-10-11 09:26:21,867 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 09:26:21,891 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:26:22,906 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4799, samples in test set: 935
2021-10-11 09:26:23,244 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3772, samples in test set: 1962
2021-10-11 09:26:23,563 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5653, samples in test set: 81
2021-10-11 09:26:23,918 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5396, samples in test set: 338
2021-10-11 09:26:24,282 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3316, samples in test set: 2418
5it [02:31, 30.23s/it]
2021-10-11 09:28:55,555 knodle.trainer.cleanlab.cleanlab INFO     [[0.20711528 0.79288472]
 [0.09082892 0.90917108]
 [0.11717496 0.88282504]
 [0.21139706 0.78860294]
 [0.81768293 0.18231707]
 [0.93118467 0.06881533]
 [0.69543147 0.30456853]
 [0.05357143 0.94642857]
 [0.08974359 0.91025641]]
2021-10-11 09:28:55,693 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 207 out of 5734
2021-10-11 09:28:55,693 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:28:55,694 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:28:55,694 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 65.82it/s]
2021-10-11 09:28:56,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 169.02it/s]
2021-10-11 09:28:57,371 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 173.37it/s]
2021-10-11 09:28:57,981 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22838847385272146
100%|██████████| 22/22 [00:00<00:00, 175.15it/s]
2021-10-11 09:28:58,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 191.15it/s]
2021-10-11 09:28:59,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 187.44it/s]
2021-10-11 09:28:59,794 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2312344361437211
100%|██████████| 22/22 [00:00<00:00, 175.73it/s]
2021-10-11 09:29:00,394 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 171.72it/s]
2021-10-11 09:29:01,018 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 187.80it/s]
2021-10-11 09:29:01,631 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2504446816079687
100%|██████████| 22/22 [00:00<00:00, 165.98it/s]
2021-10-11 09:29:02,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22447527570259693
100%|██████████| 22/22 [00:00<00:00, 170.08it/s]
2021-10-11 09:29:02,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21949484169334757
100%|██████████| 22/22 [00:00<00:00, 167.19it/s]
2021-10-11 09:29:03,544 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 198.90it/s]
2021-10-11 09:29:04,126 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 188.61it/s]
2021-10-11 09:29:04,681 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 168.34it/s]
2021-10-11 09:29:05,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 193.26it/s]
2021-10-11 09:29:05,868 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 175.71it/s]
2021-10-11 09:29:06,474 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 169.16it/s]
2021-10-11 09:29:07,131 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21309142653859836
100%|██████████| 22/22 [00:00<00:00, 171.35it/s]
2021-10-11 09:29:07,759 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 191.36it/s]
2021-10-11 09:29:08,336 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 181.22it/s]
2021-10-11 09:29:08,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 183.17it/s]
2021-10-11 09:29:09,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 204.01it/s]
2021-10-11 09:29:10,084 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34542867307008185
100%|██████████| 22/22 [00:00<00:00, 203.15it/s]
2021-10-11 09:29:10,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 194.86it/s]
2021-10-11 09:29:11,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 185.19it/s]
2021-10-11 09:29:11,787 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 202.32it/s]
2021-10-11 09:29:12,351 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 179.86it/s]
2021-10-11 09:29:12,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 194.41it/s]
2021-10-11 09:29:13,548 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 205.28it/s]
2021-10-11 09:29:14,125 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21700462468872286
100%|██████████| 22/22 [00:00<00:00, 181.09it/s]
2021-10-11 09:29:14,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 197.56it/s]
2021-10-11 09:29:15,303 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 168.59it/s]
2021-10-11 09:29:15,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21237993596584845
100%|██████████| 22/22 [00:00<00:00, 85.03it/s]
2021-10-11 09:29:16,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 178.42it/s]
2021-10-11 09:29:17,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 192.87it/s]
2021-10-11 09:29:17,862 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3959445037353255
100%|██████████| 22/22 [00:00<00:00, 192.76it/s]
2021-10-11 09:29:18,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 204.87it/s]
2021-10-11 09:29:18,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 196.99it/s]
2021-10-11 09:29:19,525 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 175.74it/s]
2021-10-11 09:29:20,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 170.80it/s]
2021-10-11 09:29:20,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2294557097118463
100%|██████████| 22/22 [00:00<00:00, 193.08it/s]
2021-10-11 09:29:21,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3244397011739594
100%|██████████| 22/22 [00:00<00:00, 181.02it/s]
2021-10-11 09:29:21,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 187.93it/s]
2021-10-11 09:29:22,402 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 189.60it/s]
2021-10-11 09:29:23,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 178.23it/s]
2021-10-11 09:29:23,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 207.08it/s]
2021-10-11 09:29:24,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 164.94it/s]
2021-10-11 09:29:24,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 184.73it/s]
2021-10-11 09:29:25,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 189.36it/s]
2021-10-11 09:29:25,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 188.64it/s]
2021-10-11 09:29:26,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 205.59it/s]
2021-10-11 09:29:26,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 191.88it/s]
2021-10-11 09:29:27,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 159.47it/s]
2021-10-11 09:29:28,207 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 165.85it/s]
2021-10-11 09:29:28,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22981145499822128
100%|██████████| 22/22 [00:00<00:00, 190.53it/s]
2021-10-11 09:29:29,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 192.92it/s]
2021-10-11 09:29:30,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 192.09it/s]
2021-10-11 09:29:30,599 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 145.13it/s]
2021-10-11 09:29:31,231 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 186.21it/s]
2021-10-11 09:29:31,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 187.06it/s]
2021-10-11 09:29:32,419 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 150.26it/s]
2021-10-11 09:29:33,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 186.04it/s]
2021-10-11 09:29:33,677 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 199.25it/s]
2021-10-11 09:29:34,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 189.88it/s]
2021-10-11 09:29:34,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3792244752757026
100%|██████████| 22/22 [00:00<00:00, 203.27it/s]
2021-10-11 09:29:35,295 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 132.84it/s]
2021-10-11 09:29:35,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 148.35it/s]
2021-10-11 09:29:36,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 167.12it/s]
2021-10-11 09:29:37,267 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 202.85it/s]
2021-10-11 09:29:37,980 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 183.35it/s]
2021-10-11 09:29:38,614 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 198.95it/s]
2021-10-11 09:29:39,174 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 175.15it/s]
2021-10-11 09:29:39,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 194.60it/s]
2021-10-11 09:29:40,339 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 204.17it/s]
2021-10-11 09:29:40,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35432230522945574
100%|██████████| 22/22 [00:00<00:00, 159.21it/s]
2021-10-11 09:29:41,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 157.88it/s]
2021-10-11 09:29:42,274 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 144.61it/s]
2021-10-11 09:29:42,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 174.08it/s]
2021-10-11 09:29:43,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 180.55it/s]
2021-10-11 09:29:44,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 180.12it/s]
2021-10-11 09:29:44,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 184.95it/s]
2021-10-11 09:29:45,411 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36748488082532904
100%|██████████| 22/22 [00:00<00:00, 198.98it/s]
2021-10-11 09:29:46,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 176.89it/s]
2021-10-11 09:29:46,600 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 177.82it/s]
2021-10-11 09:29:47,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 170.94it/s]
2021-10-11 09:29:47,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 168.09it/s]
2021-10-11 09:29:48,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 98.06it/s]
2021-10-11 09:29:49,260 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22127356812522234
100%|██████████| 22/22 [00:00<00:00, 150.73it/s]
2021-10-11 09:29:50,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 148.46it/s]
2021-10-11 09:29:50,880 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 195.77it/s]
2021-10-11 09:29:51,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 183.34it/s]
2021-10-11 09:29:52,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 189.24it/s]
2021-10-11 09:29:52,706 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 171.40it/s]
2021-10-11 09:29:53,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 186.84it/s]
2021-10-11 09:29:53,933 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 164.24it/s]
2021-10-11 09:29:54,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 167.12it/s]
2021-10-11 09:29:55,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 192.27it/s]
2021-10-11 09:29:55,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 201.39it/s]
2021-10-11 09:29:56,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 187.11it/s]
2021-10-11 09:29:56,979 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
2021-10-11 09:29:56,980 knodle.trainer.trainer INFO     Train avg loss: 0.16127674011596377
2021-10-11 09:29:56,980 knodle.trainer.trainer INFO     Train avg accuracy: 0.9275671293867959
2021-10-11 09:29:56,980 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:29:56,980 knodle.trainer.trainer INFO     Training done
2021-10-11 09:29:56,980 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 125.51it/s]
2021-10-11 09:29:57,165 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9393442622950819, 'recall': 0.21861884776802748, 'f1-score': 0.35468895078922935, 'support': 2621}, '1': {'precision': 0.06951385733757383, 'recall': 0.8052631578947368, 'f1-score': 0.12797992471769132, 'support': 190}, 'accuracy': 0.25827107790821774, 'macro avg': {'precision': 0.5044290598163279, 'recall': 0.5119410028313821, 'f1-score': 0.24133443775346033, 'support': 2811}, 'weighted avg': {'precision': 0.8805510296583239, 'recall': 0.25827107790821774, 'f1-score': 0.3393653239825441, 'support': 2811}}, Dev loss: 3.5371832847595215, denoising continues.
2021-10-11 09:29:57,165 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:29:57,199 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:29:57,464 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4867, samples in test set: 867
2021-10-11 09:29:57,578 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5648, samples in test set: 86
2021-10-11 09:29:57,693 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5425, samples in test set: 309
2021-10-11 09:29:57,836 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3326, samples in test set: 2408
2021-10-11 09:29:58,149 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3670, samples in test set: 2064
5it [02:30, 30.19s/it]
2021-10-11 09:32:29,210 knodle.trainer.cleanlab.cleanlab INFO     [[0.0722061  0.9277939 ]
 [0.02512998 0.97487002]
 [0.09025788 0.90974212]
 [0.07865169 0.92134831]
 [0.95808383 0.04191617]
 [0.97478992 0.02521008]
 [0.93777778 0.06222222]
 [0.025      0.975     ]
 [0.03571429 0.96428571]]
2021-10-11 09:32:29,319 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 99 out of 5734
2021-10-11 09:32:29,320 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:32:29,320 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:32:29,320 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 147.81it/s]
2021-10-11 09:32:29,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39807897545357523
100%|██████████| 22/22 [00:00<00:00, 203.28it/s]
2021-10-11 09:32:30,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3799359658484525
100%|██████████| 22/22 [00:00<00:00, 207.34it/s]
2021-10-11 09:32:31,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3888295980078264
100%|██████████| 22/22 [00:00<00:00, 169.66it/s]
2021-10-11 09:32:31,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3810032017075774
100%|██████████| 22/22 [00:00<00:00, 201.80it/s]
2021-10-11 09:32:32,295 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3738882959800783
100%|██████████| 22/22 [00:00<00:00, 200.84it/s]
2021-10-11 09:32:32,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37139807897545357
100%|██████████| 22/22 [00:00<00:00, 187.35it/s]
2021-10-11 09:32:33,420 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3959445037353255
100%|██████████| 22/22 [00:00<00:00, 192.19it/s]
2021-10-11 09:32:33,979 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35538954108858056
100%|██████████| 22/22 [00:00<00:00, 201.62it/s]
2021-10-11 09:32:34,536 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39807897545357523
100%|██████████| 22/22 [00:00<00:00, 211.72it/s]
2021-10-11 09:32:35,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39950195659907506
100%|██████████| 22/22 [00:00<00:00, 173.05it/s]
2021-10-11 09:32:35,722 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38598363571682676
100%|██████████| 22/22 [00:00<00:00, 181.05it/s]
2021-10-11 09:32:36,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39381003201707576
100%|██████████| 22/22 [00:00<00:00, 200.94it/s]
2021-10-11 09:32:36,875 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3774457488438278
100%|██████████| 22/22 [00:00<00:00, 212.58it/s]
2021-10-11 09:32:37,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3660618996798292
100%|██████████| 22/22 [00:00<00:00, 193.85it/s]
2021-10-11 09:32:37,979 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 162.75it/s]
2021-10-11 09:32:38,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.368196371398079
100%|██████████| 22/22 [00:00<00:00, 156.47it/s]
2021-10-11 09:32:39,313 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3874066168623266
100%|██████████| 22/22 [00:00<00:00, 183.21it/s]
2021-10-11 09:32:39,940 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37637851298470293
100%|██████████| 22/22 [00:00<00:00, 183.78it/s]
2021-10-11 09:32:40,538 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37104233368907863
100%|██████████| 22/22 [00:00<00:00, 179.83it/s]
2021-10-11 09:32:41,140 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 160.52it/s]
2021-10-11 09:32:41,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34293845606545714
100%|██████████| 22/22 [00:00<00:00, 169.11it/s]
2021-10-11 09:32:42,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38456065457132693
100%|██████████| 22/22 [00:00<00:00, 186.36it/s]
2021-10-11 09:32:43,031 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3646389185343294
100%|██████████| 22/22 [00:00<00:00, 164.46it/s]
2021-10-11 09:32:43,634 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36036997509783
100%|██████████| 22/22 [00:00<00:00, 156.50it/s]
2021-10-11 09:32:44,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3767342582710779
100%|██████████| 22/22 [00:00<00:00, 149.72it/s]
2021-10-11 09:32:45,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 184.75it/s]
2021-10-11 09:32:45,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3664176449662042
100%|██████████| 22/22 [00:00<00:00, 178.60it/s]
2021-10-11 09:32:46,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 193.60it/s]
2021-10-11 09:32:46,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34293845606545714
100%|██████████| 22/22 [00:00<00:00, 186.60it/s]
2021-10-11 09:32:47,368 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39558875844895053
100%|██████████| 22/22 [00:00<00:00, 193.20it/s]
2021-10-11 09:32:47,950 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3696193525435788
100%|██████████| 22/22 [00:00<00:00, 189.78it/s]
2021-10-11 09:32:48,534 knodle.trainer.trainer INFO     Epoch development accuracy: 0.368196371398079
100%|██████████| 22/22 [00:00<00:00, 178.65it/s]
2021-10-11 09:32:49,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3934542867307008
100%|██████████| 22/22 [00:00<00:00, 185.86it/s]
2021-10-11 09:32:49,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 202.71it/s]
2021-10-11 09:32:50,282 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3952330131625756
100%|██████████| 22/22 [00:00<00:00, 204.18it/s]
2021-10-11 09:32:50,827 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3447171824973319
100%|██████████| 22/22 [00:00<00:00, 187.08it/s]
2021-10-11 09:32:51,433 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37886872998932764
100%|██████████| 22/22 [00:00<00:00, 211.05it/s]
2021-10-11 09:32:51,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 177.25it/s]
2021-10-11 09:32:52,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37104233368907863
100%|██████████| 22/22 [00:00<00:00, 194.52it/s]
2021-10-11 09:32:53,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39985770188545
100%|██████████| 22/22 [00:00<00:00, 195.91it/s]
2021-10-11 09:32:53,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35076485236570615
100%|██████████| 22/22 [00:00<00:00, 187.12it/s]
2021-10-11 09:32:54,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 166.93it/s]
2021-10-11 09:32:54,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3625044468160797
100%|██████████| 22/22 [00:00<00:00, 170.75it/s]
2021-10-11 09:32:55,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3888295980078264
100%|██████████| 22/22 [00:00<00:00, 187.07it/s]
2021-10-11 09:32:56,173 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3767342582710779
100%|██████████| 22/22 [00:00<00:00, 179.83it/s]
2021-10-11 09:32:56,788 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36535040910707933
100%|██████████| 22/22 [00:00<00:00, 165.61it/s]
2021-10-11 09:32:57,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35183208822483103
100%|██████████| 22/22 [00:00<00:00, 182.36it/s]
2021-10-11 09:32:58,035 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 187.06it/s]
2021-10-11 09:32:58,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3625044468160797
100%|██████████| 22/22 [00:00<00:00, 182.95it/s]
2021-10-11 09:32:59,243 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36677339025257916
100%|██████████| 22/22 [00:00<00:00, 185.18it/s]
2021-10-11 09:32:59,827 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36214870152970474
100%|██████████| 22/22 [00:00<00:00, 187.50it/s]
2021-10-11 09:33:00,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3831376734258271
100%|██████████| 22/22 [00:00<00:00, 178.27it/s]
2021-10-11 09:33:00,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3646389185343294
100%|██████████| 22/22 [00:00<00:00, 171.22it/s]
2021-10-11 09:33:01,579 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 184.30it/s]
2021-10-11 09:33:02,191 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 188.31it/s]
2021-10-11 09:33:02,771 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3792244752757026
100%|██████████| 22/22 [00:00<00:00, 174.94it/s]
2021-10-11 09:33:03,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3792244752757026
100%|██████████| 22/22 [00:00<00:00, 176.61it/s]
2021-10-11 09:33:03,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35787975809320527
100%|██████████| 22/22 [00:00<00:00, 177.77it/s]
2021-10-11 09:33:04,590 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3628601921024546
100%|██████████| 22/22 [00:00<00:00, 182.64it/s]
2021-10-11 09:33:05,207 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36428317324795445
100%|██████████| 22/22 [00:00<00:00, 194.24it/s]
2021-10-11 09:33:05,799 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37815723941657775
100%|██████████| 22/22 [00:00<00:00, 171.08it/s]
2021-10-11 09:33:06,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3703308431163287
100%|██████████| 22/22 [00:00<00:00, 187.07it/s]
2021-10-11 09:33:06,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 187.30it/s]
2021-10-11 09:33:07,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3457844183564568
100%|██████████| 22/22 [00:00<00:00, 174.20it/s]
2021-10-11 09:33:08,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36535040910707933
100%|██████████| 22/22 [00:00<00:00, 173.88it/s]
2021-10-11 09:33:08,815 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3422269654927072
100%|██████████| 22/22 [00:00<00:00, 181.66it/s]
2021-10-11 09:33:09,426 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 178.91it/s]
2021-10-11 09:33:10,029 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37886872998932764
100%|██████████| 22/22 [00:00<00:00, 164.26it/s]
2021-10-11 09:33:10,628 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3557452863749555
100%|██████████| 22/22 [00:00<00:00, 179.47it/s]
2021-10-11 09:33:11,228 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 175.23it/s]
2021-10-11 09:33:11,863 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 179.76it/s]
2021-10-11 09:33:12,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3582355033795802
100%|██████████| 22/22 [00:00<00:00, 162.02it/s]
2021-10-11 09:33:13,165 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 189.03it/s]
2021-10-11 09:33:13,788 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 147.14it/s]
2021-10-11 09:33:14,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 189.86it/s]
2021-10-11 09:33:15,052 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 154.97it/s]
2021-10-11 09:33:15,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3706865884027037
100%|██████████| 22/22 [00:00<00:00, 156.28it/s]
2021-10-11 09:33:16,320 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 177.29it/s]
2021-10-11 09:33:16,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 137.04it/s]
2021-10-11 09:33:17,628 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3607257203842049
100%|██████████| 22/22 [00:00<00:00, 181.80it/s]
2021-10-11 09:33:18,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34614016364283173
100%|██████████| 22/22 [00:00<00:00, 185.62it/s]
2021-10-11 09:33:19,003 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34436143721095697
100%|██████████| 22/22 [00:00<00:00, 160.40it/s]
2021-10-11 09:33:19,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 150.25it/s]
2021-10-11 09:33:20,340 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 86.52it/s]
2021-10-11 09:33:23,097 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 177.49it/s]
2021-10-11 09:33:23,785 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3820704375667022
100%|██████████| 22/22 [00:00<00:00, 171.21it/s]
2021-10-11 09:33:24,393 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 152.00it/s]
2021-10-11 09:33:25,044 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 182.14it/s]
2021-10-11 09:33:25,663 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 149.20it/s]
2021-10-11 09:33:26,323 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39950195659907506
100%|██████████| 22/22 [00:00<00:00, 155.30it/s]
2021-10-11 09:33:27,028 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3792244752757026
100%|██████████| 22/22 [00:00<00:00, 167.20it/s]
2021-10-11 09:33:27,651 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34969761650658127
100%|██████████| 22/22 [00:00<00:00, 174.29it/s]
2021-10-11 09:33:28,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3525435787975809
100%|██████████| 22/22 [00:00<00:00, 189.57it/s]
2021-10-11 09:33:28,863 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3383137673425827
100%|██████████| 22/22 [00:00<00:00, 176.41it/s]
2021-10-11 09:33:29,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 180.97it/s]
2021-10-11 09:33:30,074 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36108146567057986
100%|██████████| 22/22 [00:00<00:00, 193.36it/s]
2021-10-11 09:33:30,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3536108146567058
100%|██████████| 22/22 [00:00<00:00, 192.97it/s]
2021-10-11 09:33:31,221 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 191.84it/s]
2021-10-11 09:33:31,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35645677694770544
100%|██████████| 22/22 [00:00<00:00, 181.59it/s]
2021-10-11 09:33:32,412 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
2021-10-11 09:33:32,413 knodle.trainer.trainer INFO     Train avg loss: 0.12764881741669445
2021-10-11 09:33:32,413 knodle.trainer.trainer INFO     Train avg accuracy: 0.9425236585272684
2021-10-11 09:33:32,413 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:33:32,413 knodle.trainer.trainer INFO     Training done
2021-10-11 09:33:32,414 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 130.20it/s]
2021-10-11 09:33:32,594 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.7321221828460693). Denoising stops.
2021-10-11 09:33:32,594 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 52.85it/s]
2021-10-11 09:33:33,021 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 09:33:33,021 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 09:33:33,021 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 09:33:34,297 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
Accuracy is: 0.359496482784154
Precision is: 0.5221206946944175
Recall is: 0.5637583272676217
F1 is: 0.3239919331504693
{'0': {'precision': 0.9498207885304659, 'recall': 0.3201772049939589, 'f1-score': 0.4789156626506024, 'support': 2483}, '1': {'precision': 0.0944206008583691, 'recall': 0.8073394495412844, 'f1-score': 0.16906820365033623, 'support': 218}, 'accuracy': 0.359496482784154, 'macro avg': {'precision': 0.5221206946944175, 'recall': 0.5637583272676217, 'f1-score': 0.3239919331504693, 'support': 2701}, 'weighted avg': {'precision': 0.8807807141459724, 'recall': 0.359496482784154, 'f1-score': 0.45390761153543835, 'support': 2701}}
2021-10-11 09:33:35,136 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:33:35,283 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4793, samples in test set: 941
2021-10-11 09:33:35,528 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3670, samples in test set: 2064
2021-10-11 09:33:36,099 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5555, samples in test set: 179
2021-10-11 09:33:36,408 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3740, samples in test set: 1994
2021-10-11 09:33:36,704 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5178, samples in test set: 556
5it [02:31, 30.26s/it]
2021-10-11 09:36:08,137 knodle.trainer.cleanlab.cleanlab INFO     [[0.18914186 0.81085814]
 [0.04694836 0.95305164]
 [0.33278689 0.66721311]
 [0.13468635 0.86531365]
 [0.80380499 0.19619501]
 [0.94798658 0.05201342]
 [0.6880531  0.3119469 ]
 [0.12962963 0.87037037]
 [0.1025641  0.8974359 ]]
2021-10-11 09:36:08,285 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 197 out of 5734
2021-10-11 09:36:08,286 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:36:08,286 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:36:08,286 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 142.02it/s]
2021-10-11 09:36:09,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 166.12it/s]
2021-10-11 09:36:09,922 knodle.trainer.trainer INFO     Epoch development accuracy: 0.1903237282106012
100%|██████████| 22/22 [00:00<00:00, 181.84it/s]
2021-10-11 09:36:10,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 183.29it/s]
2021-10-11 09:36:11,118 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 178.64it/s]
2021-10-11 09:36:11,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 187.61it/s]
2021-10-11 09:36:12,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22696549270722163
100%|██████████| 22/22 [00:00<00:00, 165.48it/s]
2021-10-11 09:36:12,920 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 168.42it/s]
2021-10-11 09:36:13,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 172.96it/s]
2021-10-11 09:36:14,205 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 184.42it/s]
2021-10-11 09:36:14,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 164.45it/s]
2021-10-11 09:36:15,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327641408751334
100%|██████████| 22/22 [00:00<00:00, 159.29it/s]
2021-10-11 09:36:16,095 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 176.63it/s]
2021-10-11 09:36:16,717 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 175.87it/s]
2021-10-11 09:36:17,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 193.48it/s]
2021-10-11 09:36:17,903 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 184.69it/s]
2021-10-11 09:36:18,490 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 191.51it/s]
2021-10-11 09:36:19,101 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 183.89it/s]
2021-10-11 09:36:19,677 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 178.11it/s]
2021-10-11 09:36:20,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2102454642475987
100%|██████████| 22/22 [00:00<00:00, 182.94it/s]
2021-10-11 09:36:20,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 182.28it/s]
2021-10-11 09:36:21,512 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 170.10it/s]
2021-10-11 09:36:22,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 175.95it/s]
2021-10-11 09:36:22,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 172.90it/s]
2021-10-11 09:36:23,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20135183208822482
100%|██████████| 22/22 [00:00<00:00, 176.92it/s]
2021-10-11 09:36:23,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 171.22it/s]
2021-10-11 09:36:24,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 176.76it/s]
2021-10-11 09:36:25,201 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 176.26it/s]
2021-10-11 09:36:25,821 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 182.32it/s]
2021-10-11 09:36:26,414 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22376378512984704
100%|██████████| 22/22 [00:00<00:00, 166.65it/s]
2021-10-11 09:36:27,052 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 173.50it/s]
2021-10-11 09:36:27,681 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2504446816079687
100%|██████████| 22/22 [00:00<00:00, 184.63it/s]
2021-10-11 09:36:28,268 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 172.37it/s]
2021-10-11 09:36:28,888 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 184.46it/s]
2021-10-11 09:36:29,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 187.57it/s]
2021-10-11 09:36:30,054 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 186.50it/s]
2021-10-11 09:36:30,626 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 189.91it/s]
2021-10-11 09:36:31,201 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 186.39it/s]
2021-10-11 09:36:31,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 186.57it/s]
2021-10-11 09:36:32,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22411953041622198
100%|██████████| 22/22 [00:00<00:00, 192.91it/s]
2021-10-11 09:36:32,906 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 184.86it/s]
2021-10-11 09:36:33,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 191.47it/s]
2021-10-11 09:36:34,043 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 188.75it/s]
2021-10-11 09:36:34,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 185.73it/s]
2021-10-11 09:36:35,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 192.98it/s]
2021-10-11 09:36:35,757 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 201.58it/s]
2021-10-11 09:36:36,326 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 191.58it/s]
2021-10-11 09:36:36,880 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 194.51it/s]
2021-10-11 09:36:37,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 188.04it/s]
2021-10-11 09:36:38,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 193.31it/s]
2021-10-11 09:36:38,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 190.61it/s]
2021-10-11 09:36:39,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22198505869797225
100%|██████████| 22/22 [00:00<00:00, 160.79it/s]
2021-10-11 09:36:39,804 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22838847385272146
100%|██████████| 22/22 [00:00<00:00, 185.23it/s]
2021-10-11 09:36:40,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 191.40it/s]
2021-10-11 09:36:41,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 195.73it/s]
2021-10-11 09:36:41,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 189.51it/s]
2021-10-11 09:36:42,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 188.26it/s]
2021-10-11 09:36:42,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 178.71it/s]
2021-10-11 09:36:43,323 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 182.46it/s]
2021-10-11 09:36:43,901 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2255425115617218
100%|██████████| 22/22 [00:00<00:00, 185.92it/s]
2021-10-11 09:36:44,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 180.38it/s]
2021-10-11 09:36:45,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 185.13it/s]
2021-10-11 09:36:45,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 178.10it/s]
2021-10-11 09:36:46,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 178.67it/s]
2021-10-11 09:36:46,829 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 181.91it/s]
2021-10-11 09:36:47,413 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 186.34it/s]
2021-10-11 09:36:47,987 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22411953041622198
100%|██████████| 22/22 [00:00<00:00, 178.83it/s]
2021-10-11 09:36:48,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 176.57it/s]
2021-10-11 09:36:49,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 184.96it/s]
2021-10-11 09:36:49,759 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22696549270722163
100%|██████████| 22/22 [00:00<00:00, 187.52it/s]
2021-10-11 09:36:50,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 160.94it/s]
2021-10-11 09:36:50,989 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 188.32it/s]
2021-10-11 09:36:51,633 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 178.19it/s]
2021-10-11 09:36:52,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 199.20it/s]
2021-10-11 09:36:52,787 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 149.73it/s]
2021-10-11 09:36:53,425 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 149.74it/s]
2021-10-11 09:36:54,118 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 169.23it/s]
2021-10-11 09:36:54,769 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 168.15it/s]
2021-10-11 09:36:55,428 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 165.31it/s]
2021-10-11 09:36:56,072 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 169.86it/s]
2021-10-11 09:36:56,740 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3607257203842049
100%|██████████| 22/22 [00:00<00:00, 181.71it/s]
2021-10-11 09:36:57,340 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 166.55it/s]
2021-10-11 09:36:57,968 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 186.98it/s]
2021-10-11 09:36:58,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 189.63it/s]
2021-10-11 09:36:59,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 176.09it/s]
2021-10-11 09:36:59,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 185.18it/s]
2021-10-11 09:37:00,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 166.16it/s]
2021-10-11 09:37:00,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 167.46it/s]
2021-10-11 09:37:01,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 180.28it/s]
2021-10-11 09:37:02,243 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 162.48it/s]
2021-10-11 09:37:02,927 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 175.21it/s]
2021-10-11 09:37:03,557 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33724653148345785
100%|██████████| 22/22 [00:00<00:00, 161.12it/s]
2021-10-11 09:37:04,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 148.02it/s]
2021-10-11 09:37:04,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 169.49it/s]
2021-10-11 09:37:05,509 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 164.90it/s]
2021-10-11 09:37:06,185 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 156.90it/s]
2021-10-11 09:37:06,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 161.67it/s]
2021-10-11 09:37:07,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 182.88it/s]
2021-10-11 09:37:08,201 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 174.44it/s]
2021-10-11 09:37:08,830 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 163.91it/s]
2021-10-11 09:37:09,459 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
2021-10-11 09:37:09,461 knodle.trainer.trainer INFO     Train avg loss: 0.13399948592359812
2021-10-11 09:37:09,461 knodle.trainer.trainer INFO     Train avg accuracy: 0.9404206833177142
2021-10-11 09:37:09,461 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:37:09,462 knodle.trainer.trainer INFO     Training done
2021-10-11 09:37:09,462 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 126.00it/s]
2021-10-11 09:37:09,647 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9368723098995696, 'recall': 0.2491415490270889, 'f1-score': 0.39361060880048226, 'support': 2621}, '1': {'precision': 0.06906338694418164, 'recall': 0.7684210526315789, 'f1-score': 0.12673611111111108, 'support': 190}, 'accuracy': 0.28424048381358946, 'macro avg': {'precision': 0.5029678484218756, 'recall': 0.5087813008293339, 'f1-score': 0.26017335995579666, 'support': 2811}, 'weighted avg': {'precision': 0.8782157124746234, 'recall': 0.28424048381358946, 'f1-score': 0.37557213332521344, 'support': 2811}}, Dev loss: 3.4440293312072754, denoising continues.
2021-10-11 09:37:09,647 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:37:09,684 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:37:09,819 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 2422, samples in test set: 3312
2021-10-11 09:37:09,935 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5593, samples in test set: 141
2021-10-11 09:37:10,061 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4994, samples in test set: 740
2021-10-11 09:37:10,188 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4843, samples in test set: 891
2021-10-11 09:37:10,577 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5084, samples in test set: 650
5it [02:41, 32.26s/it]
2021-10-11 09:39:51,974 knodle.trainer.cleanlab.cleanlab INFO     [[0.01871257 0.98128743]
 [0.00590551 0.99409449]
 [0.12093023 0.87906977]
 [0.01485149 0.98514851]
 [0.96081923 0.03918077]
 [0.98798077 0.01201923]
 [0.96240602 0.03759398]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 09:39:52,081 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 5734
2021-10-11 09:39:52,082 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:39:52,083 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:39:52,083 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 133.23it/s]
2021-10-11 09:39:52,777 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 188.31it/s]
2021-10-11 09:39:53,329 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 193.38it/s]
2021-10-11 09:39:53,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 197.28it/s]
2021-10-11 09:39:54,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 195.09it/s]
2021-10-11 09:39:54,992 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 200.25it/s]
2021-10-11 09:39:55,546 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 201.76it/s]
2021-10-11 09:39:56,094 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327641408751334
100%|██████████| 22/22 [00:00<00:00, 199.80it/s]
2021-10-11 09:39:56,644 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 192.82it/s]
2021-10-11 09:39:57,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 199.40it/s]
2021-10-11 09:39:57,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 197.38it/s]
2021-10-11 09:39:58,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 204.66it/s]
2021-10-11 09:39:58,844 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 202.83it/s]
2021-10-11 09:39:59,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 194.38it/s]
2021-10-11 09:39:59,939 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 200.07it/s]
2021-10-11 09:40:00,495 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 186.79it/s]
2021-10-11 09:40:01,065 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 202.21it/s]
2021-10-11 09:40:01,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 200.63it/s]
2021-10-11 09:40:02,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 205.70it/s]
2021-10-11 09:40:02,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 200.79it/s]
2021-10-11 09:40:03,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 198.46it/s]
2021-10-11 09:40:03,781 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 206.66it/s]
2021-10-11 09:40:04,325 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 195.12it/s]
2021-10-11 09:40:04,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 193.89it/s]
2021-10-11 09:40:05,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 201.24it/s]
2021-10-11 09:40:05,955 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327641408751334
100%|██████████| 22/22 [00:00<00:00, 203.05it/s]
2021-10-11 09:40:06,496 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 193.80it/s]
2021-10-11 09:40:07,032 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 207.69it/s]
2021-10-11 09:40:07,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 196.62it/s]
2021-10-11 09:40:08,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 195.02it/s]
2021-10-11 09:40:08,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 197.48it/s]
2021-10-11 09:40:09,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 196.36it/s]
2021-10-11 09:40:09,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 202.45it/s]
2021-10-11 09:40:10,302 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 199.90it/s]
2021-10-11 09:40:10,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2191390964069726
100%|██████████| 22/22 [00:00<00:00, 210.11it/s]
2021-10-11 09:40:11,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 215.61it/s]
2021-10-11 09:40:11,974 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 192.33it/s]
2021-10-11 09:40:12,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 164.58it/s]
2021-10-11 09:40:13,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 202.54it/s]
2021-10-11 09:40:13,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 215.85it/s]
2021-10-11 09:40:14,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 204.99it/s]
2021-10-11 09:40:14,744 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 195.52it/s]
2021-10-11 09:40:15,293 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 192.72it/s]
2021-10-11 09:40:15,854 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 189.57it/s]
2021-10-11 09:40:16,406 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 197.38it/s]
2021-10-11 09:40:16,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 185.89it/s]
2021-10-11 09:40:17,505 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 198.73it/s]
2021-10-11 09:40:18,062 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 196.23it/s]
2021-10-11 09:40:18,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 195.03it/s]
2021-10-11 09:40:19,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 204.44it/s]
2021-10-11 09:40:19,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 192.88it/s]
2021-10-11 09:40:20,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 194.47it/s]
2021-10-11 09:40:20,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 196.16it/s]
2021-10-11 09:40:21,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 200.23it/s]
2021-10-11 09:40:21,900 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 190.51it/s]
2021-10-11 09:40:22,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 198.76it/s]
2021-10-11 09:40:23,004 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 196.30it/s]
2021-10-11 09:40:23,554 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 190.00it/s]
2021-10-11 09:40:24,111 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 191.51it/s]
2021-10-11 09:40:24,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 182.31it/s]
2021-10-11 09:40:25,223 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 201.98it/s]
2021-10-11 09:40:25,777 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 197.18it/s]
2021-10-11 09:40:26,324 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 193.14it/s]
2021-10-11 09:40:26,871 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 195.73it/s]
2021-10-11 09:40:27,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 193.12it/s]
2021-10-11 09:40:27,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 198.24it/s]
2021-10-11 09:40:28,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 186.92it/s]
2021-10-11 09:40:29,094 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33404482390608325
100%|██████████| 22/22 [00:00<00:00, 204.43it/s]
2021-10-11 09:40:29,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 213.03it/s]
2021-10-11 09:40:30,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 195.42it/s]
2021-10-11 09:40:30,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 197.75it/s]
2021-10-11 09:40:31,207 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 188.42it/s]
2021-10-11 09:40:31,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 194.97it/s]
2021-10-11 09:40:32,320 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 192.00it/s]
2021-10-11 09:40:32,871 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 191.30it/s]
2021-10-11 09:40:33,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 189.76it/s]
2021-10-11 09:40:33,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 193.12it/s]
2021-10-11 09:40:34,524 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 193.19it/s]
2021-10-11 09:40:35,074 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 187.16it/s]
2021-10-11 09:40:35,628 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 198.23it/s]
2021-10-11 09:40:36,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 208.14it/s]
2021-10-11 09:40:36,714 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 192.42it/s]
2021-10-11 09:40:37,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 192.90it/s]
2021-10-11 09:40:37,814 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 191.83it/s]
2021-10-11 09:40:38,368 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 199.01it/s]
2021-10-11 09:40:38,906 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 204.55it/s]
2021-10-11 09:40:39,448 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 202.08it/s]
2021-10-11 09:40:40,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33475631447883314
100%|██████████| 22/22 [00:00<00:00, 200.50it/s]
2021-10-11 09:40:40,552 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 198.21it/s]
2021-10-11 09:40:41,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 196.05it/s]
2021-10-11 09:40:41,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 196.68it/s]
2021-10-11 09:40:42,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 194.71it/s]
2021-10-11 09:40:42,749 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 193.73it/s]
2021-10-11 09:40:43,311 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 187.88it/s]
2021-10-11 09:40:43,869 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 200.97it/s]
2021-10-11 09:40:44,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 196.73it/s]
2021-10-11 09:40:44,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 186.19it/s]
2021-10-11 09:40:45,520 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 192.26it/s]
2021-10-11 09:40:46,069 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 193.32it/s]
2021-10-11 09:40:46,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 187.30it/s]
2021-10-11 09:40:47,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
2021-10-11 09:40:47,170 knodle.trainer.trainer INFO     Train avg loss: 0.13076187802023356
2021-10-11 09:40:47,170 knodle.trainer.trainer INFO     Train avg accuracy: 0.9417282472583983
2021-10-11 09:40:47,170 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:40:47,170 knodle.trainer.trainer INFO     Training done
2021-10-11 09:40:47,170 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 139.78it/s]
2021-10-11 09:40:47,334 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.522034168243408). Denoising stops.
2021-10-11 09:40:47,335 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 67.64it/s]
2021-10-11 09:40:47,668 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 09:40:47,669 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 09:40:47,669 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 09:40:48,421 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 09:40:48,446 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:40:48,863 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5140, samples in test set: 594
Accuracy is: 0.29359496482784153
Precision is: 0.5173721081048472
Recall is: 0.5425600505455446
F1 is: 0.2754877217607245
{'0': {'precision': 0.9457364341085271, 'recall': 0.24567055980668545, 'f1-score': 0.3900255754475703, 'support': 2483}, '1': {'precision': 0.08900778210116732, 'recall': 0.8394495412844036, 'f1-score': 0.16094986807387865, 'support': 218}, 'accuracy': 0.29359496482784153, 'macro avg': {'precision': 0.5173721081048472, 'recall': 0.5425600505455446, 'f1-score': 0.2754877217607245, 'support': 2701}, 'weighted avg': {'precision': 0.8765891382412171, 'recall': 0.29359496482784153, 'f1-score': 0.3715366808872353, 'support': 2701}}
2021-10-11 09:40:49,212 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4215, samples in test set: 1519
2021-10-11 09:40:49,665 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5069, samples in test set: 665
2021-10-11 09:40:50,028 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4693, samples in test set: 1041
2021-10-11 09:40:50,315 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3819, samples in test set: 1915
5it [02:25, 29.05s/it]
2021-10-11 09:43:15,660 knodle.trainer.cleanlab.cleanlab INFO     [[0.13580645 0.86419355]
 [0.04965753 0.95034247]
 [0.28558875 0.71441125]
 [0.08333333 0.91666667]
 [0.78656361 0.21343639]
 [0.96761453 0.03238547]
 [0.86425339 0.13574661]
 [0.1875     0.8125    ]
 [0.13513514 0.86486486]]
2021-10-11 09:43:15,753 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 202 out of 5734
2021-10-11 09:43:15,753 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:43:15,754 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:43:15,754 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 70.10it/s]
2021-10-11 09:43:16,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21451440768409819
100%|██████████| 22/22 [00:00<00:00, 211.29it/s]
2021-10-11 09:43:17,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2152258982568481
100%|██████████| 22/22 [00:00<00:00, 206.18it/s]
2021-10-11 09:43:17,841 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 200.51it/s]
2021-10-11 09:43:18,395 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 197.96it/s]
2021-10-11 09:43:18,947 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 197.45it/s]
2021-10-11 09:43:19,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2191390964069726
100%|██████████| 22/22 [00:00<00:00, 201.49it/s]
2021-10-11 09:43:20,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 207.89it/s]
2021-10-11 09:43:20,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 93.90it/s]
2021-10-11 09:43:21,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21629313411597295
100%|██████████| 22/22 [00:00<00:00, 203.33it/s]
2021-10-11 09:43:21,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 211.03it/s]
2021-10-11 09:43:22,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 189.47it/s]
2021-10-11 09:43:22,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 184.26it/s]
2021-10-11 09:43:23,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 196.63it/s]
2021-10-11 09:43:24,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23194592671647102
100%|██████████| 22/22 [00:00<00:00, 198.50it/s]
2021-10-11 09:43:24,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20597652081109924
100%|██████████| 22/22 [00:00<00:00, 189.89it/s]
2021-10-11 09:43:25,223 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 211.96it/s]
2021-10-11 09:43:25,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 214.44it/s]
2021-10-11 09:43:26,332 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 202.18it/s]
2021-10-11 09:43:26,877 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 204.32it/s]
2021-10-11 09:43:27,425 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
100%|██████████| 22/22 [00:00<00:00, 208.73it/s]
2021-10-11 09:43:27,982 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 202.84it/s]
2021-10-11 09:43:28,528 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 205.53it/s]
2021-10-11 09:43:29,065 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 207.91it/s]
2021-10-11 09:43:29,599 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 205.38it/s]
2021-10-11 09:43:30,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 195.53it/s]
2021-10-11 09:43:30,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 202.45it/s]
2021-10-11 09:43:31,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 203.50it/s]
2021-10-11 09:43:31,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 185.07it/s]
2021-10-11 09:43:32,373 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 197.75it/s]
2021-10-11 09:43:32,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 188.02it/s]
2021-10-11 09:43:33,519 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 164.72it/s]
2021-10-11 09:43:34,124 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23692636072572038
100%|██████████| 22/22 [00:00<00:00, 170.34it/s]
2021-10-11 09:43:34,724 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 194.70it/s]
2021-10-11 09:43:35,292 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 173.79it/s]
2021-10-11 09:43:35,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 197.00it/s]
2021-10-11 09:43:36,475 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 195.20it/s]
2021-10-11 09:43:37,034 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 201.40it/s]
2021-10-11 09:43:37,575 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 220.57it/s]
2021-10-11 09:43:38,094 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 215.61it/s]
2021-10-11 09:43:38,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2376378512984703
100%|██████████| 22/22 [00:00<00:00, 208.07it/s]
2021-10-11 09:43:39,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 171.11it/s]
2021-10-11 09:43:39,681 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 142.88it/s]
2021-10-11 09:43:40,354 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 198.74it/s]
2021-10-11 09:43:40,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 188.42it/s]
2021-10-11 09:43:41,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 171.77it/s]
2021-10-11 09:43:42,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 166.29it/s]
2021-10-11 09:43:42,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 207.48it/s]
2021-10-11 09:43:43,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22909996442547137
100%|██████████| 22/22 [00:00<00:00, 202.81it/s]
2021-10-11 09:43:43,931 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 188.37it/s]
2021-10-11 09:43:44,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 187.97it/s]
2021-10-11 09:43:45,067 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 183.76it/s]
2021-10-11 09:43:45,644 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 173.05it/s]
2021-10-11 09:43:46,218 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 172.71it/s]
2021-10-11 09:43:46,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 187.01it/s]
2021-10-11 09:43:47,431 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 205.59it/s]
2021-10-11 09:43:47,983 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 190.89it/s]
2021-10-11 09:43:48,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 195.25it/s]
2021-10-11 09:43:49,076 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 199.66it/s]
2021-10-11 09:43:49,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 187.38it/s]
2021-10-11 09:43:50,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 188.76it/s]
2021-10-11 09:43:50,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 209.58it/s]
2021-10-11 09:43:51,387 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 188.41it/s]
2021-10-11 09:43:51,930 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 206.63it/s]
2021-10-11 09:43:52,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 205.39it/s]
2021-10-11 09:43:53,014 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 220.87it/s]
2021-10-11 09:43:53,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 181.99it/s]
2021-10-11 09:43:54,067 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 171.97it/s]
2021-10-11 09:43:54,728 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 159.97it/s]
2021-10-11 09:43:55,376 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 153.44it/s]
2021-10-11 09:43:56,035 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 168.42it/s]
2021-10-11 09:43:56,677 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 187.58it/s]
2021-10-11 09:43:57,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 177.61it/s]
2021-10-11 09:43:57,933 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 173.86it/s]
2021-10-11 09:43:58,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 193.97it/s]
2021-10-11 09:43:59,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 203.73it/s]
2021-10-11 09:43:59,706 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 180.04it/s]
2021-10-11 09:44:00,292 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 171.68it/s]
2021-10-11 09:44:00,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 193.52it/s]
2021-10-11 09:44:01,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 174.89it/s]
2021-10-11 09:44:01,997 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 195.12it/s]
2021-10-11 09:44:02,584 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 211.28it/s]
2021-10-11 09:44:03,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 158.45it/s]
2021-10-11 09:44:03,771 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 161.47it/s]
2021-10-11 09:44:04,420 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 192.21it/s]
2021-10-11 09:44:05,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 184.92it/s]
2021-10-11 09:44:05,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 185.64it/s]
2021-10-11 09:44:06,218 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 193.05it/s]
2021-10-11 09:44:06,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 180.77it/s]
2021-10-11 09:44:07,426 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34969761650658127
100%|██████████| 22/22 [00:00<00:00, 210.52it/s]
2021-10-11 09:44:07,989 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 172.42it/s]
2021-10-11 09:44:08,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 186.96it/s]
2021-10-11 09:44:09,164 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 204.16it/s]
2021-10-11 09:44:09,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 190.95it/s]
2021-10-11 09:44:10,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 178.91it/s]
2021-10-11 09:44:10,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 154.25it/s]
2021-10-11 09:44:11,538 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 192.83it/s]
2021-10-11 09:44:12,216 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 189.60it/s]
2021-10-11 09:44:12,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 190.71it/s]
2021-10-11 09:44:13,315 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 188.77it/s]
2021-10-11 09:44:13,880 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
2021-10-11 09:44:13,882 knodle.trainer.trainer INFO     Train avg loss: 0.13359430978157452
2021-10-11 09:44:13,882 knodle.trainer.trainer INFO     Train avg accuracy: 0.9402700501150554
2021-10-11 09:44:13,882 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:44:13,882 knodle.trainer.trainer INFO     Training done
2021-10-11 09:44:13,882 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 123.30it/s]
2021-10-11 09:44:14,071 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9412587412587412, 'recall': 0.25677222434185426, 'f1-score': 0.40347721822541965, 'support': 2621}, '1': {'precision': 0.07061068702290077, 'recall': 0.7789473684210526, 'f1-score': 0.1294838145231846, 'support': 190}, 'accuracy': 0.29206688011383847, 'macro avg': {'precision': 0.505934714140821, 'recall': 0.5178597963814534, 'f1-score': 0.26648051637430215, 'support': 2811}, 'weighted avg': {'precision': 0.8824102423954151, 'recall': 0.29206688011383847, 'f1-score': 0.3849575644710886, 'support': 2811}}, Dev loss: 3.333207607269287, denoising continues.
2021-10-11 09:44:14,071 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:44:14,097 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:44:14,403 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5275, samples in test set: 459
2021-10-11 09:44:14,586 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3632, samples in test set: 2102
2021-10-11 09:44:15,026 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4819, samples in test set: 915
2021-10-11 09:44:15,455 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5046, samples in test set: 688
2021-10-11 09:44:15,784 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4164, samples in test set: 1570
5it [02:40, 32.03s/it]
2021-10-11 09:46:56,088 knodle.trainer.cleanlab.cleanlab INFO     [[0.0240458  0.9759542 ]
 [0.00797267 0.99202733]
 [0.09607438 0.90392562]
 [0.03038674 0.96961326]
 [0.94982394 0.05017606]
 [0.95657277 0.04342723]
 [0.99386503 0.00613497]
 [0.02631579 0.97368421]
 [0.01923077 0.98076923]]
2021-10-11 09:46:56,191 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 31 out of 5734
2021-10-11 09:46:56,191 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:46:56,191 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:46:56,191 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 69.14it/s]
2021-10-11 09:46:57,268 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 176.16it/s]
2021-10-11 09:46:57,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 173.56it/s]
2021-10-11 09:46:58,521 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 195.93it/s]
2021-10-11 09:46:59,140 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 168.50it/s]
2021-10-11 09:46:59,699 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 161.68it/s]
2021-10-11 09:47:00,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 165.76it/s]
2021-10-11 09:47:00,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 158.13it/s]
2021-10-11 09:47:01,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 200.65it/s]
2021-10-11 09:47:02,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 186.69it/s]
2021-10-11 09:47:02,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 165.14it/s]
2021-10-11 09:47:03,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 158.42it/s]
2021-10-11 09:47:04,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 180.76it/s]
2021-10-11 09:47:05,195 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 184.50it/s]
2021-10-11 09:47:05,834 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 174.41it/s]
2021-10-11 09:47:06,455 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 178.66it/s]
2021-10-11 09:47:07,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 197.56it/s]
2021-10-11 09:47:07,654 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 208.58it/s]
2021-10-11 09:47:08,247 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 201.67it/s]
2021-10-11 09:47:08,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 181.02it/s]
2021-10-11 09:47:09,388 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 190.28it/s]
2021-10-11 09:47:09,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 180.86it/s]
2021-10-11 09:47:10,468 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 110.28it/s]
2021-10-11 09:47:11,363 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 181.77it/s]
2021-10-11 09:47:11,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 162.38it/s]
2021-10-11 09:47:12,580 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 183.27it/s]
2021-10-11 09:47:13,243 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 210.64it/s]
2021-10-11 09:47:13,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 202.27it/s]
2021-10-11 09:47:14,334 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 87.89it/s]
2021-10-11 09:47:15,053 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 192.84it/s]
2021-10-11 09:47:15,617 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 158.23it/s]
2021-10-11 09:47:16,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 209.27it/s]
2021-10-11 09:47:17,038 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 172.00it/s]
2021-10-11 09:47:17,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 152.95it/s]
2021-10-11 09:47:18,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 163.76it/s]
2021-10-11 09:47:19,021 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 188.10it/s]
2021-10-11 09:47:19,624 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 186.38it/s]
2021-10-11 09:47:20,193 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 169.83it/s]
2021-10-11 09:47:20,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 84.40it/s]
2021-10-11 09:47:21,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 158.79it/s]
2021-10-11 09:47:22,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 153.98it/s]
2021-10-11 09:47:23,217 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 191.06it/s]
2021-10-11 09:47:23,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 207.47it/s]
2021-10-11 09:47:24,413 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 203.67it/s]
2021-10-11 09:47:24,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 173.96it/s]
2021-10-11 09:47:25,548 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 127.28it/s]
2021-10-11 09:47:26,459 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 178.28it/s]
2021-10-11 09:47:27,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 183.65it/s]
2021-10-11 09:47:27,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 135.74it/s]
2021-10-11 09:47:28,354 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 179.40it/s]
2021-10-11 09:47:29,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 186.79it/s]
2021-10-11 09:47:29,650 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 183.85it/s]
2021-10-11 09:47:30,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 161.78it/s]
2021-10-11 09:47:30,904 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 158.31it/s]
2021-10-11 09:47:31,527 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 164.92it/s]
2021-10-11 09:47:32,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 175.80it/s]
2021-10-11 09:47:32,833 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 143.07it/s]
2021-10-11 09:47:33,519 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 146.90it/s]
2021-10-11 09:47:34,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 151.74it/s]
2021-10-11 09:47:34,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 162.64it/s]
2021-10-11 09:47:35,562 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 135.56it/s]
2021-10-11 09:47:36,254 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 173.61it/s]
2021-10-11 09:47:36,891 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 182.20it/s]
2021-10-11 09:47:37,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 170.38it/s]
2021-10-11 09:47:38,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 193.93it/s]
2021-10-11 09:47:38,682 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 165.46it/s]
2021-10-11 09:47:39,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 173.81it/s]
2021-10-11 09:47:39,940 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 179.43it/s]
2021-10-11 09:47:40,512 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 167.25it/s]
2021-10-11 09:47:41,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 179.87it/s]
2021-10-11 09:47:41,740 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 143.34it/s]
2021-10-11 09:47:42,386 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 173.42it/s]
2021-10-11 09:47:43,063 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 191.57it/s]
2021-10-11 09:47:43,709 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 176.96it/s]
2021-10-11 09:47:44,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 177.86it/s]
2021-10-11 09:47:44,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 175.55it/s]
2021-10-11 09:47:45,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 163.86it/s]
2021-10-11 09:47:46,239 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 163.05it/s]
2021-10-11 09:47:46,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 174.46it/s]
2021-10-11 09:47:47,526 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 187.99it/s]
2021-10-11 09:47:48,094 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 200.14it/s]
2021-10-11 09:47:48,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 185.68it/s]
2021-10-11 09:47:49,230 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 171.46it/s]
2021-10-11 09:47:49,866 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 174.22it/s]
2021-10-11 09:47:50,459 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 181.33it/s]
2021-10-11 09:47:51,074 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 167.99it/s]
2021-10-11 09:47:51,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 178.86it/s]
2021-10-11 09:47:52,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 183.70it/s]
2021-10-11 09:47:52,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 163.35it/s]
2021-10-11 09:47:53,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 159.54it/s]
2021-10-11 09:47:54,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 158.31it/s]
2021-10-11 09:47:55,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 188.88it/s]
2021-10-11 09:47:55,739 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 166.73it/s]
2021-10-11 09:47:56,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 153.00it/s]
2021-10-11 09:47:57,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 170.41it/s]
2021-10-11 09:47:57,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 115.19it/s]
2021-10-11 09:47:58,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 138.39it/s]
2021-10-11 09:47:59,214 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 145.57it/s]
2021-10-11 09:47:59,900 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 147.15it/s]
2021-10-11 09:48:00,562 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 174.51it/s]
2021-10-11 09:48:01,198 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
2021-10-11 09:48:01,200 knodle.trainer.trainer INFO     Train avg loss: 0.13410648573583198
2021-10-11 09:48:01,200 knodle.trainer.trainer INFO     Train avg accuracy: 0.9402673267788352
2021-10-11 09:48:01,200 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:48:01,200 knodle.trainer.trainer INFO     Training done
2021-10-11 09:48:01,200 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 114.79it/s]
2021-10-11 09:48:01,407 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.100447654724121). Denoising stops.
2021-10-11 09:48:01,407 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 61.41it/s]
2021-10-11 09:48:01,774 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 09:48:01,774 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 09:48:01,774 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.332469455757127
Precision is: 0.5195368637978253
Recall is: 0.5532427848821527
F1 is: 0.30446222790470284
{'0': {'precision': 0.9473684210526315, 'recall': 0.2899718082964156, 'f1-score': 0.4440333024976873, 'support': 2483}, '1': {'precision': 0.09170530654301906, 'recall': 0.8165137614678899, 'f1-score': 0.16489115331171836, 'support': 218}, 'accuracy': 0.332469455757127, 'macro avg': {'precision': 0.5195368637978253, 'recall': 0.5532427848821527, 'f1-score': 0.30446222790470284, 'support': 2701}, 'weighted avg': {'precision': 0.8783071256201638, 'recall': 0.332469455757127, 'f1-score': 0.42150350297064504, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 09:48:03,544 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 09:48:03,589 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:48:03,931 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3401, samples in test set: 2333
2021-10-11 09:48:04,307 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3937, samples in test set: 1797
2021-10-11 09:48:04,856 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5623, samples in test set: 111
2021-10-11 09:48:05,207 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5371, samples in test set: 363
2021-10-11 09:48:05,700 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4604, samples in test set: 1130
5it [02:42, 32.43s/it]
2021-10-11 09:50:48,045 knodle.trainer.cleanlab.cleanlab INFO     [[0.1820345  0.8179655 ]
 [0.04746318 0.95253682]
 [0.15384615 0.84615385]
 [0.1627907  0.8372093 ]
 [0.85665991 0.14334009]
 [0.9180791  0.0819209 ]
 [0.72432432 0.27567568]
 [0.         1.        ]
 [0.01612903 0.98387097]]
2021-10-11 09:50:48,268 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 215 out of 5734
2021-10-11 09:50:48,269 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:50:48,269 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:50:48,269 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 62.53it/s]
2021-10-11 09:50:49,475 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 149.58it/s]
2021-10-11 09:50:50,187 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19779437922447526
100%|██████████| 22/22 [00:00<00:00, 180.61it/s]
2021-10-11 09:50:50,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 185.24it/s]
2021-10-11 09:50:51,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 195.04it/s]
2021-10-11 09:50:52,031 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 157.75it/s]
2021-10-11 09:50:52,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 146.48it/s]
2021-10-11 09:50:53,411 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 182.39it/s]
2021-10-11 09:50:54,060 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23301316257559587
100%|██████████| 22/22 [00:00<00:00, 196.24it/s]
2021-10-11 09:50:54,636 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 149.59it/s]
2021-10-11 09:50:55,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 171.65it/s]
2021-10-11 09:50:55,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 92.15it/s]
2021-10-11 09:50:56,878 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 163.39it/s]
2021-10-11 09:50:57,544 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 130.86it/s]
2021-10-11 09:50:58,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 168.17it/s]
2021-10-11 09:50:59,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 165.79it/s]
2021-10-11 09:50:59,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.215937388829598
100%|██████████| 22/22 [00:00<00:00, 144.73it/s]
2021-10-11 09:51:00,427 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 180.48it/s]
2021-10-11 09:51:01,097 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2280327285663465
100%|██████████| 22/22 [00:00<00:00, 160.16it/s]
2021-10-11 09:51:01,789 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 169.47it/s]
2021-10-11 09:51:02,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 169.15it/s]
2021-10-11 09:51:03,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 189.44it/s]
2021-10-11 09:51:03,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 170.15it/s]
2021-10-11 09:51:04,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23265741728922093
100%|██████████| 22/22 [00:00<00:00, 158.77it/s]
2021-10-11 09:51:05,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 176.41it/s]
2021-10-11 09:51:05,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 159.18it/s]
2021-10-11 09:51:06,322 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 129.89it/s]
2021-10-11 09:51:07,117 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23230167200284596
100%|██████████| 22/22 [00:00<00:00, 145.91it/s]
2021-10-11 09:51:07,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 145.86it/s]
2021-10-11 09:51:08,749 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 108.51it/s]
2021-10-11 09:51:09,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 161.92it/s]
2021-10-11 09:51:10,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 186.95it/s]
2021-10-11 09:51:10,940 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 188.50it/s]
2021-10-11 09:51:11,537 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 178.45it/s]
2021-10-11 09:51:12,155 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 199.71it/s]
2021-10-11 09:51:12,748 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 174.92it/s]
2021-10-11 09:51:13,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 182.24it/s]
2021-10-11 09:51:13,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 183.87it/s]
2021-10-11 09:51:14,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 187.54it/s]
2021-10-11 09:51:15,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 192.29it/s]
2021-10-11 09:51:15,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 175.15it/s]
2021-10-11 09:51:16,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 182.45it/s]
2021-10-11 09:51:17,049 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 193.70it/s]
2021-10-11 09:51:17,631 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2280327285663465
100%|██████████| 22/22 [00:00<00:00, 151.05it/s]
2021-10-11 09:51:18,279 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2351476342938456
100%|██████████| 22/22 [00:00<00:00, 186.82it/s]
2021-10-11 09:51:18,909 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 169.64it/s]
2021-10-11 09:51:19,512 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 166.22it/s]
2021-10-11 09:51:20,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 164.78it/s]
2021-10-11 09:51:20,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 147.54it/s]
2021-10-11 09:51:21,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 186.66it/s]
2021-10-11 09:51:22,190 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 200.41it/s]
2021-10-11 09:51:22,759 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 184.21it/s]
2021-10-11 09:51:23,339 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 200.86it/s]
2021-10-11 09:51:23,896 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 200.39it/s]
2021-10-11 09:51:24,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 184.73it/s]
2021-10-11 09:51:25,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 208.49it/s]
2021-10-11 09:51:25,567 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23728210601209535
100%|██████████| 22/22 [00:00<00:00, 205.25it/s]
2021-10-11 09:51:26,092 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 221.61it/s]
2021-10-11 09:51:26,593 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 196.69it/s]
2021-10-11 09:51:27,118 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 217.92it/s]
2021-10-11 09:51:27,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 186.18it/s]
2021-10-11 09:51:28,156 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 190.88it/s]
2021-10-11 09:51:28,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 183.31it/s]
2021-10-11 09:51:29,364 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 140.31it/s]
2021-10-11 09:51:30,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 181.58it/s]
2021-10-11 09:51:30,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 185.25it/s]
2021-10-11 09:51:31,255 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 183.13it/s]
2021-10-11 09:51:31,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 168.16it/s]
2021-10-11 09:51:32,437 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 181.78it/s]
2021-10-11 09:51:33,046 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 199.60it/s]
2021-10-11 09:51:33,650 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 191.32it/s]
2021-10-11 09:51:34,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22732123799359658
100%|██████████| 22/22 [00:00<00:00, 199.04it/s]
2021-10-11 09:51:34,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 197.45it/s]
2021-10-11 09:51:35,345 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 187.48it/s]
2021-10-11 09:51:35,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 187.64it/s]
2021-10-11 09:51:36,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 174.03it/s]
2021-10-11 09:51:37,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 178.51it/s]
2021-10-11 09:51:37,701 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23692636072572038
100%|██████████| 22/22 [00:00<00:00, 156.64it/s]
2021-10-11 09:51:38,326 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 219.54it/s]
2021-10-11 09:51:38,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 204.11it/s]
2021-10-11 09:51:39,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 230.28it/s]
2021-10-11 09:51:39,956 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 192.85it/s]
2021-10-11 09:51:40,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 212.90it/s]
2021-10-11 09:51:41,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 193.59it/s]
2021-10-11 09:51:41,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 205.62it/s]
2021-10-11 09:51:42,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 239.80it/s]
2021-10-11 09:51:42,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 212.14it/s]
2021-10-11 09:51:43,136 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 225.25it/s]
2021-10-11 09:51:43,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 223.76it/s]
2021-10-11 09:51:44,181 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33404482390608325
100%|██████████| 22/22 [00:00<00:00, 216.80it/s]
2021-10-11 09:51:44,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 186.84it/s]
2021-10-11 09:51:45,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 176.61it/s]
2021-10-11 09:51:45,848 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 190.51it/s]
2021-10-11 09:51:46,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 184.63it/s]
2021-10-11 09:51:46,988 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 198.44it/s]
2021-10-11 09:51:47,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 183.83it/s]
2021-10-11 09:51:48,125 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37353255069370334
100%|██████████| 22/22 [00:00<00:00, 193.35it/s]
2021-10-11 09:51:48,721 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 194.63it/s]
2021-10-11 09:51:49,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 201.56it/s]
2021-10-11 09:51:49,848 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 202.49it/s]
2021-10-11 09:51:50,394 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
2021-10-11 09:51:50,396 knodle.trainer.trainer INFO     Train avg loss: 0.13295431054631865
2021-10-11 09:51:50,396 knodle.trainer.trainer INFO     Train avg accuracy: 0.9402263069550197
2021-10-11 09:51:50,396 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:51:50,396 knodle.trainer.trainer INFO     Training done
2021-10-11 09:51:50,396 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 130.63it/s]
2021-10-11 09:51:50,576 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9321382842509603, 'recall': 0.27775658145745896, 'f1-score': 0.4279835390946502, 'support': 2621}, '1': {'precision': 0.06748768472906404, 'recall': 0.7210526315789474, 'f1-score': 0.12342342342342341, 'support': 190}, 'accuracy': 0.30771967271433653, 'macro avg': {'precision': 0.4998129844900122, 'recall': 0.4994046065182032, 'f1-score': 0.2757034812590368, 'support': 2811}, 'weighted avg': {'precision': 0.8736951629741334, 'recall': 0.3077196727143365, 'f1-score': 0.4073978322367587, 'support': 2811}}, Dev loss: 3.183755397796631, denoising continues.
2021-10-11 09:51:50,576 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:51:50,605 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:51:51,543 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5363, samples in test set: 371
2021-10-11 09:51:51,901 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3650, samples in test set: 2084
2021-10-11 09:51:52,397 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3504, samples in test set: 2230
2021-10-11 09:51:52,711 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4820, samples in test set: 914
2021-10-11 09:51:53,039 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5599, samples in test set: 135
5it [02:46, 33.27s/it]
2021-10-11 09:54:39,477 knodle.trainer.cleanlab.cleanlab INFO     [[0.06158833 0.93841167]
 [0.00326797 0.99673203]
 [0.13341969 0.86658031]
 [0.08181818 0.91818182]
 [0.99155909 0.00844091]
 [1.         0.        ]
 [0.93406593 0.06593407]
 [0.05263158 0.94736842]
 [0.03571429 0.96428571]]
2021-10-11 09:54:39,596 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 17 out of 5734
2021-10-11 09:54:39,597 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:54:39,598 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:54:39,598 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 75.56it/s]
2021-10-11 09:54:40,616 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 198.33it/s]
2021-10-11 09:54:41,195 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 206.33it/s]
2021-10-11 09:54:41,730 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 192.45it/s]
2021-10-11 09:54:42,273 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 179.14it/s]
2021-10-11 09:54:42,872 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 190.95it/s]
2021-10-11 09:54:43,403 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 200.04it/s]
2021-10-11 09:54:43,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 218.51it/s]
2021-10-11 09:54:44,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 105.88it/s]
2021-10-11 09:54:45,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3319103521878335
100%|██████████| 22/22 [00:00<00:00, 213.45it/s]
2021-10-11 09:54:45,631 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 208.16it/s]
2021-10-11 09:54:46,197 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 188.42it/s]
2021-10-11 09:54:46,779 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 163.79it/s]
2021-10-11 09:54:47,376 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 106.60it/s]
2021-10-11 09:54:48,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 110.99it/s]
2021-10-11 09:54:48,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 194.67it/s]
2021-10-11 09:54:49,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37886872998932764
100%|██████████| 22/22 [00:00<00:00, 201.01it/s]
2021-10-11 09:54:50,136 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 161.74it/s]
2021-10-11 09:54:50,768 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 192.19it/s]
2021-10-11 09:54:51,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 184.18it/s]
2021-10-11 09:54:51,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 206.41it/s]
2021-10-11 09:54:52,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 170.64it/s]
2021-10-11 09:54:53,046 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 173.14it/s]
2021-10-11 09:54:53,590 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 187.58it/s]
2021-10-11 09:54:54,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 182.78it/s]
2021-10-11 09:54:54,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 126.60it/s]
2021-10-11 09:54:55,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 181.30it/s]
2021-10-11 09:54:56,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327641408751334
100%|██████████| 22/22 [00:00<00:00, 209.71it/s]
2021-10-11 09:54:56,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 217.86it/s]
2021-10-11 09:54:57,049 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 224.89it/s]
2021-10-11 09:54:57,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 171.23it/s]
2021-10-11 09:54:58,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 184.09it/s]
2021-10-11 09:54:58,740 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 224.39it/s]
2021-10-11 09:54:59,275 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 230.85it/s]
2021-10-11 09:54:59,754 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 199.12it/s]
2021-10-11 09:55:00,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 187.21it/s]
2021-10-11 09:55:00,940 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 143.81it/s]
2021-10-11 09:55:01,644 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 205.82it/s]
2021-10-11 09:55:02,209 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 177.01it/s]
2021-10-11 09:55:02,796 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 183.06it/s]
2021-10-11 09:55:03,396 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 179.75it/s]
2021-10-11 09:55:04,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 185.04it/s]
2021-10-11 09:55:04,614 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 195.71it/s]
2021-10-11 09:55:05,196 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 208.90it/s]
2021-10-11 09:55:05,735 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 194.83it/s]
2021-10-11 09:55:06,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 203.60it/s]
2021-10-11 09:55:06,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 188.77it/s]
2021-10-11 09:55:07,369 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35645677694770544
100%|██████████| 22/22 [00:00<00:00, 164.21it/s]
2021-10-11 09:55:08,028 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 145.14it/s]
2021-10-11 09:55:08,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 151.25it/s]
2021-10-11 09:55:09,470 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 197.75it/s]
2021-10-11 09:55:10,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35432230522945574
100%|██████████| 22/22 [00:00<00:00, 174.10it/s]
2021-10-11 09:55:10,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34756314478833156
100%|██████████| 22/22 [00:00<00:00, 201.68it/s]
2021-10-11 09:55:11,196 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 182.76it/s]
2021-10-11 09:55:11,804 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 166.35it/s]
2021-10-11 09:55:12,381 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 176.46it/s]
2021-10-11 09:55:12,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 197.47it/s]
2021-10-11 09:55:13,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 207.18it/s]
2021-10-11 09:55:14,126 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 169.63it/s]
2021-10-11 09:55:14,735 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 186.68it/s]
2021-10-11 09:55:15,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 188.14it/s]
2021-10-11 09:55:15,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 220.24it/s]
2021-10-11 09:55:16,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 173.35it/s]
2021-10-11 09:55:17,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 200.72it/s]
2021-10-11 09:55:17,739 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 158.55it/s]
2021-10-11 09:55:18,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 139.77it/s]
2021-10-11 09:55:18,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3489861259338314
100%|██████████| 22/22 [00:00<00:00, 160.90it/s]
2021-10-11 09:55:19,552 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 149.13it/s]
2021-10-11 09:55:20,382 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 170.92it/s]
2021-10-11 09:55:21,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 195.10it/s]
2021-10-11 09:55:21,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 174.46it/s]
2021-10-11 09:55:22,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34827463536108144
100%|██████████| 22/22 [00:00<00:00, 174.20it/s]
2021-10-11 09:55:23,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 169.08it/s]
2021-10-11 09:55:23,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 210.01it/s]
2021-10-11 09:55:24,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 153.83it/s]
2021-10-11 09:55:24,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 169.11it/s]
2021-10-11 09:55:25,457 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 192.49it/s]
2021-10-11 09:55:26,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 176.70it/s]
2021-10-11 09:55:26,595 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 186.78it/s]
2021-10-11 09:55:27,164 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 192.13it/s]
2021-10-11 09:55:27,734 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 157.16it/s]
2021-10-11 09:55:28,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 113.14it/s]
2021-10-11 09:55:29,232 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 143.39it/s]
2021-10-11 09:55:29,960 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33724653148345785
100%|██████████| 22/22 [00:00<00:00, 174.97it/s]
2021-10-11 09:55:30,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 126.06it/s]
2021-10-11 09:55:31,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 222.13it/s]
2021-10-11 09:55:31,739 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 169.80it/s]
2021-10-11 09:55:32,299 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36036997509783
100%|██████████| 22/22 [00:00<00:00, 187.33it/s]
2021-10-11 09:55:32,906 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 188.55it/s]
2021-10-11 09:55:33,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 208.38it/s]
2021-10-11 09:55:34,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 194.69it/s]
2021-10-11 09:55:34,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35432230522945574
100%|██████████| 22/22 [00:00<00:00, 180.55it/s]
2021-10-11 09:55:35,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 124.29it/s]
2021-10-11 09:55:35,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 146.61it/s]
2021-10-11 09:55:36,699 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 187.39it/s]
2021-10-11 09:55:37,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 160.86it/s]
2021-10-11 09:55:37,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 203.36it/s]
2021-10-11 09:55:38,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 206.16it/s]
2021-10-11 09:55:39,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 194.42it/s]
2021-10-11 09:55:39,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 189.56it/s]
2021-10-11 09:55:40,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
2021-10-11 09:55:40,288 knodle.trainer.trainer INFO     Train avg loss: 0.1263259709734056
2021-10-11 09:55:40,288 knodle.trainer.trainer INFO     Train avg accuracy: 0.9432100692192713
2021-10-11 09:55:40,288 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:55:40,288 knodle.trainer.trainer INFO     Training done
2021-10-11 09:55:40,288 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 129.99it/s]
2021-10-11 09:55:40,469 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.195283889770508). Denoising stops.
2021-10-11 09:55:40,469 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 65.26it/s]
2021-10-11 09:55:40,815 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 09:55:40,815 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 09:55:40,815 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.33469085523880043
Precision is: 0.5198851714669311
Recall is: 0.5544510007500545
F1 is: 0.30612870700720807
{'0': {'precision': 0.9477806788511749, 'recall': 0.2923882400322191, 'f1-score': 0.4469067405355494, 'support': 2483}, '1': {'precision': 0.09198966408268734, 'recall': 0.8165137614678899, 'f1-score': 0.1653506734788667, 'support': 218}, 'accuracy': 0.33469085523880043, 'macro avg': {'precision': 0.5198851714669311, 'recall': 0.5544510007500545, 'f1-score': 0.30612870700720807, 'support': 2701}, 'weighted avg': {'precision': 0.8787090604803751, 'recall': 0.33469085523880043, 'f1-score': 0.42418211165055986, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 09:55:41,805 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 09:55:41,831 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:55:42,470 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4963, samples in test set: 771
2021-10-11 09:55:42,872 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3999, samples in test set: 1735
2021-10-11 09:55:43,289 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4807, samples in test set: 927
2021-10-11 09:55:43,699 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3703, samples in test set: 2031
2021-10-11 09:55:44,092 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5464, samples in test set: 270
5it [02:29, 29.82s/it]
2021-10-11 09:58:13,322 knodle.trainer.cleanlab.cleanlab INFO     [[0.21595634 0.78404366]
 [0.05428135 0.94571865]
 [0.13036304 0.86963696]
 [0.28368794 0.71631206]
 [0.80429371 0.19570629]
 [0.86620926 0.13379074]
 [0.70652174 0.29347826]
 [0.10416667 0.89583333]
 [0.09722222 0.90277778]]
2021-10-11 09:58:13,469 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 212 out of 5734
2021-10-11 09:58:13,469 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:58:13,469 knodle.trainer.trainer INFO     Training starts
2021-10-11 09:58:13,469 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 74.04it/s]
2021-10-11 09:58:14,494 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 175.78it/s]
2021-10-11 09:58:15,171 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22589825684809675
100%|██████████| 22/22 [00:00<00:00, 174.26it/s]
2021-10-11 09:58:15,774 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2056207755247243
100%|██████████| 22/22 [00:00<00:00, 179.19it/s]
2021-10-11 09:58:16,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22127356812522234
100%|██████████| 22/22 [00:00<00:00, 176.16it/s]
2021-10-11 09:58:17,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 191.45it/s]
2021-10-11 09:58:17,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 176.60it/s]
2021-10-11 09:58:18,248 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 162.89it/s]
2021-10-11 09:58:18,872 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22909996442547137
100%|██████████| 22/22 [00:00<00:00, 184.57it/s]
2021-10-11 09:58:19,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 187.55it/s]
2021-10-11 09:58:20,079 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 177.05it/s]
2021-10-11 09:58:20,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23372465314834578
100%|██████████| 22/22 [00:00<00:00, 161.41it/s]
2021-10-11 09:58:21,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 154.66it/s]
2021-10-11 09:58:22,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 112.45it/s]
2021-10-11 09:58:22,786 knodle.trainer.trainer INFO     Epoch development accuracy: 0.18356456776947705
100%|██████████| 22/22 [00:00<00:00, 158.20it/s]
2021-10-11 09:58:23,554 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 191.16it/s]
2021-10-11 09:58:24,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21558164354322304
100%|██████████| 22/22 [00:00<00:00, 201.39it/s]
2021-10-11 09:58:24,704 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 186.79it/s]
2021-10-11 09:58:25,277 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 199.43it/s]
2021-10-11 09:58:25,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 183.99it/s]
2021-10-11 09:58:26,427 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 189.18it/s]
2021-10-11 09:58:27,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 187.62it/s]
2021-10-11 09:58:27,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 189.65it/s]
2021-10-11 09:58:28,172 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23301316257559587
100%|██████████| 22/22 [00:00<00:00, 188.78it/s]
2021-10-11 09:58:28,758 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 160.35it/s]
2021-10-11 09:58:29,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 178.89it/s]
2021-10-11 09:58:29,991 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 146.89it/s]
2021-10-11 09:58:30,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 143.48it/s]
2021-10-11 09:58:31,457 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 75.84it/s]
2021-10-11 09:58:32,291 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 168.65it/s]
2021-10-11 09:58:33,014 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 186.55it/s]
2021-10-11 09:58:33,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 175.01it/s]
2021-10-11 09:58:34,323 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 180.68it/s]
2021-10-11 09:58:34,973 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 166.92it/s]
2021-10-11 09:58:35,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 184.07it/s]
2021-10-11 09:58:36,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2504446816079687
100%|██████████| 22/22 [00:00<00:00, 178.78it/s]
2021-10-11 09:58:36,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 162.61it/s]
2021-10-11 09:58:37,450 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 165.62it/s]
2021-10-11 09:58:38,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 152.96it/s]
2021-10-11 09:58:39,284 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 169.07it/s]
2021-10-11 09:58:39,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 161.79it/s]
2021-10-11 09:58:40,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2209178228388474
100%|██████████| 22/22 [00:00<00:00, 169.71it/s]
2021-10-11 09:58:41,219 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 175.33it/s]
2021-10-11 09:58:41,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2287442191390964
100%|██████████| 22/22 [00:00<00:00, 164.23it/s]
2021-10-11 09:58:42,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 154.14it/s]
2021-10-11 09:58:43,076 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 163.19it/s]
2021-10-11 09:58:43,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 180.42it/s]
2021-10-11 09:58:44,407 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 184.66it/s]
2021-10-11 09:58:45,019 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 198.88it/s]
2021-10-11 09:58:45,605 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34756314478833156
100%|██████████| 22/22 [00:00<00:00, 167.23it/s]
2021-10-11 09:58:46,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 173.68it/s]
2021-10-11 09:58:46,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 155.09it/s]
2021-10-11 09:58:47,521 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 166.29it/s]
2021-10-11 09:58:48,187 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 179.91it/s]
2021-10-11 09:58:48,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 175.86it/s]
2021-10-11 09:58:49,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 185.05it/s]
2021-10-11 09:58:50,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 192.74it/s]
2021-10-11 09:58:50,673 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 168.84it/s]
2021-10-11 09:58:51,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 188.31it/s]
2021-10-11 09:58:52,113 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 186.15it/s]
2021-10-11 09:58:52,721 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 164.68it/s]
2021-10-11 09:58:53,376 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 194.58it/s]
2021-10-11 09:58:53,954 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 138.12it/s]
2021-10-11 09:58:54,611 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 188.47it/s]
2021-10-11 09:58:55,278 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 125.39it/s]
2021-10-11 09:58:55,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 132.75it/s]
2021-10-11 09:58:56,856 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 132.52it/s]
2021-10-11 09:58:57,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 174.65it/s]
2021-10-11 09:58:58,515 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23159018143009605
100%|██████████| 22/22 [00:00<00:00, 172.55it/s]
2021-10-11 09:58:59,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 158.00it/s]
2021-10-11 09:58:59,835 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 188.04it/s]
2021-10-11 09:59:00,409 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 201.42it/s]
2021-10-11 09:59:01,014 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 174.56it/s]
2021-10-11 09:59:01,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 198.41it/s]
2021-10-11 09:59:02,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 139.09it/s]
2021-10-11 09:59:02,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 150.43it/s]
2021-10-11 09:59:03,478 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 170.17it/s]
2021-10-11 09:59:04,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 177.77it/s]
2021-10-11 09:59:04,723 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20384204909284953
100%|██████████| 22/22 [00:00<00:00, 169.24it/s]
2021-10-11 09:59:05,361 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 185.37it/s]
2021-10-11 09:59:05,955 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 174.02it/s]
2021-10-11 09:59:06,530 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 194.58it/s]
2021-10-11 09:59:07,136 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 203.27it/s]
2021-10-11 09:59:07,709 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 124.61it/s]
2021-10-11 09:59:08,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 142.45it/s]
2021-10-11 09:59:09,311 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 185.88it/s]
2021-10-11 09:59:09,908 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 168.50it/s]
2021-10-11 09:59:10,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 174.42it/s]
2021-10-11 09:59:11,491 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 163.54it/s]
2021-10-11 09:59:12,127 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 170.82it/s]
2021-10-11 09:59:12,953 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 139.25it/s]
2021-10-11 09:59:13,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 174.35it/s]
2021-10-11 09:59:14,369 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 166.15it/s]
2021-10-11 09:59:15,024 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22376378512984704
100%|██████████| 22/22 [00:00<00:00, 226.53it/s]
2021-10-11 09:59:15,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 193.12it/s]
2021-10-11 09:59:16,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 218.54it/s]
2021-10-11 09:59:16,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 178.68it/s]
2021-10-11 09:59:17,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 200.16it/s]
2021-10-11 09:59:17,856 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 195.09it/s]
2021-10-11 09:59:18,425 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 168.42it/s]
2021-10-11 09:59:18,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
2021-10-11 09:59:18,966 knodle.trainer.trainer INFO     Train avg loss: 0.16097435335732174
2021-10-11 09:59:18,966 knodle.trainer.trainer INFO     Train avg accuracy: 0.9278073595099978
2021-10-11 09:59:18,966 knodle.trainer.trainer INFO     ======================================
2021-10-11 09:59:18,966 knodle.trainer.trainer INFO     Training done
2021-10-11 09:59:18,966 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 135.04it/s]
2021-10-11 09:59:19,139 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9416873449131513, 'recall': 0.2895841281953453, 'f1-score': 0.4429530201342282, 'support': 2621}, '1': {'precision': 0.0713216957605985, 'recall': 0.7526315789473684, 'f1-score': 0.13029612756264236, 'support': 190}, 'accuracy': 0.3208822483102099, 'macro avg': {'precision': 0.5065045203368749, 'recall': 0.5211078535713569, 'f1-score': 0.2866245738484353, 'support': 2811}, 'weighted avg': {'precision': 0.8828579342624986, 'recall': 0.3208822483102099, 'f1-score': 0.4218200391350816, 'support': 2811}}, Dev loss: 3.0881166458129883, denoising continues.
2021-10-11 09:59:19,139 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 09:59:19,170 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 09:59:19,437 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5380, samples in test set: 354
2021-10-11 09:59:20,114 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4664, samples in test set: 1070
2021-10-11 09:59:20,509 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 2523, samples in test set: 3211
2021-10-11 09:59:20,684 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5110, samples in test set: 624
2021-10-11 09:59:20,990 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5259, samples in test set: 475
5it [03:07, 37.53s/it]
2021-10-11 10:02:28,721 knodle.trainer.cleanlab.cleanlab INFO     [[6.77966102e-02 9.32203390e-01]
 [9.12408759e-04 9.99087591e-01]
 [5.92672414e-02 9.40732759e-01]
 [8.10810811e-02 9.18918919e-01]
 [9.77107558e-01 2.28924419e-02]
 [9.80000000e-01 2.00000000e-02]
 [8.83458647e-01 1.16541353e-01]
 [4.54545455e-02 9.54545455e-01]
 [3.33333333e-02 9.66666667e-01]]
2021-10-11 10:02:28,832 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 79 out of 5734
2021-10-11 10:02:28,834 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:02:28,835 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:02:28,835 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 66.58it/s]
2021-10-11 10:02:30,003 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 196.70it/s]
2021-10-11 10:02:30,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.42547136250444684
100%|██████████| 22/22 [00:00<00:00, 195.64it/s]
2021-10-11 10:02:31,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 198.20it/s]
2021-10-11 10:02:31,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 193.42it/s]
2021-10-11 10:02:32,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.408039843472074
100%|██████████| 22/22 [00:00<00:00, 192.58it/s]
2021-10-11 10:02:32,818 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39701173959445035
100%|██████████| 22/22 [00:00<00:00, 179.60it/s]
2021-10-11 10:02:33,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 206.52it/s]
2021-10-11 10:02:34,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3664176449662042
100%|██████████| 22/22 [00:00<00:00, 190.37it/s]
2021-10-11 10:02:34,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 178.23it/s]
2021-10-11 10:02:35,127 knodle.trainer.trainer INFO     Epoch development accuracy: 0.40270366417644965
100%|██████████| 22/22 [00:00<00:00, 178.80it/s]
2021-10-11 10:02:35,746 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 143.10it/s]
2021-10-11 10:02:36,468 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 160.72it/s]
2021-10-11 10:02:37,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 63.17it/s]
2021-10-11 10:02:38,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 161.11it/s]
2021-10-11 10:02:39,043 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 159.41it/s]
2021-10-11 10:02:39,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 165.73it/s]
2021-10-11 10:02:40,439 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36784062611170404
100%|██████████| 22/22 [00:00<00:00, 164.33it/s]
2021-10-11 10:02:41,147 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 150.92it/s]
2021-10-11 10:02:41,933 knodle.trainer.trainer INFO     Epoch development accuracy: 0.360014229811455
100%|██████████| 22/22 [00:00<00:00, 145.18it/s]
2021-10-11 10:02:42,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 161.33it/s]
2021-10-11 10:02:43,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 177.83it/s]
2021-10-11 10:02:44,028 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 185.65it/s]
2021-10-11 10:02:44,584 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 201.07it/s]
2021-10-11 10:02:45,143 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3831376734258271
100%|██████████| 22/22 [00:00<00:00, 201.34it/s]
2021-10-11 10:02:45,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 202.28it/s]
2021-10-11 10:02:46,239 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33724653148345785
100%|██████████| 22/22 [00:00<00:00, 204.19it/s]
2021-10-11 10:02:46,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 196.39it/s]
2021-10-11 10:02:47,332 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 198.13it/s]
2021-10-11 10:02:47,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3244397011739594
100%|██████████| 22/22 [00:00<00:00, 193.35it/s]
2021-10-11 10:02:48,443 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3614372109569548
100%|██████████| 22/22 [00:00<00:00, 185.29it/s]
2021-10-11 10:02:49,019 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37637851298470293
100%|██████████| 22/22 [00:00<00:00, 198.04it/s]
2021-10-11 10:02:49,561 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 184.91it/s]
2021-10-11 10:02:50,116 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 171.52it/s]
2021-10-11 10:02:50,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35787975809320527
100%|██████████| 22/22 [00:00<00:00, 194.00it/s]
2021-10-11 10:02:51,278 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 206.14it/s]
2021-10-11 10:02:51,801 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 211.58it/s]
2021-10-11 10:02:52,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 196.41it/s]
2021-10-11 10:02:52,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 194.32it/s]
2021-10-11 10:02:53,450 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 202.48it/s]
2021-10-11 10:02:53,987 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34542867307008185
100%|██████████| 22/22 [00:00<00:00, 194.85it/s]
2021-10-11 10:02:54,542 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3632159373888296
100%|██████████| 22/22 [00:00<00:00, 158.42it/s]
2021-10-11 10:02:55,124 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3625044468160797
100%|██████████| 22/22 [00:00<00:00, 194.08it/s]
2021-10-11 10:02:55,696 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3411597296335824
100%|██████████| 22/22 [00:00<00:00, 206.24it/s]
2021-10-11 10:02:56,230 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36036997509783
100%|██████████| 22/22 [00:00<00:00, 204.61it/s]
2021-10-11 10:02:56,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 212.95it/s]
2021-10-11 10:02:57,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 204.33it/s]
2021-10-11 10:02:57,803 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 178.83it/s]
2021-10-11 10:02:58,358 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3799359658484525
100%|██████████| 22/22 [00:00<00:00, 199.57it/s]
2021-10-11 10:02:58,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 200.18it/s]
2021-10-11 10:02:59,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 203.38it/s]
2021-10-11 10:02:59,948 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 169.58it/s]
2021-10-11 10:03:00,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 201.80it/s]
2021-10-11 10:03:01,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 191.77it/s]
2021-10-11 10:03:01,537 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 211.78it/s]
2021-10-11 10:03:02,049 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3504091070793312
100%|██████████| 22/22 [00:00<00:00, 198.74it/s]
2021-10-11 10:03:02,594 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 177.51it/s]
2021-10-11 10:03:03,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 203.00it/s]
2021-10-11 10:03:03,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 201.20it/s]
2021-10-11 10:03:04,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 193.08it/s]
2021-10-11 10:03:04,758 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 170.28it/s]
2021-10-11 10:03:05,337 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3468516542155816
100%|██████████| 22/22 [00:00<00:00, 186.98it/s]
2021-10-11 10:03:05,930 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 181.76it/s]
2021-10-11 10:03:06,490 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3244397011739594
100%|██████████| 22/22 [00:00<00:00, 193.29it/s]
2021-10-11 10:03:07,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33795802205620773
100%|██████████| 22/22 [00:00<00:00, 187.70it/s]
2021-10-11 10:03:07,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 163.04it/s]
2021-10-11 10:03:08,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36108146567057986
100%|██████████| 22/22 [00:00<00:00, 200.08it/s]
2021-10-11 10:03:08,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 210.72it/s]
2021-10-11 10:03:09,337 knodle.trainer.trainer INFO     Epoch development accuracy: 0.343649946638207
100%|██████████| 22/22 [00:00<00:00, 151.01it/s]
2021-10-11 10:03:09,961 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 159.40it/s]
2021-10-11 10:03:10,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36108146567057986
100%|██████████| 22/22 [00:00<00:00, 195.68it/s]
2021-10-11 10:03:11,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 191.90it/s]
2021-10-11 10:03:12,005 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3422269654927072
100%|██████████| 22/22 [00:00<00:00, 199.08it/s]
2021-10-11 10:03:12,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 187.74it/s]
2021-10-11 10:03:13,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 193.80it/s]
2021-10-11 10:03:13,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 199.71it/s]
2021-10-11 10:03:14,279 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33795802205620773
100%|██████████| 22/22 [00:00<00:00, 199.65it/s]
2021-10-11 10:03:14,832 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34187122020633226
100%|██████████| 22/22 [00:00<00:00, 191.79it/s]
2021-10-11 10:03:15,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3464959089292067
100%|██████████| 22/22 [00:00<00:00, 194.78it/s]
2021-10-11 10:03:15,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 179.54it/s]
2021-10-11 10:03:16,504 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 193.52it/s]
2021-10-11 10:03:17,048 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35432230522945574
100%|██████████| 22/22 [00:00<00:00, 193.15it/s]
2021-10-11 10:03:17,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3383137673425827
100%|██████████| 22/22 [00:00<00:00, 165.31it/s]
2021-10-11 10:03:18,190 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3536108146567058
100%|██████████| 22/22 [00:00<00:00, 186.88it/s]
2021-10-11 10:03:18,774 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 190.78it/s]
2021-10-11 10:03:19,367 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3493418712202063
100%|██████████| 22/22 [00:00<00:00, 196.32it/s]
2021-10-11 10:03:19,929 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 180.20it/s]
2021-10-11 10:03:20,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 205.77it/s]
2021-10-11 10:03:21,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 193.69it/s]
2021-10-11 10:03:21,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37353255069370334
100%|██████████| 22/22 [00:00<00:00, 182.18it/s]
2021-10-11 10:03:22,162 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 199.60it/s]
2021-10-11 10:03:22,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36428317324795445
100%|██████████| 22/22 [00:00<00:00, 179.12it/s]
2021-10-11 10:03:23,300 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 194.20it/s]
2021-10-11 10:03:23,855 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 191.15it/s]
2021-10-11 10:03:24,407 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 182.63it/s]
2021-10-11 10:03:24,964 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34863038064745644
100%|██████████| 22/22 [00:00<00:00, 194.31it/s]
2021-10-11 10:03:25,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 200.62it/s]
2021-10-11 10:03:26,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3696193525435788
100%|██████████| 22/22 [00:00<00:00, 192.61it/s]
2021-10-11 10:03:26,624 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 192.00it/s]
2021-10-11 10:03:27,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 199.91it/s]
2021-10-11 10:03:27,734 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
2021-10-11 10:03:27,735 knodle.trainer.trainer INFO     Train avg loss: 0.12970169225107456
2021-10-11 10:03:27,736 knodle.trainer.trainer INFO     Train avg accuracy: 0.9412170817454659
2021-10-11 10:03:27,736 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:03:27,736 knodle.trainer.trainer INFO     Training done
2021-10-11 10:03:27,736 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 142.17it/s]
2021-10-11 10:03:27,900 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.763298273086548). Denoising stops.
2021-10-11 10:03:27,900 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 66.47it/s]
2021-10-11 10:03:28,241 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:03:28,241 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:03:28,241 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
Accuracy is: 0.3646797482413921
Precision is: 0.5206545179800393
Recall is: 0.5603008716150558
F1 is: 0.32701289951619555
{'0': {'precision': 0.9474912485414235, 'recall': 0.3270237615787354, 'f1-score': 0.4862275449101796, 'support': 2483}, '1': {'precision': 0.0938177874186551, 'recall': 0.7935779816513762, 'f1-score': 0.16779825412221147, 'support': 218}, 'accuracy': 0.3646797482413921, 'macro avg': {'precision': 0.5206545179800393, 'recall': 0.5603008716150558, 'f1-score': 0.32701289951619555, 'support': 2701}, 'weighted avg': {'precision': 0.878590539720704, 'recall': 0.3646797482413921, 'f1-score': 0.46052684687546025, 'support': 2701}}
2021-10-11 10:03:28,806 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:03:28,836 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:03:29,031 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3751, samples in test set: 1983
2021-10-11 10:03:29,238 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5657, samples in test set: 77
2021-10-11 10:03:29,492 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5212, samples in test set: 522
2021-10-11 10:03:29,702 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3806, samples in test set: 1928
2021-10-11 10:03:29,885 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4510, samples in test set: 1224
5it [02:16, 27.38s/it]
2021-10-11 10:05:46,896 knodle.trainer.cleanlab.cleanlab INFO     [[0.18574573 0.81425427]
 [0.11390285 0.88609715]
 [0.29719189 0.70280811]
 [0.19415808 0.80584192]
 [0.7536193  0.2463807 ]
 [0.86460033 0.13539967]
 [0.88104839 0.11895161]
 [0.17857143 0.82142857]
 [0.18292683 0.81707317]]
2021-10-11 10:05:47,006 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 197 out of 5734
2021-10-11 10:05:47,007 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:05:47,007 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:05:47,007 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 77.53it/s]
2021-10-11 10:05:47,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 200.19it/s]
2021-10-11 10:05:48,506 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 200.45it/s]
2021-10-11 10:05:49,060 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 197.81it/s]
2021-10-11 10:05:49,617 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22696549270722163
100%|██████████| 22/22 [00:00<00:00, 195.30it/s]
2021-10-11 10:05:50,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 181.79it/s]
2021-10-11 10:05:50,716 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22020633226609748
100%|██████████| 22/22 [00:00<00:00, 189.62it/s]
2021-10-11 10:05:51,265 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 206.74it/s]
2021-10-11 10:05:51,779 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 79.10it/s]
2021-10-11 10:05:52,468 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 136.63it/s]
2021-10-11 10:05:53,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 150.47it/s]
2021-10-11 10:05:53,575 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3390252579153326
100%|██████████| 22/22 [00:00<00:00, 143.19it/s]
2021-10-11 10:05:54,174 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 140.54it/s]
2021-10-11 10:05:54,748 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 150.80it/s]
2021-10-11 10:05:55,344 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 138.67it/s]
2021-10-11 10:05:55,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 142.75it/s]
2021-10-11 10:05:56,502 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 155.88it/s]
2021-10-11 10:05:57,032 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 149.04it/s]
2021-10-11 10:05:57,581 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 136.39it/s]
2021-10-11 10:05:58,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 151.64it/s]
2021-10-11 10:05:58,695 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3411597296335824
100%|██████████| 22/22 [00:00<00:00, 156.59it/s]
2021-10-11 10:05:59,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23728210601209535
100%|██████████| 22/22 [00:00<00:00, 153.96it/s]
2021-10-11 10:05:59,776 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 152.49it/s]
2021-10-11 10:06:00,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 149.31it/s]
2021-10-11 10:06:00,871 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 143.15it/s]
2021-10-11 10:06:01,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 147.08it/s]
2021-10-11 10:06:01,987 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2255425115617218
100%|██████████| 22/22 [00:00<00:00, 150.77it/s]
2021-10-11 10:06:02,546 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 142.63it/s]
2021-10-11 10:06:03,093 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 151.63it/s]
2021-10-11 10:06:03,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 148.50it/s]
2021-10-11 10:06:04,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 133.89it/s]
2021-10-11 10:06:04,856 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 148.91it/s]
2021-10-11 10:06:05,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 146.02it/s]
2021-10-11 10:06:06,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 143.35it/s]
2021-10-11 10:06:06,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 144.94it/s]
2021-10-11 10:06:07,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 145.87it/s]
2021-10-11 10:06:07,781 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 144.35it/s]
2021-10-11 10:06:08,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 148.30it/s]
2021-10-11 10:06:08,935 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 149.27it/s]
2021-10-11 10:06:09,512 knodle.trainer.trainer INFO     Epoch development accuracy: 0.247954464603344
100%|██████████| 22/22 [00:00<00:00, 143.00it/s]
2021-10-11 10:06:10,077 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 150.68it/s]
2021-10-11 10:06:10,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 148.40it/s]
2021-10-11 10:06:11,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 143.71it/s]
2021-10-11 10:06:11,751 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 147.35it/s]
2021-10-11 10:06:12,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 145.01it/s]
2021-10-11 10:06:12,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 144.62it/s]
2021-10-11 10:06:13,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 151.29it/s]
2021-10-11 10:06:14,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 145.09it/s]
2021-10-11 10:06:14,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 131.16it/s]
2021-10-11 10:06:15,174 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 156.40it/s]
2021-10-11 10:06:15,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 132.18it/s]
2021-10-11 10:06:16,396 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 143.01it/s]
2021-10-11 10:06:16,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 150.07it/s]
2021-10-11 10:06:17,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 133.84it/s]
2021-10-11 10:06:18,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 144.46it/s]
2021-10-11 10:06:18,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 149.78it/s]
2021-10-11 10:06:19,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 147.42it/s]
2021-10-11 10:06:19,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 143.06it/s]
2021-10-11 10:06:20,443 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 153.17it/s]
2021-10-11 10:06:21,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 150.02it/s]
2021-10-11 10:06:21,580 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 138.40it/s]
2021-10-11 10:06:22,159 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 147.39it/s]
2021-10-11 10:06:22,760 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 143.19it/s]
2021-10-11 10:06:23,367 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 143.44it/s]
2021-10-11 10:06:23,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23941657773034508
100%|██████████| 22/22 [00:00<00:00, 151.01it/s]
2021-10-11 10:06:24,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 130.27it/s]
2021-10-11 10:06:25,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 147.47it/s]
2021-10-11 10:06:25,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 146.78it/s]
2021-10-11 10:06:26,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 149.64it/s]
2021-10-11 10:06:26,866 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 143.77it/s]
2021-10-11 10:06:27,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 145.05it/s]
2021-10-11 10:06:28,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 147.57it/s]
2021-10-11 10:06:28,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 143.95it/s]
2021-10-11 10:06:29,177 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 152.00it/s]
2021-10-11 10:06:29,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 149.62it/s]
2021-10-11 10:06:30,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 145.37it/s]
2021-10-11 10:06:30,870 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 148.07it/s]
2021-10-11 10:06:31,446 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 148.60it/s]
2021-10-11 10:06:32,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 146.87it/s]
2021-10-11 10:06:32,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 141.88it/s]
2021-10-11 10:06:33,164 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 151.11it/s]
2021-10-11 10:06:33,736 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 145.02it/s]
2021-10-11 10:06:34,293 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 150.33it/s]
2021-10-11 10:06:34,851 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 144.28it/s]
2021-10-11 10:06:35,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 144.24it/s]
2021-10-11 10:06:36,031 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 150.67it/s]
2021-10-11 10:06:36,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 145.77it/s]
2021-10-11 10:06:37,181 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3368907861970829
100%|██████████| 22/22 [00:00<00:00, 145.10it/s]
2021-10-11 10:06:37,746 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 147.61it/s]
2021-10-11 10:06:38,339 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 146.03it/s]
2021-10-11 10:06:38,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 139.82it/s]
2021-10-11 10:06:39,502 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 154.38it/s]
2021-10-11 10:06:40,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 153.57it/s]
2021-10-11 10:06:40,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 145.30it/s]
2021-10-11 10:06:41,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 151.81it/s]
2021-10-11 10:06:41,724 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 147.68it/s]
2021-10-11 10:06:42,302 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 142.99it/s]
2021-10-11 10:06:42,868 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 141.82it/s]
2021-10-11 10:06:43,466 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 129.71it/s]
2021-10-11 10:06:44,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 142.83it/s]
2021-10-11 10:06:44,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
2021-10-11 10:06:44,679 knodle.trainer.trainer INFO     Train avg loss: 0.1341876106307738
2021-10-11 10:06:44,679 knodle.trainer.trainer INFO     Train avg accuracy: 0.9402271579768923
2021-10-11 10:06:44,679 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:06:44,679 knodle.trainer.trainer INFO     Training done
2021-10-11 10:06:44,679 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 147.15it/s]
2021-10-11 10:06:44,837 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.93625, 'recall': 0.2857687905379626, 'f1-score': 0.4378836597486115, 'support': 2621}, '1': {'precision': 0.06911984087518648, 'recall': 0.7315789473684211, 'f1-score': 0.1263062244434348, 'support': 190}, 'accuracy': 0.31590181430096054, 'macro avg': {'precision': 0.5026849204375933, 'recall': 0.5086738689531919, 'f1-score': 0.28209494209602315, 'support': 2811}, 'weighted avg': {'precision': 0.8776392813113787, 'recall': 0.31590181430096054, 'f1-score': 0.4168236409979948, 'support': 2811}}, Dev loss: 3.153961420059204, denoising continues.
2021-10-11 10:06:44,837 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:06:44,859 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:06:45,000 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4283, samples in test set: 1451
2021-10-11 10:06:45,213 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3257, samples in test set: 2477
2021-10-11 10:06:45,809 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5340, samples in test set: 394
2021-10-11 10:06:46,096 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5198, samples in test set: 536
2021-10-11 10:06:46,324 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4858, samples in test set: 876
5it [02:24, 28.88s/it]
2021-10-11 10:09:10,841 knodle.trainer.cleanlab.cleanlab INFO     [[0.01728024 0.98271976]
 [0.00342466 0.99657534]
 [0.13809524 0.86190476]
 [0.01476793 0.98523207]
 [0.956617   0.043383  ]
 [0.99137931 0.00862069]
 [0.97666667 0.02333333]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 10:09:10,964 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 19 out of 5734
2021-10-11 10:09:10,967 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:09:10,967 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:09:10,967 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 76.14it/s]
2021-10-11 10:09:11,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 199.37it/s]
2021-10-11 10:09:12,505 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 184.82it/s]
2021-10-11 10:09:13,060 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 202.94it/s]
2021-10-11 10:09:13,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 197.56it/s]
2021-10-11 10:09:14,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 196.83it/s]
2021-10-11 10:09:14,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 206.12it/s]
2021-10-11 10:09:15,254 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 198.05it/s]
2021-10-11 10:09:15,813 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 195.33it/s]
2021-10-11 10:09:16,358 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 200.55it/s]
2021-10-11 10:09:16,905 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24439701173959444
100%|██████████| 22/22 [00:00<00:00, 198.21it/s]
2021-10-11 10:09:17,442 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 217.09it/s]
2021-10-11 10:09:17,978 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 184.81it/s]
2021-10-11 10:09:18,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 163.82it/s]
2021-10-11 10:09:19,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 185.42it/s]
2021-10-11 10:09:19,847 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 197.96it/s]
2021-10-11 10:09:20,387 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 210.58it/s]
2021-10-11 10:09:20,912 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 196.78it/s]
2021-10-11 10:09:21,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 192.21it/s]
2021-10-11 10:09:22,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 188.07it/s]
2021-10-11 10:09:22,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 177.26it/s]
2021-10-11 10:09:23,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 196.83it/s]
2021-10-11 10:09:23,734 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 203.03it/s]
2021-10-11 10:09:24,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 186.93it/s]
2021-10-11 10:09:24,835 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 193.29it/s]
2021-10-11 10:09:25,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 203.53it/s]
2021-10-11 10:09:25,918 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 177.63it/s]
2021-10-11 10:09:26,478 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 187.57it/s]
2021-10-11 10:09:27,058 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 199.00it/s]
2021-10-11 10:09:27,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 175.49it/s]
2021-10-11 10:09:28,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 175.00it/s]
2021-10-11 10:09:28,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 197.44it/s]
2021-10-11 10:09:29,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 198.47it/s]
2021-10-11 10:09:29,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 99.20it/s]
2021-10-11 10:09:30,493 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 200.93it/s]
2021-10-11 10:09:31,021 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 180.65it/s]
2021-10-11 10:09:31,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 194.64it/s]
2021-10-11 10:09:32,100 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 191.32it/s]
2021-10-11 10:09:32,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 176.76it/s]
2021-10-11 10:09:33,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 194.07it/s]
2021-10-11 10:09:33,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 194.36it/s]
2021-10-11 10:09:34,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 197.95it/s]
2021-10-11 10:09:34,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 185.60it/s]
2021-10-11 10:09:35,439 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 188.39it/s]
2021-10-11 10:09:36,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 193.98it/s]
2021-10-11 10:09:36,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 205.28it/s]
2021-10-11 10:09:37,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 196.87it/s]
2021-10-11 10:09:37,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 176.57it/s]
2021-10-11 10:09:38,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 192.80it/s]
2021-10-11 10:09:38,757 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 189.72it/s]
2021-10-11 10:09:39,300 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 194.26it/s]
2021-10-11 10:09:39,848 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 200.00it/s]
2021-10-11 10:09:40,373 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 203.46it/s]
2021-10-11 10:09:40,901 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 205.39it/s]
2021-10-11 10:09:41,437 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 200.25it/s]
2021-10-11 10:09:41,964 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 196.71it/s]
2021-10-11 10:09:42,520 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 181.80it/s]
2021-10-11 10:09:43,080 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 201.77it/s]
2021-10-11 10:09:43,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 182.27it/s]
2021-10-11 10:09:44,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 198.50it/s]
2021-10-11 10:09:44,756 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 199.43it/s]
2021-10-11 10:09:45,284 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 202.21it/s]
2021-10-11 10:09:45,816 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 200.50it/s]
2021-10-11 10:09:46,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 204.38it/s]
2021-10-11 10:09:46,878 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 204.70it/s]
2021-10-11 10:09:47,408 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 197.30it/s]
2021-10-11 10:09:47,930 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 212.70it/s]
2021-10-11 10:09:48,472 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 188.63it/s]
2021-10-11 10:09:48,987 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 209.77it/s]
2021-10-11 10:09:49,514 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 213.54it/s]
2021-10-11 10:09:50,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 205.55it/s]
2021-10-11 10:09:50,514 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 211.24it/s]
2021-10-11 10:09:51,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 199.40it/s]
2021-10-11 10:09:51,549 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 201.89it/s]
2021-10-11 10:09:52,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 197.16it/s]
2021-10-11 10:09:52,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 183.35it/s]
2021-10-11 10:09:53,178 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 211.69it/s]
2021-10-11 10:09:53,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 200.68it/s]
2021-10-11 10:09:54,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 218.64it/s]
2021-10-11 10:09:54,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 198.80it/s]
2021-10-11 10:09:55,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 199.95it/s]
2021-10-11 10:09:55,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 196.82it/s]
2021-10-11 10:09:56,353 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 214.33it/s]
2021-10-11 10:09:56,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 200.28it/s]
2021-10-11 10:09:57,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 197.05it/s]
2021-10-11 10:09:57,915 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 206.27it/s]
2021-10-11 10:09:58,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 202.66it/s]
2021-10-11 10:09:59,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 198.60it/s]
2021-10-11 10:09:59,553 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 194.64it/s]
2021-10-11 10:10:00,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 220.35it/s]
2021-10-11 10:10:00,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 209.81it/s]
2021-10-11 10:10:01,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 217.29it/s]
2021-10-11 10:10:01,643 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 222.89it/s]
2021-10-11 10:10:02,129 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 211.83it/s]
2021-10-11 10:10:02,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 190.28it/s]
2021-10-11 10:10:03,132 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 223.53it/s]
2021-10-11 10:10:03,634 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 195.94it/s]
2021-10-11 10:10:04,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 206.41it/s]
2021-10-11 10:10:04,663 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 224.99it/s]
2021-10-11 10:10:05,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 209.37it/s]
2021-10-11 10:10:05,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
2021-10-11 10:10:05,656 knodle.trainer.trainer INFO     Train avg loss: 0.13165860084589157
2021-10-11 10:10:05,656 knodle.trainer.trainer INFO     Train avg accuracy: 0.9417134052250118
2021-10-11 10:10:05,656 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:10:05,656 knodle.trainer.trainer INFO     Training done
2021-10-11 10:10:05,656 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 151.44it/s]
2021-10-11 10:10:05,810 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.269710063934326). Denoising stops.
2021-10-11 10:10:05,810 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 74.54it/s]
2021-10-11 10:10:06,113 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:10:06,113 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:10:06,113 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:10:06,614 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:10:06,641 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:10:06,774 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 2266, samples in test set: 3468
2021-10-11 10:10:06,891 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5286, samples in test set: 448
2021-10-11 10:10:07,000 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5383, samples in test set: 351
2021-10-11 10:10:07,260 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4681, samples in test set: 1053
2021-10-11 10:10:07,469 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5320, samples in test set: 414
0it [00:00, ?it/s]Accuracy is: 0.31617919289152163
Precision is: 0.517731853687625
Recall is: 0.5464747438545412
F1 is: 0.29231457779650283
{'0': {'precision': 0.9453781512605042, 'recall': 0.27184857027788967, 'f1-score': 0.4222708789490147, 'support': 2483}, '1': {'precision': 0.09008555611474585, 'recall': 0.8211009174311926, 'f1-score': 0.1623582766439909, 'support': 218}, 'accuracy': 0.31617919289152163, 'macro avg': {'precision': 0.517731853687625, 'recall': 0.5464747438545412, 'f1-score': 0.29231457779650283, 'support': 2701}, 'weighted avg': {'precision': 0.8763467607600319, 'recall': 0.31617919289152163, 'f1-score': 0.40129311245419974, 'support': 2701}}
5it [02:18, 27.61s/it]
2021-10-11 10:12:25,570 knodle.trainer.cleanlab.cleanlab INFO     [[0.07426857 0.92573143]
 [0.04271845 0.95728155]
 [0.23311547 0.76688453]
 [0.08629442 0.91370558]
 [0.88539898 0.11460102]
 [0.97166362 0.02833638]
 [0.90062112 0.09937888]
 [0.125      0.875     ]
 [0.10344828 0.89655172]]
2021-10-11 10:12:25,689 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 181 out of 5734
2021-10-11 10:12:25,690 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:12:25,690 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:12:25,690 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 60.83it/s]
2021-10-11 10:12:26,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 209.61it/s]
2021-10-11 10:12:27,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23479188900747064
100%|██████████| 22/22 [00:00<00:00, 214.12it/s]
2021-10-11 10:12:27,803 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 184.60it/s]
2021-10-11 10:12:28,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 208.84it/s]
2021-10-11 10:12:28,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 193.96it/s]
2021-10-11 10:12:29,418 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 208.28it/s]
2021-10-11 10:12:29,915 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23372465314834578
100%|██████████| 22/22 [00:00<00:00, 209.76it/s]
2021-10-11 10:12:30,411 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19779437922447526
100%|██████████| 22/22 [00:00<00:00, 213.25it/s]
2021-10-11 10:12:30,912 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 224.43it/s]
2021-10-11 10:12:31,389 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 213.64it/s]
2021-10-11 10:12:31,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 209.62it/s]
2021-10-11 10:12:32,396 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 196.83it/s]
2021-10-11 10:12:32,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 209.28it/s]
2021-10-11 10:12:33,484 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2351476342938456
100%|██████████| 22/22 [00:00<00:00, 203.06it/s]
2021-10-11 10:12:34,003 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 202.66it/s]
2021-10-11 10:12:34,526 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23230167200284596
100%|██████████| 22/22 [00:00<00:00, 197.33it/s]
2021-10-11 10:12:35,034 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 198.62it/s]
2021-10-11 10:12:35,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 195.31it/s]
2021-10-11 10:12:36,099 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 185.07it/s]
2021-10-11 10:12:36,661 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 194.41it/s]
2021-10-11 10:12:37,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 186.78it/s]
2021-10-11 10:12:37,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 194.47it/s]
2021-10-11 10:12:38,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 193.55it/s]
2021-10-11 10:12:38,872 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 199.60it/s]
2021-10-11 10:12:39,390 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 181.39it/s]
2021-10-11 10:12:39,953 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 196.90it/s]
2021-10-11 10:12:40,504 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 186.16it/s]
2021-10-11 10:12:41,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 201.50it/s]
2021-10-11 10:12:41,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 199.95it/s]
2021-10-11 10:12:42,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 192.59it/s]
2021-10-11 10:12:42,695 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 193.13it/s]
2021-10-11 10:12:43,249 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 182.89it/s]
2021-10-11 10:12:43,801 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 196.94it/s]
2021-10-11 10:12:44,322 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 198.07it/s]
2021-10-11 10:12:44,844 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 196.92it/s]
2021-10-11 10:12:45,370 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 174.00it/s]
2021-10-11 10:12:45,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 186.82it/s]
2021-10-11 10:12:46,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 201.17it/s]
2021-10-11 10:12:47,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 198.16it/s]
2021-10-11 10:12:47,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 181.32it/s]
2021-10-11 10:12:48,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3536108146567058
100%|██████████| 22/22 [00:00<00:00, 202.47it/s]
2021-10-11 10:12:48,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 198.98it/s]
2021-10-11 10:12:49,153 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 199.52it/s]
2021-10-11 10:12:49,679 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 199.79it/s]
2021-10-11 10:12:50,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 193.78it/s]
2021-10-11 10:12:50,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 194.43it/s]
2021-10-11 10:12:51,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 206.08it/s]
2021-10-11 10:12:51,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 194.32it/s]
2021-10-11 10:12:52,357 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 207.46it/s]
2021-10-11 10:12:52,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 195.02it/s]
2021-10-11 10:12:53,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 199.02it/s]
2021-10-11 10:12:53,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 208.55it/s]
2021-10-11 10:12:54,515 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 180.05it/s]
2021-10-11 10:12:55,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 196.51it/s]
2021-10-11 10:12:55,592 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 186.04it/s]
2021-10-11 10:12:56,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 195.32it/s]
2021-10-11 10:12:56,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 199.15it/s]
2021-10-11 10:12:57,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 197.95it/s]
2021-10-11 10:12:57,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 190.22it/s]
2021-10-11 10:12:58,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 193.55it/s]
2021-10-11 10:12:58,835 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 196.46it/s]
2021-10-11 10:12:59,377 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 201.55it/s]
2021-10-11 10:12:59,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 196.35it/s]
2021-10-11 10:13:00,433 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 197.59it/s]
2021-10-11 10:13:00,958 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 200.16it/s]
2021-10-11 10:13:01,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 202.00it/s]
2021-10-11 10:13:02,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 203.81it/s]
2021-10-11 10:13:02,546 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 184.65it/s]
2021-10-11 10:13:03,109 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 206.31it/s]
2021-10-11 10:13:03,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 200.66it/s]
2021-10-11 10:13:04,181 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 195.93it/s]
2021-10-11 10:13:04,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3464959089292067
100%|██████████| 22/22 [00:00<00:00, 199.73it/s]
2021-10-11 10:13:05,255 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 191.09it/s]
2021-10-11 10:13:05,814 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 202.20it/s]
2021-10-11 10:13:06,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 199.24it/s]
2021-10-11 10:13:06,877 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 203.06it/s]
2021-10-11 10:13:07,406 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 197.06it/s]
2021-10-11 10:13:07,941 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 199.20it/s]
2021-10-11 10:13:08,489 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 211.33it/s]
2021-10-11 10:13:09,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 205.03it/s]
2021-10-11 10:13:09,538 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 204.39it/s]
2021-10-11 10:13:10,061 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 198.71it/s]
2021-10-11 10:13:10,589 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 201.71it/s]
2021-10-11 10:13:11,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 200.54it/s]
2021-10-11 10:13:11,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 202.63it/s]
2021-10-11 10:13:12,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 201.84it/s]
2021-10-11 10:13:12,711 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 191.00it/s]
2021-10-11 10:13:13,257 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 193.85it/s]
2021-10-11 10:13:13,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 198.83it/s]
2021-10-11 10:13:14,328 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 198.60it/s]
2021-10-11 10:13:14,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 214.01it/s]
2021-10-11 10:13:15,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 205.17it/s]
2021-10-11 10:13:15,898 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 191.22it/s]
2021-10-11 10:13:16,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 204.66it/s]
2021-10-11 10:13:16,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 204.14it/s]
2021-10-11 10:13:17,530 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 73.12it/s]
2021-10-11 10:13:18,514 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 192.42it/s]
2021-10-11 10:13:19,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 193.54it/s]
2021-10-11 10:13:19,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 191.59it/s]
2021-10-11 10:13:20,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
2021-10-11 10:13:20,334 knodle.trainer.trainer INFO     Train avg loss: 0.13358765171509648
2021-10-11 10:13:20,334 knodle.trainer.trainer INFO     Train avg accuracy: 0.9407000610166132
2021-10-11 10:13:20,334 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:13:20,334 knodle.trainer.trainer INFO     Training done
2021-10-11 10:13:20,334 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 144.24it/s]
2021-10-11 10:13:20,496 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9475177304964539, 'recall': 0.2548645555131629, 'f1-score': 0.401683704149128, 'support': 2621}, '1': {'precision': 0.07264957264957266, 'recall': 0.8052631578947368, 'f1-score': 0.13327526132404183, 'support': 190}, 'accuracy': 0.29206688011383847, 'macro avg': {'precision': 0.5100836515730133, 'recall': 0.5300638567039498, 'f1-score': 0.26747948273658495, 'support': 2811}, 'weighted avg': {'precision': 0.888383988059276, 'recall': 0.29206688011383847, 'f1-score': 0.3835415468610574, 'support': 2811}}, Dev loss: 3.487872362136841, denoising continues.
2021-10-11 10:13:20,497 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:13:20,522 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:13:21,016 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5003, samples in test set: 731
2021-10-11 10:13:21,180 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5432, samples in test set: 302
2021-10-11 10:13:21,412 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5065, samples in test set: 669
2021-10-11 10:13:21,641 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4753, samples in test set: 981
2021-10-11 10:13:21,858 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 2683, samples in test set: 3051
5it [02:23, 28.77s/it]
2021-10-11 10:15:45,826 knodle.trainer.cleanlab.cleanlab INFO     [[0.02100271 0.97899729]
 [0.00514403 0.99485597]
 [0.14766839 0.85233161]
 [0.04716981 0.95283019]
 [0.94797936 0.05202064]
 [0.98769575 0.01230425]
 [0.98013245 0.01986755]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 10:15:45,941 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 21 out of 5734
2021-10-11 10:15:45,943 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:15:45,943 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:15:45,943 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 80.11it/s]
2021-10-11 10:15:46,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 201.05it/s]
2021-10-11 10:15:47,424 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35859124866595515
100%|██████████| 22/22 [00:00<00:00, 196.13it/s]
2021-10-11 10:15:47,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 202.82it/s]
2021-10-11 10:15:48,512 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 192.50it/s]
2021-10-11 10:15:49,069 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 198.60it/s]
2021-10-11 10:15:49,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 193.59it/s]
2021-10-11 10:15:50,153 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 195.36it/s]
2021-10-11 10:15:50,701 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 202.07it/s]
2021-10-11 10:15:51,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 208.26it/s]
2021-10-11 10:15:51,747 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 203.56it/s]
2021-10-11 10:15:52,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 209.19it/s]
2021-10-11 10:15:52,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 187.07it/s]
2021-10-11 10:15:53,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 186.38it/s]
2021-10-11 10:15:53,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 213.60it/s]
2021-10-11 10:15:54,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 193.38it/s]
2021-10-11 10:15:54,905 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 208.55it/s]
2021-10-11 10:15:55,446 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 203.63it/s]
2021-10-11 10:15:55,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 102.48it/s]
2021-10-11 10:15:56,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 200.24it/s]
2021-10-11 10:15:57,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 201.26it/s]
2021-10-11 10:15:57,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 196.66it/s]
2021-10-11 10:15:58,153 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 186.51it/s]
2021-10-11 10:15:58,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 192.04it/s]
2021-10-11 10:15:59,274 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 199.21it/s]
2021-10-11 10:15:59,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 194.13it/s]
2021-10-11 10:16:00,371 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 198.13it/s]
2021-10-11 10:16:00,904 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 200.50it/s]
2021-10-11 10:16:01,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 203.41it/s]
2021-10-11 10:16:01,960 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 208.17it/s]
2021-10-11 10:16:02,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 198.81it/s]
2021-10-11 10:16:03,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 197.39it/s]
2021-10-11 10:16:03,567 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3582355033795802
100%|██████████| 22/22 [00:00<00:00, 199.93it/s]
2021-10-11 10:16:04,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 217.34it/s]
2021-10-11 10:16:04,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 197.16it/s]
2021-10-11 10:16:05,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 207.60it/s]
2021-10-11 10:16:05,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 199.85it/s]
2021-10-11 10:16:06,219 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 201.74it/s]
2021-10-11 10:16:06,735 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 207.48it/s]
2021-10-11 10:16:07,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 195.89it/s]
2021-10-11 10:16:07,800 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 198.16it/s]
2021-10-11 10:16:08,336 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 192.48it/s]
2021-10-11 10:16:08,881 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 200.97it/s]
2021-10-11 10:16:09,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 182.11it/s]
2021-10-11 10:16:09,996 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 199.09it/s]
2021-10-11 10:16:10,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 204.03it/s]
2021-10-11 10:16:11,048 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 202.11it/s]
2021-10-11 10:16:11,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 202.05it/s]
2021-10-11 10:16:12,105 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 204.08it/s]
2021-10-11 10:16:12,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 211.43it/s]
2021-10-11 10:16:13,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 204.12it/s]
2021-10-11 10:16:13,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 205.40it/s]
2021-10-11 10:16:14,173 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 206.49it/s]
2021-10-11 10:16:14,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3333333333333333
100%|██████████| 22/22 [00:00<00:00, 197.48it/s]
2021-10-11 10:16:15,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35005336179295626
100%|██████████| 22/22 [00:00<00:00, 203.65it/s]
2021-10-11 10:16:15,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 206.13it/s]
2021-10-11 10:16:16,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 208.04it/s]
2021-10-11 10:16:16,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 178.38it/s]
2021-10-11 10:16:17,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 207.50it/s]
2021-10-11 10:16:17,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 204.03it/s]
2021-10-11 10:16:18,380 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 200.85it/s]
2021-10-11 10:16:18,896 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 190.10it/s]
2021-10-11 10:16:19,474 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 196.20it/s]
2021-10-11 10:16:20,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 196.86it/s]
2021-10-11 10:16:20,537 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 201.23it/s]
2021-10-11 10:16:21,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 203.53it/s]
2021-10-11 10:16:21,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 203.86it/s]
2021-10-11 10:16:22,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 207.09it/s]
2021-10-11 10:16:22,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 203.39it/s]
2021-10-11 10:16:23,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 179.75it/s]
2021-10-11 10:16:23,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 186.57it/s]
2021-10-11 10:16:24,270 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 197.39it/s]
2021-10-11 10:16:24,811 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 203.17it/s]
2021-10-11 10:16:25,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 202.31it/s]
2021-10-11 10:16:25,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 206.21it/s]
2021-10-11 10:16:26,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 209.61it/s]
2021-10-11 10:16:26,915 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 200.78it/s]
2021-10-11 10:16:27,426 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 202.67it/s]
2021-10-11 10:16:27,971 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 226.89it/s]
2021-10-11 10:16:28,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 216.05it/s]
2021-10-11 10:16:28,980 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 201.10it/s]
2021-10-11 10:16:29,510 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 219.02it/s]
2021-10-11 10:16:30,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 223.64it/s]
2021-10-11 10:16:30,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 225.08it/s]
2021-10-11 10:16:30,979 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 203.47it/s]
2021-10-11 10:16:31,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 208.34it/s]
2021-10-11 10:16:31,964 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 221.46it/s]
2021-10-11 10:16:32,446 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 210.95it/s]
2021-10-11 10:16:32,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 207.95it/s]
2021-10-11 10:16:33,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 202.19it/s]
2021-10-11 10:16:33,970 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 200.39it/s]
2021-10-11 10:16:34,504 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 197.70it/s]
2021-10-11 10:16:35,015 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 198.82it/s]
2021-10-11 10:16:35,555 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 195.19it/s]
2021-10-11 10:16:36,092 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 197.72it/s]
2021-10-11 10:16:36,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 220.96it/s]
2021-10-11 10:16:37,159 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 198.88it/s]
2021-10-11 10:16:37,695 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 178.71it/s]
2021-10-11 10:16:38,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 195.53it/s]
2021-10-11 10:16:38,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 195.61it/s]
2021-10-11 10:16:39,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
2021-10-11 10:16:39,343 knodle.trainer.trainer INFO     Train avg loss: 0.13158181538991637
2021-10-11 10:16:39,343 knodle.trainer.trainer INFO     Train avg accuracy: 0.9410090547667607
2021-10-11 10:16:39,343 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:16:39,343 knodle.trainer.trainer INFO     Training done
2021-10-11 10:16:39,343 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 141.91it/s]
2021-10-11 10:16:39,507 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.19887638092041). Denoising stops.
2021-10-11 10:16:39,507 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 29.49it/s]
2021-10-11 10:16:40,261 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:16:40,261 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:16:40,261 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:16:40,952 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:16:40,977 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:16:41,214 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3560, samples in test set: 2174
2021-10-11 10:16:41,494 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5039, samples in test set: 695
2021-10-11 10:16:41,681 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5054, samples in test set: 680
2021-10-11 10:16:41,865 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3612, samples in test set: 2122
2021-10-11 10:16:42,119 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5671, samples in test set: 63
0it [00:00, ?it/s]Accuracy is: 0.32395409107737877
Precision is: 0.5173668441939475
Recall is: 0.5465190820515284
F1 is: 0.29782829059391
{'0': {'precision': 0.9445196211096076, 'recall': 0.2811115585984696, 'f1-score': 0.43327126008690253, 'support': 2483}, '1': {'precision': 0.09021406727828746, 'recall': 0.8119266055045872, 'f1-score': 0.1623853211009174, 'support': 218}, 'accuracy': 0.32395409107737877, 'macro avg': {'precision': 0.5173668441939475, 'recall': 0.5465190820515284, 'f1-score': 0.29782829059391, 'support': 2701}, 'weighted avg': {'precision': 0.875567895550471, 'recall': 0.32395409107737877, 'f1-score': 0.4114078262849978, 'support': 2701}}
5it [02:20, 28.14s/it]
2021-10-11 10:19:02,916 knodle.trainer.cleanlab.cleanlab INFO     [[0.172593   0.827407  ]
 [0.05478395 0.94521605]
 [0.29200653 0.70799347]
 [0.20300752 0.79699248]
 [0.78682842 0.21317158]
 [0.9483871  0.0516129 ]
 [0.71493213 0.28506787]
 [0.06       0.94      ]
 [0.10526316 0.89473684]]
2021-10-11 10:19:03,024 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 209 out of 5734
2021-10-11 10:19:03,025 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:19:03,025 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:19:03,025 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 77.96it/s]
2021-10-11 10:19:03,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 182.53it/s]
2021-10-11 10:19:04,579 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 176.85it/s]
2021-10-11 10:19:05,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.18463180362860193
100%|██████████| 22/22 [00:00<00:00, 196.99it/s]
2021-10-11 10:19:05,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20419779437922447
100%|██████████| 22/22 [00:00<00:00, 192.61it/s]
2021-10-11 10:19:06,244 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 202.39it/s]
2021-10-11 10:19:06,776 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 191.48it/s]
2021-10-11 10:19:07,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 197.58it/s]
2021-10-11 10:19:07,855 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 191.71it/s]
2021-10-11 10:19:08,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 198.10it/s]
2021-10-11 10:19:08,967 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 189.05it/s]
2021-10-11 10:19:09,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 193.51it/s]
2021-10-11 10:19:10,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 199.07it/s]
2021-10-11 10:19:10,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 201.58it/s]
2021-10-11 10:19:11,140 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 205.52it/s]
2021-10-11 10:19:11,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 208.74it/s]
2021-10-11 10:19:12,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 191.76it/s]
2021-10-11 10:19:12,723 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 199.62it/s]
2021-10-11 10:19:13,257 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 204.86it/s]
2021-10-11 10:19:13,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 197.64it/s]
2021-10-11 10:19:14,304 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 199.84it/s]
2021-10-11 10:19:14,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 200.18it/s]
2021-10-11 10:19:15,354 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 199.39it/s]
2021-10-11 10:19:15,875 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 207.50it/s]
2021-10-11 10:19:16,396 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 195.22it/s]
2021-10-11 10:19:16,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 194.00it/s]
2021-10-11 10:19:17,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 199.10it/s]
2021-10-11 10:19:17,999 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 200.45it/s]
2021-10-11 10:19:18,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 179.43it/s]
2021-10-11 10:19:19,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 174.72it/s]
2021-10-11 10:19:19,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 191.92it/s]
2021-10-11 10:19:20,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 197.36it/s]
2021-10-11 10:19:20,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 173.51it/s]
2021-10-11 10:19:21,306 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 174.87it/s]
2021-10-11 10:19:21,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 178.37it/s]
2021-10-11 10:19:22,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 173.94it/s]
2021-10-11 10:19:23,277 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 201.17it/s]
2021-10-11 10:19:23,829 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 185.47it/s]
2021-10-11 10:19:24,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 174.43it/s]
2021-10-11 10:19:24,979 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 191.00it/s]
2021-10-11 10:19:25,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 193.74it/s]
2021-10-11 10:19:26,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 203.04it/s]
2021-10-11 10:19:26,617 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 194.71it/s]
2021-10-11 10:19:27,145 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 107.27it/s]
2021-10-11 10:19:27,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 194.93it/s]
2021-10-11 10:19:28,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 194.75it/s]
2021-10-11 10:19:28,868 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24439701173959444
100%|██████████| 22/22 [00:00<00:00, 200.65it/s]
2021-10-11 10:19:29,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 196.84it/s]
2021-10-11 10:19:29,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 22.63it/s]
2021-10-11 10:19:31,328 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 199.34it/s]
2021-10-11 10:19:31,857 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 185.16it/s]
2021-10-11 10:19:32,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 196.82it/s]
2021-10-11 10:19:32,945 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 185.31it/s]
2021-10-11 10:19:33,500 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 203.61it/s]
2021-10-11 10:19:34,021 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 194.16it/s]
2021-10-11 10:19:34,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 198.45it/s]
2021-10-11 10:19:35,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 202.61it/s]
2021-10-11 10:19:35,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 201.97it/s]
2021-10-11 10:19:36,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 204.95it/s]
2021-10-11 10:19:36,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 181.30it/s]
2021-10-11 10:19:37,147 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 203.66it/s]
2021-10-11 10:19:37,677 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 203.05it/s]
2021-10-11 10:19:38,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 195.89it/s]
2021-10-11 10:19:38,722 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 184.32it/s]
2021-10-11 10:19:39,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 189.02it/s]
2021-10-11 10:19:39,807 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 186.93it/s]
2021-10-11 10:19:40,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 189.96it/s]
2021-10-11 10:19:40,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 203.43it/s]
2021-10-11 10:19:41,413 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 201.67it/s]
2021-10-11 10:19:41,930 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 191.38it/s]
2021-10-11 10:19:42,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 203.16it/s]
2021-10-11 10:19:43,023 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 199.86it/s]
2021-10-11 10:19:43,536 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 198.36it/s]
2021-10-11 10:19:44,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 204.16it/s]
2021-10-11 10:19:44,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 204.40it/s]
2021-10-11 10:19:45,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 194.01it/s]
2021-10-11 10:19:45,603 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 198.43it/s]
2021-10-11 10:19:46,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 205.03it/s]
2021-10-11 10:19:46,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 195.19it/s]
2021-10-11 10:19:47,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 197.40it/s]
2021-10-11 10:19:47,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 201.08it/s]
2021-10-11 10:19:48,193 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 191.85it/s]
2021-10-11 10:19:48,760 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 190.39it/s]
2021-10-11 10:19:49,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 203.34it/s]
2021-10-11 10:19:49,832 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 185.12it/s]
2021-10-11 10:19:50,377 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 186.68it/s]
2021-10-11 10:19:50,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 195.97it/s]
2021-10-11 10:19:51,482 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 217.97it/s]
2021-10-11 10:19:51,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 198.50it/s]
2021-10-11 10:19:52,496 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 198.30it/s]
2021-10-11 10:19:52,997 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 197.78it/s]
2021-10-11 10:19:53,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 204.03it/s]
2021-10-11 10:19:54,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 211.38it/s]
2021-10-11 10:19:54,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 186.58it/s]
2021-10-11 10:19:55,113 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 204.23it/s]
2021-10-11 10:19:55,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3447171824973319
100%|██████████| 22/22 [00:00<00:00, 196.45it/s]
2021-10-11 10:19:56,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 197.65it/s]
2021-10-11 10:19:56,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 188.13it/s]
2021-10-11 10:19:57,202 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 202.97it/s]
2021-10-11 10:19:57,715 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 215.70it/s]
2021-10-11 10:19:58,219 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
2021-10-11 10:19:58,221 knodle.trainer.trainer INFO     Train avg loss: 0.13376949887205333
2021-10-11 10:19:58,221 knodle.trainer.trainer INFO     Train avg accuracy: 0.940588030801879
2021-10-11 10:19:58,221 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:19:58,221 knodle.trainer.trainer INFO     Training done
2021-10-11 10:19:58,221 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 145.61it/s]
2021-10-11 10:19:58,382 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9342465753424658, 'recall': 0.26020602823349864, 'f1-score': 0.40704267382870785, 'support': 2621}, '1': {'precision': 0.06823642479577126, 'recall': 0.7473684210526316, 'f1-score': 0.12505504183179214, 'support': 190}, 'accuracy': 0.29313411597296335, 'macro avg': {'precision': 0.5012415000691185, 'recall': 0.5037872246430651, 'f1-score': 0.26604885783025, 'support': 2811}, 'weighted avg': {'precision': 0.8757115598305938, 'recall': 0.29313411597296335, 'f1-score': 0.3879826773579096, 'support': 2811}}, Dev loss: 3.4256505966186523, denoising continues.
2021-10-11 10:19:58,382 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:19:58,407 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:19:59,177 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4308, samples in test set: 1426
2021-10-11 10:19:59,504 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5033, samples in test set: 701
2021-10-11 10:19:59,701 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3665, samples in test set: 2069
2021-10-11 10:19:59,873 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4896, samples in test set: 838
2021-10-11 10:20:00,039 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5034, samples in test set: 700
5it [02:23, 28.75s/it]
2021-10-11 10:22:23,877 knodle.trainer.cleanlab.cleanlab INFO     [[0.02102102 0.97897898]
 [0.         1.        ]
 [0.12561576 0.87438424]
 [0.04232804 0.95767196]
 [0.95928637 0.04071363]
 [0.9941452  0.0058548 ]
 [0.97486034 0.02513966]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 10:22:24,005 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 35 out of 5734
2021-10-11 10:22:24,005 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:22:24,005 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:22:24,005 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 72.81it/s]
2021-10-11 10:22:25,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 203.71it/s]
2021-10-11 10:22:25,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 206.25it/s]
2021-10-11 10:22:26,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 186.23it/s]
2021-10-11 10:22:26,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 196.66it/s]
2021-10-11 10:22:27,182 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35538954108858056
100%|██████████| 22/22 [00:00<00:00, 196.76it/s]
2021-10-11 10:22:27,730 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 204.95it/s]
2021-10-11 10:22:28,260 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 202.29it/s]
2021-10-11 10:22:28,786 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 94.64it/s]
2021-10-11 10:22:29,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 206.34it/s]
2021-10-11 10:22:29,948 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 210.24it/s]
2021-10-11 10:22:30,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 208.13it/s]
2021-10-11 10:22:30,991 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 201.03it/s]
2021-10-11 10:22:31,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 197.24it/s]
2021-10-11 10:22:32,079 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 195.70it/s]
2021-10-11 10:22:32,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 201.74it/s]
2021-10-11 10:22:33,190 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 178.50it/s]
2021-10-11 10:22:33,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 185.31it/s]
2021-10-11 10:22:34,353 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 202.83it/s]
2021-10-11 10:22:34,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 198.56it/s]
2021-10-11 10:22:35,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 203.37it/s]
2021-10-11 10:22:35,966 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 193.09it/s]
2021-10-11 10:22:36,490 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 200.91it/s]
2021-10-11 10:22:37,026 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 199.85it/s]
2021-10-11 10:22:37,555 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 198.04it/s]
2021-10-11 10:22:38,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3319103521878335
100%|██████████| 22/22 [00:00<00:00, 203.14it/s]
2021-10-11 10:22:38,617 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 208.88it/s]
2021-10-11 10:22:39,138 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 202.15it/s]
2021-10-11 10:22:39,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 199.37it/s]
2021-10-11 10:22:40,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 204.09it/s]
2021-10-11 10:22:40,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 196.85it/s]
2021-10-11 10:22:41,267 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 198.22it/s]
2021-10-11 10:22:41,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
100%|██████████| 22/22 [00:00<00:00, 197.38it/s]
2021-10-11 10:22:42,332 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 184.24it/s]
2021-10-11 10:22:42,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 190.17it/s]
2021-10-11 10:22:43,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 194.74it/s]
2021-10-11 10:22:44,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 196.42it/s]
2021-10-11 10:22:44,551 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 204.94it/s]
2021-10-11 10:22:45,077 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 203.55it/s]
2021-10-11 10:22:45,611 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 206.21it/s]
2021-10-11 10:22:46,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 201.42it/s]
2021-10-11 10:22:46,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 200.71it/s]
2021-10-11 10:22:47,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 201.01it/s]
2021-10-11 10:22:47,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 192.48it/s]
2021-10-11 10:22:48,265 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 195.84it/s]
2021-10-11 10:22:48,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 183.63it/s]
2021-10-11 10:22:49,398 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 185.94it/s]
2021-10-11 10:22:49,961 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 188.99it/s]
2021-10-11 10:22:50,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 195.90it/s]
2021-10-11 10:22:51,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 201.27it/s]
2021-10-11 10:22:51,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 197.40it/s]
2021-10-11 10:22:52,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 195.75it/s]
2021-10-11 10:22:52,743 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 192.78it/s]
2021-10-11 10:22:53,288 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 198.53it/s]
2021-10-11 10:22:53,840 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 181.87it/s]
2021-10-11 10:22:54,390 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 177.52it/s]
2021-10-11 10:22:54,972 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 194.83it/s]
2021-10-11 10:22:55,528 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 194.07it/s]
2021-10-11 10:22:56,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 193.09it/s]
2021-10-11 10:22:56,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 207.02it/s]
2021-10-11 10:22:57,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 190.33it/s]
2021-10-11 10:22:57,751 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 187.79it/s]
2021-10-11 10:22:58,302 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 204.77it/s]
2021-10-11 10:22:58,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 195.15it/s]
2021-10-11 10:22:59,419 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 205.97it/s]
2021-10-11 10:22:59,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 208.40it/s]
2021-10-11 10:23:00,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 206.24it/s]
2021-10-11 10:23:01,041 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 203.52it/s]
2021-10-11 10:23:01,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 194.78it/s]
2021-10-11 10:23:02,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 198.81it/s]
2021-10-11 10:23:02,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 212.54it/s]
2021-10-11 10:23:03,165 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 202.47it/s]
2021-10-11 10:23:03,692 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 199.96it/s]
2021-10-11 10:23:04,229 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 196.08it/s]
2021-10-11 10:23:04,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 203.18it/s]
2021-10-11 10:23:05,292 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 202.00it/s]
2021-10-11 10:23:05,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 205.20it/s]
2021-10-11 10:23:06,366 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 199.47it/s]
2021-10-11 10:23:06,901 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 197.68it/s]
2021-10-11 10:23:07,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 189.14it/s]
2021-10-11 10:23:07,988 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 185.32it/s]
2021-10-11 10:23:08,566 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 202.60it/s]
2021-10-11 10:23:09,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 204.14it/s]
2021-10-11 10:23:09,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 201.11it/s]
2021-10-11 10:23:10,202 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 200.19it/s]
2021-10-11 10:23:10,728 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 204.62it/s]
2021-10-11 10:23:11,259 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 179.61it/s]
2021-10-11 10:23:11,814 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 186.76it/s]
2021-10-11 10:23:12,348 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 170.63it/s]
2021-10-11 10:23:12,905 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 197.69it/s]
2021-10-11 10:23:13,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 192.03it/s]
2021-10-11 10:23:14,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 196.81it/s]
2021-10-11 10:23:14,555 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 201.66it/s]
2021-10-11 10:23:15,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 199.15it/s]
2021-10-11 10:23:15,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 206.00it/s]
2021-10-11 10:23:16,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 198.90it/s]
2021-10-11 10:23:16,695 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 198.90it/s]
2021-10-11 10:23:17,232 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3333333333333333
100%|██████████| 22/22 [00:00<00:00, 195.83it/s]
2021-10-11 10:23:17,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 196.79it/s]
2021-10-11 10:23:18,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 205.38it/s]
2021-10-11 10:23:18,846 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
2021-10-11 10:23:18,848 knodle.trainer.trainer INFO     Train avg loss: 0.1308446177811258
2021-10-11 10:23:18,848 knodle.trainer.trainer INFO     Train avg accuracy: 0.9419243938657975
2021-10-11 10:23:18,848 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:23:18,848 knodle.trainer.trainer INFO     Training done
2021-10-11 10:23:18,848 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 137.83it/s]
2021-10-11 10:23:19,017 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.236955642700195). Denoising stops.
2021-10-11 10:23:19,017 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 47.02it/s]
2021-10-11 10:23:19,505 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:23:19,505 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:23:19,505 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:23:20,502 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:23:20,561 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:23:20,780 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5352, samples in test set: 382
2021-10-11 10:23:20,990 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4020, samples in test set: 1714
2021-10-11 10:23:21,200 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4539, samples in test set: 1195
Accuracy is: 0.322843391336542
Precision is: 0.5155660377358491
Recall is: 0.5417305567769086
F1 is: 0.2965702143425588
{'0': {'precision': 0.9418918918918919, 'recall': 0.2807088199758357, 'f1-score': 0.4325162891715793, 'support': 2483}, '1': {'precision': 0.08924018357980622, 'recall': 0.8027522935779816, 'f1-score': 0.16062413951353832, 'support': 218}, 'accuracy': 0.322843391336542, 'macro avg': {'precision': 0.5155660377358491, 'recall': 0.5417305567769086, 'f1-score': 0.2965702143425588, 'support': 2701}, 'weighted avg': {'precision': 0.8730736496067995, 'recall': 0.322843391336542, 'f1-score': 0.4105716432532332, 'support': 2701}}
2021-10-11 10:23:21,426 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4049, samples in test set: 1685
2021-10-11 10:23:21,646 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4976, samples in test set: 758
5it [02:16, 27.22s/it]
2021-10-11 10:25:37,860 knodle.trainer.cleanlab.cleanlab INFO     [[0.11406969 0.88593031]
 [0.04847397 0.95152603]
 [0.33951763 0.66048237]
 [0.01356589 0.98643411]
 [0.82845052 0.17154948]
 [0.97557003 0.02442997]
 [0.92465753 0.07534247]
 [0.06818182 0.93181818]
 [0.10294118 0.89705882]]
2021-10-11 10:25:37,964 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 193 out of 5734
2021-10-11 10:25:37,965 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:25:37,965 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:25:37,965 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 64.57it/s]
2021-10-11 10:25:39,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21380291711134827
100%|██████████| 22/22 [00:00<00:00, 140.73it/s]
2021-10-11 10:25:39,706 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 193.26it/s]
2021-10-11 10:25:40,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21878335112059766
100%|██████████| 22/22 [00:00<00:00, 204.39it/s]
2021-10-11 10:25:40,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.1967271433653504
100%|██████████| 22/22 [00:00<00:00, 199.61it/s]
2021-10-11 10:25:41,515 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 198.98it/s]
2021-10-11 10:25:42,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 201.00it/s]
2021-10-11 10:25:42,556 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 200.95it/s]
2021-10-11 10:25:43,089 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 201.23it/s]
2021-10-11 10:25:43,609 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21344717182497333
100%|██████████| 22/22 [00:00<00:00, 204.60it/s]
2021-10-11 10:25:44,127 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 196.41it/s]
2021-10-11 10:25:44,647 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 194.26it/s]
2021-10-11 10:25:45,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 196.63it/s]
2021-10-11 10:25:45,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23194592671647102
100%|██████████| 22/22 [00:00<00:00, 181.75it/s]
2021-10-11 10:25:46,303 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 194.57it/s]
2021-10-11 10:25:46,852 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 184.09it/s]
2021-10-11 10:25:47,407 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 186.18it/s]
2021-10-11 10:25:47,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 192.13it/s]
2021-10-11 10:25:48,544 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3408039843472074
100%|██████████| 22/22 [00:00<00:00, 193.43it/s]
2021-10-11 10:25:49,155 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 159.12it/s]
2021-10-11 10:25:49,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 191.75it/s]
2021-10-11 10:25:50,353 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 191.44it/s]
2021-10-11 10:25:50,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 189.51it/s]
2021-10-11 10:25:51,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 195.79it/s]
2021-10-11 10:25:51,987 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 202.02it/s]
2021-10-11 10:25:52,493 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 205.95it/s]
2021-10-11 10:25:53,026 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 196.00it/s]
2021-10-11 10:25:53,553 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 191.87it/s]
2021-10-11 10:25:54,076 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 88.76it/s]
2021-10-11 10:25:54,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 187.69it/s]
2021-10-11 10:25:55,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 180.83it/s]
2021-10-11 10:25:55,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 196.89it/s]
2021-10-11 10:25:56,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 201.87it/s]
2021-10-11 10:25:56,970 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23728210601209535
100%|██████████| 22/22 [00:00<00:00, 199.64it/s]
2021-10-11 10:25:57,489 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 200.56it/s]
2021-10-11 10:25:58,018 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 209.54it/s]
2021-10-11 10:25:58,538 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 199.47it/s]
2021-10-11 10:25:59,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 204.64it/s]
2021-10-11 10:25:59,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 196.87it/s]
2021-10-11 10:26:00,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 198.89it/s]
2021-10-11 10:26:00,631 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 198.75it/s]
2021-10-11 10:26:01,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 197.75it/s]
2021-10-11 10:26:01,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 176.13it/s]
2021-10-11 10:26:02,257 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 184.87it/s]
2021-10-11 10:26:02,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 190.82it/s]
2021-10-11 10:26:03,396 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 195.64it/s]
2021-10-11 10:26:03,931 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 197.67it/s]
2021-10-11 10:26:04,491 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 199.70it/s]
2021-10-11 10:26:05,032 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 187.14it/s]
2021-10-11 10:26:05,571 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 196.21it/s]
2021-10-11 10:26:06,111 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 195.75it/s]
2021-10-11 10:26:06,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 195.86it/s]
2021-10-11 10:26:07,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 211.12it/s]
2021-10-11 10:26:07,689 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 184.92it/s]
2021-10-11 10:26:08,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 185.10it/s]
2021-10-11 10:26:08,783 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 192.25it/s]
2021-10-11 10:26:09,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 189.78it/s]
2021-10-11 10:26:09,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 204.48it/s]
2021-10-11 10:26:10,397 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 203.03it/s]
2021-10-11 10:26:10,920 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 197.99it/s]
2021-10-11 10:26:11,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 195.88it/s]
2021-10-11 10:26:11,964 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 203.36it/s]
2021-10-11 10:26:12,502 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 207.29it/s]
2021-10-11 10:26:13,027 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 203.79it/s]
2021-10-11 10:26:13,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 196.09it/s]
2021-10-11 10:26:14,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 186.36it/s]
2021-10-11 10:26:14,637 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 195.73it/s]
2021-10-11 10:26:15,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 196.59it/s]
2021-10-11 10:26:15,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 191.43it/s]
2021-10-11 10:26:16,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 190.39it/s]
2021-10-11 10:26:16,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 196.16it/s]
2021-10-11 10:26:17,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 187.34it/s]
2021-10-11 10:26:17,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 193.40it/s]
2021-10-11 10:26:18,405 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 191.06it/s]
2021-10-11 10:26:18,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 192.45it/s]
2021-10-11 10:26:19,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 195.63it/s]
2021-10-11 10:26:20,018 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 191.46it/s]
2021-10-11 10:26:20,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33475631447883314
100%|██████████| 22/22 [00:00<00:00, 205.39it/s]
2021-10-11 10:26:21,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 205.04it/s]
2021-10-11 10:26:21,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 202.81it/s]
2021-10-11 10:26:22,135 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 202.02it/s]
2021-10-11 10:26:22,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 200.46it/s]
2021-10-11 10:26:23,187 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 200.64it/s]
2021-10-11 10:26:23,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 195.53it/s]
2021-10-11 10:26:24,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 193.50it/s]
2021-10-11 10:26:24,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 195.34it/s]
2021-10-11 10:26:25,375 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 191.20it/s]
2021-10-11 10:26:25,919 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 192.79it/s]
2021-10-11 10:26:26,456 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 181.28it/s]
2021-10-11 10:26:26,996 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 196.72it/s]
2021-10-11 10:26:27,548 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 200.23it/s]
2021-10-11 10:26:28,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 200.90it/s]
2021-10-11 10:26:28,582 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 188.24it/s]
2021-10-11 10:26:29,124 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 188.19it/s]
2021-10-11 10:26:29,679 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 198.78it/s]
2021-10-11 10:26:30,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 196.72it/s]
2021-10-11 10:26:30,749 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 197.34it/s]
2021-10-11 10:26:31,274 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 197.09it/s]
2021-10-11 10:26:31,793 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 198.74it/s]
2021-10-11 10:26:32,325 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 184.67it/s]
2021-10-11 10:26:32,879 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
2021-10-11 10:26:32,880 knodle.trainer.trainer INFO     Train avg loss: 0.1341875921587149
2021-10-11 10:26:32,880 knodle.trainer.trainer INFO     Train avg accuracy: 0.9402052353090709
2021-10-11 10:26:32,880 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:26:32,880 knodle.trainer.trainer INFO     Training done
2021-10-11 10:26:32,880 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 146.07it/s]
2021-10-11 10:26:33,040 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.930298719772404, 'recall': 0.24952308279282717, 'f1-score': 0.3935018050541516, 'support': 2621}, '1': {'precision': 0.06688804554079697, 'recall': 0.7421052631578947, 'f1-score': 0.1227154046997389, 'support': 190}, 'accuracy': 0.28281750266808964, 'macro avg': {'precision': 0.49859338265660047, 'recall': 0.49581417297536096, 'f1-score': 0.25810860487694526, 'support': 2811}, 'weighted avg': {'precision': 0.8719394070352978, 'recall': 0.28281750266808964, 'f1-score': 0.37519891780145204, 'support': 2811}}, Dev loss: 3.481957197189331, denoising continues.
2021-10-11 10:26:33,040 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:26:33,066 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:26:33,314 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4701, samples in test set: 1033
2021-10-11 10:26:33,433 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5098, samples in test set: 636
2021-10-11 10:26:33,549 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5592, samples in test set: 142
2021-10-11 10:26:33,672 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3713, samples in test set: 2021
2021-10-11 10:26:33,793 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3832, samples in test set: 1902
5it [02:51, 34.39s/it]
2021-10-11 10:29:25,814 knodle.trainer.cleanlab.cleanlab INFO     [[0.0593985  0.9406015 ]
 [0.00675676 0.99324324]
 [0.07944732 0.92055268]
 [0.0201005  0.9798995 ]
 [0.95       0.05      ]
 [0.98894349 0.01105651]
 [0.98529412 0.01470588]
 [0.02941176 0.97058824]
 [0.01923077 0.98076923]]
2021-10-11 10:29:26,005 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 215 out of 5734
2021-10-11 10:29:26,007 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:29:26,007 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:29:26,007 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 58.74it/s]
2021-10-11 10:29:27,426 knodle.trainer.trainer INFO     Epoch development accuracy: 0.4372109569548204
100%|██████████| 22/22 [00:00<00:00, 147.11it/s]
2021-10-11 10:29:28,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.46531483457844186
100%|██████████| 22/22 [00:00<00:00, 120.02it/s]
2021-10-11 10:29:28,891 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3898968338669513
100%|██████████| 22/22 [00:00<00:00, 153.81it/s]
2021-10-11 10:29:29,506 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38135894699395234
100%|██████████| 22/22 [00:00<00:00, 102.29it/s]
2021-10-11 10:29:30,244 knodle.trainer.trainer INFO     Epoch development accuracy: 0.49413020277481323
100%|██████████| 22/22 [00:00<00:00, 142.79it/s]
2021-10-11 10:29:31,072 knodle.trainer.trainer INFO     Epoch development accuracy: 0.43472073995019567
100%|██████████| 22/22 [00:00<00:00, 152.14it/s]
2021-10-11 10:29:31,788 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36357168267520457
100%|██████████| 22/22 [00:00<00:00, 187.36it/s]
2021-10-11 10:29:32,366 knodle.trainer.trainer INFO     Epoch development accuracy: 0.40626111704019924
100%|██████████| 22/22 [00:00<00:00, 173.86it/s]
2021-10-11 10:29:33,024 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3660618996798292
100%|██████████| 22/22 [00:00<00:00, 136.80it/s]
2021-10-11 10:29:33,683 knodle.trainer.trainer INFO     Epoch development accuracy: 0.4041266453219495
100%|██████████| 22/22 [00:00<00:00, 142.84it/s]
2021-10-11 10:29:34,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3464959089292067
100%|██████████| 22/22 [00:00<00:00, 190.19it/s]
2021-10-11 10:29:34,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3831376734258271
100%|██████████| 22/22 [00:00<00:00, 144.15it/s]
2021-10-11 10:29:35,530 knodle.trainer.trainer INFO     Epoch development accuracy: 0.39025257915332623
100%|██████████| 22/22 [00:00<00:00, 169.29it/s]
2021-10-11 10:29:36,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3721095695482035
100%|██████████| 22/22 [00:00<00:00, 166.38it/s]
2021-10-11 10:29:36,867 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 173.99it/s]
2021-10-11 10:29:37,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37246531483457845
100%|██████████| 22/22 [00:00<00:00, 173.52it/s]
2021-10-11 10:29:38,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3504091070793312
100%|██████████| 22/22 [00:00<00:00, 194.24it/s]
2021-10-11 10:29:38,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3749555318392031
100%|██████████| 22/22 [00:00<00:00, 168.50it/s]
2021-10-11 10:29:39,321 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34436143721095697
100%|██████████| 22/22 [00:00<00:00, 190.27it/s]
2021-10-11 10:29:39,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3646389185343294
100%|██████████| 22/22 [00:00<00:00, 179.99it/s]
2021-10-11 10:29:40,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35396655994308074
100%|██████████| 22/22 [00:00<00:00, 179.49it/s]
2021-10-11 10:29:41,242 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3657061543934543
100%|██████████| 22/22 [00:00<00:00, 200.34it/s]
2021-10-11 10:29:41,801 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36036997509783
100%|██████████| 22/22 [00:00<00:00, 180.29it/s]
2021-10-11 10:29:42,355 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35859124866595515
100%|██████████| 22/22 [00:00<00:00, 196.98it/s]
2021-10-11 10:29:42,891 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35965848452508004
100%|██████████| 22/22 [00:00<00:00, 149.07it/s]
2021-10-11 10:29:43,548 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35894699395233015
100%|██████████| 22/22 [00:00<00:00, 122.39it/s]
2021-10-11 10:29:44,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 144.13it/s]
2021-10-11 10:29:45,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36890786197082887
100%|██████████| 22/22 [00:00<00:00, 154.50it/s]
2021-10-11 10:29:45,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34187122020633226
100%|██████████| 22/22 [00:00<00:00, 183.90it/s]
2021-10-11 10:29:46,636 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3717538242618285
100%|██████████| 22/22 [00:00<00:00, 139.67it/s]
2021-10-11 10:29:47,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36535040910707933
100%|██████████| 22/22 [00:00<00:00, 145.24it/s]
2021-10-11 10:29:47,968 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38669512628957664
100%|██████████| 22/22 [00:00<00:00, 74.96it/s]
2021-10-11 10:29:49,041 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 192.95it/s]
2021-10-11 10:29:49,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3874066168623266
100%|██████████| 22/22 [00:00<00:00, 154.19it/s]
2021-10-11 10:29:50,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3464959089292067
100%|██████████| 22/22 [00:00<00:00, 192.59it/s]
2021-10-11 10:29:51,140 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37566702241195304
100%|██████████| 22/22 [00:00<00:00, 150.44it/s]
2021-10-11 10:29:51,736 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3617929562433298
100%|██████████| 22/22 [00:00<00:00, 128.92it/s]
2021-10-11 10:29:53,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3660618996798292
100%|██████████| 22/22 [00:00<00:00, 127.21it/s]
2021-10-11 10:29:54,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3511205976520811
100%|██████████| 22/22 [00:00<00:00, 148.47it/s]
2021-10-11 10:29:55,050 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 107.81it/s]
2021-10-11 10:29:55,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.368196371398079
100%|██████████| 22/22 [00:00<00:00, 131.55it/s]
2021-10-11 10:29:56,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 156.27it/s]
2021-10-11 10:29:57,822 knodle.trainer.trainer INFO     Epoch development accuracy: 0.376022767698328
100%|██████████| 22/22 [00:00<00:00, 154.70it/s]
2021-10-11 10:29:58,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.392031305585201
100%|██████████| 22/22 [00:00<00:00, 197.96it/s]
2021-10-11 10:29:59,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3824261828530772
100%|██████████| 22/22 [00:00<00:00, 142.90it/s]
2021-10-11 10:29:59,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 187.52it/s]
2021-10-11 10:30:00,428 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 135.70it/s]
2021-10-11 10:30:01,199 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3945215225898257
100%|██████████| 22/22 [00:00<00:00, 127.32it/s]
2021-10-11 10:30:01,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3799359658484525
100%|██████████| 22/22 [00:00<00:00, 189.22it/s]
2021-10-11 10:30:02,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36890786197082887
100%|██████████| 22/22 [00:00<00:00, 151.36it/s]
2021-10-11 10:30:03,259 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3852721451440768
100%|██████████| 22/22 [00:00<00:00, 167.10it/s]
2021-10-11 10:30:03,893 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 184.36it/s]
2021-10-11 10:30:04,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3632159373888296
100%|██████████| 22/22 [00:00<00:00, 186.27it/s]
2021-10-11 10:30:05,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 192.22it/s]
2021-10-11 10:30:05,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3753112771255781
100%|██████████| 22/22 [00:00<00:00, 196.50it/s]
2021-10-11 10:30:06,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 210.88it/s]
2021-10-11 10:30:06,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33795802205620773
100%|██████████| 22/22 [00:00<00:00, 196.45it/s]
2021-10-11 10:30:07,277 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 199.56it/s]
2021-10-11 10:30:07,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35894699395233015
100%|██████████| 22/22 [00:00<00:00, 140.23it/s]
2021-10-11 10:30:08,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 176.66it/s]
2021-10-11 10:30:09,067 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3368907861970829
100%|██████████| 22/22 [00:00<00:00, 176.04it/s]
2021-10-11 10:30:09,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3767342582710779
100%|██████████| 22/22 [00:00<00:00, 202.08it/s]
2021-10-11 10:30:10,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 196.17it/s]
2021-10-11 10:30:10,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3721095695482035
100%|██████████| 22/22 [00:00<00:00, 132.10it/s]
2021-10-11 10:30:11,518 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3447171824973319
100%|██████████| 22/22 [00:00<00:00, 186.09it/s]
2021-10-11 10:30:12,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.38135894699395234
100%|██████████| 22/22 [00:00<00:00, 97.11it/s]
2021-10-11 10:30:13,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33938100320170755
100%|██████████| 22/22 [00:00<00:00, 126.41it/s]
2021-10-11 10:30:14,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 117.47it/s]
2021-10-11 10:30:14,924 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3785129847029527
100%|██████████| 22/22 [00:00<00:00, 83.29it/s]
2021-10-11 10:30:16,320 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3550337958022056
100%|██████████| 22/22 [00:00<00:00, 59.61it/s]
2021-10-11 10:30:18,304 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33724653148345785
100%|██████████| 22/22 [00:00<00:00, 112.84it/s]
2021-10-11 10:30:20,090 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36784062611170404
100%|██████████| 22/22 [00:00<00:00, 131.82it/s]
2021-10-11 10:30:21,046 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34187122020633226
100%|██████████| 22/22 [00:00<00:00, 154.80it/s]
2021-10-11 10:30:21,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35076485236570615
100%|██████████| 22/22 [00:00<00:00, 186.07it/s]
2021-10-11 10:30:22,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 158.22it/s]
2021-10-11 10:30:23,231 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3493418712202063
100%|██████████| 22/22 [00:00<00:00, 105.00it/s]
2021-10-11 10:30:24,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 127.30it/s]
2021-10-11 10:30:25,433 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33724653148345785
100%|██████████| 22/22 [00:00<00:00, 113.99it/s]
2021-10-11 10:30:26,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37637851298470293
100%|██████████| 22/22 [00:00<00:00, 88.99it/s]
2021-10-11 10:30:27,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3671291355389541
100%|██████████| 22/22 [00:00<00:00, 104.47it/s]
2021-10-11 10:30:28,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3368907861970829
100%|██████████| 22/22 [00:00<00:00, 109.92it/s]
2021-10-11 10:30:29,220 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3550337958022056
100%|██████████| 22/22 [00:00<00:00, 86.85it/s]
2021-10-11 10:30:30,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3550337958022056
100%|██████████| 22/22 [00:00<00:00, 97.19it/s]
2021-10-11 10:30:31,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 65.36it/s]
2021-10-11 10:30:33,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3457844183564568
100%|██████████| 22/22 [00:00<00:00, 139.14it/s]
2021-10-11 10:30:35,669 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 132.49it/s]
2021-10-11 10:30:36,542 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 122.20it/s]
2021-10-11 10:30:37,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 93.42it/s]
2021-10-11 10:30:38,877 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 105.99it/s]
2021-10-11 10:30:40,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 115.01it/s]
2021-10-11 10:30:41,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35432230522945574
100%|██████████| 22/22 [00:00<00:00, 138.84it/s]
2021-10-11 10:30:42,616 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3639274279615795
100%|██████████| 22/22 [00:00<00:00, 121.42it/s]
2021-10-11 10:30:43,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 123.77it/s]
2021-10-11 10:30:44,378 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35183208822483103
100%|██████████| 22/22 [00:00<00:00, 135.10it/s]
2021-10-11 10:30:45,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3749555318392031
100%|██████████| 22/22 [00:00<00:00, 91.35it/s]
2021-10-11 10:30:46,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34436143721095697
100%|██████████| 22/22 [00:00<00:00, 138.72it/s]
2021-10-11 10:30:46,970 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3685521166844539
100%|██████████| 22/22 [00:00<00:00, 122.40it/s]
2021-10-11 10:30:47,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3593027392387051
100%|██████████| 22/22 [00:00<00:00, 100.61it/s]
2021-10-11 10:30:48,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35076485236570615
100%|██████████| 22/22 [00:00<00:00, 134.17it/s]
2021-10-11 10:30:49,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33866951262895767
2021-10-11 10:30:49,561 knodle.trainer.trainer INFO     Train avg loss: 0.1288388221748174
2021-10-11 10:30:49,562 knodle.trainer.trainer INFO     Train avg accuracy: 0.9421442671351958
2021-10-11 10:30:49,562 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:30:49,562 knodle.trainer.trainer INFO     Training done
2021-10-11 10:30:49,562 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 92.46it/s]
2021-10-11 10:30:49,816 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.9407007694244385). Denoising stops.
2021-10-11 10:30:49,817 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 35.14it/s]
Accuracy is: 0.3683820807108478
Precision is: 0.5212131103002494
Recall is: 0.5623145647282253
F1 is: 0.3296811265310873
{'0': {'precision': 0.9480968858131488, 'recall': 0.3310511478050745, 'f1-score': 0.49074626865671644, 'support': 2483}, '1': {'precision': 0.09432933478735006, 'recall': 0.7935779816513762, 'f1-score': 0.1686159844054581, 'support': 218}, 'accuracy': 0.3683820807108478, 'macro avg': {'precision': 0.5212131103002494, 'recall': 0.5623145647282253, 'f1-score': 0.3296811265310873, 'support': 2701}, 'weighted avg': {'precision': 0.8791885829165831, 'recall': 0.3683820807108478, 'f1-score': 0.46474686030174633, 'support': 2701}}
2021-10-11 10:30:50,461 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:30:50,461 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:30:50,461 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:30:52,005 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:30:52,059 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:30:52,432 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3563, samples in test set: 2171
2021-10-11 10:30:52,774 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4806, samples in test set: 928
2021-10-11 10:30:53,283 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5458, samples in test set: 276
2021-10-11 10:30:53,852 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5166, samples in test set: 568
2021-10-11 10:30:54,485 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3943, samples in test set: 1791
5it [04:24, 52.89s/it]
2021-10-11 10:35:18,987 knodle.trainer.cleanlab.cleanlab INFO     [[0.16716777 0.83283223]
 [0.0408805  0.9591195 ]
 [0.26782274 0.73217726]
 [0.11924686 0.88075314]
 [0.798125   0.201875  ]
 [0.97797716 0.02202284]
 [0.88425926 0.11574074]
 [0.02       0.98      ]
 [0.03947368 0.96052632]]
2021-10-11 10:35:19,219 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 212 out of 5734
2021-10-11 10:35:19,227 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:35:19,228 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:35:19,228 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 26.66it/s]
2021-10-11 10:35:21,740 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21380291711134827
100%|██████████| 22/22 [00:00<00:00, 88.35it/s]
2021-10-11 10:35:22,801 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21487015297047315
100%|██████████| 22/22 [00:00<00:00, 63.06it/s]
2021-10-11 10:35:23,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21664887940234792
100%|██████████| 22/22 [00:00<00:00, 89.22it/s]
2021-10-11 10:35:25,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20135183208822482
100%|██████████| 22/22 [00:00<00:00, 87.19it/s]
2021-10-11 10:35:26,356 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22056207755247242
100%|██████████| 22/22 [00:00<00:00, 103.22it/s]
2021-10-11 10:35:27,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 105.38it/s]
2021-10-11 10:35:28,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20917822838847386
100%|██████████| 22/22 [00:00<00:00, 96.68it/s]
2021-10-11 10:35:29,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 59.72it/s]
2021-10-11 10:35:30,789 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 103.75it/s]
2021-10-11 10:35:31,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 91.57it/s]
2021-10-11 10:35:33,231 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 59.68it/s]
2021-10-11 10:35:34,534 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23087869085734614
100%|██████████| 22/22 [00:00<00:00, 89.81it/s]
2021-10-11 10:35:35,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 100.88it/s]
2021-10-11 10:35:36,812 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 57.36it/s]
2021-10-11 10:35:38,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 79.53it/s]
2021-10-11 10:35:39,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 100.43it/s]
2021-10-11 10:35:41,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 98.21it/s]
2021-10-11 10:35:42,325 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 94.77it/s]
2021-10-11 10:35:43,495 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 102.91it/s]
2021-10-11 10:35:44,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 123.34it/s]
2021-10-11 10:35:45,475 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 101.75it/s]
2021-10-11 10:35:46,596 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23087869085734614
100%|██████████| 22/22 [00:00<00:00, 113.80it/s]
2021-10-11 10:35:47,544 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 93.41it/s]
2021-10-11 10:35:48,553 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 107.53it/s]
2021-10-11 10:35:49,614 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 107.49it/s]
2021-10-11 10:35:50,549 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 110.85it/s]
2021-10-11 10:35:51,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 114.39it/s]
2021-10-11 10:35:52,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 121.73it/s]
2021-10-11 10:35:53,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 121.12it/s]
2021-10-11 10:35:54,202 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 127.76it/s]
2021-10-11 10:35:55,050 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 135.56it/s]
2021-10-11 10:35:55,871 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 130.12it/s]
2021-10-11 10:35:56,693 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 130.31it/s]
2021-10-11 10:35:57,494 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 120.70it/s]
2021-10-11 10:35:58,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 100.23it/s]
2021-10-11 10:35:59,200 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 95.65it/s]
2021-10-11 10:36:00,138 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 128.66it/s]
2021-10-11 10:36:00,976 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 133.20it/s]
2021-10-11 10:36:01,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 124.66it/s]
2021-10-11 10:36:02,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23301316257559587
100%|██████████| 22/22 [00:00<00:00, 123.33it/s]
2021-10-11 10:36:03,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 130.38it/s]
2021-10-11 10:36:04,294 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 121.57it/s]
2021-10-11 10:36:05,246 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 98.84it/s]
2021-10-11 10:36:06,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 107.57it/s]
2021-10-11 10:36:07,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 125.08it/s]
2021-10-11 10:36:08,010 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 141.43it/s]
2021-10-11 10:36:08,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 124.76it/s]
2021-10-11 10:36:09,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 125.56it/s]
2021-10-11 10:36:10,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 139.00it/s]
2021-10-11 10:36:11,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 139.09it/s]
2021-10-11 10:36:12,032 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 134.29it/s]
2021-10-11 10:36:12,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 140.30it/s]
2021-10-11 10:36:13,590 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 134.58it/s]
2021-10-11 10:36:14,341 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 139.27it/s]
2021-10-11 10:36:15,110 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 113.30it/s]
2021-10-11 10:36:15,927 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 88.28it/s]
2021-10-11 10:36:17,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 96.86it/s]
2021-10-11 10:36:18,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 59.26it/s]
2021-10-11 10:36:20,209 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 58.32it/s]
2021-10-11 10:36:22,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 47.85it/s]
2021-10-11 10:36:24,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 75.84it/s]
2021-10-11 10:36:25,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 72.99it/s]
2021-10-11 10:36:26,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 88.69it/s]
2021-10-11 10:36:28,199 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 114.24it/s]
2021-10-11 10:36:29,248 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 55.79it/s]
2021-10-11 10:36:30,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 93.74it/s]
2021-10-11 10:36:32,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 101.80it/s]
2021-10-11 10:36:33,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 43.40it/s]
2021-10-11 10:36:35,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 98.59it/s]
2021-10-11 10:36:36,553 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 96.24it/s]
2021-10-11 10:36:37,575 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 80.37it/s]
2021-10-11 10:36:38,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 70.80it/s]
2021-10-11 10:36:40,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 83.37it/s]
2021-10-11 10:36:41,842 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 116.35it/s]
2021-10-11 10:36:43,003 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 107.27it/s]
2021-10-11 10:36:44,116 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 117.38it/s]
2021-10-11 10:36:45,272 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 85.57it/s]
2021-10-11 10:36:46,281 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 104.60it/s]
2021-10-11 10:36:47,455 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 116.70it/s]
2021-10-11 10:36:48,466 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 83.93it/s]
2021-10-11 10:36:49,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 53.53it/s]
2021-10-11 10:36:51,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 66.42it/s]
2021-10-11 10:36:52,685 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 67.47it/s]
2021-10-11 10:36:54,552 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 81.17it/s]
2021-10-11 10:36:56,080 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 43.89it/s]
2021-10-11 10:36:57,716 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 56.15it/s]
2021-10-11 10:36:59,842 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 65.93it/s]
2021-10-11 10:37:01,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 83.25it/s]
2021-10-11 10:37:02,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 93.72it/s]
2021-10-11 10:37:04,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 111.92it/s]
2021-10-11 10:37:05,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 117.95it/s]
2021-10-11 10:37:06,393 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 113.30it/s]
2021-10-11 10:37:07,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 66.48it/s]
2021-10-11 10:37:09,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 93.58it/s]
2021-10-11 10:37:10,402 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 126.60it/s]
2021-10-11 10:37:11,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 96.15it/s]
2021-10-11 10:37:12,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 106.94it/s]
2021-10-11 10:37:13,488 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 97.22it/s]
2021-10-11 10:37:14,468 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 106.72it/s]
2021-10-11 10:37:15,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
2021-10-11 10:37:15,417 knodle.trainer.trainer INFO     Train avg loss: 0.1348538112673494
2021-10-11 10:37:15,418 knodle.trainer.trainer INFO     Train avg accuracy: 0.9398931097057134
2021-10-11 10:37:15,418 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:37:15,418 knodle.trainer.trainer INFO     Training done
2021-10-11 10:37:15,418 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 84.39it/s]
2021-10-11 10:37:15,701 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9447236180904522, 'recall': 0.21518504387638307, 'f1-score': 0.35052827843380985, 'support': 2621}, '1': {'precision': 0.07091237579042457, 'recall': 0.8263157894736842, 'f1-score': 0.1306156405990017, 'support': 190}, 'accuracy': 0.2564923514763429, 'macro avg': {'precision': 0.5078179969404384, 'recall': 0.5207504166750336, 'f1-score': 0.24057195951640575, 'support': 2811}, 'weighted avg': {'precision': 0.8856613142708131, 'recall': 0.2564923514763429, 'f1-score': 0.33566403041224685, 'support': 2811}}, Dev loss: 3.6170029640197754, denoising continues.
2021-10-11 10:37:15,701 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:37:15,769 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:37:17,763 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4990, samples in test set: 744
2021-10-11 10:37:18,207 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4013, samples in test set: 1721
2021-10-11 10:37:18,583 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5152, samples in test set: 582
2021-10-11 10:37:19,035 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4170, samples in test set: 1564
2021-10-11 10:37:19,494 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4611, samples in test set: 1123
5it [04:25, 53.07s/it]
2021-10-11 10:41:44,917 knodle.trainer.cleanlab.cleanlab INFO     [[0.02447042 0.97552958]
 [0.0072314  0.9927686 ]
 [0.09153318 0.90846682]
 [0.06345178 0.93654822]
 [0.95442115 0.04557885]
 [0.99030172 0.00969828]
 [0.97206704 0.02793296]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 10:41:45,158 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 42 out of 5734
2021-10-11 10:41:45,160 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:41:45,161 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:41:45,161 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 23.29it/s]
2021-10-11 10:41:48,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 90.39it/s]
2021-10-11 10:41:49,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 100.88it/s]
2021-10-11 10:41:50,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 87.75it/s]
2021-10-11 10:41:51,985 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 116.35it/s]
2021-10-11 10:41:52,953 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 128.84it/s]
2021-10-11 10:41:53,866 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 107.21it/s]
2021-10-11 10:41:54,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 120.57it/s]
2021-10-11 10:41:55,851 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 93.85it/s]
2021-10-11 10:41:57,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 115.73it/s]
2021-10-11 10:41:58,090 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 38.74it/s]
2021-10-11 10:41:59,547 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 129.93it/s]
2021-10-11 10:42:00,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 129.61it/s]
2021-10-11 10:42:01,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 135.39it/s]
2021-10-11 10:42:02,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 98.30it/s]
2021-10-11 10:42:03,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 115.43it/s]
2021-10-11 10:42:04,624 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 97.27it/s]
2021-10-11 10:42:05,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 124.93it/s]
2021-10-11 10:42:06,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 121.20it/s]
2021-10-11 10:42:07,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 129.83it/s]
2021-10-11 10:42:08,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 149.62it/s]
2021-10-11 10:42:08,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 103.34it/s]
2021-10-11 10:42:09,877 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 148.32it/s]
2021-10-11 10:42:10,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 140.28it/s]
2021-10-11 10:42:11,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 168.65it/s]
2021-10-11 10:42:12,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 125.13it/s]
2021-10-11 10:42:12,937 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 120.71it/s]
2021-10-11 10:42:13,709 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 155.88it/s]
2021-10-11 10:42:14,475 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 102.75it/s]
2021-10-11 10:42:15,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 90.87it/s]
2021-10-11 10:42:16,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 116.64it/s]
2021-10-11 10:42:17,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3244397011739594
100%|██████████| 22/22 [00:00<00:00, 145.94it/s]
2021-10-11 10:42:18,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 155.14it/s]
2021-10-11 10:42:19,065 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 153.07it/s]
2021-10-11 10:42:19,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 169.17it/s]
2021-10-11 10:42:20,424 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 132.83it/s]
2021-10-11 10:42:21,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 119.68it/s]
2021-10-11 10:42:21,921 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 56.70it/s]
2021-10-11 10:42:23,525 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 100.64it/s]
2021-10-11 10:42:25,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 101.59it/s]
2021-10-11 10:42:25,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 113.49it/s]
2021-10-11 10:42:26,916 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 115.77it/s]
2021-10-11 10:42:27,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 117.96it/s]
2021-10-11 10:42:28,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 161.79it/s]
2021-10-11 10:42:29,598 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 173.23it/s]
2021-10-11 10:42:30,238 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 167.41it/s]
2021-10-11 10:42:30,901 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 171.29it/s]
2021-10-11 10:42:31,529 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 177.59it/s]
2021-10-11 10:42:32,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 109.85it/s]
2021-10-11 10:42:32,843 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 153.37it/s]
2021-10-11 10:42:33,700 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 161.98it/s]
2021-10-11 10:42:34,397 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 133.95it/s]
2021-10-11 10:42:35,205 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 157.97it/s]
2021-10-11 10:42:36,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 147.30it/s]
2021-10-11 10:42:36,870 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 98.25it/s]
2021-10-11 10:42:37,914 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 95.34it/s]
2021-10-11 10:42:39,303 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 133.60it/s]
2021-10-11 10:42:40,487 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 78.77it/s]
2021-10-11 10:42:41,394 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 148.25it/s]
2021-10-11 10:42:42,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 140.95it/s]
2021-10-11 10:42:42,842 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 150.74it/s]
2021-10-11 10:42:43,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 143.39it/s]
2021-10-11 10:42:44,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 137.22it/s]
2021-10-11 10:42:45,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 115.62it/s]
2021-10-11 10:42:46,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 143.98it/s]
2021-10-11 10:42:47,061 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 142.26it/s]
2021-10-11 10:42:48,000 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34187122020633226
100%|██████████| 22/22 [00:00<00:00, 165.95it/s]
2021-10-11 10:42:48,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 166.01it/s]
2021-10-11 10:42:49,579 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 126.33it/s]
2021-10-11 10:42:50,362 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 105.30it/s]
2021-10-11 10:42:51,324 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 107.50it/s]
2021-10-11 10:42:52,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 122.27it/s]
2021-10-11 10:42:53,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 152.61it/s]
2021-10-11 10:42:54,004 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 124.92it/s]
2021-10-11 10:42:54,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 122.40it/s]
2021-10-11 10:42:55,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 132.27it/s]
2021-10-11 10:42:56,582 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 137.35it/s]
2021-10-11 10:42:57,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 116.47it/s]
2021-10-11 10:42:58,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 133.42it/s]
2021-10-11 10:42:59,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 121.81it/s]
2021-10-11 10:43:00,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 76.80it/s]
2021-10-11 10:43:01,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 99.60it/s]
2021-10-11 10:43:02,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 118.71it/s]
2021-10-11 10:43:03,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 129.65it/s]
2021-10-11 10:43:04,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 124.55it/s]
2021-10-11 10:43:04,908 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 139.29it/s]
2021-10-11 10:43:05,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 119.22it/s]
2021-10-11 10:43:06,553 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 135.61it/s]
2021-10-11 10:43:07,311 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 120.05it/s]
2021-10-11 10:43:08,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 131.07it/s]
2021-10-11 10:43:09,021 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 130.40it/s]
2021-10-11 10:43:09,908 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 119.98it/s]
2021-10-11 10:43:10,953 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 80.57it/s]
2021-10-11 10:43:12,291 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 78.96it/s]
2021-10-11 10:43:13,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 117.59it/s]
2021-10-11 10:43:14,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 120.07it/s]
2021-10-11 10:43:15,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 120.13it/s]
2021-10-11 10:43:16,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 106.95it/s]
2021-10-11 10:43:17,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 113.14it/s]
2021-10-11 10:43:18,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 76.48it/s]
2021-10-11 10:43:19,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
2021-10-11 10:43:19,804 knodle.trainer.trainer INFO     Train avg loss: 0.13120964930040965
2021-10-11 10:43:19,805 knodle.trainer.trainer INFO     Train avg accuracy: 0.9416518243153894
2021-10-11 10:43:19,805 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:43:19,805 knodle.trainer.trainer INFO     Training done
2021-10-11 10:43:19,805 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 75.53it/s]
2021-10-11 10:43:20,130 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.8151655197143555). Denoising stops.
2021-10-11 10:43:20,131 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 26.70it/s]
2021-10-11 10:43:20,991 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:43:20,991 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:43:20,991 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.3383931877082562
Precision is: 0.5173221870907988
Recall is: 0.5480958591818863
F1 is: 0.30800632827458463
{'0': {'precision': 0.9438775510204082, 'recall': 0.29802658074909383, 'f1-score': 0.453014998469544, 'support': 2483}, '1': {'precision': 0.09076682316118936, 'recall': 0.7981651376146789, 'f1-score': 0.1629976580796253, 'support': 218}, 'accuracy': 0.3383931877082562, 'macro avg': {'precision': 0.5173221870907988, 'recall': 0.5480958591818863, 'f1-score': 0.30800632827458463, 'support': 2701}, 'weighted avg': {'precision': 0.8750222608784941, 'recall': 0.3383931877082562, 'f1-score': 0.42960745304007264, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:43:22,649 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:43:22,710 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:43:23,027 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5271, samples in test set: 463
2021-10-11 10:43:23,383 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3710, samples in test set: 2024
2021-10-11 10:43:23,803 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3139, samples in test set: 2595
2021-10-11 10:43:24,227 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5581, samples in test set: 153
2021-10-11 10:43:24,577 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5235, samples in test set: 499
5it [03:39, 43.90s/it]
2021-10-11 10:47:04,164 knodle.trainer.cleanlab.cleanlab INFO     [[0.10323469 0.89676531]
 [0.04829545 0.95170455]
 [0.13265306 0.86734694]
 [0.13681592 0.86318408]
 [0.88771518 0.11228482]
 [0.9245283  0.0754717 ]
 [0.79573171 0.20426829]
 [0.04545455 0.95454545]
 [0.09375    0.90625   ]]
2021-10-11 10:47:04,383 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 200 out of 5734
2021-10-11 10:47:04,386 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:47:04,386 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:47:04,386 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 36.60it/s]
2021-10-11 10:47:06,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20846673781572395
100%|██████████| 22/22 [00:00<00:00, 169.76it/s]
2021-10-11 10:47:07,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 175.48it/s]
2021-10-11 10:47:07,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 154.09it/s]
2021-10-11 10:47:08,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 170.34it/s]
2021-10-11 10:47:09,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2209178228388474
100%|██████████| 22/22 [00:00<00:00, 154.08it/s]
2021-10-11 10:47:09,997 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 152.70it/s]
2021-10-11 10:47:10,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23016720028459622
100%|██████████| 22/22 [00:00<00:00, 164.66it/s]
2021-10-11 10:47:11,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 154.64it/s]
2021-10-11 10:47:11,973 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21664887940234792
100%|██████████| 22/22 [00:00<00:00, 137.06it/s]
2021-10-11 10:47:12,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2294557097118463
100%|██████████| 22/22 [00:00<00:00, 143.06it/s]
2021-10-11 10:47:13,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 174.33it/s]
2021-10-11 10:47:13,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 150.96it/s]
2021-10-11 10:47:14,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21415866239772324
100%|██████████| 22/22 [00:00<00:00, 181.71it/s]
2021-10-11 10:47:15,247 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 179.26it/s]
2021-10-11 10:47:15,830 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 183.45it/s]
2021-10-11 10:47:16,419 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 176.48it/s]
2021-10-11 10:47:17,051 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23479188900747064
100%|██████████| 22/22 [00:00<00:00, 221.35it/s]
2021-10-11 10:47:17,584 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 170.71it/s]
2021-10-11 10:47:18,159 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 186.34it/s]
2021-10-11 10:47:18,734 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 127.37it/s]
2021-10-11 10:47:19,414 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23194592671647102
100%|██████████| 22/22 [00:00<00:00, 173.74it/s]
2021-10-11 10:47:20,101 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 161.51it/s]
2021-10-11 10:47:20,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2248310209889719
100%|██████████| 22/22 [00:00<00:00, 174.43it/s]
2021-10-11 10:47:21,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 65.95it/s]
2021-10-11 10:47:22,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.247954464603344
100%|██████████| 22/22 [00:00<00:00, 194.66it/s]
2021-10-11 10:47:22,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 137.61it/s]
2021-10-11 10:47:23,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 180.86it/s]
2021-10-11 10:47:24,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 188.02it/s]
2021-10-11 10:47:24,691 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 167.63it/s]
2021-10-11 10:47:25,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 147.54it/s]
2021-10-11 10:47:26,118 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 189.44it/s]
2021-10-11 10:47:26,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 207.50it/s]
2021-10-11 10:47:27,377 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 146.11it/s]
2021-10-11 10:47:28,003 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2312344361437211
100%|██████████| 22/22 [00:00<00:00, 197.66it/s]
2021-10-11 10:47:28,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 191.35it/s]
2021-10-11 10:47:29,196 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 182.11it/s]
2021-10-11 10:47:29,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 204.54it/s]
2021-10-11 10:47:30,368 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 209.80it/s]
2021-10-11 10:47:30,934 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 178.84it/s]
2021-10-11 10:47:31,528 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 137.89it/s]
2021-10-11 10:47:32,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 142.20it/s]
2021-10-11 10:47:33,132 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22411953041622198
100%|██████████| 22/22 [00:00<00:00, 169.25it/s]
2021-10-11 10:47:33,803 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 183.10it/s]
2021-10-11 10:47:34,399 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 165.77it/s]
2021-10-11 10:47:35,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 170.17it/s]
2021-10-11 10:47:35,616 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 195.67it/s]
2021-10-11 10:47:36,509 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2102454642475987
100%|██████████| 22/22 [00:00<00:00, 205.18it/s]
2021-10-11 10:47:37,044 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3390252579153326
100%|██████████| 22/22 [00:00<00:00, 205.00it/s]
2021-10-11 10:47:37,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 210.14it/s]
2021-10-11 10:47:38,123 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 190.92it/s]
2021-10-11 10:47:38,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23265741728922093
100%|██████████| 22/22 [00:00<00:00, 205.56it/s]
2021-10-11 10:47:39,220 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 192.73it/s]
2021-10-11 10:47:39,796 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 201.29it/s]
2021-10-11 10:47:40,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 199.96it/s]
2021-10-11 10:47:40,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 176.72it/s]
2021-10-11 10:47:41,540 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 131.96it/s]
2021-10-11 10:47:42,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 144.82it/s]
2021-10-11 10:47:43,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 65.68it/s]
2021-10-11 10:47:44,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2408395588758449
100%|██████████| 22/22 [00:00<00:00, 201.23it/s]
2021-10-11 10:47:45,053 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 171.95it/s]
2021-10-11 10:47:45,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 186.26it/s]
2021-10-11 10:47:46,468 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 201.30it/s]
2021-10-11 10:47:47,010 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 206.85it/s]
2021-10-11 10:47:47,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 163.16it/s]
2021-10-11 10:47:48,103 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 196.06it/s]
2021-10-11 10:47:48,759 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 125.69it/s]
2021-10-11 10:47:49,448 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 106.25it/s]
2021-10-11 10:47:50,279 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 179.78it/s]
2021-10-11 10:47:50,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 161.85it/s]
2021-10-11 10:47:51,609 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 184.30it/s]
2021-10-11 10:47:52,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 153.53it/s]
2021-10-11 10:47:52,841 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 179.69it/s]
2021-10-11 10:47:53,481 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 166.60it/s]
2021-10-11 10:47:54,197 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 201.73it/s]
2021-10-11 10:47:54,809 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 118.57it/s]
2021-10-11 10:47:55,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2312344361437211
100%|██████████| 22/22 [00:00<00:00, 136.52it/s]
2021-10-11 10:47:56,418 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 189.94it/s]
2021-10-11 10:47:57,378 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 159.01it/s]
2021-10-11 10:47:58,177 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 176.86it/s]
2021-10-11 10:47:58,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 158.24it/s]
2021-10-11 10:47:59,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 186.21it/s]
2021-10-11 10:48:00,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 156.06it/s]
2021-10-11 10:48:01,029 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 187.90it/s]
2021-10-11 10:48:01,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 160.54it/s]
2021-10-11 10:48:02,325 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 198.72it/s]
2021-10-11 10:48:02,937 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 200.42it/s]
2021-10-11 10:48:03,552 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 154.00it/s]
2021-10-11 10:48:04,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 181.00it/s]
2021-10-11 10:48:04,743 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 161.87it/s]
2021-10-11 10:48:05,399 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 175.71it/s]
2021-10-11 10:48:06,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 167.01it/s]
2021-10-11 10:48:06,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 174.95it/s]
2021-10-11 10:48:07,258 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 175.97it/s]
2021-10-11 10:48:07,896 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 105.26it/s]
2021-10-11 10:48:08,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 200.27it/s]
2021-10-11 10:48:09,400 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 85.05it/s]
2021-10-11 10:48:10,351 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 197.50it/s]
2021-10-11 10:48:10,991 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 142.57it/s]
2021-10-11 10:48:11,758 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 113.52it/s]
2021-10-11 10:48:12,427 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
2021-10-11 10:48:12,437 knodle.trainer.trainer INFO     Train avg loss: 0.1362758137029078
2021-10-11 10:48:12,437 knodle.trainer.trainer INFO     Train avg accuracy: 0.9394322573741276
2021-10-11 10:48:12,438 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:48:12,438 knodle.trainer.trainer INFO     Training done
2021-10-11 10:48:12,438 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 115.19it/s]
2021-10-11 10:48:12,639 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9403453689167975, 'recall': 0.22853872567722244, 'f1-score': 0.36771025168815225, 'support': 2621}, '1': {'precision': 0.06991720331186753, 'recall': 0.8, 'f1-score': 0.12859560067681894, 'support': 190}, 'accuracy': 0.2671647100675916, 'macro avg': {'precision': 0.5051312861143326, 'recall': 0.5142693628386112, 'f1-score': 0.24815292618248558, 'support': 2811}, 'weighted avg': {'precision': 0.8815117326788264, 'recall': 0.2671647100675916, 'f1-score': 0.35154810878806214, 'support': 2811}}, Dev loss: 3.4109437465667725, denoising continues.
2021-10-11 10:48:12,639 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:48:12,674 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:48:13,149 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3664, samples in test set: 2070
2021-10-11 10:48:13,604 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5291, samples in test set: 443
2021-10-11 10:48:14,023 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5285, samples in test set: 449
2021-10-11 10:48:14,518 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5290, samples in test set: 444
2021-10-11 10:48:14,980 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3406, samples in test set: 2328
5it [02:37, 31.42s/it]
2021-10-11 10:50:52,178 knodle.trainer.cleanlab.cleanlab INFO     [[0.08931357 0.91068643]
 [0.01166966 0.98833034]
 [0.15725806 0.84274194]
 [0.0362069  0.9637931 ]
 [0.92549306 0.07450694]
 [0.9626556  0.0373444 ]
 [0.86879433 0.13120567]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 10:50:52,294 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 238 out of 5734
2021-10-11 10:50:52,295 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:50:52,295 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:50:52,295 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:01<00:00, 18.59it/s]
2021-10-11 10:50:54,269 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3877623621487015
100%|██████████| 22/22 [00:00<00:00, 204.35it/s]
2021-10-11 10:50:54,870 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3447171824973319
100%|██████████| 22/22 [00:00<00:00, 208.94it/s]
2021-10-11 10:50:55,402 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3817146922803273
100%|██████████| 22/22 [00:00<00:00, 217.59it/s]
2021-10-11 10:50:55,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3472073995019566
100%|██████████| 22/22 [00:00<00:00, 207.63it/s]
2021-10-11 10:50:56,427 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3930985414443259
100%|██████████| 22/22 [00:00<00:00, 206.54it/s]
2021-10-11 10:50:56,945 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 201.63it/s]
2021-10-11 10:50:57,462 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3607257203842049
100%|██████████| 22/22 [00:00<00:00, 209.43it/s]
2021-10-11 10:50:57,971 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37780149413020275
100%|██████████| 22/22 [00:00<00:00, 101.68it/s]
2021-10-11 10:50:58,599 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 216.39it/s]
2021-10-11 10:50:59,109 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 215.94it/s]
2021-10-11 10:50:59,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3457844183564568
100%|██████████| 22/22 [00:00<00:00, 195.99it/s]
2021-10-11 10:51:00,156 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34507292778370685
100%|██████████| 22/22 [00:00<00:00, 203.02it/s]
2021-10-11 10:51:00,698 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3749555318392031
100%|██████████| 22/22 [00:00<00:00, 209.99it/s]
2021-10-11 10:51:01,224 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 212.21it/s]
2021-10-11 10:51:01,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3703308431163287
100%|██████████| 22/22 [00:00<00:00, 215.87it/s]
2021-10-11 10:51:02,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 214.20it/s]
2021-10-11 10:51:02,779 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35894699395233015
100%|██████████| 22/22 [00:00<00:00, 203.17it/s]
2021-10-11 10:51:03,299 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3550337958022056
100%|██████████| 22/22 [00:00<00:00, 213.75it/s]
2021-10-11 10:51:03,813 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 209.15it/s]
2021-10-11 10:51:04,326 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37353255069370334
100%|██████████| 22/22 [00:00<00:00, 179.01it/s]
2021-10-11 10:51:04,854 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3546780505158307
100%|██████████| 22/22 [00:00<00:00, 137.69it/s]
2021-10-11 10:51:05,530 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3415154749199573
100%|██████████| 22/22 [00:00<00:00, 150.85it/s]
2021-10-11 10:51:06,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3511205976520811
100%|██████████| 22/22 [00:00<00:00, 190.02it/s]
2021-10-11 10:51:06,833 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 203.15it/s]
2021-10-11 10:51:07,474 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3383137673425827
100%|██████████| 22/22 [00:00<00:00, 198.63it/s]
2021-10-11 10:51:08,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34542867307008185
100%|██████████| 22/22 [00:00<00:00, 212.54it/s]
2021-10-11 10:51:08,613 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 203.78it/s]
2021-10-11 10:51:09,167 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34827463536108144
100%|██████████| 22/22 [00:00<00:00, 200.33it/s]
2021-10-11 10:51:09,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 185.40it/s]
2021-10-11 10:51:10,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36784062611170404
100%|██████████| 22/22 [00:00<00:00, 145.23it/s]
2021-10-11 10:51:11,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 177.29it/s]
2021-10-11 10:51:11,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 201.01it/s]
2021-10-11 10:51:12,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3415154749199573
100%|██████████| 22/22 [00:00<00:00, 200.20it/s]
2021-10-11 10:51:12,920 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 176.43it/s]
2021-10-11 10:51:13,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36748488082532904
100%|██████████| 22/22 [00:00<00:00, 167.33it/s]
2021-10-11 10:51:14,288 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 172.28it/s]
2021-10-11 10:51:14,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3557452863749555
100%|██████████| 22/22 [00:00<00:00, 156.64it/s]
2021-10-11 10:51:15,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 182.49it/s]
2021-10-11 10:51:16,348 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3546780505158307
100%|██████████| 22/22 [00:00<00:00, 203.10it/s]
2021-10-11 10:51:17,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34756314478833156
100%|██████████| 22/22 [00:00<00:00, 201.90it/s]
2021-10-11 10:51:17,581 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3472073995019566
100%|██████████| 22/22 [00:00<00:00, 168.11it/s]
2021-10-11 10:51:18,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 179.42it/s]
2021-10-11 10:51:18,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 147.77it/s]
2021-10-11 10:51:19,496 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34614016364283173
100%|██████████| 22/22 [00:00<00:00, 153.63it/s]
2021-10-11 10:51:20,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3557452863749555
100%|██████████| 22/22 [00:00<00:00, 207.60it/s]
2021-10-11 10:51:20,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 196.04it/s]
2021-10-11 10:51:21,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35965848452508004
100%|██████████| 22/22 [00:00<00:00, 197.70it/s]
2021-10-11 10:51:22,146 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 183.17it/s]
2021-10-11 10:51:22,700 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34293845606545714
100%|██████████| 22/22 [00:00<00:00, 211.59it/s]
2021-10-11 10:51:23,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35076485236570615
100%|██████████| 22/22 [00:00<00:00, 215.05it/s]
2021-10-11 10:51:23,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 202.01it/s]
2021-10-11 10:51:24,436 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 183.59it/s]
2021-10-11 10:51:24,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 209.15it/s]
2021-10-11 10:51:25,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 207.20it/s]
2021-10-11 10:51:26,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 211.14it/s]
2021-10-11 10:51:26,592 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 202.56it/s]
2021-10-11 10:51:27,118 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35183208822483103
100%|██████████| 22/22 [00:00<00:00, 209.06it/s]
2021-10-11 10:51:27,654 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35325506937033085
100%|██████████| 22/22 [00:00<00:00, 191.61it/s]
2021-10-11 10:51:28,196 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34614016364283173
100%|██████████| 22/22 [00:00<00:00, 205.50it/s]
2021-10-11 10:51:28,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 209.64it/s]
2021-10-11 10:51:29,260 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34293845606545714
100%|██████████| 22/22 [00:00<00:00, 205.35it/s]
2021-10-11 10:51:29,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 215.17it/s]
2021-10-11 10:51:30,306 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 207.28it/s]
2021-10-11 10:51:30,825 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 216.69it/s]
2021-10-11 10:51:31,339 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 208.16it/s]
2021-10-11 10:51:31,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 205.82it/s]
2021-10-11 10:51:32,381 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 214.45it/s]
2021-10-11 10:51:32,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.368196371398079
100%|██████████| 22/22 [00:00<00:00, 208.41it/s]
2021-10-11 10:51:33,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 203.28it/s]
2021-10-11 10:51:33,955 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 216.27it/s]
2021-10-11 10:51:34,472 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 213.82it/s]
2021-10-11 10:51:34,985 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3319103521878335
100%|██████████| 22/22 [00:00<00:00, 208.66it/s]
2021-10-11 10:51:35,511 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 214.00it/s]
2021-10-11 10:51:36,027 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 208.95it/s]
2021-10-11 10:51:36,547 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 216.98it/s]
2021-10-11 10:51:37,062 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35005336179295626
100%|██████████| 22/22 [00:00<00:00, 216.52it/s]
2021-10-11 10:51:37,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 191.99it/s]
2021-10-11 10:51:38,122 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3333333333333333
100%|██████████| 22/22 [00:00<00:00, 203.39it/s]
2021-10-11 10:51:38,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 192.40it/s]
2021-10-11 10:51:39,205 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 201.74it/s]
2021-10-11 10:51:39,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 202.05it/s]
2021-10-11 10:51:40,258 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 200.05it/s]
2021-10-11 10:51:40,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 210.29it/s]
2021-10-11 10:51:41,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3593027392387051
100%|██████████| 22/22 [00:00<00:00, 219.18it/s]
2021-10-11 10:51:41,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3504091070793312
100%|██████████| 22/22 [00:00<00:00, 211.52it/s]
2021-10-11 10:51:42,336 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 200.75it/s]
2021-10-11 10:51:42,847 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 161.53it/s]
2021-10-11 10:51:43,442 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 175.12it/s]
2021-10-11 10:51:44,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 197.79it/s]
2021-10-11 10:51:44,661 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 150.14it/s]
2021-10-11 10:51:45,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35645677694770544
100%|██████████| 22/22 [00:00<00:00, 205.56it/s]
2021-10-11 10:51:45,937 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 196.07it/s]
2021-10-11 10:51:46,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 200.24it/s]
2021-10-11 10:51:47,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3422269654927072
100%|██████████| 22/22 [00:00<00:00, 210.38it/s]
2021-10-11 10:51:47,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 176.63it/s]
2021-10-11 10:51:48,122 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3415154749199573
100%|██████████| 22/22 [00:00<00:00, 211.39it/s]
2021-10-11 10:51:48,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3568125222340804
100%|██████████| 22/22 [00:00<00:00, 208.49it/s]
2021-10-11 10:51:49,180 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 204.05it/s]
2021-10-11 10:51:49,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3504091070793312
100%|██████████| 22/22 [00:00<00:00, 191.22it/s]
2021-10-11 10:51:50,268 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3489861259338314
2021-10-11 10:51:50,269 knodle.trainer.trainer INFO     Train avg loss: 0.12789654141685192
2021-10-11 10:51:50,269 knodle.trainer.trainer INFO     Train avg accuracy: 0.9432326726780998
2021-10-11 10:51:50,269 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:51:50,269 knodle.trainer.trainer INFO     Training done
2021-10-11 10:51:50,269 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 123.88it/s]
2021-10-11 10:51:50,458 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.7276618480682373). Denoising stops.
2021-10-11 10:51:50,458 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 39.66it/s]
Accuracy is: 0.3920770085153647
Precision is: 0.5232808061966678
Recall is: 0.5710177833118416
F1 is: 0.34599056937654543
{'0': {'precision': 0.9497326203208556, 'recall': 0.3576318968989126, 'f1-score': 0.5196021064950264, 'support': 2483}, '1': {'precision': 0.09682899207248018, 'recall': 0.7844036697247706, 'f1-score': 0.1723790322580645, 'support': 218}, 'accuracy': 0.3920770085153647, 'macro avg': {'precision': 0.5232808061966678, 'recall': 0.5710177833118416, 'f1-score': 0.34599056937654543, 'support': 2701}, 'weighted avg': {'precision': 0.8808940453641189, 'recall': 0.3920770085153647, 'f1-score': 0.4915774377857862, 'support': 2701}}
2021-10-11 10:51:51,032 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:51:51,033 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:51:51,033 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:51:51,823 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:51:51,848 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:51:52,250 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4856, samples in test set: 878
2021-10-11 10:51:52,466 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4966, samples in test set: 768
2021-10-11 10:51:52,731 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5286, samples in test set: 448
2021-10-11 10:51:52,977 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 2617, samples in test set: 3117
2021-10-11 10:51:53,213 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5211, samples in test set: 523
5it [02:15, 27.07s/it]
2021-10-11 10:54:08,702 knodle.trainer.cleanlab.cleanlab INFO     [[0.09784508 0.90215492]
 [0.0990991  0.9009009 ]
 [0.3318662  0.6681338 ]
 [0.14959016 0.85040984]
 [0.83890049 0.16109951]
 [0.95190563 0.04809437]
 [0.88516746 0.11483254]
 [0.1        0.9       ]
 [0.14473684 0.85526316]]
2021-10-11 10:54:08,810 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 188 out of 5734
2021-10-11 10:54:08,811 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:54:08,811 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:54:08,812 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 71.34it/s]
2021-10-11 10:54:09,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 216.11it/s]
2021-10-11 10:54:10,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 216.11it/s]
2021-10-11 10:54:10,841 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2294557097118463
100%|██████████| 22/22 [00:00<00:00, 214.82it/s]
2021-10-11 10:54:11,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 216.36it/s]
2021-10-11 10:54:11,846 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 200.22it/s]
2021-10-11 10:54:12,372 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23087869085734614
100%|██████████| 22/22 [00:00<00:00, 204.46it/s]
2021-10-11 10:54:12,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 200.09it/s]
2021-10-11 10:54:13,419 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22411953041622198
100%|██████████| 22/22 [00:00<00:00, 209.57it/s]
2021-10-11 10:54:13,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2198505869797225
100%|██████████| 22/22 [00:00<00:00, 199.50it/s]
2021-10-11 10:54:14,487 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 201.16it/s]
2021-10-11 10:54:15,028 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2006403415154749
100%|██████████| 22/22 [00:00<00:00, 198.46it/s]
2021-10-11 10:54:15,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 207.31it/s]
2021-10-11 10:54:16,105 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 205.36it/s]
2021-10-11 10:54:16,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 205.43it/s]
2021-10-11 10:54:17,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21273568125222342
100%|██████████| 22/22 [00:00<00:00, 214.87it/s]
2021-10-11 10:54:17,687 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 201.66it/s]
2021-10-11 10:54:18,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 217.16it/s]
2021-10-11 10:54:18,711 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 204.53it/s]
2021-10-11 10:54:19,255 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 193.15it/s]
2021-10-11 10:54:19,786 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 203.11it/s]
2021-10-11 10:54:20,348 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 207.65it/s]
2021-10-11 10:54:20,852 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 214.29it/s]
2021-10-11 10:54:21,375 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 216.40it/s]
2021-10-11 10:54:21,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 207.55it/s]
2021-10-11 10:54:22,390 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 216.04it/s]
2021-10-11 10:54:22,896 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 199.15it/s]
2021-10-11 10:54:23,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 207.96it/s]
2021-10-11 10:54:23,932 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 201.67it/s]
2021-10-11 10:54:24,478 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 187.55it/s]
2021-10-11 10:54:25,023 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 200.72it/s]
2021-10-11 10:54:25,592 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 202.98it/s]
2021-10-11 10:54:26,111 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 201.99it/s]
2021-10-11 10:54:26,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 102.18it/s]
2021-10-11 10:54:27,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 204.67it/s]
2021-10-11 10:54:27,812 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 209.84it/s]
2021-10-11 10:54:28,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 213.26it/s]
2021-10-11 10:54:28,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 213.10it/s]
2021-10-11 10:54:29,341 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 206.66it/s]
2021-10-11 10:54:29,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 214.77it/s]
2021-10-11 10:54:30,388 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 208.03it/s]
2021-10-11 10:54:30,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 206.34it/s]
2021-10-11 10:54:31,451 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 204.37it/s]
2021-10-11 10:54:31,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 208.22it/s]
2021-10-11 10:54:32,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 215.68it/s]
2021-10-11 10:54:33,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 196.40it/s]
2021-10-11 10:54:33,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 205.82it/s]
2021-10-11 10:54:34,054 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 217.71it/s]
2021-10-11 10:54:34,565 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 195.59it/s]
2021-10-11 10:54:35,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 201.25it/s]
2021-10-11 10:54:35,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 197.16it/s]
2021-10-11 10:54:36,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22838847385272146
100%|██████████| 22/22 [00:00<00:00, 206.82it/s]
2021-10-11 10:54:36,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.247954464603344
100%|██████████| 22/22 [00:00<00:00, 174.93it/s]
2021-10-11 10:54:37,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 211.85it/s]
2021-10-11 10:54:37,746 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 215.31it/s]
2021-10-11 10:54:38,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 207.32it/s]
2021-10-11 10:54:38,788 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 217.15it/s]
2021-10-11 10:54:39,290 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 208.84it/s]
2021-10-11 10:54:39,863 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 169.89it/s]
2021-10-11 10:54:40,397 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 217.82it/s]
2021-10-11 10:54:40,900 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 167.41it/s]
2021-10-11 10:54:41,426 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 220.35it/s]
2021-10-11 10:54:41,918 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 216.76it/s]
2021-10-11 10:54:42,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 204.94it/s]
2021-10-11 10:54:42,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2408395588758449
100%|██████████| 22/22 [00:00<00:00, 209.85it/s]
2021-10-11 10:54:43,447 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 216.59it/s]
2021-10-11 10:54:43,954 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 220.70it/s]
2021-10-11 10:54:44,447 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 218.44it/s]
2021-10-11 10:54:44,945 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 173.59it/s]
2021-10-11 10:54:45,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 200.78it/s]
2021-10-11 10:54:45,989 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 151.78it/s]
2021-10-11 10:54:46,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 209.26it/s]
2021-10-11 10:54:47,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 197.45it/s]
2021-10-11 10:54:47,593 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 221.12it/s]
2021-10-11 10:54:48,105 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 215.30it/s]
2021-10-11 10:54:48,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 197.67it/s]
2021-10-11 10:54:49,125 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 203.28it/s]
2021-10-11 10:54:49,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 205.41it/s]
2021-10-11 10:54:50,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 205.73it/s]
2021-10-11 10:54:50,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 203.06it/s]
2021-10-11 10:54:51,216 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 208.22it/s]
2021-10-11 10:54:51,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 208.75it/s]
2021-10-11 10:54:52,255 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 209.55it/s]
2021-10-11 10:54:52,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 195.46it/s]
2021-10-11 10:54:53,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 202.57it/s]
2021-10-11 10:54:53,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 204.09it/s]
2021-10-11 10:54:54,388 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 162.46it/s]
2021-10-11 10:54:54,997 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 207.59it/s]
2021-10-11 10:54:55,521 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 217.84it/s]
2021-10-11 10:54:56,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 214.17it/s]
2021-10-11 10:54:56,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 214.81it/s]
2021-10-11 10:54:57,058 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23230167200284596
100%|██████████| 22/22 [00:00<00:00, 218.83it/s]
2021-10-11 10:54:57,582 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 219.32it/s]
2021-10-11 10:54:58,084 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 196.20it/s]
2021-10-11 10:54:58,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 220.18it/s]
2021-10-11 10:54:59,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 220.39it/s]
2021-10-11 10:54:59,603 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 200.97it/s]
2021-10-11 10:55:00,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 197.79it/s]
2021-10-11 10:55:00,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 201.73it/s]
2021-10-11 10:55:01,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 201.43it/s]
2021-10-11 10:55:01,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
2021-10-11 10:55:01,726 knodle.trainer.trainer INFO     Train avg loss: 0.13319916696225603
2021-10-11 10:55:01,726 knodle.trainer.trainer INFO     Train avg accuracy: 0.9403622683021756
2021-10-11 10:55:01,726 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:55:01,726 knodle.trainer.trainer INFO     Training done
2021-10-11 10:55:01,726 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 152.92it/s]
2021-10-11 10:55:01,878 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9477977161500816, 'recall': 0.22167111789393362, 'f1-score': 0.3593073593073593, 'support': 2621}, '1': {'precision': 0.0718835304822566, 'recall': 0.8315789473684211, 'f1-score': 0.1323283082077052, 'support': 190}, 'accuracy': 0.26289576663109215, 'macro avg': {'precision': 0.5098406233161691, 'recall': 0.5266250326311773, 'f1-score': 0.24581783375753224, 'support': 2811}, 'weighted avg': {'precision': 0.8885932710142271, 'recall': 0.26289576663109215, 'f1-score': 0.34396548107579245, 'support': 2811}}, Dev loss: 3.7245371341705322, denoising continues.
2021-10-11 10:55:01,878 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 10:55:01,905 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:55:02,075 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4274, samples in test set: 1460
2021-10-11 10:55:02,346 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5160, samples in test set: 574
2021-10-11 10:55:02,919 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4536, samples in test set: 1198
2021-10-11 10:55:03,118 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4829, samples in test set: 905
2021-10-11 10:55:03,305 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4137, samples in test set: 1597
5it [02:21, 28.21s/it]
2021-10-11 10:57:24,564 knodle.trainer.cleanlab.cleanlab INFO     [[0.02917009 0.97082991]
 [0.00197239 0.99802761]
 [0.0952381  0.9047619 ]
 [0.02956989 0.97043011]
 [0.95782609 0.04217391]
 [0.99287411 0.00712589]
 [0.95486111 0.04513889]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 10:57:24,732 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 8 out of 5734
2021-10-11 10:57:24,733 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:57:24,734 knodle.trainer.trainer INFO     Training starts
2021-10-11 10:57:24,734 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 76.37it/s]
2021-10-11 10:57:25,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 196.84it/s]
2021-10-11 10:57:26,312 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 208.21it/s]
2021-10-11 10:57:26,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 208.19it/s]
2021-10-11 10:57:27,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 209.84it/s]
2021-10-11 10:57:27,864 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 212.21it/s]
2021-10-11 10:57:28,371 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 209.98it/s]
2021-10-11 10:57:28,898 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 211.74it/s]
2021-10-11 10:57:29,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 213.53it/s]
2021-10-11 10:57:29,944 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 196.86it/s]
2021-10-11 10:57:30,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 223.94it/s]
2021-10-11 10:57:30,982 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 203.65it/s]
2021-10-11 10:57:31,514 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 208.45it/s]
2021-10-11 10:57:32,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 212.76it/s]
2021-10-11 10:57:32,554 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 210.03it/s]
2021-10-11 10:57:33,069 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 203.42it/s]
2021-10-11 10:57:33,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 203.77it/s]
2021-10-11 10:57:34,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 201.21it/s]
2021-10-11 10:57:34,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 203.68it/s]
2021-10-11 10:57:35,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
100%|██████████| 22/22 [00:00<00:00, 214.64it/s]
2021-10-11 10:57:35,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 205.60it/s]
2021-10-11 10:57:36,248 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 207.95it/s]
2021-10-11 10:57:36,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 208.82it/s]
2021-10-11 10:57:37,262 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 212.23it/s]
2021-10-11 10:57:37,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 207.57it/s]
2021-10-11 10:57:38,254 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 211.89it/s]
2021-10-11 10:57:38,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 209.47it/s]
2021-10-11 10:57:39,294 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 204.32it/s]
2021-10-11 10:57:39,787 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 207.61it/s]
2021-10-11 10:57:40,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22269654927072216
100%|██████████| 22/22 [00:00<00:00, 208.14it/s]
2021-10-11 10:57:40,815 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 201.65it/s]
2021-10-11 10:57:41,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 208.30it/s]
2021-10-11 10:57:41,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 206.10it/s]
2021-10-11 10:57:42,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 200.24it/s]
2021-10-11 10:57:42,850 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 205.96it/s]
2021-10-11 10:57:43,358 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 200.72it/s]
2021-10-11 10:57:43,864 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 199.82it/s]
2021-10-11 10:57:44,394 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 214.81it/s]
2021-10-11 10:57:44,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 213.98it/s]
2021-10-11 10:57:45,432 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 208.18it/s]
2021-10-11 10:57:45,922 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 180.60it/s]
2021-10-11 10:57:46,452 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 218.61it/s]
2021-10-11 10:57:46,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 204.52it/s]
2021-10-11 10:57:47,450 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 199.48it/s]
2021-10-11 10:57:47,995 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 209.12it/s]
2021-10-11 10:57:48,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 203.10it/s]
2021-10-11 10:57:49,031 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 204.64it/s]
2021-10-11 10:57:49,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 206.62it/s]
2021-10-11 10:57:50,110 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 208.66it/s]
2021-10-11 10:57:50,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 198.24it/s]
2021-10-11 10:57:51,197 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 203.36it/s]
2021-10-11 10:57:51,744 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 202.95it/s]
2021-10-11 10:57:52,276 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 204.01it/s]
2021-10-11 10:57:52,812 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 160.90it/s]
2021-10-11 10:57:53,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 208.00it/s]
2021-10-11 10:57:54,312 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 217.05it/s]
2021-10-11 10:57:54,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 213.13it/s]
2021-10-11 10:57:55,382 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 210.20it/s]
2021-10-11 10:57:55,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 189.26it/s]
2021-10-11 10:57:56,448 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 202.83it/s]
2021-10-11 10:57:56,976 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 176.90it/s]
2021-10-11 10:57:57,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 204.03it/s]
2021-10-11 10:57:58,124 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 182.33it/s]
2021-10-11 10:57:58,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 202.78it/s]
2021-10-11 10:57:59,219 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 211.26it/s]
2021-10-11 10:57:59,772 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 211.48it/s]
2021-10-11 10:58:00,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 156.30it/s]
2021-10-11 10:58:00,850 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 193.57it/s]
2021-10-11 10:58:01,398 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 155.17it/s]
2021-10-11 10:58:01,978 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 209.21it/s]
2021-10-11 10:58:02,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 208.38it/s]
2021-10-11 10:58:03,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 173.60it/s]
2021-10-11 10:58:03,582 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 199.40it/s]
2021-10-11 10:58:04,104 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 208.10it/s]
2021-10-11 10:58:04,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 207.42it/s]
2021-10-11 10:58:05,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 211.08it/s]
2021-10-11 10:58:05,654 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 218.05it/s]
2021-10-11 10:58:06,153 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 212.26it/s]
2021-10-11 10:58:06,691 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 204.55it/s]
2021-10-11 10:58:07,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 195.91it/s]
2021-10-11 10:58:07,821 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 159.60it/s]
2021-10-11 10:58:08,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 203.32it/s]
2021-10-11 10:58:09,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 199.99it/s]
2021-10-11 10:58:09,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 199.81it/s]
2021-10-11 10:58:10,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 206.01it/s]
2021-10-11 10:58:10,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 208.83it/s]
2021-10-11 10:58:11,118 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 208.50it/s]
2021-10-11 10:58:11,624 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 204.73it/s]
2021-10-11 10:58:12,122 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 205.47it/s]
2021-10-11 10:58:12,669 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 203.31it/s]
2021-10-11 10:58:13,185 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 213.31it/s]
2021-10-11 10:58:13,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
100%|██████████| 22/22 [00:00<00:00, 203.03it/s]
2021-10-11 10:58:14,228 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 200.18it/s]
2021-10-11 10:58:14,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 217.31it/s]
2021-10-11 10:58:15,247 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 207.92it/s]
2021-10-11 10:58:15,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 208.71it/s]
2021-10-11 10:58:16,292 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 192.91it/s]
2021-10-11 10:58:16,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 202.12it/s]
2021-10-11 10:58:17,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 210.88it/s]
2021-10-11 10:58:17,909 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 212.46it/s]
2021-10-11 10:58:18,408 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
2021-10-11 10:58:18,409 knodle.trainer.trainer INFO     Train avg loss: 0.13080837949241197
2021-10-11 10:58:18,409 knodle.trainer.trainer INFO     Train avg accuracy: 0.9417998704115554
2021-10-11 10:58:18,409 knodle.trainer.trainer INFO     ======================================
2021-10-11 10:58:18,409 knodle.trainer.trainer INFO     Training done
2021-10-11 10:58:18,409 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 156.34it/s]
2021-10-11 10:58:18,559 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.186706066131592). Denoising stops.
2021-10-11 10:58:18,559 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 64.69it/s]
Accuracy is: 0.32395409107737877
Precision is: 0.5214546866000551
Recall is: 0.5569801254032005
F1 is: 0.2988584474885845
{'0': {'precision': 0.9506172839506173, 'recall': 0.2790978654853, 'f1-score': 0.4315068493150685, 'support': 2483}, '1': {'precision': 0.0922920892494929, 'recall': 0.8348623853211009, 'f1-score': 0.16621004566210046, 'support': 218}, 'accuracy': 0.32395409107737877, 'macro avg': {'precision': 0.5214546866000551, 'recall': 0.5569801254032005, 'f1-score': 0.2988584474885845, 'support': 2701}, 'weighted avg': {'precision': 0.8813411297688901, 'recall': 0.32395409107737877, 'f1-score': 0.4100945193645513, 'support': 2701}}
2021-10-11 10:58:18,911 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 10:58:18,911 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 10:58:18,912 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 10:58:19,452 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 10:58:19,487 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 10:58:19,760 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4980, samples in test set: 754
2021-10-11 10:58:20,162 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5093, samples in test set: 641
2021-10-11 10:58:20,419 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 2660, samples in test set: 3074
2021-10-11 10:58:20,656 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5264, samples in test set: 470
2021-10-11 10:58:20,922 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4939, samples in test set: 795
5it [02:15, 27.14s/it]
2021-10-11 11:00:36,683 knodle.trainer.cleanlab.cleanlab INFO     [[0.07320349 0.92679651]
 [0.0377193  0.9622807 ]
 [0.29904762 0.70095238]
 [0.09760956 0.90239044]
 [0.87912088 0.12087912]
 [0.95732839 0.04267161]
 [0.83333333 0.16666667]
 [0.06818182 0.93181818]
 [0.07575758 0.92424242]]
2021-10-11 11:00:36,788 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 203 out of 5734
2021-10-11 11:00:36,789 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:00:36,789 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:00:36,789 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 79.55it/s]
2021-10-11 11:00:37,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33938100320170755
100%|██████████| 22/22 [00:00<00:00, 205.48it/s]
2021-10-11 11:00:38,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 211.91it/s]
2021-10-11 11:00:38,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 89.37it/s]
2021-10-11 11:00:39,521 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22518676627534684
100%|██████████| 22/22 [00:00<00:00, 197.42it/s]
2021-10-11 11:00:40,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 203.50it/s]
2021-10-11 11:00:40,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 218.76it/s]
2021-10-11 11:00:41,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 203.35it/s]
2021-10-11 11:00:41,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20419779437922447
100%|██████████| 22/22 [00:00<00:00, 215.70it/s]
2021-10-11 11:00:42,135 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 208.57it/s]
2021-10-11 11:00:42,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 212.58it/s]
2021-10-11 11:00:43,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2184276058342227
100%|██████████| 22/22 [00:00<00:00, 206.40it/s]
2021-10-11 11:00:43,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 217.86it/s]
2021-10-11 11:00:44,164 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 222.45it/s]
2021-10-11 11:00:44,654 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 217.49it/s]
2021-10-11 11:00:45,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 207.52it/s]
2021-10-11 11:00:45,650 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 192.78it/s]
2021-10-11 11:00:46,171 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 213.21it/s]
2021-10-11 11:00:46,680 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 203.11it/s]
2021-10-11 11:00:47,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 202.99it/s]
2021-10-11 11:00:47,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 217.98it/s]
2021-10-11 11:00:48,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 212.21it/s]
2021-10-11 11:00:48,699 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 202.34it/s]
2021-10-11 11:00:49,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 208.89it/s]
2021-10-11 11:00:49,757 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 196.28it/s]
2021-10-11 11:00:50,278 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 208.35it/s]
2021-10-11 11:00:50,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 207.22it/s]
2021-10-11 11:00:51,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 213.00it/s]
2021-10-11 11:00:51,786 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22056207755247242
100%|██████████| 22/22 [00:00<00:00, 193.40it/s]
2021-10-11 11:00:52,294 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 207.05it/s]
2021-10-11 11:00:52,793 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 159.61it/s]
2021-10-11 11:00:53,307 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 176.99it/s]
2021-10-11 11:00:53,890 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 161.77it/s]
2021-10-11 11:00:54,510 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 190.84it/s]
2021-10-11 11:00:55,034 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 203.23it/s]
2021-10-11 11:00:55,556 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 218.51it/s]
2021-10-11 11:00:56,084 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 207.40it/s]
2021-10-11 11:00:56,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 210.21it/s]
2021-10-11 11:00:57,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 215.72it/s]
2021-10-11 11:00:57,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 205.71it/s]
2021-10-11 11:00:58,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 219.15it/s]
2021-10-11 11:00:58,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 202.96it/s]
2021-10-11 11:00:59,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 207.97it/s]
2021-10-11 11:00:59,628 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 199.01it/s]
2021-10-11 11:01:00,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 196.35it/s]
2021-10-11 11:01:00,714 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 203.31it/s]
2021-10-11 11:01:01,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 210.34it/s]
2021-10-11 11:01:01,744 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 216.14it/s]
2021-10-11 11:01:02,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 215.68it/s]
2021-10-11 11:01:02,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 212.76it/s]
2021-10-11 11:01:03,224 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 207.72it/s]
2021-10-11 11:01:03,730 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 197.17it/s]
2021-10-11 11:01:04,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 210.79it/s]
2021-10-11 11:01:04,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 180.80it/s]
2021-10-11 11:01:05,282 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 214.47it/s]
2021-10-11 11:01:05,762 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 206.92it/s]
2021-10-11 11:01:06,267 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 212.17it/s]
2021-10-11 11:01:06,793 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2511561721807186
100%|██████████| 22/22 [00:00<00:00, 214.18it/s]
2021-10-11 11:01:07,277 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 200.59it/s]
2021-10-11 11:01:07,781 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 215.10it/s]
2021-10-11 11:01:08,276 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 214.33it/s]
2021-10-11 11:01:08,760 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 160.41it/s]
2021-10-11 11:01:09,302 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 196.63it/s]
2021-10-11 11:01:09,831 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 180.80it/s]
2021-10-11 11:01:10,357 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 199.63it/s]
2021-10-11 11:01:10,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3625044468160797
100%|██████████| 22/22 [00:00<00:00, 193.45it/s]
2021-10-11 11:01:11,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 203.06it/s]
2021-10-11 11:01:11,931 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 189.68it/s]
2021-10-11 11:01:12,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 205.41it/s]
2021-10-11 11:01:12,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 201.07it/s]
2021-10-11 11:01:13,484 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 201.49it/s]
2021-10-11 11:01:14,000 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 207.69it/s]
2021-10-11 11:01:14,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 208.74it/s]
2021-10-11 11:01:15,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 203.73it/s]
2021-10-11 11:01:15,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 215.51it/s]
2021-10-11 11:01:16,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 213.03it/s]
2021-10-11 11:01:16,581 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 186.83it/s]
2021-10-11 11:01:17,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 203.12it/s]
2021-10-11 11:01:17,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 212.33it/s]
2021-10-11 11:01:18,095 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 201.63it/s]
2021-10-11 11:01:18,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 199.58it/s]
2021-10-11 11:01:19,147 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 207.49it/s]
2021-10-11 11:01:19,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 165.72it/s]
2021-10-11 11:01:20,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 212.21it/s]
2021-10-11 11:01:20,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 184.74it/s]
2021-10-11 11:01:21,201 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 214.34it/s]
2021-10-11 11:01:21,716 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 213.24it/s]
2021-10-11 11:01:22,218 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 214.77it/s]
2021-10-11 11:01:22,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 217.04it/s]
2021-10-11 11:01:23,232 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 204.36it/s]
2021-10-11 11:01:23,739 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 199.41it/s]
2021-10-11 11:01:24,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 208.63it/s]
2021-10-11 11:01:24,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 210.96it/s]
2021-10-11 11:01:25,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 200.78it/s]
2021-10-11 11:01:25,834 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 203.79it/s]
2021-10-11 11:01:26,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 211.00it/s]
2021-10-11 11:01:26,888 knodle.trainer.trainer INFO     Epoch development accuracy: 0.343649946638207
100%|██████████| 22/22 [00:00<00:00, 192.75it/s]
2021-10-11 11:01:27,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 213.60it/s]
2021-10-11 11:01:27,931 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 204.36it/s]
2021-10-11 11:01:28,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 209.75it/s]
2021-10-11 11:01:28,916 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
2021-10-11 11:01:28,917 knodle.trainer.trainer INFO     Train avg loss: 0.13306886836286216
2021-10-11 11:01:28,917 knodle.trainer.trainer INFO     Train avg accuracy: 0.9404553373787131
2021-10-11 11:01:28,917 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:01:28,917 knodle.trainer.trainer INFO     Training done
2021-10-11 11:01:28,917 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 155.06it/s]
2021-10-11 11:01:29,068 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9418803418803419, 'recall': 0.2102251049217856, 'f1-score': 0.3437305053025577, 'support': 2621}, '1': {'precision': 0.07008086253369272, 'recall': 0.8210526315789474, 'f1-score': 0.1291390728476821, 'support': 190}, 'accuracy': 0.25151191746709356, 'macro avg': {'precision': 0.5059806022070172, 'recall': 0.5156388682503665, 'f1-score': 0.23643478907511992, 'support': 2811}, 'weighted avg': {'precision': 0.8829540163464167, 'recall': 0.25151191746709356, 'f1-score': 0.3292259260900261, 'support': 2811}}, Dev loss: 3.712918758392334, denoising continues.
2021-10-11 11:01:29,068 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:01:29,100 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:01:30,023 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4678, samples in test set: 1056
2021-10-11 11:01:30,297 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4796, samples in test set: 938
2021-10-11 11:01:30,458 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5629, samples in test set: 105
2021-10-11 11:01:30,643 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3722, samples in test set: 2012
2021-10-11 11:01:30,822 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4111, samples in test set: 1623
5it [02:14, 26.89s/it]
2021-10-11 11:03:45,447 knodle.trainer.cleanlab.cleanlab INFO     [[0.01701245 0.98298755]
 [0.0021097  0.9978903 ]
 [0.11509901 0.88490099]
 [0.01231527 0.98768473]
 [0.95304569 0.04695431]
 [0.97014925 0.02985075]
 [0.91610738 0.08389262]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:03:45,559 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 21 out of 5734
2021-10-11 11:03:45,560 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:03:45,560 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:03:45,560 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 80.89it/s]
2021-10-11 11:03:46,481 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 206.68it/s]
2021-10-11 11:03:46,992 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 207.08it/s]
2021-10-11 11:03:47,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 194.60it/s]
2021-10-11 11:03:48,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 208.81it/s]
2021-10-11 11:03:48,555 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 180.44it/s]
2021-10-11 11:03:49,061 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 209.72it/s]
2021-10-11 11:03:49,596 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 214.31it/s]
2021-10-11 11:03:50,100 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 213.58it/s]
2021-10-11 11:03:50,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 211.03it/s]
2021-10-11 11:03:51,082 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 205.80it/s]
2021-10-11 11:03:51,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23692636072572038
100%|██████████| 22/22 [00:00<00:00, 217.51it/s]
2021-10-11 11:03:52,073 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 208.96it/s]
2021-10-11 11:03:52,593 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 199.66it/s]
2021-10-11 11:03:53,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 205.81it/s]
2021-10-11 11:03:53,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 200.15it/s]
2021-10-11 11:03:54,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 148.09it/s]
2021-10-11 11:03:54,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23977232301672002
100%|██████████| 22/22 [00:00<00:00, 155.63it/s]
2021-10-11 11:03:55,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 184.94it/s]
2021-10-11 11:03:56,229 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 197.06it/s]
2021-10-11 11:03:56,789 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 190.35it/s]
2021-10-11 11:03:57,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 205.72it/s]
2021-10-11 11:03:57,833 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 208.08it/s]
2021-10-11 11:03:58,389 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 80.50it/s]
2021-10-11 11:03:59,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 153.26it/s]
2021-10-11 11:03:59,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 145.35it/s]
2021-10-11 11:04:00,215 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 146.26it/s]
2021-10-11 11:04:00,808 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 162.01it/s]
2021-10-11 11:04:01,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 158.27it/s]
2021-10-11 11:04:01,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 153.18it/s]
2021-10-11 11:04:02,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 161.59it/s]
2021-10-11 11:04:02,961 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 136.29it/s]
2021-10-11 11:04:03,519 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23016720028459622
100%|██████████| 22/22 [00:00<00:00, 154.02it/s]
2021-10-11 11:04:04,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 129.84it/s]
2021-10-11 11:04:04,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 161.78it/s]
2021-10-11 11:04:05,190 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 133.50it/s]
2021-10-11 11:04:05,747 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 157.46it/s]
2021-10-11 11:04:06,267 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 162.93it/s]
2021-10-11 11:04:06,815 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 152.44it/s]
2021-10-11 11:04:07,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327641408751334
100%|██████████| 22/22 [00:00<00:00, 151.57it/s]
2021-10-11 11:04:07,891 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 167.30it/s]
2021-10-11 11:04:08,425 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 155.28it/s]
2021-10-11 11:04:08,992 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 154.94it/s]
2021-10-11 11:04:09,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 156.03it/s]
2021-10-11 11:04:10,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 149.79it/s]
2021-10-11 11:04:10,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 153.45it/s]
2021-10-11 11:04:11,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 164.07it/s]
2021-10-11 11:04:11,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 148.56it/s]
2021-10-11 11:04:12,334 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 154.07it/s]
2021-10-11 11:04:12,868 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 168.68it/s]
2021-10-11 11:04:13,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 134.75it/s]
2021-10-11 11:04:13,960 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 161.62it/s]
2021-10-11 11:04:14,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 134.90it/s]
2021-10-11 11:04:15,077 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 158.43it/s]
2021-10-11 11:04:15,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 146.13it/s]
2021-10-11 11:04:16,146 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 162.55it/s]
2021-10-11 11:04:16,698 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 156.08it/s]
2021-10-11 11:04:17,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 161.09it/s]
2021-10-11 11:04:17,765 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 167.76it/s]
2021-10-11 11:04:18,294 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 144.93it/s]
2021-10-11 11:04:18,867 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 146.28it/s]
2021-10-11 11:04:19,453 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 155.81it/s]
2021-10-11 11:04:20,018 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33795802205620773
100%|██████████| 22/22 [00:00<00:00, 151.04it/s]
2021-10-11 11:04:20,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 155.74it/s]
2021-10-11 11:04:21,160 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 162.41it/s]
2021-10-11 11:04:21,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 150.05it/s]
2021-10-11 11:04:22,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 156.55it/s]
2021-10-11 11:04:22,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 163.68it/s]
2021-10-11 11:04:23,369 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 155.06it/s]
2021-10-11 11:04:23,910 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 151.77it/s]
2021-10-11 11:04:24,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 142.52it/s]
2021-10-11 11:04:25,028 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 151.39it/s]
2021-10-11 11:04:25,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
100%|██████████| 22/22 [00:00<00:00, 154.60it/s]
2021-10-11 11:04:26,165 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 152.90it/s]
2021-10-11 11:04:26,733 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 148.18it/s]
2021-10-11 11:04:27,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 158.45it/s]
2021-10-11 11:04:27,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 168.54it/s]
2021-10-11 11:04:28,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 147.78it/s]
2021-10-11 11:04:28,922 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 155.42it/s]
2021-10-11 11:04:29,448 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 105.18it/s]
2021-10-11 11:04:30,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 112.71it/s]
2021-10-11 11:04:30,829 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 107.92it/s]
2021-10-11 11:04:31,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 55.69it/s]
2021-10-11 11:04:32,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 128.36it/s]
2021-10-11 11:04:33,507 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 143.35it/s]
2021-10-11 11:04:34,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 134.67it/s]
2021-10-11 11:04:34,771 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 99.22it/s]
2021-10-11 11:04:35,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 110.75it/s]
2021-10-11 11:04:36,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 132.51it/s]
2021-10-11 11:04:36,908 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 115.05it/s]
2021-10-11 11:04:37,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 124.56it/s]
2021-10-11 11:04:38,284 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 135.29it/s]
2021-10-11 11:04:38,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 109.09it/s]
2021-10-11 11:04:39,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 125.14it/s]
2021-10-11 11:04:40,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 137.45it/s]
2021-10-11 11:04:41,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 123.26it/s]
2021-10-11 11:04:41,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 121.15it/s]
2021-10-11 11:04:42,407 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 125.38it/s]
2021-10-11 11:04:43,049 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 120.48it/s]
2021-10-11 11:04:43,728 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 117.13it/s]
2021-10-11 11:04:44,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
2021-10-11 11:04:44,418 knodle.trainer.trainer INFO     Train avg loss: 0.13258832234785786
2021-10-11 11:04:44,418 knodle.trainer.trainer INFO     Train avg accuracy: 0.9407745776176452
2021-10-11 11:04:44,418 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:04:44,418 knodle.trainer.trainer INFO     Training done
2021-10-11 11:04:44,418 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 132.59it/s]
2021-10-11 11:04:44,602 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.7495596408843994). Denoising stops.
2021-10-11 11:04:44,602 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 58.43it/s]
Accuracy is: 0.3661606812291744
Precision is: 0.5216200945725088
Recall is: 0.563198557530658
F1 is: 0.32833196795128783
{'0': {'precision': 0.9487776484284052, 'recall': 0.3282319774466371, 'f1-score': 0.48773189706762415, 'support': 2483}, '1': {'precision': 0.09446254071661238, 'recall': 0.7981651376146789, 'f1-score': 0.16893203883495145, 'support': 218}, 'accuracy': 0.3661606812291744, 'macro avg': {'precision': 0.5216200945725088, 'recall': 0.563198557530658, 'f1-score': 0.32833196795128783, 'support': 2701}, 'weighted avg': {'precision': 0.8798251517674756, 'recall': 0.3661606812291744, 'f1-score': 0.4620012902202629, 'support': 2701}}
2021-10-11 11:04:44,992 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:04:44,992 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:04:44,992 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:04:45,536 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:04:45,562 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:04:45,880 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5420, samples in test set: 314
2021-10-11 11:04:46,241 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3589, samples in test set: 2145
2021-10-11 11:04:46,478 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5282, samples in test set: 452
2021-10-11 11:04:46,781 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5009, samples in test set: 725
2021-10-11 11:04:47,151 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3636, samples in test set: 2098
5it [02:47, 33.59s/it]
2021-10-11 11:07:35,163 knodle.trainer.cleanlab.cleanlab INFO     [[0.16365462 0.83634538]
 [0.03399668 0.96600332]
 [0.29935622 0.70064378]
 [0.06205674 0.93794326]
 [0.80084197 0.19915803]
 [0.89963834 0.10036166]
 [0.84715026 0.15284974]
 [0.08333333 0.91666667]
 [0.08333333 0.91666667]]
2021-10-11 11:07:35,349 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 191 out of 5734
2021-10-11 11:07:35,350 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:07:35,350 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:07:35,350 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 44.37it/s]
2021-10-11 11:07:37,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22732123799359658
100%|██████████| 22/22 [00:00<00:00, 200.54it/s]
2021-10-11 11:07:37,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 158.63it/s]
2021-10-11 11:07:38,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2017075773745998
100%|██████████| 22/22 [00:00<00:00, 195.67it/s]
2021-10-11 11:07:38,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 163.93it/s]
2021-10-11 11:07:39,459 knodle.trainer.trainer INFO     Epoch development accuracy: 0.18854500177872643
100%|██████████| 22/22 [00:00<00:00, 165.38it/s]
2021-10-11 11:07:40,181 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19388118107435076
100%|██████████| 22/22 [00:00<00:00, 162.95it/s]
2021-10-11 11:07:41,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 82.46it/s]
2021-10-11 11:07:41,981 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2216293134115973
100%|██████████| 22/22 [00:00<00:00, 160.42it/s]
2021-10-11 11:07:42,670 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 151.36it/s]
2021-10-11 11:07:43,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23194592671647102
100%|██████████| 22/22 [00:00<00:00, 130.96it/s]
2021-10-11 11:07:44,098 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 137.54it/s]
2021-10-11 11:07:44,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 157.13it/s]
2021-10-11 11:07:45,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 188.53it/s]
2021-10-11 11:07:46,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 180.33it/s]
2021-10-11 11:07:46,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 192.04it/s]
2021-10-11 11:07:47,520 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 176.81it/s]
2021-10-11 11:07:48,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 201.80it/s]
2021-10-11 11:07:48,682 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 186.08it/s]
2021-10-11 11:07:49,243 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 183.06it/s]
2021-10-11 11:07:49,850 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22909996442547137
100%|██████████| 22/22 [00:00<00:00, 202.36it/s]
2021-10-11 11:07:50,409 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 193.99it/s]
2021-10-11 11:07:50,982 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 197.48it/s]
2021-10-11 11:07:51,567 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 196.83it/s]
2021-10-11 11:07:52,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20597652081109924
100%|██████████| 22/22 [00:00<00:00, 197.05it/s]
2021-10-11 11:07:52,696 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20739950195659906
100%|██████████| 22/22 [00:00<00:00, 195.61it/s]
2021-10-11 11:07:53,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 179.19it/s]
2021-10-11 11:07:53,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 197.98it/s]
2021-10-11 11:07:54,452 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2280327285663465
100%|██████████| 22/22 [00:00<00:00, 162.00it/s]
2021-10-11 11:07:55,043 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 203.59it/s]
2021-10-11 11:07:55,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21558164354322304
100%|██████████| 22/22 [00:00<00:00, 198.35it/s]
2021-10-11 11:07:56,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 205.00it/s]
2021-10-11 11:07:56,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 199.49it/s]
2021-10-11 11:07:57,367 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 190.81it/s]
2021-10-11 11:07:57,914 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 199.45it/s]
2021-10-11 11:07:58,507 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 186.74it/s]
2021-10-11 11:07:59,055 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 198.73it/s]
2021-10-11 11:07:59,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22732123799359658
100%|██████████| 22/22 [00:00<00:00, 200.41it/s]
2021-10-11 11:08:00,182 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 199.49it/s]
2021-10-11 11:08:00,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 197.40it/s]
2021-10-11 11:08:01,325 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 195.95it/s]
2021-10-11 11:08:01,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 196.98it/s]
2021-10-11 11:08:02,418 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 193.19it/s]
2021-10-11 11:08:02,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 193.12it/s]
2021-10-11 11:08:03,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 205.02it/s]
2021-10-11 11:08:04,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 194.50it/s]
2021-10-11 11:08:04,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 184.64it/s]
2021-10-11 11:08:05,320 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 200.29it/s]
2021-10-11 11:08:05,912 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 178.63it/s]
2021-10-11 11:08:06,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 201.30it/s]
2021-10-11 11:08:07,073 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 203.20it/s]
2021-10-11 11:08:07,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 178.07it/s]
2021-10-11 11:08:08,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23692636072572038
100%|██████████| 22/22 [00:00<00:00, 206.06it/s]
2021-10-11 11:08:08,736 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 205.70it/s]
2021-10-11 11:08:09,283 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 202.48it/s]
2021-10-11 11:08:09,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 201.36it/s]
2021-10-11 11:08:10,377 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 208.25it/s]
2021-10-11 11:08:10,929 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 166.47it/s]
2021-10-11 11:08:11,482 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 200.09it/s]
2021-10-11 11:08:12,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 164.99it/s]
2021-10-11 11:08:12,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 178.27it/s]
2021-10-11 11:08:13,171 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 190.37it/s]
2021-10-11 11:08:13,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 175.27it/s]
2021-10-11 11:08:14,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 178.84it/s]
2021-10-11 11:08:14,956 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 188.72it/s]
2021-10-11 11:08:15,524 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 134.67it/s]
2021-10-11 11:08:16,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 130.00it/s]
2021-10-11 11:08:16,945 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 176.14it/s]
2021-10-11 11:08:17,633 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 126.02it/s]
2021-10-11 11:08:18,353 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 195.82it/s]
2021-10-11 11:08:18,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 200.03it/s]
2021-10-11 11:08:19,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 182.44it/s]
2021-10-11 11:08:20,005 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 206.99it/s]
2021-10-11 11:08:20,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 177.88it/s]
2021-10-11 11:08:21,136 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 202.48it/s]
2021-10-11 11:08:21,714 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 162.66it/s]
2021-10-11 11:08:22,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 148.37it/s]
2021-10-11 11:08:23,082 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 176.86it/s]
2021-10-11 11:08:23,733 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 163.97it/s]
2021-10-11 11:08:24,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 194.69it/s]
2021-10-11 11:08:24,939 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 110.19it/s]
2021-10-11 11:08:25,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 146.63it/s]
2021-10-11 11:08:26,270 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 167.36it/s]
2021-10-11 11:08:26,934 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 173.50it/s]
2021-10-11 11:08:27,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 176.37it/s]
2021-10-11 11:08:28,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 184.58it/s]
2021-10-11 11:08:28,726 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 188.59it/s]
2021-10-11 11:08:29,299 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 179.43it/s]
2021-10-11 11:08:29,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 184.38it/s]
2021-10-11 11:08:30,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 195.32it/s]
2021-10-11 11:08:30,995 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 175.42it/s]
2021-10-11 11:08:31,563 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 189.40it/s]
2021-10-11 11:08:32,124 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 207.73it/s]
2021-10-11 11:08:32,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 152.67it/s]
2021-10-11 11:08:33,364 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 156.58it/s]
2021-10-11 11:08:34,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 204.89it/s]
2021-10-11 11:08:35,050 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 216.66it/s]
2021-10-11 11:08:35,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23941657773034508
100%|██████████| 22/22 [00:00<00:00, 205.32it/s]
2021-10-11 11:08:36,123 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 180.38it/s]
2021-10-11 11:08:36,754 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 147.34it/s]
2021-10-11 11:08:37,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
2021-10-11 11:08:37,441 knodle.trainer.trainer INFO     Train avg loss: 0.13424635266471246
2021-10-11 11:08:37,441 knodle.trainer.trainer INFO     Train avg accuracy: 0.9399263682497871
2021-10-11 11:08:37,441 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:08:37,441 knodle.trainer.trainer INFO     Training done
2021-10-11 11:08:37,441 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 119.53it/s]
2021-10-11 11:08:37,639 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.936923076923077, 'recall': 0.23235406333460512, 'f1-score': 0.37236319168450016, 'support': 2621}, '1': {'precision': 0.06894956038870893, 'recall': 0.7842105263157895, 'f1-score': 0.12675457252233094, 'support': 190}, 'accuracy': 0.2696549270722163, 'macro avg': {'precision': 0.5029363186558929, 'recall': 0.5082822948251973, 'f1-score': 0.24955888210341554, 'support': 2811}, 'weighted avg': {'precision': 0.8782553543540518, 'recall': 0.2696549270722163, 'f1-score': 0.3557621110580995, 'support': 2811}}, Dev loss: 3.621054172515869, denoising continues.
2021-10-11 11:08:37,640 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:08:37,679 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:08:38,441 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5278, samples in test set: 456
2021-10-11 11:08:38,667 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3989, samples in test set: 1745
2021-10-11 11:08:38,884 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3399, samples in test set: 2335
2021-10-11 11:08:39,160 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5173, samples in test set: 561
2021-10-11 11:08:39,404 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5097, samples in test set: 637
5it [03:01, 36.29s/it]
2021-10-11 11:11:40,890 knodle.trainer.cleanlab.cleanlab INFO     [[0.03081914 0.96918086]
 [0.00557621 0.99442379]
 [0.11977716 0.88022284]
 [0.08139535 0.91860465]
 [0.94020356 0.05979644]
 [0.9786036  0.0213964 ]
 [0.97289157 0.02710843]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:11:41,020 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 35 out of 5734
2021-10-11 11:11:41,022 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:11:41,022 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:11:41,022 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 67.06it/s]
2021-10-11 11:11:42,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34507292778370685
100%|██████████| 22/22 [00:00<00:00, 199.67it/s]
2021-10-11 11:11:42,719 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 177.86it/s]
2021-10-11 11:11:43,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 94.81it/s]
2021-10-11 11:11:43,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.343649946638207
100%|██████████| 22/22 [00:00<00:00, 198.12it/s]
2021-10-11 11:11:44,518 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 202.30it/s]
2021-10-11 11:11:45,067 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 201.44it/s]
2021-10-11 11:11:45,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 200.91it/s]
2021-10-11 11:11:46,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35183208822483103
100%|██████████| 22/22 [00:00<00:00, 181.16it/s]
2021-10-11 11:11:46,755 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 205.09it/s]
2021-10-11 11:11:47,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 199.14it/s]
2021-10-11 11:11:47,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 199.94it/s]
2021-10-11 11:11:48,354 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 204.47it/s]
2021-10-11 11:11:48,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 194.43it/s]
2021-10-11 11:11:49,472 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 203.66it/s]
2021-10-11 11:11:49,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 202.57it/s]
2021-10-11 11:11:50,529 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 205.58it/s]
2021-10-11 11:11:51,055 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 204.23it/s]
2021-10-11 11:11:51,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 202.30it/s]
2021-10-11 11:11:52,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 205.84it/s]
2021-10-11 11:11:52,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3511205976520811
100%|██████████| 22/22 [00:00<00:00, 213.22it/s]
2021-10-11 11:11:53,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 175.88it/s]
2021-10-11 11:11:53,728 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 195.19it/s]
2021-10-11 11:11:54,275 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 200.53it/s]
2021-10-11 11:11:54,815 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 203.97it/s]
2021-10-11 11:11:55,380 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 207.43it/s]
2021-10-11 11:11:55,904 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 192.18it/s]
2021-10-11 11:11:56,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 194.70it/s]
2021-10-11 11:11:56,987 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 200.04it/s]
2021-10-11 11:11:57,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 206.71it/s]
2021-10-11 11:11:58,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 179.95it/s]
2021-10-11 11:11:58,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 211.38it/s]
2021-10-11 11:11:59,182 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 206.31it/s]
2021-10-11 11:11:59,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 207.95it/s]
2021-10-11 11:12:00,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 211.27it/s]
2021-10-11 11:12:00,774 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 217.93it/s]
2021-10-11 11:12:01,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 205.53it/s]
2021-10-11 11:12:01,827 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 202.99it/s]
2021-10-11 11:12:02,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 211.89it/s]
2021-10-11 11:12:02,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 205.28it/s]
2021-10-11 11:12:03,442 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3607257203842049
100%|██████████| 22/22 [00:00<00:00, 209.92it/s]
2021-10-11 11:12:03,963 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 200.04it/s]
2021-10-11 11:12:04,482 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22447527570259693
100%|██████████| 22/22 [00:00<00:00, 200.84it/s]
2021-10-11 11:12:05,004 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 208.79it/s]
2021-10-11 11:12:05,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 211.72it/s]
2021-10-11 11:12:06,059 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 207.25it/s]
2021-10-11 11:12:06,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 212.43it/s]
2021-10-11 11:12:07,100 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 210.37it/s]
2021-10-11 11:12:07,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 208.40it/s]
2021-10-11 11:12:08,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 181.48it/s]
2021-10-11 11:12:08,692 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 208.01it/s]
2021-10-11 11:12:09,218 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 198.13it/s]
2021-10-11 11:12:09,754 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 207.70it/s]
2021-10-11 11:12:10,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 194.45it/s]
2021-10-11 11:12:10,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 204.58it/s]
2021-10-11 11:12:11,351 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 212.33it/s]
2021-10-11 11:12:11,875 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 178.43it/s]
2021-10-11 11:12:12,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 205.24it/s]
2021-10-11 11:12:12,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 193.52it/s]
2021-10-11 11:12:13,522 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 207.43it/s]
2021-10-11 11:12:14,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 204.61it/s]
2021-10-11 11:12:14,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 210.05it/s]
2021-10-11 11:12:15,080 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 205.57it/s]
2021-10-11 11:12:15,608 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 206.39it/s]
2021-10-11 11:12:16,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 211.71it/s]
2021-10-11 11:12:16,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 224.20it/s]
2021-10-11 11:12:17,165 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 203.14it/s]
2021-10-11 11:12:17,738 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 162.02it/s]
2021-10-11 11:12:18,500 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 167.75it/s]
2021-10-11 11:12:19,247 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 203.22it/s]
2021-10-11 11:12:19,980 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 208.83it/s]
2021-10-11 11:12:20,567 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 207.29it/s]
2021-10-11 11:12:21,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 201.59it/s]
2021-10-11 11:12:21,616 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 204.65it/s]
2021-10-11 11:12:22,140 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 197.08it/s]
2021-10-11 11:12:22,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 180.11it/s]
2021-10-11 11:12:23,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 195.62it/s]
2021-10-11 11:12:23,803 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 203.50it/s]
2021-10-11 11:12:24,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 199.01it/s]
2021-10-11 11:12:24,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 196.53it/s]
2021-10-11 11:12:25,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 208.77it/s]
2021-10-11 11:12:25,956 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 178.68it/s]
2021-10-11 11:12:26,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 210.60it/s]
2021-10-11 11:12:27,027 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 201.08it/s]
2021-10-11 11:12:27,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 180.48it/s]
2021-10-11 11:12:28,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 204.99it/s]
2021-10-11 11:12:28,691 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 175.63it/s]
2021-10-11 11:12:29,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 207.27it/s]
2021-10-11 11:12:29,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 204.66it/s]
2021-10-11 11:12:30,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 205.55it/s]
2021-10-11 11:12:30,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 207.17it/s]
2021-10-11 11:12:31,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 204.17it/s]
2021-10-11 11:12:31,946 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 198.17it/s]
2021-10-11 11:12:32,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 192.40it/s]
2021-10-11 11:12:33,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 193.93it/s]
2021-10-11 11:12:33,592 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 206.37it/s]
2021-10-11 11:12:34,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 205.27it/s]
2021-10-11 11:12:34,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 207.58it/s]
2021-10-11 11:12:35,162 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 208.07it/s]
2021-10-11 11:12:35,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 204.98it/s]
2021-10-11 11:12:36,207 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
2021-10-11 11:12:36,208 knodle.trainer.trainer INFO     Train avg loss: 0.1313875101156947
2021-10-11 11:12:36,208 knodle.trainer.trainer INFO     Train avg accuracy: 0.9416966569556129
2021-10-11 11:12:36,208 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:12:36,208 knodle.trainer.trainer INFO     Training done
2021-10-11 11:12:36,208 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 148.82it/s]
2021-10-11 11:12:36,367 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.116359710693359). Denoising stops.
2021-10-11 11:12:36,370 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 39.30it/s]
2021-10-11 11:12:36,965 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:12:36,966 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:12:36,967 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:12:37,937 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:12:37,982 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
Accuracy is: 0.33024805627545356
Precision is: 0.51441833478387
Recall is: 0.5394813169922446
F1 is: 0.30149517583530294
{'0': {'precision': 0.9399477806788512, 'recall': 0.2899718082964156, 'f1-score': 0.44321329639889195, 'support': 2483}, '1': {'precision': 0.08888888888888889, 'recall': 0.7889908256880734, 'f1-score': 0.1597770552717139, 'support': 218}, 'accuracy': 0.33024805627545356, 'macro avg': {'precision': 0.51441833478387, 'recall': 0.5394813169922446, 'f1-score': 0.30149517583530294, 'support': 2701}, 'weighted avg': {'precision': 0.8712580959657036, 'recall': 0.33024805627545356, 'f1-score': 0.420336917070597, 'support': 2701}}
2021-10-11 11:12:38,178 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3991, samples in test set: 1743
2021-10-11 11:12:38,433 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5347, samples in test set: 387
2021-10-11 11:12:39,432 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5412, samples in test set: 322
2021-10-11 11:12:39,839 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4884, samples in test set: 850
2021-10-11 11:12:40,298 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3302, samples in test set: 2432
5it [02:13, 26.74s/it]
2021-10-11 11:14:54,164 knodle.trainer.cleanlab.cleanlab INFO     [[0.18277778 0.81722222]
 [0.05334395 0.94665605]
 [0.23679577 0.76320423]
 [0.21052632 0.78947368]
 [0.79431337 0.20568663]
 [0.92845258 0.07154742]
 [0.69037657 0.30962343]
 [0.10869565 0.89130435]
 [0.125      0.875     ]]
2021-10-11 11:14:54,274 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 202 out of 5734
2021-10-11 11:14:54,274 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:14:54,275 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:14:54,275 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 86.09it/s]
2021-10-11 11:14:55,267 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 215.80it/s]
2021-10-11 11:14:55,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 216.50it/s]
2021-10-11 11:14:56,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 218.21it/s]
2021-10-11 11:14:56,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20811099252934898
100%|██████████| 22/22 [00:00<00:00, 204.27it/s]
2021-10-11 11:14:57,313 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2216293134115973
100%|██████████| 22/22 [00:00<00:00, 212.49it/s]
2021-10-11 11:14:57,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 207.70it/s]
2021-10-11 11:14:58,332 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 218.92it/s]
2021-10-11 11:14:58,838 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 210.02it/s]
2021-10-11 11:14:59,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2152258982568481
100%|██████████| 22/22 [00:00<00:00, 217.30it/s]
2021-10-11 11:14:59,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2287442191390964
100%|██████████| 22/22 [00:00<00:00, 210.85it/s]
2021-10-11 11:15:00,368 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 187.88it/s]
2021-10-11 11:15:00,901 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 212.45it/s]
2021-10-11 11:15:01,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 211.80it/s]
2021-10-11 11:15:01,929 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 212.54it/s]
2021-10-11 11:15:02,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22020633226609748
100%|██████████| 22/22 [00:00<00:00, 217.64it/s]
2021-10-11 11:15:02,935 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 196.05it/s]
2021-10-11 11:15:03,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 206.39it/s]
2021-10-11 11:15:04,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 196.30it/s]
2021-10-11 11:15:04,557 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20988971896122377
100%|██████████| 22/22 [00:00<00:00, 209.93it/s]
2021-10-11 11:15:05,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22020633226609748
100%|██████████| 22/22 [00:00<00:00, 216.36it/s]
2021-10-11 11:15:05,593 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 216.53it/s]
2021-10-11 11:15:06,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20206332266097474
100%|██████████| 22/22 [00:00<00:00, 213.21it/s]
2021-10-11 11:15:06,613 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 102.03it/s]
2021-10-11 11:15:07,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2376378512984703
100%|██████████| 22/22 [00:00<00:00, 214.23it/s]
2021-10-11 11:15:07,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 208.57it/s]
2021-10-11 11:15:08,245 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 221.24it/s]
2021-10-11 11:15:08,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 193.77it/s]
2021-10-11 11:15:09,262 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 207.90it/s]
2021-10-11 11:15:09,779 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 209.29it/s]
2021-10-11 11:15:10,293 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 214.26it/s]
2021-10-11 11:15:10,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 217.34it/s]
2021-10-11 11:15:11,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 206.85it/s]
2021-10-11 11:15:11,799 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 213.56it/s]
2021-10-11 11:15:12,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 204.38it/s]
2021-10-11 11:15:12,801 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22981145499822128
100%|██████████| 22/22 [00:00<00:00, 206.81it/s]
2021-10-11 11:15:13,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 212.59it/s]
2021-10-11 11:15:13,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 199.48it/s]
2021-10-11 11:15:14,376 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 211.09it/s]
2021-10-11 11:15:14,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 203.04it/s]
2021-10-11 11:15:15,406 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 219.04it/s]
2021-10-11 11:15:15,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 218.42it/s]
2021-10-11 11:15:16,414 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 212.21it/s]
2021-10-11 11:15:16,919 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 208.79it/s]
2021-10-11 11:15:17,426 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 216.49it/s]
2021-10-11 11:15:17,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21736036997509783
100%|██████████| 22/22 [00:00<00:00, 201.81it/s]
2021-10-11 11:15:18,431 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 197.99it/s]
2021-10-11 11:15:18,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 213.41it/s]
2021-10-11 11:15:19,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 209.91it/s]
2021-10-11 11:15:19,980 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 212.84it/s]
2021-10-11 11:15:20,482 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 216.56it/s]
2021-10-11 11:15:20,976 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 175.51it/s]
2021-10-11 11:15:21,511 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 202.88it/s]
2021-10-11 11:15:22,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23301316257559587
100%|██████████| 22/22 [00:00<00:00, 218.03it/s]
2021-10-11 11:15:22,593 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 215.16it/s]
2021-10-11 11:15:23,090 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 213.05it/s]
2021-10-11 11:15:23,609 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 220.39it/s]
2021-10-11 11:15:24,103 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 204.79it/s]
2021-10-11 11:15:24,605 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 194.03it/s]
2021-10-11 11:15:25,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 215.16it/s]
2021-10-11 11:15:25,650 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 212.28it/s]
2021-10-11 11:15:26,159 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23265741728922093
100%|██████████| 22/22 [00:00<00:00, 218.76it/s]
2021-10-11 11:15:26,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 208.39it/s]
2021-10-11 11:15:27,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 210.54it/s]
2021-10-11 11:15:27,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 177.45it/s]
2021-10-11 11:15:28,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 207.69it/s]
2021-10-11 11:15:28,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 213.06it/s]
2021-10-11 11:15:29,275 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 210.61it/s]
2021-10-11 11:15:29,796 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3479188900747065
100%|██████████| 22/22 [00:00<00:00, 210.24it/s]
2021-10-11 11:15:30,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 206.79it/s]
2021-10-11 11:15:30,818 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 218.47it/s]
2021-10-11 11:15:31,328 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 201.97it/s]
2021-10-11 11:15:31,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 198.85it/s]
2021-10-11 11:15:32,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 209.55it/s]
2021-10-11 11:15:32,899 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 205.69it/s]
2021-10-11 11:15:33,466 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 205.29it/s]
2021-10-11 11:15:33,994 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 198.11it/s]
2021-10-11 11:15:34,522 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 210.16it/s]
2021-10-11 11:15:35,049 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 205.89it/s]
2021-10-11 11:15:35,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 210.71it/s]
2021-10-11 11:15:36,093 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 212.08it/s]
2021-10-11 11:15:36,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 199.91it/s]
2021-10-11 11:15:37,150 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 213.63it/s]
2021-10-11 11:15:37,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 177.34it/s]
2021-10-11 11:15:38,254 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 206.93it/s]
2021-10-11 11:15:38,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33155460690145855
100%|██████████| 22/22 [00:00<00:00, 201.82it/s]
2021-10-11 11:15:39,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 207.09it/s]
2021-10-11 11:15:39,834 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 202.45it/s]
2021-10-11 11:15:40,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 195.21it/s]
2021-10-11 11:15:40,918 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 203.16it/s]
2021-10-11 11:15:41,447 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 204.16it/s]
2021-10-11 11:15:41,970 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 203.02it/s]
2021-10-11 11:15:42,507 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 184.58it/s]
2021-10-11 11:15:43,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 201.80it/s]
2021-10-11 11:15:43,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 206.81it/s]
2021-10-11 11:15:44,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 210.33it/s]
2021-10-11 11:15:44,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 203.10it/s]
2021-10-11 11:15:45,195 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 206.04it/s]
2021-10-11 11:15:45,721 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 207.52it/s]
2021-10-11 11:15:46,245 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 210.17it/s]
2021-10-11 11:15:46,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
2021-10-11 11:15:46,777 knodle.trainer.trainer INFO     Train avg loss: 0.13586718761196567
2021-10-11 11:15:46,777 knodle.trainer.trainer INFO     Train avg accuracy: 0.9395501086579435
2021-10-11 11:15:46,777 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:15:46,777 knodle.trainer.trainer INFO     Training done
2021-10-11 11:15:46,777 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 148.22it/s]
2021-10-11 11:15:46,934 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9459901800327333, 'recall': 0.22052651659671882, 'f1-score': 0.3576732673267327, 'support': 2621}, '1': {'precision': 0.07136363636363637, 'recall': 0.8263157894736842, 'f1-score': 0.13138075313807532, 'support': 190}, 'accuracy': 0.26147278548559233, 'macro avg': {'precision': 0.5086769081981848, 'recall': 0.5234211530352015, 'f1-score': 0.24452701023240403, 'support': 2811}, 'weighted avg': {'precision': 0.8868727686854804, 'recall': 0.26147278548559233, 'f1-score': 0.3423777932264677, 'support': 2811}}, Dev loss: 3.614193916320801, denoising continues.
2021-10-11 11:15:46,934 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:15:46,959 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:15:47,812 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4442, samples in test set: 1292
2021-10-11 11:15:48,142 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5605, samples in test set: 129
2021-10-11 11:15:48,395 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3598, samples in test set: 2136
2021-10-11 11:15:48,661 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3621, samples in test set: 2113
2021-10-11 11:15:48,869 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5670, samples in test set: 64
5it [02:45, 33.18s/it]
2021-10-11 11:18:34,836 knodle.trainer.cleanlab.cleanlab INFO     [[0.02913009 0.97086991]
 [0.00642398 0.99357602]
 [0.13910761 0.86089239]
 [0.04054054 0.95945946]
 [0.90758294 0.09241706]
 [0.99610136 0.00389864]
 [0.9125     0.0875    ]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:18:34,981 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 37 out of 5734
2021-10-11 11:18:34,981 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:18:34,981 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:18:34,982 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 75.38it/s]
2021-10-11 11:18:36,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 190.03it/s]
2021-10-11 11:18:36,780 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 175.62it/s]
2021-10-11 11:18:37,369 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 190.30it/s]
2021-10-11 11:18:37,935 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 183.28it/s]
2021-10-11 11:18:38,514 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 189.15it/s]
2021-10-11 11:18:39,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 140.97it/s]
2021-10-11 11:18:39,704 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 177.08it/s]
2021-10-11 11:18:40,299 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 169.68it/s]
2021-10-11 11:18:40,937 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 180.69it/s]
2021-10-11 11:18:41,551 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 180.07it/s]
2021-10-11 11:18:42,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 199.28it/s]
2021-10-11 11:18:42,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 196.35it/s]
2021-10-11 11:18:43,221 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 194.38it/s]
2021-10-11 11:18:43,782 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 175.60it/s]
2021-10-11 11:18:44,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 180.44it/s]
2021-10-11 11:18:44,958 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 186.89it/s]
2021-10-11 11:18:45,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 183.82it/s]
2021-10-11 11:18:46,123 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 195.00it/s]
2021-10-11 11:18:46,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 189.77it/s]
2021-10-11 11:18:47,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 189.49it/s]
2021-10-11 11:18:47,846 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 174.36it/s]
2021-10-11 11:18:48,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 170.84it/s]
2021-10-11 11:18:49,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 183.28it/s]
2021-10-11 11:18:49,647 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 191.12it/s]
2021-10-11 11:18:50,228 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 176.78it/s]
2021-10-11 11:18:50,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 171.42it/s]
2021-10-11 11:18:51,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 190.50it/s]
2021-10-11 11:18:52,000 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 172.56it/s]
2021-10-11 11:18:52,596 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 191.76it/s]
2021-10-11 11:18:53,171 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 184.09it/s]
2021-10-11 11:18:53,760 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 192.99it/s]
2021-10-11 11:18:54,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 190.04it/s]
2021-10-11 11:18:54,895 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 185.97it/s]
2021-10-11 11:18:55,476 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 189.67it/s]
2021-10-11 11:18:56,050 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 134.04it/s]
2021-10-11 11:18:56,707 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 122.61it/s]
2021-10-11 11:18:57,533 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 56.37it/s]
2021-10-11 11:18:58,633 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 177.02it/s]
2021-10-11 11:18:59,547 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 146.27it/s]
2021-10-11 11:19:00,191 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 164.40it/s]
2021-10-11 11:19:00,807 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 133.39it/s]
2021-10-11 11:19:01,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 136.29it/s]
2021-10-11 11:19:02,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 163.22it/s]
2021-10-11 11:19:02,909 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 138.64it/s]
2021-10-11 11:19:03,669 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 187.47it/s]
2021-10-11 11:19:04,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 125.74it/s]
2021-10-11 11:19:04,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 161.20it/s]
2021-10-11 11:19:05,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3408039843472074
100%|██████████| 22/22 [00:00<00:00, 197.55it/s]
2021-10-11 11:19:06,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 198.59it/s]
2021-10-11 11:19:06,858 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 194.27it/s]
2021-10-11 11:19:07,433 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 187.87it/s]
2021-10-11 11:19:07,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 198.92it/s]
2021-10-11 11:19:08,540 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 197.71it/s]
2021-10-11 11:19:09,098 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 185.96it/s]
2021-10-11 11:19:09,673 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 193.84it/s]
2021-10-11 11:19:10,231 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 196.99it/s]
2021-10-11 11:19:10,787 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 202.74it/s]
2021-10-11 11:19:11,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 216.19it/s]
2021-10-11 11:19:11,855 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 214.37it/s]
2021-10-11 11:19:12,373 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 197.30it/s]
2021-10-11 11:19:12,896 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 204.82it/s]
2021-10-11 11:19:13,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 217.42it/s]
2021-10-11 11:19:13,914 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 199.44it/s]
2021-10-11 11:19:14,451 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 209.64it/s]
2021-10-11 11:19:14,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 207.69it/s]
2021-10-11 11:19:15,506 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 207.87it/s]
2021-10-11 11:19:16,028 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 203.71it/s]
2021-10-11 11:19:16,547 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 225.76it/s]
2021-10-11 11:19:17,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 217.53it/s]
2021-10-11 11:19:17,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 225.86it/s]
2021-10-11 11:19:18,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 212.76it/s]
2021-10-11 11:19:18,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 202.95it/s]
2021-10-11 11:19:19,032 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 218.25it/s]
2021-10-11 11:19:19,534 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 130.48it/s]
2021-10-11 11:19:20,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 180.21it/s]
2021-10-11 11:19:20,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 185.90it/s]
2021-10-11 11:19:21,397 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 180.12it/s]
2021-10-11 11:19:21,992 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 173.92it/s]
2021-10-11 11:19:22,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 182.16it/s]
2021-10-11 11:19:23,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 182.42it/s]
2021-10-11 11:19:23,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 189.47it/s]
2021-10-11 11:19:24,378 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 195.39it/s]
2021-10-11 11:19:24,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 210.12it/s]
2021-10-11 11:19:25,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 186.22it/s]
2021-10-11 11:19:26,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 166.02it/s]
2021-10-11 11:19:26,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 169.79it/s]
2021-10-11 11:19:27,242 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 135.35it/s]
2021-10-11 11:19:28,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 131.05it/s]
2021-10-11 11:19:28,872 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 133.74it/s]
2021-10-11 11:19:29,590 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 126.67it/s]
2021-10-11 11:19:30,428 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 115.70it/s]
2021-10-11 11:19:31,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 135.17it/s]
2021-10-11 11:19:32,408 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 156.37it/s]
2021-10-11 11:19:33,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 163.58it/s]
2021-10-11 11:19:33,796 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 142.49it/s]
2021-10-11 11:19:34,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 139.10it/s]
2021-10-11 11:19:35,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 140.15it/s]
2021-10-11 11:19:35,964 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 128.24it/s]
2021-10-11 11:19:36,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 150.78it/s]
2021-10-11 11:19:37,502 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
2021-10-11 11:19:37,505 knodle.trainer.trainer INFO     Train avg loss: 0.13143984085776741
2021-10-11 11:19:37,505 knodle.trainer.trainer INFO     Train avg accuracy: 0.9415485428174334
2021-10-11 11:19:37,505 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:19:37,505 knodle.trainer.trainer INFO     Training done
2021-10-11 11:19:37,505 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 113.00it/s]
2021-10-11 11:19:37,711 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.398614406585693). Denoising stops.
2021-10-11 11:19:37,711 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 55.69it/s]
Accuracy is: 0.2987782302850796
Precision is: 0.5147665842594926
Recall is: 0.5370103862226443
F1 is: 0.278849981674138
{'0': {'precision': 0.9415292353823088, 'recall': 0.25291985501409586, 'f1-score': 0.3987301587301587, 'support': 2483}, '1': {'precision': 0.0880039331366765, 'recall': 0.8211009174311926, 'f1-score': 0.15896980461811722, 'support': 218}, 'accuracy': 0.2987782302850796, 'macro avg': {'precision': 0.5147665842594926, 'recall': 0.5370103862226443, 'f1-score': 0.278849981674138, 'support': 2701}, 'weighted avg': {'precision': 0.8726404845901772, 'recall': 0.2987782302850796, 'f1-score': 0.37937889727276325, 'support': 2701}}
2021-10-11 11:19:38,120 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:19:38,120 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:19:38,121 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:19:39,562 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:19:39,605 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:19:39,974 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5132, samples in test set: 602
2021-10-11 11:19:40,295 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5221, samples in test set: 513
2021-10-11 11:19:40,725 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 3626, samples in test set: 2108
2021-10-11 11:19:41,334 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4844, samples in test set: 890
2021-10-11 11:19:41,834 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4113, samples in test set: 1621
5it [02:38, 31.67s/it]
2021-10-11 11:22:20,189 knodle.trainer.cleanlab.cleanlab INFO     [[0.19198193 0.80801807]
 [0.09421488 0.90578512]
 [0.2649063  0.7350937 ]
 [0.17343173 0.82656827]
 [0.77064465 0.22935535]
 [0.92879499 0.07120501]
 [0.89314516 0.10685484]
 [0.14583333 0.85416667]
 [0.16216216 0.83783784]]
2021-10-11 11:22:20,304 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 201 out of 5734
2021-10-11 11:22:20,304 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:22:20,304 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:22:20,304 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 49.59it/s]
2021-10-11 11:22:21,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19494841693347564
100%|██████████| 22/22 [00:00<00:00, 129.06it/s]
2021-10-11 11:22:22,436 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23016720028459622
100%|██████████| 22/22 [00:00<00:00, 145.62it/s]
2021-10-11 11:22:23,230 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20704375667022412
100%|██████████| 22/22 [00:00<00:00, 80.21it/s]
2021-10-11 11:22:24,064 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 151.38it/s]
2021-10-11 11:22:24,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 195.42it/s]
2021-10-11 11:22:25,372 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 160.61it/s]
2021-10-11 11:22:25,997 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22198505869797225
100%|██████████| 22/22 [00:00<00:00, 157.28it/s]
2021-10-11 11:22:26,683 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 158.07it/s]
2021-10-11 11:22:27,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 138.00it/s]
2021-10-11 11:22:28,089 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 124.14it/s]
2021-10-11 11:22:28,931 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 138.59it/s]
2021-10-11 11:22:29,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 161.08it/s]
2021-10-11 11:22:30,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 161.05it/s]
2021-10-11 11:22:31,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 147.09it/s]
2021-10-11 11:22:31,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 180.37it/s]
2021-10-11 11:22:32,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 162.97it/s]
2021-10-11 11:22:33,061 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 128.71it/s]
2021-10-11 11:22:33,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21273568125222342
100%|██████████| 22/22 [00:00<00:00, 86.03it/s]
2021-10-11 11:22:34,598 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 130.48it/s]
2021-10-11 11:22:35,442 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 136.09it/s]
2021-10-11 11:22:36,181 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 145.78it/s]
2021-10-11 11:22:36,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 133.79it/s]
2021-10-11 11:22:37,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 150.09it/s]
2021-10-11 11:22:38,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 150.61it/s]
2021-10-11 11:22:39,099 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 157.28it/s]
2021-10-11 11:22:39,912 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 182.81it/s]
2021-10-11 11:22:40,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 154.95it/s]
2021-10-11 11:22:41,229 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 181.79it/s]
2021-10-11 11:22:41,872 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 145.83it/s]
2021-10-11 11:22:42,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 168.05it/s]
2021-10-11 11:22:43,149 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 193.53it/s]
2021-10-11 11:22:43,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 172.52it/s]
2021-10-11 11:22:44,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 153.03it/s]
2021-10-11 11:22:45,005 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 165.87it/s]
2021-10-11 11:22:45,661 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 163.85it/s]
2021-10-11 11:22:46,306 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34969761650658127
100%|██████████| 22/22 [00:00<00:00, 178.54it/s]
2021-10-11 11:22:46,940 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 156.70it/s]
2021-10-11 11:22:47,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 198.49it/s]
2021-10-11 11:22:48,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 155.62it/s]
2021-10-11 11:22:48,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 188.19it/s]
2021-10-11 11:22:49,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 211.06it/s]
2021-10-11 11:22:49,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 204.49it/s]
2021-10-11 11:22:50,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 204.36it/s]
2021-10-11 11:22:50,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 200.61it/s]
2021-10-11 11:22:51,488 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 158.42it/s]
2021-10-11 11:22:52,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20668801138384915
100%|██████████| 22/22 [00:00<00:00, 186.04it/s]
2021-10-11 11:22:52,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 156.02it/s]
2021-10-11 11:22:53,341 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 162.37it/s]
2021-10-11 11:22:54,018 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 187.61it/s]
2021-10-11 11:22:54,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 183.52it/s]
2021-10-11 11:22:55,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 169.51it/s]
2021-10-11 11:22:55,934 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 174.60it/s]
2021-10-11 11:22:56,515 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 182.97it/s]
2021-10-11 11:22:57,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 167.57it/s]
2021-10-11 11:22:57,716 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 138.42it/s]
2021-10-11 11:22:58,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 154.66it/s]
2021-10-11 11:22:59,198 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 145.21it/s]
2021-10-11 11:22:59,971 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 109.64it/s]
2021-10-11 11:23:00,970 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 104.94it/s]
2021-10-11 11:23:02,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 95.64it/s]
2021-10-11 11:23:03,093 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 98.60it/s]
2021-10-11 11:23:04,434 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 140.46it/s]
2021-10-11 11:23:05,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 109.01it/s]
2021-10-11 11:23:06,343 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 101.20it/s]
2021-10-11 11:23:07,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 97.47it/s]
2021-10-11 11:23:08,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 114.20it/s]
2021-10-11 11:23:09,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 129.42it/s]
2021-10-11 11:23:10,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 116.87it/s]
2021-10-11 11:23:11,295 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 93.96it/s]
2021-10-11 11:23:12,281 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 70.91it/s]
2021-10-11 11:23:13,424 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 90.42it/s]
2021-10-11 11:23:14,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 120.27it/s]
2021-10-11 11:23:15,699 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 109.16it/s]
2021-10-11 11:23:16,654 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 101.64it/s]
2021-10-11 11:23:17,692 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 120.29it/s]
2021-10-11 11:23:18,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 130.97it/s]
2021-10-11 11:23:19,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 102.77it/s]
2021-10-11 11:23:20,661 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 124.57it/s]
2021-10-11 11:23:21,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 109.13it/s]
2021-10-11 11:23:22,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 103.11it/s]
2021-10-11 11:23:23,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 119.93it/s]
2021-10-11 11:23:24,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 108.33it/s]
2021-10-11 11:23:25,484 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 130.00it/s]
2021-10-11 11:23:26,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 136.48it/s]
2021-10-11 11:23:27,058 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 132.09it/s]
2021-10-11 11:23:27,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 127.36it/s]
2021-10-11 11:23:28,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 143.77it/s]
2021-10-11 11:23:29,561 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 129.23it/s]
2021-10-11 11:23:30,336 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 168.45it/s]
2021-10-11 11:23:31,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 156.83it/s]
2021-10-11 11:23:31,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 150.28it/s]
2021-10-11 11:23:32,356 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 163.12it/s]
2021-10-11 11:23:33,035 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 164.51it/s]
2021-10-11 11:23:33,747 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 171.86it/s]
2021-10-11 11:23:34,417 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 152.08it/s]
2021-10-11 11:23:35,116 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 175.77it/s]
2021-10-11 11:23:35,770 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 171.10it/s]
2021-10-11 11:23:36,389 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 156.31it/s]
2021-10-11 11:23:37,067 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 169.11it/s]
2021-10-11 11:23:37,735 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
2021-10-11 11:23:37,736 knodle.trainer.trainer INFO     Train avg loss: 0.1340228665464869
2021-10-11 11:23:37,736 knodle.trainer.trainer INFO     Train avg accuracy: 0.9401624112659032
2021-10-11 11:23:37,736 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:23:37,736 knodle.trainer.trainer INFO     Training done
2021-10-11 11:23:37,736 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 113.93it/s]
2021-10-11 11:23:37,942 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9364069952305246, 'recall': 0.22472338801983976, 'f1-score': 0.3624615384615385, 'support': 2621}, '1': {'precision': 0.06874427131072411, 'recall': 0.7894736842105263, 'f1-score': 0.12647554806070826, 'support': 190}, 'accuracy': 0.26289576663109215, 'macro avg': {'precision': 0.5025756332706244, 'recall': 0.5070985361151831, 'f1-score': 0.24446854326112338, 'support': 2811}, 'weighted avg': {'precision': 0.8777602796329572, 'recall': 0.26289576663109215, 'f1-score': 0.3465108667517705, 'support': 2811}}, Dev loss: 3.7337806224823, denoising continues.
2021-10-11 11:23:37,942 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:23:37,983 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:23:38,358 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4008, samples in test set: 1726
2021-10-11 11:23:38,531 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4055, samples in test set: 1679
2021-10-11 11:23:38,681 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5380, samples in test set: 354
2021-10-11 11:23:38,840 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4097, samples in test set: 1637
2021-10-11 11:23:39,001 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5396, samples in test set: 338
5it [03:27, 41.55s/it]
2021-10-11 11:27:06,895 knodle.trainer.cleanlab.cleanlab INFO     [[0.01847291 0.98152709]
 [0.00550661 0.99449339]
 [0.11002445 0.88997555]
 [0.01470588 0.98529412]
 [0.97022333 0.02977667]
 [0.99303944 0.00696056]
 [0.87719298 0.12280702]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:27:07,049 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 28 out of 5734
2021-10-11 11:27:07,050 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:27:07,050 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:27:07,050 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 54.81it/s]
2021-10-11 11:27:08,329 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 146.05it/s]
2021-10-11 11:27:09,005 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19779437922447526
100%|██████████| 22/22 [00:00<00:00, 122.42it/s]
2021-10-11 11:27:09,864 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24439701173959444
100%|██████████| 22/22 [00:00<00:00, 162.20it/s]
2021-10-11 11:27:10,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 176.57it/s]
2021-10-11 11:27:11,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 132.44it/s]
2021-10-11 11:27:12,080 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 140.65it/s]
2021-10-11 11:27:12,809 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 131.56it/s]
2021-10-11 11:27:13,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 133.72it/s]
2021-10-11 11:27:14,468 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 148.58it/s]
2021-10-11 11:27:15,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 156.90it/s]
2021-10-11 11:27:15,888 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 155.82it/s]
2021-10-11 11:27:16,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 142.39it/s]
2021-10-11 11:27:17,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 113.88it/s]
2021-10-11 11:27:18,024 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 108.95it/s]
2021-10-11 11:27:19,311 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21807186054784775
100%|██████████| 22/22 [00:00<00:00, 109.73it/s]
2021-10-11 11:27:20,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 120.71it/s]
2021-10-11 11:27:21,038 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 132.77it/s]
2021-10-11 11:27:21,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 133.29it/s]
2021-10-11 11:27:22,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 127.23it/s]
2021-10-11 11:27:23,385 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2351476342938456
100%|██████████| 22/22 [00:00<00:00, 151.18it/s]
2021-10-11 11:27:24,162 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 128.65it/s]
2021-10-11 11:27:24,916 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 141.58it/s]
2021-10-11 11:27:25,680 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 130.09it/s]
2021-10-11 11:27:26,382 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 76.96it/s]
2021-10-11 11:27:27,441 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 108.86it/s]
2021-10-11 11:27:28,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 137.88it/s]
2021-10-11 11:27:29,343 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 132.23it/s]
2021-10-11 11:27:30,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 69.25it/s]
2021-10-11 11:27:31,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 164.99it/s]
2021-10-11 11:27:31,813 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 149.40it/s]
2021-10-11 11:27:32,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 132.97it/s]
2021-10-11 11:27:33,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 146.78it/s]
2021-10-11 11:27:33,958 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 128.10it/s]
2021-10-11 11:27:34,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 110.36it/s]
2021-10-11 11:27:35,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 105.74it/s]
2021-10-11 11:27:36,642 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 118.26it/s]
2021-10-11 11:27:37,515 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 135.22it/s]
2021-10-11 11:27:38,390 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 136.69it/s]
2021-10-11 11:27:39,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 158.11it/s]
2021-10-11 11:27:39,904 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 133.68it/s]
2021-10-11 11:27:40,722 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 164.68it/s]
2021-10-11 11:27:41,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 158.78it/s]
2021-10-11 11:27:42,124 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 138.09it/s]
2021-10-11 11:27:42,845 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 164.54it/s]
2021-10-11 11:27:43,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 142.33it/s]
2021-10-11 11:27:44,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 134.17it/s]
2021-10-11 11:27:45,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 147.35it/s]
2021-10-11 11:27:45,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23372465314834578
100%|██████████| 22/22 [00:00<00:00, 145.62it/s]
2021-10-11 11:27:46,542 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 151.04it/s]
2021-10-11 11:27:47,249 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 103.24it/s]
2021-10-11 11:27:48,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 132.09it/s]
2021-10-11 11:27:49,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 122.88it/s]
2021-10-11 11:27:49,822 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 130.58it/s]
2021-10-11 11:27:50,626 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 135.01it/s]
2021-10-11 11:27:51,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 138.59it/s]
2021-10-11 11:27:52,231 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 143.53it/s]
2021-10-11 11:27:53,019 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 153.81it/s]
2021-10-11 11:27:53,794 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 87.20it/s]
2021-10-11 11:27:54,756 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 128.64it/s]
2021-10-11 11:27:55,709 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 65.76it/s]
2021-10-11 11:27:56,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 152.17it/s]
2021-10-11 11:27:57,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 153.49it/s]
2021-10-11 11:27:58,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 161.69it/s]
2021-10-11 11:27:59,012 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 144.93it/s]
2021-10-11 11:27:59,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 134.02it/s]
2021-10-11 11:28:00,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 163.77it/s]
2021-10-11 11:28:01,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 128.77it/s]
2021-10-11 11:28:01,910 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 140.67it/s]
2021-10-11 11:28:02,679 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 127.91it/s]
2021-10-11 11:28:03,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 144.88it/s]
2021-10-11 11:28:04,216 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 162.78it/s]
2021-10-11 11:28:04,908 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 145.03it/s]
2021-10-11 11:28:05,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 151.69it/s]
2021-10-11 11:28:06,337 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 153.87it/s]
2021-10-11 11:28:07,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 75.92it/s]
2021-10-11 11:28:08,076 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 129.45it/s]
2021-10-11 11:28:09,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 133.24it/s]
2021-10-11 11:28:09,858 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 146.18it/s]
2021-10-11 11:28:10,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2511561721807186
100%|██████████| 22/22 [00:00<00:00, 148.84it/s]
2021-10-11 11:28:11,351 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 168.76it/s]
2021-10-11 11:28:12,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 113.48it/s]
2021-10-11 11:28:12,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 162.45it/s]
2021-10-11 11:28:13,551 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 168.28it/s]
2021-10-11 11:28:14,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 171.10it/s]
2021-10-11 11:28:14,869 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 170.41it/s]
2021-10-11 11:28:15,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 144.34it/s]
2021-10-11 11:28:16,250 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 142.36it/s]
2021-10-11 11:28:16,988 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 146.03it/s]
2021-10-11 11:28:17,730 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 145.60it/s]
2021-10-11 11:28:18,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 121.15it/s]
2021-10-11 11:28:19,216 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2280327285663465
100%|██████████| 22/22 [00:00<00:00, 143.32it/s]
2021-10-11 11:28:20,037 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 145.61it/s]
2021-10-11 11:28:20,777 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 122.23it/s]
2021-10-11 11:28:21,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 139.48it/s]
2021-10-11 11:28:22,323 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 159.38it/s]
2021-10-11 11:28:23,040 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 146.20it/s]
2021-10-11 11:28:23,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 171.22it/s]
2021-10-11 11:28:24,425 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 173.88it/s]
2021-10-11 11:28:25,058 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
100%|██████████| 22/22 [00:00<00:00, 178.10it/s]
2021-10-11 11:28:25,673 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
2021-10-11 11:28:25,674 knodle.trainer.trainer INFO     Train avg loss: 0.1342538817723592
2021-10-11 11:28:25,675 knodle.trainer.trainer INFO     Train avg accuracy: 0.9397783221668671
2021-10-11 11:28:25,675 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:28:25,675 knodle.trainer.trainer INFO     Training done
2021-10-11 11:28:25,675 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 126.22it/s]
2021-10-11 11:28:25,861 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.112817764282227). Denoising stops.
2021-10-11 11:28:25,861 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 44.38it/s]
2021-10-11 11:28:26,369 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:28:26,370 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:28:26,370 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.32432432432432434
Precision is: 0.522337615501579
Recall is: 0.5592737033848518
F1 is: 0.29934412187907805
{'0': {'precision': 0.9519230769230769, 'recall': 0.2790978654853, 'f1-score': 0.4316412332606664, 'support': 2483}, '1': {'precision': 0.0927521540800811, 'recall': 0.8394495412844036, 'f1-score': 0.16704701049748974, 'support': 218}, 'accuracy': 0.32432432432432434, 'macro avg': {'precision': 0.522337615501579, 'recall': 0.5592737033848518, 'f1-score': 0.29934412187907805, 'support': 2701}, 'weighted avg': {'precision': 0.8825786633059821, 'recall': 0.32432432432432434, 'f1-score': 0.4102856092094363, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:28:28,644 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:28:28,720 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:28:29,155 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3216, samples in test set: 2518
2021-10-11 11:28:29,572 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4084, samples in test set: 1650
2021-10-11 11:28:30,057 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5426, samples in test set: 308
2021-10-11 11:28:30,562 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4777, samples in test set: 957
2021-10-11 11:28:30,983 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5433, samples in test set: 301
5it [03:02, 36.48s/it]
2021-10-11 11:31:33,495 knodle.trainer.cleanlab.cleanlab INFO     [[0.1602602  0.8397398 ]
 [0.0317965  0.9682035 ]
 [0.29405941 0.70594059]
 [0.27725118 0.72274882]
 [0.83957055 0.16042945]
 [0.88793103 0.11206897]
 [0.74867725 0.25132275]
 [0.1        0.9       ]
 [0.13888889 0.86111111]]
2021-10-11 11:31:33,646 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 181 out of 5734
2021-10-11 11:31:33,647 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:31:33,647 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:31:33,647 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 63.22it/s]
2021-10-11 11:31:34,754 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 157.34it/s]
2021-10-11 11:31:35,502 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 185.37it/s]
2021-10-11 11:31:36,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20455353966559944
100%|██████████| 22/22 [00:00<00:00, 185.27it/s]
2021-10-11 11:31:36,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2102454642475987
100%|██████████| 22/22 [00:00<00:00, 192.20it/s]
2021-10-11 11:31:37,243 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2063322660974742
100%|██████████| 22/22 [00:00<00:00, 198.26it/s]
2021-10-11 11:31:37,802 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 153.19it/s]
2021-10-11 11:31:38,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 151.85it/s]
2021-10-11 11:31:39,093 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 195.41it/s]
2021-10-11 11:31:39,703 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 193.34it/s]
2021-10-11 11:31:40,283 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 192.76it/s]
2021-10-11 11:31:40,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21415866239772324
100%|██████████| 22/22 [00:00<00:00, 185.34it/s]
2021-10-11 11:31:41,445 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 194.29it/s]
2021-10-11 11:31:42,005 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 165.31it/s]
2021-10-11 11:31:42,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 179.68it/s]
2021-10-11 11:31:43,270 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23941657773034508
100%|██████████| 22/22 [00:00<00:00, 180.27it/s]
2021-10-11 11:31:43,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 187.48it/s]
2021-10-11 11:31:44,442 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 191.89it/s]
2021-10-11 11:31:45,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 161.17it/s]
2021-10-11 11:31:45,603 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 173.81it/s]
2021-10-11 11:31:46,239 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 169.33it/s]
2021-10-11 11:31:46,850 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 159.89it/s]
2021-10-11 11:31:47,495 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 151.74it/s]
2021-10-11 11:31:48,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 169.72it/s]
2021-10-11 11:31:48,794 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22340803984347207
100%|██████████| 22/22 [00:00<00:00, 163.31it/s]
2021-10-11 11:31:49,519 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 167.75it/s]
2021-10-11 11:31:50,149 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 172.18it/s]
2021-10-11 11:31:50,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 165.43it/s]
2021-10-11 11:31:51,393 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 176.91it/s]
2021-10-11 11:31:52,031 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 162.17it/s]
2021-10-11 11:31:52,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2294557097118463
100%|██████████| 22/22 [00:00<00:00, 158.82it/s]
2021-10-11 11:31:53,396 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 156.05it/s]
2021-10-11 11:31:54,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 176.13it/s]
2021-10-11 11:31:54,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 162.93it/s]
2021-10-11 11:31:55,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 162.32it/s]
2021-10-11 11:31:56,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20846673781572395
100%|██████████| 22/22 [00:00<00:00, 148.46it/s]
2021-10-11 11:31:56,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 164.67it/s]
2021-10-11 11:31:57,486 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 167.91it/s]
2021-10-11 11:31:58,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 159.42it/s]
2021-10-11 11:31:58,960 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 168.42it/s]
2021-10-11 11:31:59,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 165.73it/s]
2021-10-11 11:32:00,344 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 125.02it/s]
2021-10-11 11:32:01,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 156.80it/s]
2021-10-11 11:32:01,780 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 162.51it/s]
2021-10-11 11:32:02,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 176.06it/s]
2021-10-11 11:32:03,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 174.53it/s]
2021-10-11 11:32:03,680 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 168.39it/s]
2021-10-11 11:32:04,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22732123799359658
100%|██████████| 22/22 [00:00<00:00, 171.79it/s]
2021-10-11 11:32:04,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 166.24it/s]
2021-10-11 11:32:05,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 167.91it/s]
2021-10-11 11:32:06,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 163.01it/s]
2021-10-11 11:32:06,875 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 158.75it/s]
2021-10-11 11:32:07,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 182.26it/s]
2021-10-11 11:32:08,162 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 173.71it/s]
2021-10-11 11:32:08,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 176.35it/s]
2021-10-11 11:32:09,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 177.55it/s]
2021-10-11 11:32:10,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 179.15it/s]
2021-10-11 11:32:10,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 190.94it/s]
2021-10-11 11:32:11,198 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 187.68it/s]
2021-10-11 11:32:11,772 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 191.43it/s]
2021-10-11 11:32:12,334 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 166.96it/s]
2021-10-11 11:32:12,921 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 190.94it/s]
2021-10-11 11:32:13,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 191.69it/s]
2021-10-11 11:32:14,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 192.60it/s]
2021-10-11 11:32:14,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 144.46it/s]
2021-10-11 11:32:15,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 184.75it/s]
2021-10-11 11:32:15,898 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 173.08it/s]
2021-10-11 11:32:16,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 190.77it/s]
2021-10-11 11:32:17,074 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23977232301672002
100%|██████████| 22/22 [00:00<00:00, 195.64it/s]
2021-10-11 11:32:17,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 175.69it/s]
2021-10-11 11:32:18,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 194.45it/s]
2021-10-11 11:32:18,789 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 182.24it/s]
2021-10-11 11:32:19,371 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 200.95it/s]
2021-10-11 11:32:19,927 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 192.76it/s]
2021-10-11 11:32:20,476 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 197.11it/s]
2021-10-11 11:32:21,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 191.73it/s]
2021-10-11 11:32:21,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 195.15it/s]
2021-10-11 11:32:22,126 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 202.44it/s]
2021-10-11 11:32:22,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 201.96it/s]
2021-10-11 11:32:23,205 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23087869085734614
100%|██████████| 22/22 [00:00<00:00, 201.97it/s]
2021-10-11 11:32:23,748 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 199.40it/s]
2021-10-11 11:32:24,293 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 201.72it/s]
2021-10-11 11:32:24,834 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 206.81it/s]
2021-10-11 11:32:25,380 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 207.69it/s]
2021-10-11 11:32:25,903 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 208.03it/s]
2021-10-11 11:32:26,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 207.39it/s]
2021-10-11 11:32:26,954 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 203.65it/s]
2021-10-11 11:32:27,481 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 200.94it/s]
2021-10-11 11:32:28,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 202.37it/s]
2021-10-11 11:32:28,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2376378512984703
100%|██████████| 22/22 [00:00<00:00, 198.02it/s]
2021-10-11 11:32:29,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 197.19it/s]
2021-10-11 11:32:29,657 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 206.97it/s]
2021-10-11 11:32:30,198 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 208.29it/s]
2021-10-11 11:32:30,749 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 202.21it/s]
2021-10-11 11:32:31,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2376378512984703
100%|██████████| 22/22 [00:00<00:00, 212.34it/s]
2021-10-11 11:32:31,815 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 216.53it/s]
2021-10-11 11:32:32,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 196.04it/s]
2021-10-11 11:32:32,872 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 199.98it/s]
2021-10-11 11:32:33,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 179.31it/s]
2021-10-11 11:32:34,024 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 202.17it/s]
2021-10-11 11:32:34,580 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
2021-10-11 11:32:34,581 knodle.trainer.trainer INFO     Train avg loss: 0.13313097315364414
2021-10-11 11:32:34,581 knodle.trainer.trainer INFO     Train avg accuracy: 0.9407128265963653
2021-10-11 11:32:34,581 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:32:34,581 knodle.trainer.trainer INFO     Training done
2021-10-11 11:32:34,581 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 133.70it/s]
2021-10-11 11:32:34,755 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9426229508196722, 'recall': 0.2632582983594048, 'f1-score': 0.4115717268118103, 'support': 2621}, '1': {'precision': 0.07118807118807119, 'recall': 0.7789473684210526, 'f1-score': 0.13045394446892902, 'support': 190}, 'accuracy': 0.29811454998221276, 'macro avg': {'precision': 0.5069055110038717, 'recall': 0.5211028333902287, 'f1-score': 0.27101283564036965, 'support': 2811}, 'weighted avg': {'precision': 0.883721269165455, 'recall': 0.2981145499822127, 'f1-score': 0.39257052487472477, 'support': 2811}}, Dev loss: 3.3477096557617188, denoising continues.
2021-10-11 11:32:34,755 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:32:34,784 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:32:35,688 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3188, samples in test set: 2546
2021-10-11 11:32:36,017 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5143, samples in test set: 591
2021-10-11 11:32:36,368 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4275, samples in test set: 1459
2021-10-11 11:32:36,799 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4887, samples in test set: 847
2021-10-11 11:32:37,199 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5443, samples in test set: 291
5it [02:20, 28.01s/it]
2021-10-11 11:34:57,348 knodle.trainer.cleanlab.cleanlab INFO     [[0.02293259 0.97706741]
 [0.00678295 0.99321705]
 [0.15165165 0.84834835]
 [0.05424528 0.94575472]
 [0.9575678  0.0424322 ]
 [0.99662162 0.00337838]
 [0.98192771 0.01807229]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:34:57,459 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 14 out of 5734
2021-10-11 11:34:57,459 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:34:57,459 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:34:57,460 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 202.88it/s]
2021-10-11 11:34:57,938 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 206.76it/s]
2021-10-11 11:34:58,452 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 215.20it/s]
2021-10-11 11:34:58,961 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 205.34it/s]
2021-10-11 11:34:59,487 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 220.32it/s]
2021-10-11 11:34:59,996 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 201.92it/s]
2021-10-11 11:35:00,518 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 209.07it/s]
2021-10-11 11:35:01,042 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3536108146567058
100%|██████████| 22/22 [00:00<00:00, 204.46it/s]
2021-10-11 11:35:01,549 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 215.72it/s]
2021-10-11 11:35:02,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 205.40it/s]
2021-10-11 11:35:02,579 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 214.65it/s]
2021-10-11 11:35:03,079 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 224.24it/s]
2021-10-11 11:35:03,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 221.81it/s]
2021-10-11 11:35:04,067 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 96.89it/s]
2021-10-11 11:35:04,683 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 217.37it/s]
2021-10-11 11:35:05,171 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 214.82it/s]
2021-10-11 11:35:05,669 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 219.06it/s]
2021-10-11 11:35:06,156 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 227.89it/s]
2021-10-11 11:35:06,637 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 199.80it/s]
2021-10-11 11:35:07,169 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 215.40it/s]
2021-10-11 11:35:07,670 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 214.11it/s]
2021-10-11 11:35:08,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 208.42it/s]
2021-10-11 11:35:08,683 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 213.00it/s]
2021-10-11 11:35:09,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 209.94it/s]
2021-10-11 11:35:09,695 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 215.02it/s]
2021-10-11 11:35:10,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 212.24it/s]
2021-10-11 11:35:10,713 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 215.34it/s]
2021-10-11 11:35:11,210 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 217.61it/s]
2021-10-11 11:35:11,721 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 206.59it/s]
2021-10-11 11:35:12,235 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 211.61it/s]
2021-10-11 11:35:12,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 216.58it/s]
2021-10-11 11:35:13,245 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 221.85it/s]
2021-10-11 11:35:13,733 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 208.18it/s]
2021-10-11 11:35:14,229 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 221.81it/s]
2021-10-11 11:35:14,738 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 214.07it/s]
2021-10-11 11:35:15,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 213.82it/s]
2021-10-11 11:35:15,748 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 219.58it/s]
2021-10-11 11:35:16,256 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 218.16it/s]
2021-10-11 11:35:16,743 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 217.67it/s]
2021-10-11 11:35:17,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 218.15it/s]
2021-10-11 11:35:17,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 217.90it/s]
2021-10-11 11:35:18,229 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 219.42it/s]
2021-10-11 11:35:18,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 206.85it/s]
2021-10-11 11:35:19,223 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 212.97it/s]
2021-10-11 11:35:19,729 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 211.07it/s]
2021-10-11 11:35:20,224 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 225.94it/s]
2021-10-11 11:35:20,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 216.45it/s]
2021-10-11 11:35:21,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 221.21it/s]
2021-10-11 11:35:21,676 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 208.05it/s]
2021-10-11 11:35:22,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 215.05it/s]
2021-10-11 11:35:22,682 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 213.92it/s]
2021-10-11 11:35:23,174 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 215.72it/s]
2021-10-11 11:35:23,683 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 203.62it/s]
2021-10-11 11:35:24,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 210.90it/s]
2021-10-11 11:35:24,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 205.56it/s]
2021-10-11 11:35:25,230 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 210.92it/s]
2021-10-11 11:35:25,742 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 203.98it/s]
2021-10-11 11:35:26,254 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 205.88it/s]
2021-10-11 11:35:26,783 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 197.75it/s]
2021-10-11 11:35:27,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 193.93it/s]
2021-10-11 11:35:27,856 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 192.40it/s]
2021-10-11 11:35:28,413 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 204.65it/s]
2021-10-11 11:35:28,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 197.54it/s]
2021-10-11 11:35:29,484 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 190.57it/s]
2021-10-11 11:35:30,038 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 194.40it/s]
2021-10-11 11:35:30,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 203.20it/s]
2021-10-11 11:35:31,094 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 196.13it/s]
2021-10-11 11:35:31,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 193.77it/s]
2021-10-11 11:35:32,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 196.54it/s]
2021-10-11 11:35:32,711 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 199.99it/s]
2021-10-11 11:35:33,253 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 198.85it/s]
2021-10-11 11:35:33,785 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 199.55it/s]
2021-10-11 11:35:34,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 201.21it/s]
2021-10-11 11:35:34,866 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
100%|██████████| 22/22 [00:00<00:00, 209.89it/s]
2021-10-11 11:35:35,389 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 192.72it/s]
2021-10-11 11:35:35,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 179.88it/s]
2021-10-11 11:35:36,522 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 186.41it/s]
2021-10-11 11:35:37,072 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 199.71it/s]
2021-10-11 11:35:37,613 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 188.11it/s]
2021-10-11 11:35:38,178 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 196.06it/s]
2021-10-11 11:35:38,723 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 192.18it/s]
2021-10-11 11:35:39,266 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 190.78it/s]
2021-10-11 11:35:39,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 187.93it/s]
2021-10-11 11:35:40,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 199.08it/s]
2021-10-11 11:35:40,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 198.34it/s]
2021-10-11 11:35:41,474 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 190.73it/s]
2021-10-11 11:35:42,018 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3457844183564568
100%|██████████| 22/22 [00:00<00:00, 199.50it/s]
2021-10-11 11:35:42,562 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 208.73it/s]
2021-10-11 11:35:43,098 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 198.83it/s]
2021-10-11 11:35:43,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 202.79it/s]
2021-10-11 11:35:44,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 201.20it/s]
2021-10-11 11:35:44,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 192.67it/s]
2021-10-11 11:35:45,244 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 199.65it/s]
2021-10-11 11:35:45,780 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 205.26it/s]
2021-10-11 11:35:46,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 189.85it/s]
2021-10-11 11:35:46,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3408039843472074
100%|██████████| 22/22 [00:00<00:00, 196.25it/s]
2021-10-11 11:35:47,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 200.06it/s]
2021-10-11 11:35:47,978 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 199.64it/s]
2021-10-11 11:35:48,512 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 198.13it/s]
2021-10-11 11:35:49,033 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 202.34it/s]
2021-10-11 11:35:49,589 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
2021-10-11 11:35:49,591 knodle.trainer.trainer INFO     Train avg loss: 0.13130510013881655
2021-10-11 11:35:49,591 knodle.trainer.trainer INFO     Train avg accuracy: 0.9415285945600931
2021-10-11 11:35:49,591 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:35:49,591 knodle.trainer.trainer INFO     Training done
2021-10-11 11:35:49,591 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 141.92it/s]
2021-10-11 11:35:49,756 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.178380489349365). Denoising stops.
2021-10-11 11:35:49,756 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 71.95it/s]
2021-10-11 11:35:50,070 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:35:50,070 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:35:50,070 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.3320992225101814
Precision is: 0.5178847009590896
Recall is: 0.548856998230167
F1 is: 0.30375218479258614
{'0': {'precision': 0.944954128440367, 'recall': 0.2903745469190495, 'f1-score': 0.44423906346272335, 'support': 2483}, '1': {'precision': 0.09081527347781218, 'recall': 0.8073394495412844, 'f1-score': 0.163265306122449, 'support': 218}, 'accuracy': 0.3320992225101814, 'macro avg': {'precision': 0.5178847009590896, 'recall': 0.548856998230167, 'f1-score': 0.30375218479258614, 'support': 2701}, 'weighted avg': {'precision': 0.8760158572882614, 'recall': 0.3320992225101814, 'f1-score': 0.42156143328864715, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:35:50,684 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:35:50,710 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:35:50,847 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3613, samples in test set: 2121
2021-10-11 11:35:50,974 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5398, samples in test set: 336
2021-10-11 11:35:51,158 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5110, samples in test set: 624
2021-10-11 11:35:51,515 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5688, samples in test set: 46
2021-10-11 11:35:51,996 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3127, samples in test set: 2607
5it [02:29, 29.92s/it]
2021-10-11 11:38:21,732 knodle.trainer.cleanlab.cleanlab INFO     [[0.20227273 0.79772727]
 [0.05152979 0.94847021]
 [0.33278146 0.66721854]
 [0.04745763 0.95254237]
 [0.79693593 0.20306407]
 [0.97082019 0.02917981]
 [0.69396552 0.30603448]
 [0.1        0.9       ]
 [0.12162162 0.87837838]]
2021-10-11 11:38:21,858 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 199 out of 5734
2021-10-11 11:38:21,859 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:38:21,859 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:38:21,859 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 152.46it/s]
2021-10-11 11:38:22,657 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2152258982568481
100%|██████████| 22/22 [00:00<00:00, 189.56it/s]
2021-10-11 11:38:23,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 191.04it/s]
2021-10-11 11:38:23,770 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 200.94it/s]
2021-10-11 11:38:24,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 191.34it/s]
2021-10-11 11:38:24,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 193.77it/s]
2021-10-11 11:38:25,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2504446816079687
100%|██████████| 22/22 [00:00<00:00, 197.55it/s]
2021-10-11 11:38:26,004 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2287442191390964
100%|██████████| 22/22 [00:00<00:00, 185.72it/s]
2021-10-11 11:38:26,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2287442191390964
100%|██████████| 22/22 [00:00<00:00, 182.04it/s]
2021-10-11 11:38:27,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 192.94it/s]
2021-10-11 11:38:27,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21700462468872286
100%|██████████| 22/22 [00:00<00:00, 193.36it/s]
2021-10-11 11:38:28,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 189.14it/s]
2021-10-11 11:38:28,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 198.48it/s]
2021-10-11 11:38:29,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 201.55it/s]
2021-10-11 11:38:29,893 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 191.67it/s]
2021-10-11 11:38:30,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20277481323372465
100%|██████████| 22/22 [00:00<00:00, 198.47it/s]
2021-10-11 11:38:30,992 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 186.23it/s]
2021-10-11 11:38:31,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22732123799359658
100%|██████████| 22/22 [00:00<00:00, 201.70it/s]
2021-10-11 11:38:32,082 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 204.86it/s]
2021-10-11 11:38:32,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 193.55it/s]
2021-10-11 11:38:33,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 200.53it/s]
2021-10-11 11:38:33,701 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 199.65it/s]
2021-10-11 11:38:34,239 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
100%|██████████| 22/22 [00:00<00:00, 197.67it/s]
2021-10-11 11:38:34,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 199.15it/s]
2021-10-11 11:38:35,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 172.39it/s]
2021-10-11 11:38:35,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 174.54it/s]
2021-10-11 11:38:36,555 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 188.09it/s]
2021-10-11 11:38:37,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 193.98it/s]
2021-10-11 11:38:37,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 188.33it/s]
2021-10-11 11:38:38,221 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 201.21it/s]
2021-10-11 11:38:38,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 204.21it/s]
2021-10-11 11:38:39,304 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 179.63it/s]
2021-10-11 11:38:39,971 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 186.33it/s]
2021-10-11 11:38:40,533 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 194.31it/s]
2021-10-11 11:38:41,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 184.01it/s]
2021-10-11 11:38:41,682 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 182.82it/s]
2021-10-11 11:38:42,251 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 188.59it/s]
2021-10-11 11:38:42,818 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 190.23it/s]
2021-10-11 11:38:43,386 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 94.74it/s]
2021-10-11 11:38:44,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 184.15it/s]
2021-10-11 11:38:44,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 185.05it/s]
2021-10-11 11:38:45,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2006403415154749
100%|██████████| 22/22 [00:00<00:00, 187.28it/s]
2021-10-11 11:38:45,805 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 186.70it/s]
2021-10-11 11:38:46,392 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 191.40it/s]
2021-10-11 11:38:46,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 186.30it/s]
2021-10-11 11:38:47,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 176.70it/s]
2021-10-11 11:38:48,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 184.04it/s]
2021-10-11 11:38:48,738 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 159.50it/s]
2021-10-11 11:38:49,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 178.63it/s]
2021-10-11 11:38:50,001 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 185.08it/s]
2021-10-11 11:38:50,589 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 172.57it/s]
2021-10-11 11:38:51,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 178.90it/s]
2021-10-11 11:38:51,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 170.82it/s]
2021-10-11 11:38:52,410 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 176.93it/s]
2021-10-11 11:38:53,011 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 163.67it/s]
2021-10-11 11:38:53,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 174.99it/s]
2021-10-11 11:38:54,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 178.87it/s]
2021-10-11 11:38:54,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 178.13it/s]
2021-10-11 11:38:55,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 181.97it/s]
2021-10-11 11:38:56,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 179.01it/s]
2021-10-11 11:38:56,680 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 180.21it/s]
2021-10-11 11:38:57,279 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 183.03it/s]
2021-10-11 11:38:57,879 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 179.13it/s]
2021-10-11 11:38:58,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 187.95it/s]
2021-10-11 11:38:59,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 182.08it/s]
2021-10-11 11:38:59,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 179.50it/s]
2021-10-11 11:39:00,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3528993240839559
100%|██████████| 22/22 [00:00<00:00, 171.22it/s]
2021-10-11 11:39:00,868 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 186.65it/s]
2021-10-11 11:39:01,441 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 193.34it/s]
2021-10-11 11:39:02,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 190.01it/s]
2021-10-11 11:39:02,567 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 186.04it/s]
2021-10-11 11:39:03,126 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 190.68it/s]
2021-10-11 11:39:03,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 195.15it/s]
2021-10-11 11:39:04,254 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 197.06it/s]
2021-10-11 11:39:04,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23016720028459622
100%|██████████| 22/22 [00:00<00:00, 199.98it/s]
2021-10-11 11:39:05,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 196.29it/s]
2021-10-11 11:39:05,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 193.27it/s]
2021-10-11 11:39:06,437 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 197.20it/s]
2021-10-11 11:39:06,992 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 178.69it/s]
2021-10-11 11:39:07,565 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 197.19it/s]
2021-10-11 11:39:08,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 204.47it/s]
2021-10-11 11:39:08,654 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 196.02it/s]
2021-10-11 11:39:09,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 192.93it/s]
2021-10-11 11:39:09,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 186.13it/s]
2021-10-11 11:39:10,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 190.88it/s]
2021-10-11 11:39:10,876 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 195.16it/s]
2021-10-11 11:39:11,409 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 200.02it/s]
2021-10-11 11:39:11,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 194.41it/s]
2021-10-11 11:39:12,491 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2198505869797225
100%|██████████| 22/22 [00:00<00:00, 198.26it/s]
2021-10-11 11:39:13,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 194.48it/s]
2021-10-11 11:39:13,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 177.21it/s]
2021-10-11 11:39:14,139 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 196.84it/s]
2021-10-11 11:39:14,698 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 196.05it/s]
2021-10-11 11:39:15,242 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 190.72it/s]
2021-10-11 11:39:15,800 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 194.48it/s]
2021-10-11 11:39:16,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 193.59it/s]
2021-10-11 11:39:16,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 184.27it/s]
2021-10-11 11:39:17,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 182.88it/s]
2021-10-11 11:39:18,030 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 190.18it/s]
2021-10-11 11:39:18,588 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 181.54it/s]
2021-10-11 11:39:19,170 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
2021-10-11 11:39:19,171 knodle.trainer.trainer INFO     Train avg loss: 0.1341529592031406
2021-10-11 11:39:19,171 knodle.trainer.trainer INFO     Train avg accuracy: 0.940305214934879
2021-10-11 11:39:19,171 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:39:19,171 knodle.trainer.trainer INFO     Training done
2021-10-11 11:39:19,171 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 138.38it/s]
2021-10-11 11:39:19,339 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9395973154362416, 'recall': 0.26707363601678746, 'f1-score': 0.41592394533571, 'support': 2621}, '1': {'precision': 0.0701839303000968, 'recall': 0.7631578947368421, 'f1-score': 0.12854609929078015, 'support': 190}, 'accuracy': 0.3006047669868374, 'macro avg': {'precision': 0.5048906228681692, 'recall': 0.5151157653768148, 'f1-score': 0.27223502231324503, 'support': 2811}, 'weighted avg': {'precision': 0.8808322698382809, 'recall': 0.30060476698683736, 'f1-score': 0.3964996156492864, 'support': 2811}}, Dev loss: 3.2350547313690186, denoising continues.
2021-10-11 11:39:19,339 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:39:19,367 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:39:19,514 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5287, samples in test set: 447
2021-10-11 11:39:19,636 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5316, samples in test set: 418
2021-10-11 11:39:19,760 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5246, samples in test set: 488
2021-10-11 11:39:20,018 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3723, samples in test set: 2011
2021-10-11 11:39:20,847 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3364, samples in test set: 2370
5it [02:41, 32.34s/it]
2021-10-11 11:42:02,697 knodle.trainer.cleanlab.cleanlab INFO     [[0.02922078 0.97077922]
 [0.01120163 0.98879837]
 [0.08823529 0.91176471]
 [0.04304636 0.95695364]
 [0.95719178 0.04280822]
 [0.99780702 0.00219298]
 [0.87777778 0.12222222]
 [0.025      0.975     ]
 [0.01724138 0.98275862]]
2021-10-11 11:42:02,865 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 43 out of 5734
2021-10-11 11:42:02,865 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:42:02,865 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:42:02,865 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 49.72it/s]
2021-10-11 11:42:03,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 130.17it/s]
2021-10-11 11:42:04,746 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 122.38it/s]
2021-10-11 11:42:05,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 126.01it/s]
2021-10-11 11:42:06,558 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3368907861970829
100%|██████████| 22/22 [00:00<00:00, 129.80it/s]
2021-10-11 11:42:07,418 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 133.30it/s]
2021-10-11 11:42:08,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 150.96it/s]
2021-10-11 11:42:08,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 92.51it/s]
2021-10-11 11:42:10,092 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 102.16it/s]
2021-10-11 11:42:11,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 130.30it/s]
2021-10-11 11:42:11,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 140.63it/s]
2021-10-11 11:42:12,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37566702241195304
100%|██████████| 22/22 [00:00<00:00, 143.70it/s]
2021-10-11 11:42:13,513 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 138.94it/s]
2021-10-11 11:42:14,351 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 133.34it/s]
2021-10-11 11:42:15,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 133.84it/s]
2021-10-11 11:42:15,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 124.33it/s]
2021-10-11 11:42:16,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 136.44it/s]
2021-10-11 11:42:17,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33084311632870866
100%|██████████| 22/22 [00:00<00:00, 154.18it/s]
2021-10-11 11:42:18,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 137.92it/s]
2021-10-11 11:42:19,057 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 122.45it/s]
2021-10-11 11:42:19,771 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 162.15it/s]
2021-10-11 11:42:20,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 147.63it/s]
2021-10-11 11:42:21,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 167.49it/s]
2021-10-11 11:42:21,829 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 169.92it/s]
2021-10-11 11:42:22,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 156.16it/s]
2021-10-11 11:42:23,079 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 176.03it/s]
2021-10-11 11:42:23,724 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 177.79it/s]
2021-10-11 11:42:24,320 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 187.57it/s]
2021-10-11 11:42:24,916 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33973674848808255
100%|██████████| 22/22 [00:00<00:00, 179.88it/s]
2021-10-11 11:42:25,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 184.79it/s]
2021-10-11 11:42:26,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 182.50it/s]
2021-10-11 11:42:26,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 184.91it/s]
2021-10-11 11:42:27,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 182.29it/s]
2021-10-11 11:42:27,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 181.41it/s]
2021-10-11 11:42:28,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 190.73it/s]
2021-10-11 11:42:29,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 189.06it/s]
2021-10-11 11:42:29,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 192.57it/s]
2021-10-11 11:42:30,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 191.20it/s]
2021-10-11 11:42:30,776 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 193.03it/s]
2021-10-11 11:42:31,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 192.40it/s]
2021-10-11 11:42:31,912 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 187.59it/s]
2021-10-11 11:42:32,495 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 171.14it/s]
2021-10-11 11:42:33,079 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 189.28it/s]
2021-10-11 11:42:33,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 191.72it/s]
2021-10-11 11:42:34,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
100%|██████████| 22/22 [00:00<00:00, 189.87it/s]
2021-10-11 11:42:34,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 189.43it/s]
2021-10-11 11:42:35,341 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 191.99it/s]
2021-10-11 11:42:35,906 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 189.12it/s]
2021-10-11 11:42:36,444 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 183.57it/s]
2021-10-11 11:42:37,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 194.17it/s]
2021-10-11 11:42:37,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 164.55it/s]
2021-10-11 11:42:38,172 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 193.53it/s]
2021-10-11 11:42:38,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 193.82it/s]
2021-10-11 11:42:39,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 171.71it/s]
2021-10-11 11:42:39,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 187.91it/s]
2021-10-11 11:42:40,525 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 207.58it/s]
2021-10-11 11:42:41,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3329775880469584
100%|██████████| 22/22 [00:00<00:00, 195.40it/s]
2021-10-11 11:42:41,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 201.12it/s]
2021-10-11 11:42:42,160 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 190.36it/s]
2021-10-11 11:42:42,717 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 172.13it/s]
2021-10-11 11:42:43,319 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 193.84it/s]
2021-10-11 11:42:43,921 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 188.21it/s]
2021-10-11 11:42:44,488 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 192.61it/s]
2021-10-11 11:42:45,052 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 190.46it/s]
2021-10-11 11:42:45,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 187.04it/s]
2021-10-11 11:42:46,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 190.48it/s]
2021-10-11 11:42:46,763 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 181.86it/s]
2021-10-11 11:42:47,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 188.69it/s]
2021-10-11 11:42:47,918 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 183.97it/s]
2021-10-11 11:42:48,535 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2511561721807186
100%|██████████| 22/22 [00:00<00:00, 186.00it/s]
2021-10-11 11:42:49,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 189.25it/s]
2021-10-11 11:42:49,678 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 184.35it/s]
2021-10-11 11:42:50,260 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 193.76it/s]
2021-10-11 11:42:50,811 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 189.38it/s]
2021-10-11 11:42:51,381 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 194.54it/s]
2021-10-11 11:42:51,945 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 186.86it/s]
2021-10-11 11:42:52,511 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 190.69it/s]
2021-10-11 11:42:53,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 189.96it/s]
2021-10-11 11:42:53,634 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 193.13it/s]
2021-10-11 11:42:54,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 191.93it/s]
2021-10-11 11:42:54,744 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 179.10it/s]
2021-10-11 11:42:55,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 177.45it/s]
2021-10-11 11:42:55,934 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 181.13it/s]
2021-10-11 11:42:56,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 176.84it/s]
2021-10-11 11:42:57,202 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 184.86it/s]
2021-10-11 11:42:57,782 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3657061543934543
100%|██████████| 22/22 [00:00<00:00, 182.78it/s]
2021-10-11 11:42:58,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 186.91it/s]
2021-10-11 11:42:58,916 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 189.14it/s]
2021-10-11 11:42:59,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 195.87it/s]
2021-10-11 11:43:00,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 198.23it/s]
2021-10-11 11:43:00,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 213.17it/s]
2021-10-11 11:43:01,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3464959089292067
100%|██████████| 22/22 [00:00<00:00, 199.03it/s]
2021-10-11 11:43:01,642 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34507292778370685
100%|██████████| 22/22 [00:00<00:00, 196.59it/s]
2021-10-11 11:43:02,187 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 202.80it/s]
2021-10-11 11:43:02,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 205.50it/s]
2021-10-11 11:43:03,247 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 209.39it/s]
2021-10-11 11:43:03,773 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 209.53it/s]
2021-10-11 11:43:04,287 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 207.07it/s]
2021-10-11 11:43:04,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 225.64it/s]
2021-10-11 11:43:05,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 224.92it/s]
2021-10-11 11:43:05,812 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
2021-10-11 11:43:05,813 knodle.trainer.trainer INFO     Train avg loss: 0.1341894534811791
2021-10-11 11:43:05,813 knodle.trainer.trainer INFO     Train avg accuracy: 0.9405534106757905
2021-10-11 11:43:05,813 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:43:05,813 knodle.trainer.trainer INFO     Training done
2021-10-11 11:43:05,813 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 162.80it/s]
2021-10-11 11:43:05,957 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.055887222290039). Denoising stops.
2021-10-11 11:43:05,957 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 63.06it/s]
2021-10-11 11:43:06,316 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:43:06,316 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:43:06,316 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.3250647908182155
Precision is: 0.516740979445168
Recall is: 0.5450309813151448
F1 is: 0.29845905061104405
{'0': {'precision': 0.9435483870967742, 'recall': 0.28272251308900526, 'f1-score': 0.43507902076231797, 'support': 2483}, '1': {'precision': 0.08993357179356157, 'recall': 0.8073394495412844, 'f1-score': 0.1618390804597701, 'support': 218}, 'accuracy': 0.3250647908182155, 'macro avg': {'precision': 0.516740979445168, 'recall': 0.5450309813151448, 'f1-score': 0.29845905061104405, 'support': 2701}, 'weighted avg': {'precision': 0.874652411629873, 'recall': 0.3250647908182155, 'f1-score': 0.4130255935183508, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:43:07,392 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:43:07,444 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:43:07,833 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5219, samples in test set: 515
2021-10-11 11:43:08,171 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3660, samples in test set: 2074
2021-10-11 11:43:08,405 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5055, samples in test set: 679
2021-10-11 11:43:08,621 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3876, samples in test set: 1858
2021-10-11 11:43:08,873 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5126, samples in test set: 608
5it [02:42, 32.56s/it]
2021-10-11 11:45:51,769 knodle.trainer.cleanlab.cleanlab INFO     [[0.21724836 0.78275164]
 [0.09704969 0.90295031]
 [0.32983193 0.67016807]
 [0.25       0.75      ]
 [0.74583544 0.25416456]
 [0.9466967  0.0533033 ]
 [0.662      0.338     ]
 [0.18965517 0.81034483]
 [0.2        0.8       ]]
2021-10-11 11:45:51,887 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 197 out of 5734
2021-10-11 11:45:51,887 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:45:51,887 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:45:51,887 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 76.25it/s]
2021-10-11 11:45:52,911 knodle.trainer.trainer INFO     Epoch development accuracy: 0.1903237282106012
100%|██████████| 22/22 [00:00<00:00, 180.34it/s]
2021-10-11 11:45:53,476 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 176.25it/s]
2021-10-11 11:45:54,051 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2312344361437211
100%|██████████| 22/22 [00:00<00:00, 146.05it/s]
2021-10-11 11:45:54,781 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22767698327997155
100%|██████████| 22/22 [00:00<00:00, 176.16it/s]
2021-10-11 11:45:55,409 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 133.49it/s]
2021-10-11 11:45:56,275 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 127.49it/s]
2021-10-11 11:45:56,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2120241906794735
100%|██████████| 22/22 [00:00<00:00, 108.74it/s]
2021-10-11 11:45:57,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 100.03it/s]
2021-10-11 11:45:59,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 123.08it/s]
2021-10-11 11:45:59,929 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 113.69it/s]
2021-10-11 11:46:00,895 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 118.64it/s]
2021-10-11 11:46:01,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2191390964069726
100%|██████████| 22/22 [00:00<00:00, 115.02it/s]
2021-10-11 11:46:02,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 119.33it/s]
2021-10-11 11:46:03,831 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 138.58it/s]
2021-10-11 11:46:04,672 knodle.trainer.trainer INFO     Epoch development accuracy: 0.311988616150836
100%|██████████| 22/22 [00:00<00:00, 137.47it/s]
2021-10-11 11:46:05,441 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 135.26it/s]
2021-10-11 11:46:06,209 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 137.16it/s]
2021-10-11 11:46:07,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 145.47it/s]
2021-10-11 11:46:07,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 139.84it/s]
2021-10-11 11:46:08,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 139.17it/s]
2021-10-11 11:46:09,405 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 136.65it/s]
2021-10-11 11:46:10,198 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 132.06it/s]
2021-10-11 11:46:10,981 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 67.12it/s]
2021-10-11 11:46:11,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 144.69it/s]
2021-10-11 11:46:12,707 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 132.79it/s]
2021-10-11 11:46:13,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 149.03it/s]
2021-10-11 11:46:14,229 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2383493418712202
100%|██████████| 22/22 [00:00<00:00, 146.67it/s]
2021-10-11 11:46:14,999 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 104.99it/s]
2021-10-11 11:46:15,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 133.47it/s]
2021-10-11 11:46:16,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2511561721807186
100%|██████████| 22/22 [00:00<00:00, 151.14it/s]
2021-10-11 11:46:17,424 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 128.83it/s]
2021-10-11 11:46:18,195 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 154.47it/s]
2021-10-11 11:46:18,918 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 160.07it/s]
2021-10-11 11:46:19,584 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 155.21it/s]
2021-10-11 11:46:20,255 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 156.93it/s]
2021-10-11 11:46:20,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21949484169334757
100%|██████████| 22/22 [00:00<00:00, 173.42it/s]
2021-10-11 11:46:21,589 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 173.69it/s]
2021-10-11 11:46:22,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 171.32it/s]
2021-10-11 11:46:22,833 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 184.10it/s]
2021-10-11 11:46:23,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 178.87it/s]
2021-10-11 11:46:24,059 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 188.95it/s]
2021-10-11 11:46:24,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 193.38it/s]
2021-10-11 11:46:25,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 192.80it/s]
2021-10-11 11:46:25,822 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 173.83it/s]
2021-10-11 11:46:26,413 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 170.24it/s]
2021-10-11 11:46:27,027 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 203.60it/s]
2021-10-11 11:46:27,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 159.52it/s]
2021-10-11 11:46:28,221 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 176.42it/s]
2021-10-11 11:46:28,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 174.72it/s]
2021-10-11 11:46:29,406 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 185.24it/s]
2021-10-11 11:46:29,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 190.90it/s]
2021-10-11 11:46:30,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 191.99it/s]
2021-10-11 11:46:31,129 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 185.49it/s]
2021-10-11 11:46:31,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 182.50it/s]
2021-10-11 11:46:32,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 184.27it/s]
2021-10-11 11:46:32,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 186.53it/s]
2021-10-11 11:46:33,488 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 152.81it/s]
2021-10-11 11:46:34,122 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 145.90it/s]
2021-10-11 11:46:34,809 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 177.31it/s]
2021-10-11 11:46:35,464 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 173.63it/s]
2021-10-11 11:46:36,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 168.81it/s]
2021-10-11 11:46:36,711 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 159.90it/s]
2021-10-11 11:46:37,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 184.88it/s]
2021-10-11 11:46:37,954 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 162.02it/s]
2021-10-11 11:46:38,578 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 174.71it/s]
2021-10-11 11:46:39,227 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 160.80it/s]
2021-10-11 11:46:39,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 168.51it/s]
2021-10-11 11:46:40,608 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 182.65it/s]
2021-10-11 11:46:41,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 173.35it/s]
2021-10-11 11:46:41,858 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 169.19it/s]
2021-10-11 11:46:42,489 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 173.76it/s]
2021-10-11 11:46:43,103 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 178.59it/s]
2021-10-11 11:46:43,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 173.80it/s]
2021-10-11 11:46:44,332 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 169.70it/s]
2021-10-11 11:46:44,935 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 186.83it/s]
2021-10-11 11:46:45,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 157.57it/s]
2021-10-11 11:46:46,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 171.02it/s]
2021-10-11 11:46:46,833 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 172.98it/s]
2021-10-11 11:46:47,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 177.90it/s]
2021-10-11 11:46:48,065 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 167.89it/s]
2021-10-11 11:46:48,686 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 164.04it/s]
2021-10-11 11:46:49,335 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 173.82it/s]
2021-10-11 11:46:49,978 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 166.61it/s]
2021-10-11 11:46:50,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 180.24it/s]
2021-10-11 11:46:51,199 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2504446816079687
100%|██████████| 22/22 [00:00<00:00, 177.90it/s]
2021-10-11 11:46:51,805 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 166.93it/s]
2021-10-11 11:46:52,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 185.39it/s]
2021-10-11 11:46:53,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 175.85it/s]
2021-10-11 11:46:53,597 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 181.00it/s]
2021-10-11 11:46:54,177 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 180.52it/s]
2021-10-11 11:46:54,760 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 190.14it/s]
2021-10-11 11:46:55,334 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 177.47it/s]
2021-10-11 11:46:55,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 182.74it/s]
2021-10-11 11:46:56,509 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 185.61it/s]
2021-10-11 11:46:57,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 194.51it/s]
2021-10-11 11:46:57,655 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 199.24it/s]
2021-10-11 11:46:58,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 199.87it/s]
2021-10-11 11:46:58,744 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 205.64it/s]
2021-10-11 11:46:59,283 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 193.16it/s]
2021-10-11 11:46:59,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
2021-10-11 11:46:59,862 knodle.trainer.trainer INFO     Train avg loss: 0.1370714764044517
2021-10-11 11:46:59,862 knodle.trainer.trainer INFO     Train avg accuracy: 0.9378395285871294
2021-10-11 11:46:59,862 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:46:59,862 knodle.trainer.trainer INFO     Training done
2021-10-11 11:46:59,862 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 143.79it/s]
2021-10-11 11:47:00,026 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9416058394160584, 'recall': 0.24608927890118276, 'f1-score': 0.39019963702359345, 'support': 2621}, '1': {'precision': 0.07055503292568203, 'recall': 0.7894736842105263, 'f1-score': 0.1295336787564767, 'support': 190}, 'accuracy': 0.28281750266808964, 'macro avg': {'precision': 0.5060804361708702, 'recall': 0.5177814815558546, 'f1-score': 0.25986665789003505, 'support': 2811}, 'weighted avg': {'precision': 0.8827301178816679, 'recall': 0.28281750266808964, 'f1-score': 0.3725808066889253, 'support': 2811}}, Dev loss: 3.3108038902282715, denoising continues.
2021-10-11 11:47:00,026 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:47:00,054 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:47:00,337 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4835, samples in test set: 899
2021-10-11 11:47:00,477 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3976, samples in test set: 1758
2021-10-11 11:47:00,594 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5389, samples in test set: 345
2021-10-11 11:47:00,709 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5177, samples in test set: 557
2021-10-11 11:47:00,846 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3559, samples in test set: 2175
5it [02:45, 33.01s/it]
2021-10-11 11:49:46,003 knodle.trainer.cleanlab.cleanlab INFO     [[0.03096614 0.96903386]
 [0.01428571 0.98571429]
 [0.07251265 0.92748735]
 [0.02131783 0.97868217]
 [0.93381038 0.06618962]
 [0.99619772 0.00380228]
 [0.97647059 0.02352941]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:49:46,248 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 29 out of 5734
2021-10-11 11:49:46,249 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:49:46,249 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:49:46,249 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 139.86it/s]
2021-10-11 11:49:46,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 133.87it/s]
2021-10-11 11:49:47,689 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 148.74it/s]
2021-10-11 11:49:48,525 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 160.01it/s]
2021-10-11 11:49:49,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 146.32it/s]
2021-10-11 11:49:49,974 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 143.77it/s]
2021-10-11 11:49:50,714 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 134.85it/s]
2021-10-11 11:49:51,456 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 102.33it/s]
2021-10-11 11:49:52,262 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 111.31it/s]
2021-10-11 11:49:53,295 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 123.00it/s]
2021-10-11 11:49:54,281 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 110.38it/s]
2021-10-11 11:49:55,251 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 135.98it/s]
2021-10-11 11:49:56,214 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 130.09it/s]
2021-10-11 11:49:57,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 126.77it/s]
2021-10-11 11:49:57,968 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 124.66it/s]
2021-10-11 11:49:58,804 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 127.91it/s]
2021-10-11 11:49:59,614 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 132.45it/s]
2021-10-11 11:50:00,518 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 132.94it/s]
2021-10-11 11:50:01,303 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 124.09it/s]
2021-10-11 11:50:02,117 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 131.28it/s]
2021-10-11 11:50:02,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 129.43it/s]
2021-10-11 11:50:03,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 133.16it/s]
2021-10-11 11:50:04,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 149.91it/s]
2021-10-11 11:50:05,286 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 148.07it/s]
2021-10-11 11:50:06,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 158.47it/s]
2021-10-11 11:50:06,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34863038064745644
100%|██████████| 22/22 [00:00<00:00, 162.56it/s]
2021-10-11 11:50:07,357 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 165.44it/s]
2021-10-11 11:50:08,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 155.16it/s]
2021-10-11 11:50:08,711 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 163.32it/s]
2021-10-11 11:50:09,379 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 173.73it/s]
2021-10-11 11:50:10,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 168.58it/s]
2021-10-11 11:50:10,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 170.13it/s]
2021-10-11 11:50:11,293 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 175.83it/s]
2021-10-11 11:50:11,907 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 166.51it/s]
2021-10-11 11:50:12,566 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3511205976520811
100%|██████████| 22/22 [00:00<00:00, 154.41it/s]
2021-10-11 11:50:13,202 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25720384204909286
100%|██████████| 22/22 [00:00<00:00, 171.52it/s]
2021-10-11 11:50:13,802 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 136.59it/s]
2021-10-11 11:50:14,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3468516542155816
100%|██████████| 22/22 [00:00<00:00, 153.71it/s]
2021-10-11 11:50:15,123 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 195.21it/s]
2021-10-11 11:50:15,748 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 189.27it/s]
2021-10-11 11:50:16,294 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 189.27it/s]
2021-10-11 11:50:16,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 179.84it/s]
2021-10-11 11:50:17,409 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 193.44it/s]
2021-10-11 11:50:17,968 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 191.19it/s]
2021-10-11 11:50:18,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 196.25it/s]
2021-10-11 11:50:19,098 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 197.98it/s]
2021-10-11 11:50:19,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 195.50it/s]
2021-10-11 11:50:20,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 186.95it/s]
2021-10-11 11:50:20,721 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 147.38it/s]
2021-10-11 11:50:21,374 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 155.69it/s]
2021-10-11 11:50:22,095 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 163.85it/s]
2021-10-11 11:50:22,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 167.90it/s]
2021-10-11 11:50:23,524 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 182.82it/s]
2021-10-11 11:50:24,084 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 212.49it/s]
2021-10-11 11:50:24,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 165.16it/s]
2021-10-11 11:50:25,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 174.98it/s]
2021-10-11 11:50:25,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 153.69it/s]
2021-10-11 11:50:26,522 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 206.80it/s]
2021-10-11 11:50:27,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 209.51it/s]
2021-10-11 11:50:27,600 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 189.36it/s]
2021-10-11 11:50:28,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 212.64it/s]
2021-10-11 11:50:28,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 215.43it/s]
2021-10-11 11:50:29,160 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 212.40it/s]
2021-10-11 11:50:29,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 217.07it/s]
2021-10-11 11:50:30,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 212.35it/s]
2021-10-11 11:50:30,663 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 213.99it/s]
2021-10-11 11:50:31,153 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 216.29it/s]
2021-10-11 11:50:31,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 212.09it/s]
2021-10-11 11:50:32,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 213.76it/s]
2021-10-11 11:50:32,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 186.47it/s]
2021-10-11 11:50:33,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 187.60it/s]
2021-10-11 11:50:33,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 178.46it/s]
2021-10-11 11:50:34,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 181.36it/s]
2021-10-11 11:50:34,927 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 200.17it/s]
2021-10-11 11:50:35,517 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 210.75it/s]
2021-10-11 11:50:36,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 193.56it/s]
2021-10-11 11:50:36,549 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 207.52it/s]
2021-10-11 11:50:37,061 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 218.30it/s]
2021-10-11 11:50:37,563 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 199.20it/s]
2021-10-11 11:50:38,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 215.14it/s]
2021-10-11 11:50:38,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 214.59it/s]
2021-10-11 11:50:39,081 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 210.18it/s]
2021-10-11 11:50:39,595 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 160.54it/s]
2021-10-11 11:50:40,245 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 202.45it/s]
2021-10-11 11:50:40,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 153.25it/s]
2021-10-11 11:50:41,469 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 179.22it/s]
2021-10-11 11:50:42,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 169.13it/s]
2021-10-11 11:50:42,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 170.90it/s]
2021-10-11 11:50:43,312 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32052650302383495
100%|██████████| 22/22 [00:00<00:00, 193.66it/s]
2021-10-11 11:50:43,880 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 193.78it/s]
2021-10-11 11:50:44,412 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 211.65it/s]
2021-10-11 11:50:44,944 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 216.69it/s]
2021-10-11 11:50:45,437 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 218.19it/s]
2021-10-11 11:50:45,927 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 208.47it/s]
2021-10-11 11:50:46,435 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 219.15it/s]
2021-10-11 11:50:46,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 206.81it/s]
2021-10-11 11:50:47,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 213.32it/s]
2021-10-11 11:50:47,930 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 210.54it/s]
2021-10-11 11:50:48,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 217.24it/s]
2021-10-11 11:50:48,919 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 191.34it/s]
2021-10-11 11:50:49,463 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
2021-10-11 11:50:49,464 knodle.trainer.trainer INFO     Train avg loss: 0.1312067504827347
2021-10-11 11:50:49,464 knodle.trainer.trainer INFO     Train avg accuracy: 0.9414917617771361
2021-10-11 11:50:49,464 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:50:49,464 knodle.trainer.trainer INFO     Training done
2021-10-11 11:50:49,464 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 148.28it/s]
2021-10-11 11:50:49,621 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.0365777015686035). Denoising stops.
2021-10-11 11:50:49,621 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 53.86it/s]
2021-10-11 11:50:50,037 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:50:50,037 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:50:50,037 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.3261754905590522
Precision is: 0.5193474758324382
Recall is: 0.551911715260099
F1 is: 0.29992742676027134
{'0': {'precision': 0.9473684210526315, 'recall': 0.28272251308900526, 'f1-score': 0.43548387096774194, 'support': 2483}, '1': {'precision': 0.0913265306122449, 'recall': 0.8211009174311926, 'f1-score': 0.16437098255280072, 'support': 218}, 'accuracy': 0.3261754905590522, 'macro avg': {'precision': 0.5193474758324382, 'recall': 0.551911715260099, 'f1-score': 0.29992742676027134, 'support': 2701}, 'weighted avg': {'precision': 0.8782765542936517, 'recall': 0.3261754905590522, 'f1-score': 0.41360211988501067, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:50:50,949 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:50:50,975 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:50:51,331 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5640, samples in test set: 94
2021-10-11 11:50:51,702 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4543, samples in test set: 1191
2021-10-11 11:50:52,027 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5356, samples in test set: 378
2021-10-11 11:50:52,256 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4245, samples in test set: 1489
2021-10-11 11:50:52,485 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3152, samples in test set: 2582
5it [02:04, 24.81s/it]
2021-10-11 11:52:56,682 knodle.trainer.cleanlab.cleanlab INFO     [[0.18832335 0.81167665]
 [0.10390764 0.89609236]
 [0.20954003 0.79045997]
 [0.19915254 0.80084746]
 [0.77584238 0.22415762]
 [0.96682848 0.03317152]
 [0.87117904 0.12882096]
 [0.09259259 0.90740741]
 [0.12820513 0.87179487]]
2021-10-11 11:52:56,779 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 196 out of 5734
2021-10-11 11:52:56,780 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:52:56,780 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:52:56,780 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 91.82it/s]
2021-10-11 11:52:57,643 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23159018143009605
100%|██████████| 22/22 [00:00<00:00, 224.95it/s]
2021-10-11 11:52:58,137 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2351476342938456
100%|██████████| 22/22 [00:00<00:00, 215.59it/s]
2021-10-11 11:52:58,641 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21664887940234792
100%|██████████| 22/22 [00:00<00:00, 216.79it/s]
2021-10-11 11:52:59,143 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22020633226609748
100%|██████████| 22/22 [00:00<00:00, 224.96it/s]
2021-10-11 11:52:59,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 220.67it/s]
2021-10-11 11:53:00,171 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 215.07it/s]
2021-10-11 11:53:00,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 217.91it/s]
2021-10-11 11:53:01,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 90.96it/s]
2021-10-11 11:53:01,803 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 150.38it/s]
2021-10-11 11:53:02,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 157.89it/s]
2021-10-11 11:53:02,842 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 158.34it/s]
2021-10-11 11:53:03,373 knodle.trainer.trainer INFO     Epoch development accuracy: 0.1896122376378513
100%|██████████| 22/22 [00:00<00:00, 149.38it/s]
2021-10-11 11:53:03,893 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21949484169334757
100%|██████████| 22/22 [00:00<00:00, 159.83it/s]
2021-10-11 11:53:04,412 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2287442191390964
100%|██████████| 22/22 [00:00<00:00, 141.66it/s]
2021-10-11 11:53:05,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 148.51it/s]
2021-10-11 11:53:05,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 156.50it/s]
2021-10-11 11:53:06,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 159.77it/s]
2021-10-11 11:53:06,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 135.39it/s]
2021-10-11 11:53:07,193 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 161.99it/s]
2021-10-11 11:53:07,711 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 156.80it/s]
2021-10-11 11:53:08,249 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 134.11it/s]
2021-10-11 11:53:08,815 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 151.53it/s]
2021-10-11 11:53:09,340 knodle.trainer.trainer INFO     Epoch development accuracy: 0.17858413376022766
100%|██████████| 22/22 [00:00<00:00, 149.39it/s]
2021-10-11 11:53:09,898 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 146.69it/s]
2021-10-11 11:53:10,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 157.90it/s]
2021-10-11 11:53:10,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 156.57it/s]
2021-10-11 11:53:11,484 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 148.66it/s]
2021-10-11 11:53:12,010 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 152.41it/s]
2021-10-11 11:53:12,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 155.36it/s]
2021-10-11 11:53:13,090 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 143.05it/s]
2021-10-11 11:53:13,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 158.11it/s]
2021-10-11 11:53:14,167 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 148.81it/s]
2021-10-11 11:53:14,719 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 144.42it/s]
2021-10-11 11:53:15,271 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 154.80it/s]
2021-10-11 11:53:15,800 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 155.17it/s]
2021-10-11 11:53:16,336 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 145.14it/s]
2021-10-11 11:53:16,863 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 160.97it/s]
2021-10-11 11:53:17,382 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 154.56it/s]
2021-10-11 11:53:17,921 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 147.39it/s]
2021-10-11 11:53:18,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 156.25it/s]
2021-10-11 11:53:18,980 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 155.97it/s]
2021-10-11 11:53:19,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 147.06it/s]
2021-10-11 11:53:20,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 151.83it/s]
2021-10-11 11:53:20,608 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 157.61it/s]
2021-10-11 11:53:21,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23941657773034508
100%|██████████| 22/22 [00:00<00:00, 145.66it/s]
2021-10-11 11:53:21,661 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 157.99it/s]
2021-10-11 11:53:22,173 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 159.12it/s]
2021-10-11 11:53:22,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 150.92it/s]
2021-10-11 11:53:23,225 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22909996442547137
100%|██████████| 22/22 [00:00<00:00, 158.03it/s]
2021-10-11 11:53:23,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24261828530771967
100%|██████████| 22/22 [00:00<00:00, 160.44it/s]
2021-10-11 11:53:24,273 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 137.59it/s]
2021-10-11 11:53:24,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 158.53it/s]
2021-10-11 11:53:25,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 153.23it/s]
2021-10-11 11:53:25,932 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24297403059409464
100%|██████████| 22/22 [00:00<00:00, 147.09it/s]
2021-10-11 11:53:26,466 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 161.98it/s]
2021-10-11 11:53:26,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 159.97it/s]
2021-10-11 11:53:27,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 148.67it/s]
2021-10-11 11:53:28,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23977232301672002
100%|██████████| 22/22 [00:00<00:00, 146.61it/s]
2021-10-11 11:53:28,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 156.83it/s]
2021-10-11 11:53:29,129 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24119530416221985
100%|██████████| 22/22 [00:00<00:00, 143.12it/s]
2021-10-11 11:53:29,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 160.56it/s]
2021-10-11 11:53:30,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2255425115617218
100%|██████████| 22/22 [00:00<00:00, 160.49it/s]
2021-10-11 11:53:30,730 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 150.95it/s]
2021-10-11 11:53:31,245 knodle.trainer.trainer INFO     Epoch development accuracy: 0.247954464603344
100%|██████████| 22/22 [00:00<00:00, 161.36it/s]
2021-10-11 11:53:31,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 159.65it/s]
2021-10-11 11:53:32,282 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 149.67it/s]
2021-10-11 11:53:32,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 156.76it/s]
2021-10-11 11:53:33,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 156.21it/s]
2021-10-11 11:53:33,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 146.39it/s]
2021-10-11 11:53:34,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 156.00it/s]
2021-10-11 11:53:34,950 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 159.69it/s]
2021-10-11 11:53:35,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 150.34it/s]
2021-10-11 11:53:36,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26503023834934186
100%|██████████| 22/22 [00:00<00:00, 160.96it/s]
2021-10-11 11:53:36,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 157.48it/s]
2021-10-11 11:53:37,040 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 152.77it/s]
2021-10-11 11:53:37,557 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 161.54it/s]
2021-10-11 11:53:38,062 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 162.04it/s]
2021-10-11 11:53:38,580 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 151.75it/s]
2021-10-11 11:53:39,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 157.58it/s]
2021-10-11 11:53:39,603 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 156.16it/s]
2021-10-11 11:53:40,172 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 149.95it/s]
2021-10-11 11:53:40,700 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 154.47it/s]
2021-10-11 11:53:41,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 158.65it/s]
2021-10-11 11:53:41,756 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 144.62it/s]
2021-10-11 11:53:42,280 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 162.07it/s]
2021-10-11 11:53:42,807 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 158.90it/s]
2021-10-11 11:53:43,328 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 150.38it/s]
2021-10-11 11:53:43,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 162.30it/s]
2021-10-11 11:53:44,362 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 163.68it/s]
2021-10-11 11:53:44,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 149.69it/s]
2021-10-11 11:53:45,445 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 159.33it/s]
2021-10-11 11:53:45,955 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 160.88it/s]
2021-10-11 11:53:46,483 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23977232301672002
100%|██████████| 22/22 [00:00<00:00, 152.91it/s]
2021-10-11 11:53:46,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 161.91it/s]
2021-10-11 11:53:47,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 162.36it/s]
2021-10-11 11:53:48,019 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 152.32it/s]
2021-10-11 11:53:48,541 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 152.54it/s]
2021-10-11 11:53:49,052 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 156.00it/s]
2021-10-11 11:53:49,611 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 149.69it/s]
2021-10-11 11:53:50,146 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
2021-10-11 11:53:50,148 knodle.trainer.trainer INFO     Train avg loss: 0.16075272242476543
2021-10-11 11:53:50,148 knodle.trainer.trainer INFO     Train avg accuracy: 0.9282497955163322
2021-10-11 11:53:50,148 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:53:50,148 knodle.trainer.trainer INFO     Training done
2021-10-11 11:53:50,148 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 156.71it/s]
2021-10-11 11:53:50,296 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9339130434782609, 'recall': 0.20488363220144984, 'f1-score': 0.33604505632040055, 'support': 2621}, '1': {'precision': 0.06797853309481217, 'recall': 0.8, 'f1-score': 0.12530915086562242, 'support': 190}, 'accuracy': 0.24510850231234435, 'macro avg': {'precision': 0.5009457882865365, 'recall': 0.5024418161007249, 'f1-score': 0.23067710359301147, 'support': 2811}, 'weighted avg': {'precision': 0.8753831406063807, 'recall': 0.24510850231234435, 'f1-score': 0.3218010783636564, 'support': 2811}}, Dev loss: 3.8555214405059814, denoising continues.
2021-10-11 11:53:50,296 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:53:50,318 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:53:50,424 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5059, samples in test set: 675
2021-10-11 11:53:50,529 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3586, samples in test set: 2148
2021-10-11 11:53:50,739 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4562, samples in test set: 1172
2021-10-11 11:53:50,960 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4146, samples in test set: 1588
2021-10-11 11:53:51,177 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5583, samples in test set: 151
5it [02:03, 24.79s/it]
2021-10-11 11:55:55,219 knodle.trainer.cleanlab.cleanlab INFO     [[0.03254438 0.96745562]
 [0.01022495 0.98977505]
 [0.0755287  0.9244713 ]
 [0.03361345 0.96638655]
 [0.95028143 0.04971857]
 [1.         0.        ]
 [1.         0.        ]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 11:55:55,311 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 80 out of 5734
2021-10-11 11:55:55,312 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:55:55,312 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:55:55,312 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 217.00it/s]
2021-10-11 11:55:55,730 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 230.05it/s]
2021-10-11 11:55:56,205 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 213.14it/s]
2021-10-11 11:55:56,661 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 226.15it/s]
2021-10-11 11:55:57,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3425827107790822
100%|██████████| 22/22 [00:00<00:00, 223.08it/s]
2021-10-11 11:55:57,599 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32586268231945925
100%|██████████| 22/22 [00:00<00:00, 228.09it/s]
2021-10-11 11:55:58,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 225.58it/s]
2021-10-11 11:55:58,549 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 211.47it/s]
2021-10-11 11:55:59,041 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3333333333333333
100%|██████████| 22/22 [00:00<00:00, 222.08it/s]
2021-10-11 11:55:59,537 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 225.05it/s]
2021-10-11 11:56:00,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.384204909284952
100%|██████████| 22/22 [00:00<00:00, 223.83it/s]
2021-10-11 11:56:00,517 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 230.02it/s]
2021-10-11 11:56:00,991 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 227.49it/s]
2021-10-11 11:56:01,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 231.19it/s]
2021-10-11 11:56:01,946 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 234.03it/s]
2021-10-11 11:56:02,407 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 230.62it/s]
2021-10-11 11:56:02,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 237.85it/s]
2021-10-11 11:56:03,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 235.31it/s]
2021-10-11 11:56:03,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 231.35it/s]
2021-10-11 11:56:04,292 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 236.20it/s]
2021-10-11 11:56:04,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 227.56it/s]
2021-10-11 11:56:05,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 225.11it/s]
2021-10-11 11:56:05,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 218.56it/s]
2021-10-11 11:56:06,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 231.31it/s]
2021-10-11 11:56:06,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 227.28it/s]
2021-10-11 11:56:07,127 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 226.50it/s]
2021-10-11 11:56:07,613 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3432942013518321
100%|██████████| 22/22 [00:00<00:00, 227.95it/s]
2021-10-11 11:56:08,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 231.42it/s]
2021-10-11 11:56:08,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 93.73it/s]
2021-10-11 11:56:09,180 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 215.61it/s]
2021-10-11 11:56:09,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 230.53it/s]
2021-10-11 11:56:10,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 236.01it/s]
2021-10-11 11:56:10,614 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 225.94it/s]
2021-10-11 11:56:11,074 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3383137673425827
100%|██████████| 22/22 [00:01<00:00, 18.24it/s]
2021-10-11 11:56:12,676 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35218783351120597
100%|██████████| 22/22 [00:00<00:00, 232.53it/s]
2021-10-11 11:56:13,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 235.41it/s]
2021-10-11 11:56:13,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 237.90it/s]
2021-10-11 11:56:14,095 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 230.07it/s]
2021-10-11 11:56:14,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3301316257559587
100%|██████████| 22/22 [00:00<00:00, 225.36it/s]
2021-10-11 11:56:15,044 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 225.58it/s]
2021-10-11 11:56:15,527 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 218.80it/s]
2021-10-11 11:56:16,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3319103521878335
100%|██████████| 22/22 [00:00<00:00, 218.56it/s]
2021-10-11 11:56:16,493 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 226.91it/s]
2021-10-11 11:56:16,978 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 230.95it/s]
2021-10-11 11:56:17,459 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 234.52it/s]
2021-10-11 11:56:17,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 228.63it/s]
2021-10-11 11:56:18,394 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 234.35it/s]
2021-10-11 11:56:18,869 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 222.75it/s]
2021-10-11 11:56:19,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 231.08it/s]
2021-10-11 11:56:19,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 223.57it/s]
2021-10-11 11:56:20,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37104233368907863
100%|██████████| 22/22 [00:00<00:00, 227.36it/s]
2021-10-11 11:56:20,780 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3087869085734614
100%|██████████| 22/22 [00:00<00:00, 230.06it/s]
2021-10-11 11:56:21,256 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 235.96it/s]
2021-10-11 11:56:21,733 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 229.75it/s]
2021-10-11 11:56:22,195 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 222.49it/s]
2021-10-11 11:56:22,677 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 222.62it/s]
2021-10-11 11:56:23,165 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3468516542155816
100%|██████████| 22/22 [00:00<00:00, 218.54it/s]
2021-10-11 11:56:23,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 230.35it/s]
2021-10-11 11:56:24,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 220.98it/s]
2021-10-11 11:56:24,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 206.10it/s]
2021-10-11 11:56:25,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 226.75it/s]
2021-10-11 11:56:25,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 232.45it/s]
2021-10-11 11:56:26,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32266097474208466
100%|██████████| 22/22 [00:00<00:00, 235.07it/s]
2021-10-11 11:56:26,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 211.88it/s]
2021-10-11 11:56:27,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 228.55it/s]
2021-10-11 11:56:27,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 234.50it/s]
2021-10-11 11:56:27,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 218.04it/s]
2021-10-11 11:56:28,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 223.95it/s]
2021-10-11 11:56:28,981 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 224.65it/s]
2021-10-11 11:56:29,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3415154749199573
100%|██████████| 22/22 [00:00<00:00, 199.94it/s]
2021-10-11 11:56:29,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 208.25it/s]
2021-10-11 11:56:30,333 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 194.51it/s]
2021-10-11 11:56:30,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 168.81it/s]
2021-10-11 11:56:31,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 184.84it/s]
2021-10-11 11:56:32,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 197.57it/s]
2021-10-11 11:56:32,840 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 197.35it/s]
2021-10-11 11:56:33,393 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 209.28it/s]
2021-10-11 11:56:33,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 208.36it/s]
2021-10-11 11:56:34,363 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 195.07it/s]
2021-10-11 11:56:34,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 205.23it/s]
2021-10-11 11:56:35,489 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33048737104233367
100%|██████████| 22/22 [00:00<00:00, 226.93it/s]
2021-10-11 11:56:35,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31163287086446106
100%|██████████| 22/22 [00:00<00:00, 192.51it/s]
2021-10-11 11:56:36,487 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 225.09it/s]
2021-10-11 11:56:37,015 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 213.13it/s]
2021-10-11 11:56:37,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 232.74it/s]
2021-10-11 11:56:38,004 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 234.77it/s]
2021-10-11 11:56:38,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 231.06it/s]
2021-10-11 11:56:38,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 219.05it/s]
2021-10-11 11:56:39,427 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 214.48it/s]
2021-10-11 11:56:39,953 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 225.68it/s]
2021-10-11 11:56:40,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 221.28it/s]
2021-10-11 11:56:40,924 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 228.20it/s]
2021-10-11 11:56:41,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3223052294557097
100%|██████████| 22/22 [00:00<00:00, 232.76it/s]
2021-10-11 11:56:41,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 232.20it/s]
2021-10-11 11:56:42,360 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 237.09it/s]
2021-10-11 11:56:42,835 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 208.18it/s]
2021-10-11 11:56:43,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 236.31it/s]
2021-10-11 11:56:43,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 237.26it/s]
2021-10-11 11:56:44,264 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 229.70it/s]
2021-10-11 11:56:44,740 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 222.76it/s]
2021-10-11 11:56:45,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
2021-10-11 11:56:45,234 knodle.trainer.trainer INFO     Train avg loss: 0.13124601910594444
2021-10-11 11:56:45,234 knodle.trainer.trainer INFO     Train avg accuracy: 0.9414904681311715
2021-10-11 11:56:45,234 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:56:45,234 knodle.trainer.trainer INFO     Training done
2021-10-11 11:56:45,234 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 163.21it/s]
2021-10-11 11:56:45,377 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.9076578617095947). Denoising stops.
2021-10-11 11:56:45,378 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 71.14it/s]
2021-10-11 11:56:45,692 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 11:56:45,692 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 11:56:45,692 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 11:56:46,191 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 11:56:46,211 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:56:46,448 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4491, samples in test set: 1243
2021-10-11 11:56:46,828 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4188, samples in test set: 1546
2021-10-11 11:56:47,277 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5293, samples in test set: 441
2021-10-11 11:56:47,565 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4833, samples in test set: 901
2021-10-11 11:56:47,826 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4131, samples in test set: 1603
0it [00:00, ?it/s]Accuracy is: 0.3546834505738615
Precision is: 0.5168682735354105
Recall is: 0.5485872741984947
F1 is: 0.3190339680019186
{'0': {'precision': 0.9425837320574163, 'recall': 0.31735803463552154, 'f1-score': 0.4748418198252486, 'support': 2483}, '1': {'precision': 0.09115281501340483, 'recall': 0.7798165137614679, 'f1-score': 0.1632261161785886, 'support': 218}, 'accuracy': 0.3546834505738615, 'macro avg': {'precision': 0.5168682735354105, 'recall': 0.5485872741984947, 'f1-score': 0.3190339680019186, 'support': 2701}, 'weighted avg': {'precision': 0.8738640208705986, 'recall': 0.3546834505738615, 'f1-score': 0.449691052185496, 'support': 2701}}
5it [02:12, 26.55s/it]
2021-10-11 11:59:00,695 knodle.trainer.cleanlab.cleanlab INFO     [[0.14385382 0.85614618]
 [0.06737589 0.93262411]
 [0.2827381  0.7172619 ]
 [0.10408922 0.89591078]
 [0.80697823 0.19302177]
 [0.97674419 0.02325581]
 [0.77222222 0.22777778]
 [0.05769231 0.94230769]
 [0.11428571 0.88571429]]
2021-10-11 11:59:00,807 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 208 out of 5734
2021-10-11 11:59:00,807 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:59:00,807 knodle.trainer.trainer INFO     Training starts
2021-10-11 11:59:00,807 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 73.74it/s]
2021-10-11 11:59:01,848 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2120241906794735
100%|██████████| 22/22 [00:00<00:00, 175.54it/s]
2021-10-11 11:59:02,433 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2198505869797225
100%|██████████| 22/22 [00:00<00:00, 210.23it/s]
2021-10-11 11:59:03,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 203.92it/s]
2021-10-11 11:59:03,568 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 222.03it/s]
2021-10-11 11:59:04,063 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20988971896122377
100%|██████████| 22/22 [00:00<00:00, 217.73it/s]
2021-10-11 11:59:04,571 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22234080398434722
100%|██████████| 22/22 [00:00<00:00, 213.52it/s]
2021-10-11 11:59:05,105 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23550337958022055
100%|██████████| 22/22 [00:00<00:00, 214.12it/s]
2021-10-11 11:59:05,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21771611526147278
100%|██████████| 22/22 [00:00<00:00, 206.99it/s]
2021-10-11 11:59:06,160 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 216.61it/s]
2021-10-11 11:59:06,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 210.89it/s]
2021-10-11 11:59:07,221 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 219.94it/s]
2021-10-11 11:59:07,735 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22376378512984704
100%|██████████| 22/22 [00:00<00:00, 209.43it/s]
2021-10-11 11:59:08,274 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 216.40it/s]
2021-10-11 11:59:08,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 212.38it/s]
2021-10-11 11:59:09,323 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 218.99it/s]
2021-10-11 11:59:09,852 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 215.93it/s]
2021-10-11 11:59:10,373 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 220.04it/s]
2021-10-11 11:59:10,898 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 224.00it/s]
2021-10-11 11:59:11,420 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 214.36it/s]
2021-10-11 11:59:11,932 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 219.21it/s]
2021-10-11 11:59:12,456 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 229.15it/s]
2021-10-11 11:59:12,959 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 215.80it/s]
2021-10-11 11:59:13,457 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 197.18it/s]
2021-10-11 11:59:14,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2255425115617218
100%|██████████| 22/22 [00:00<00:00, 212.56it/s]
2021-10-11 11:59:14,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 210.06it/s]
2021-10-11 11:59:15,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 216.41it/s]
2021-10-11 11:59:15,603 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22909996442547137
100%|██████████| 22/22 [00:00<00:00, 217.98it/s]
2021-10-11 11:59:16,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 210.00it/s]
2021-10-11 11:59:16,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 204.56it/s]
2021-10-11 11:59:17,143 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 219.11it/s]
2021-10-11 11:59:17,664 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 220.32it/s]
2021-10-11 11:59:18,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 223.70it/s]
2021-10-11 11:59:18,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 237.43it/s]
2021-10-11 11:59:19,182 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21664887940234792
100%|██████████| 22/22 [00:00<00:00, 237.17it/s]
2021-10-11 11:59:19,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 226.06it/s]
2021-10-11 11:59:20,162 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19815012451085023
100%|██████████| 22/22 [00:00<00:00, 238.35it/s]
2021-10-11 11:59:20,643 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 223.65it/s]
2021-10-11 11:59:21,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 220.36it/s]
2021-10-11 11:59:21,666 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 211.16it/s]
2021-10-11 11:59:22,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 221.07it/s]
2021-10-11 11:59:22,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 216.03it/s]
2021-10-11 11:59:23,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 225.29it/s]
2021-10-11 11:59:23,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 217.24it/s]
2021-10-11 11:59:24,178 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 222.40it/s]
2021-10-11 11:59:24,692 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 211.09it/s]
2021-10-11 11:59:25,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3525435787975809
100%|██████████| 22/22 [00:00<00:00, 216.90it/s]
2021-10-11 11:59:25,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 227.08it/s]
2021-10-11 11:59:26,251 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 211.82it/s]
2021-10-11 11:59:26,777 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 219.12it/s]
2021-10-11 11:59:27,281 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 174.76it/s]
2021-10-11 11:59:27,847 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 198.48it/s]
2021-10-11 11:59:28,453 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 192.80it/s]
2021-10-11 11:59:29,013 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 193.26it/s]
2021-10-11 11:59:29,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 199.30it/s]
2021-10-11 11:59:30,150 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23479188900747064
100%|██████████| 22/22 [00:00<00:00, 197.85it/s]
2021-10-11 11:59:30,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 205.19it/s]
2021-10-11 11:59:31,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 216.60it/s]
2021-10-11 11:59:31,851 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 216.63it/s]
2021-10-11 11:59:32,365 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 195.18it/s]
2021-10-11 11:59:32,897 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2440412664532195
100%|██████████| 22/22 [00:00<00:00, 213.52it/s]
2021-10-11 11:59:33,425 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 220.05it/s]
2021-10-11 11:59:33,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 225.33it/s]
2021-10-11 11:59:34,451 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23479188900747064
100%|██████████| 22/22 [00:00<00:00, 224.63it/s]
2021-10-11 11:59:34,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 204.14it/s]
2021-10-11 11:59:35,500 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 195.63it/s]
2021-10-11 11:59:36,045 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 195.67it/s]
2021-10-11 11:59:36,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 212.59it/s]
2021-10-11 11:59:37,113 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 215.11it/s]
2021-10-11 11:59:37,629 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 164.97it/s]
2021-10-11 11:59:38,209 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 182.92it/s]
2021-10-11 11:59:38,867 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22696549270722163
100%|██████████| 22/22 [00:00<00:00, 191.86it/s]
2021-10-11 11:59:39,439 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23977232301672002
100%|██████████| 22/22 [00:00<00:00, 165.19it/s]
2021-10-11 11:59:40,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 181.51it/s]
2021-10-11 11:59:40,691 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 175.16it/s]
2021-10-11 11:59:41,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23336890786197084
100%|██████████| 22/22 [00:00<00:00, 156.73it/s]
2021-10-11 11:59:41,911 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 150.34it/s]
2021-10-11 11:59:42,629 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2344361437210957
100%|██████████| 22/22 [00:00<00:00, 198.02it/s]
2021-10-11 11:59:43,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 179.19it/s]
2021-10-11 11:59:43,796 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 188.17it/s]
2021-10-11 11:59:44,371 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 193.42it/s]
2021-10-11 11:59:44,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 171.23it/s]
2021-10-11 11:59:45,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 160.07it/s]
2021-10-11 11:59:46,194 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 160.69it/s]
2021-10-11 11:59:46,812 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 162.00it/s]
2021-10-11 11:59:47,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 193.04it/s]
2021-10-11 11:59:48,025 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 239.54it/s]
2021-10-11 11:59:48,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 194.77it/s]
2021-10-11 11:59:49,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 202.85it/s]
2021-10-11 11:59:49,706 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 161.98it/s]
2021-10-11 11:59:50,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 206.43it/s]
2021-10-11 11:59:50,920 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 162.33it/s]
2021-10-11 11:59:51,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 218.67it/s]
2021-10-11 11:59:52,046 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 192.14it/s]
2021-10-11 11:59:52,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 193.23it/s]
2021-10-11 11:59:53,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 198.67it/s]
2021-10-11 11:59:53,787 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 184.08it/s]
2021-10-11 11:59:54,369 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 160.39it/s]
2021-10-11 11:59:55,036 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 191.70it/s]
2021-10-11 11:59:55,590 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 199.87it/s]
2021-10-11 11:59:56,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
2021-10-11 11:59:56,132 knodle.trainer.trainer INFO     Train avg loss: 0.13308446999722057
2021-10-11 11:59:56,132 knodle.trainer.trainer INFO     Train avg accuracy: 0.9404425378640492
2021-10-11 11:59:56,132 knodle.trainer.trainer INFO     ======================================
2021-10-11 11:59:56,132 knodle.trainer.trainer INFO     Training done
2021-10-11 11:59:56,132 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 111.74it/s]
2021-10-11 11:59:56,342 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9317073170731708, 'recall': 0.21861884776802748, 'f1-score': 0.354140914709518, 'support': 2621}, '1': {'precision': 0.06739526411657559, 'recall': 0.7789473684210526, 'f1-score': 0.12405699916177704, 'support': 190}, 'accuracy': 0.2564923514763429, 'macro avg': {'precision': 0.4995512905948732, 'recall': 0.4987831080945401, 'f1-score': 0.2390989569356475, 'support': 2811}, 'weighted avg': {'precision': 0.8732870787018605, 'recall': 0.2564923514763429, 'f1-score': 0.3385891737084255, 'support': 2811}}, Dev loss: 3.6125032901763916, denoising continues.
2021-10-11 11:59:56,342 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 11:59:56,376 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 11:59:57,339 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3914, samples in test set: 1820
2021-10-11 11:59:57,620 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5698, samples in test set: 36
2021-10-11 11:59:57,866 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4770, samples in test set: 964
2021-10-11 11:59:58,173 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3376, samples in test set: 2358
2021-10-11 11:59:58,413 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5178, samples in test set: 556
5it [02:15, 27.01s/it]
2021-10-11 12:02:13,586 knodle.trainer.cleanlab.cleanlab INFO     [[0.03450808 0.96549192]
 [0.00652985 0.99347015]
 [0.12899543 0.87100457]
 [0.02040816 0.97959184]
 [0.95976027 0.04023973]
 [0.99273859 0.00726141]
 [0.87692308 0.12307692]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 12:02:13,690 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 1 out of 5734
2021-10-11 12:02:13,691 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:02:13,691 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:02:13,691 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 173.53it/s]
2021-10-11 12:02:14,195 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 196.62it/s]
2021-10-11 12:02:14,723 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 165.64it/s]
2021-10-11 12:02:15,329 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24937744574884382
100%|██████████| 22/22 [00:00<00:00, 190.25it/s]
2021-10-11 12:02:15,911 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 206.57it/s]
2021-10-11 12:02:16,438 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 182.26it/s]
2021-10-11 12:02:16,996 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 114.03it/s]
2021-10-11 12:02:17,696 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 79.18it/s]
2021-10-11 12:02:20,411 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 156.55it/s]
2021-10-11 12:02:21,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 202.05it/s]
2021-10-11 12:02:21,675 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 198.03it/s]
2021-10-11 12:02:22,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 156.97it/s]
2021-10-11 12:02:22,824 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2408395588758449
100%|██████████| 22/22 [00:00<00:00, 181.99it/s]
2021-10-11 12:02:23,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 88.08it/s]
2021-10-11 12:02:24,284 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 181.74it/s]
2021-10-11 12:02:24,867 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 169.12it/s]
2021-10-11 12:02:25,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 208.58it/s]
2021-10-11 12:02:25,997 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 198.89it/s]
2021-10-11 12:02:26,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 205.54it/s]
2021-10-11 12:02:27,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 226.41it/s]
2021-10-11 12:02:27,616 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 215.34it/s]
2021-10-11 12:02:28,101 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 233.10it/s]
2021-10-11 12:02:28,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 188.60it/s]
2021-10-11 12:02:29,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 233.27it/s]
2021-10-11 12:02:29,629 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 212.65it/s]
2021-10-11 12:02:30,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 237.59it/s]
2021-10-11 12:02:30,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 232.22it/s]
2021-10-11 12:02:31,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34969761650658127
100%|██████████| 22/22 [00:00<00:00, 234.53it/s]
2021-10-11 12:02:31,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 182.99it/s]
2021-10-11 12:02:32,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3319103521878335
100%|██████████| 22/22 [00:00<00:00, 227.55it/s]
2021-10-11 12:02:32,575 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 211.89it/s]
2021-10-11 12:02:33,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 201.30it/s]
2021-10-11 12:02:33,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 186.36it/s]
2021-10-11 12:02:34,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 193.22it/s]
2021-10-11 12:02:34,747 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 196.26it/s]
2021-10-11 12:02:35,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 187.92it/s]
2021-10-11 12:02:35,906 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 203.18it/s]
2021-10-11 12:02:36,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 132.24it/s]
2021-10-11 12:02:37,041 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 163.68it/s]
2021-10-11 12:02:37,716 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 196.80it/s]
2021-10-11 12:02:38,315 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 144.13it/s]
2021-10-11 12:02:38,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 94.14it/s]
2021-10-11 12:02:39,802 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 209.02it/s]
2021-10-11 12:02:40,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 184.44it/s]
2021-10-11 12:02:41,078 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 206.43it/s]
2021-10-11 12:02:41,638 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 88.12it/s]
2021-10-11 12:02:42,378 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 157.98it/s]
2021-10-11 12:02:43,290 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 127.34it/s]
2021-10-11 12:02:43,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 193.69it/s]
2021-10-11 12:02:44,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 218.39it/s]
2021-10-11 12:02:45,097 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 212.98it/s]
2021-10-11 12:02:45,621 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 158.60it/s]
2021-10-11 12:02:46,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 187.47it/s]
2021-10-11 12:02:46,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3365350409107079
100%|██████████| 22/22 [00:00<00:00, 193.88it/s]
2021-10-11 12:02:47,386 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 168.90it/s]
2021-10-11 12:02:48,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 157.87it/s]
2021-10-11 12:02:48,755 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 164.64it/s]
2021-10-11 12:02:49,437 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 100.85it/s]
2021-10-11 12:02:50,149 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 184.50it/s]
2021-10-11 12:02:50,903 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 145.52it/s]
2021-10-11 12:02:51,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 186.92it/s]
2021-10-11 12:02:52,091 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 195.56it/s]
2021-10-11 12:02:52,696 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 197.23it/s]
2021-10-11 12:02:53,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 201.15it/s]
2021-10-11 12:02:54,029 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 199.04it/s]
2021-10-11 12:02:54,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30914265385983636
100%|██████████| 22/22 [00:00<00:00, 194.68it/s]
2021-10-11 12:02:55,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 205.93it/s]
2021-10-11 12:02:55,683 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 187.04it/s]
2021-10-11 12:02:56,239 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 212.24it/s]
2021-10-11 12:02:56,768 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 204.11it/s]
2021-10-11 12:02:57,288 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 212.49it/s]
2021-10-11 12:02:57,830 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 203.66it/s]
2021-10-11 12:02:58,340 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 213.03it/s]
2021-10-11 12:02:58,866 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 222.69it/s]
2021-10-11 12:02:59,387 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 204.36it/s]
2021-10-11 12:02:59,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3319103521878335
100%|██████████| 22/22 [00:00<00:00, 209.25it/s]
2021-10-11 12:03:00,400 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 180.06it/s]
2021-10-11 12:03:00,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 205.93it/s]
2021-10-11 12:03:01,463 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 209.80it/s]
2021-10-11 12:03:02,003 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22020633226609748
100%|██████████| 22/22 [00:00<00:00, 196.13it/s]
2021-10-11 12:03:02,559 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 209.55it/s]
2021-10-11 12:03:03,103 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 193.53it/s]
2021-10-11 12:03:03,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 203.87it/s]
2021-10-11 12:03:04,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 212.97it/s]
2021-10-11 12:03:04,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 192.07it/s]
2021-10-11 12:03:05,283 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 196.26it/s]
2021-10-11 12:03:05,831 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 223.63it/s]
2021-10-11 12:03:06,330 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 193.78it/s]
2021-10-11 12:03:06,835 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 219.89it/s]
2021-10-11 12:03:07,358 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 209.67it/s]
2021-10-11 12:03:07,869 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 216.41it/s]
2021-10-11 12:03:08,367 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 214.45it/s]
2021-10-11 12:03:08,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 228.57it/s]
2021-10-11 12:03:09,391 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 206.36it/s]
2021-10-11 12:03:09,889 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 202.30it/s]
2021-10-11 12:03:10,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2646744930629669
100%|██████████| 22/22 [00:00<00:00, 173.47it/s]
2021-10-11 12:03:11,122 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24332977588046958
100%|██████████| 22/22 [00:00<00:00, 174.06it/s]
2021-10-11 12:03:11,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 172.12it/s]
2021-10-11 12:03:12,284 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 175.31it/s]
2021-10-11 12:03:12,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 197.04it/s]
2021-10-11 12:03:13,447 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
2021-10-11 12:03:13,448 knodle.trainer.trainer INFO     Train avg loss: 0.13042475104932155
2021-10-11 12:03:13,449 knodle.trainer.trainer INFO     Train avg accuracy: 0.9418501835399202
2021-10-11 12:03:13,449 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:03:13,449 knodle.trainer.trainer INFO     Training done
2021-10-11 12:03:13,449 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 144.93it/s]
2021-10-11 12:03:13,612 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.196576118469238). Denoising stops.
2021-10-11 12:03:13,614 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 68.40it/s]
Accuracy is: 0.30322102924842653
Precision is: 0.5164014105475797
Recall is: 0.5415190266287822
F1 is: 0.2825006492846577
{'0': {'precision': 0.9438700147710487, 'recall': 0.25734997986306885, 'f1-score': 0.40443037974683543, 'support': 2483}, '1': {'precision': 0.08893280632411067, 'recall': 0.8256880733944955, 'f1-score': 0.16057091882247992, 'support': 218}, 'accuracy': 0.30322102924842653, 'macro avg': {'precision': 0.5164014105475797, 'recall': 0.5415190266287822, 'f1-score': 0.2825006492846577, 'support': 2701}, 'weighted avg': {'precision': 0.8748673078323472, 'recall': 0.3032210292484265, 'f1-score': 0.3847482759032555, 'support': 2701}}
2021-10-11 12:03:13,967 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 12:03:13,967 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 12:03:13,967 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 12:03:14,506 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 12:03:14,533 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:03:14,661 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3346, samples in test set: 2388
2021-10-11 12:03:14,808 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5318, samples in test set: 416
2021-10-11 12:03:15,166 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5412, samples in test set: 322
2021-10-11 12:03:15,642 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4085, samples in test set: 1649
2021-10-11 12:03:15,969 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4775, samples in test set: 959
5it [02:10, 26.13s/it]
2021-10-11 12:05:26,759 knodle.trainer.cleanlab.cleanlab INFO     [[0.08530281 0.91469719]
 [0.04310345 0.95689655]
 [0.20028011 0.79971989]
 [0.05349794 0.94650206]
 [0.88677043 0.11322957]
 [0.97137014 0.02862986]
 [0.84294872 0.15705128]
 [0.09090909 0.90909091]
 [0.125      0.875     ]]
2021-10-11 12:05:26,873 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 192 out of 5734
2021-10-11 12:05:26,873 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:05:26,873 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:05:26,874 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 84.21it/s]
2021-10-11 12:05:27,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23301316257559587
100%|██████████| 22/22 [00:00<00:00, 202.91it/s]
2021-10-11 12:05:28,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 212.86it/s]
2021-10-11 12:05:28,886 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30202774813233724
100%|██████████| 22/22 [00:00<00:00, 204.85it/s]
2021-10-11 12:05:29,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2209178228388474
100%|██████████| 22/22 [00:00<00:00, 207.47it/s]
2021-10-11 12:05:29,991 knodle.trainer.trainer INFO     Epoch development accuracy: 0.215937388829598
100%|██████████| 22/22 [00:00<00:00, 243.75it/s]
2021-10-11 12:05:30,494 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 212.57it/s]
2021-10-11 12:05:31,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2198505869797225
100%|██████████| 22/22 [00:00<00:00, 223.02it/s]
2021-10-11 12:05:31,524 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 220.09it/s]
2021-10-11 12:05:32,023 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 211.27it/s]
2021-10-11 12:05:32,546 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 197.56it/s]
2021-10-11 12:05:33,089 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 208.53it/s]
2021-10-11 12:05:33,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 222.00it/s]
2021-10-11 12:05:34,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 203.11it/s]
2021-10-11 12:05:34,674 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 208.19it/s]
2021-10-11 12:05:35,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 211.07it/s]
2021-10-11 12:05:35,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 205.98it/s]
2021-10-11 12:05:36,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21807186054784775
100%|██████████| 22/22 [00:00<00:00, 224.22it/s]
2021-10-11 12:05:36,781 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 194.79it/s]
2021-10-11 12:05:37,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 202.88it/s]
2021-10-11 12:05:37,835 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 212.85it/s]
2021-10-11 12:05:38,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 206.30it/s]
2021-10-11 12:05:38,879 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19886161508360015
100%|██████████| 22/22 [00:00<00:00, 194.84it/s]
2021-10-11 12:05:39,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22838847385272146
100%|██████████| 22/22 [00:00<00:00, 209.67it/s]
2021-10-11 12:05:39,993 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 216.49it/s]
2021-10-11 12:05:40,519 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 207.68it/s]
2021-10-11 12:05:41,053 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 203.83it/s]
2021-10-11 12:05:41,589 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 198.97it/s]
2021-10-11 12:05:42,150 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 202.58it/s]
2021-10-11 12:05:42,709 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3447171824973319
100%|██████████| 22/22 [00:00<00:00, 194.16it/s]
2021-10-11 12:05:43,245 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 203.48it/s]
2021-10-11 12:05:43,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2248310209889719
100%|██████████| 22/22 [00:00<00:00, 194.92it/s]
2021-10-11 12:05:44,368 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 198.17it/s]
2021-10-11 12:05:44,936 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 96.25it/s]
2021-10-11 12:05:45,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 206.37it/s]
2021-10-11 12:05:46,154 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 212.16it/s]
2021-10-11 12:05:46,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 214.22it/s]
2021-10-11 12:05:47,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 211.80it/s]
2021-10-11 12:05:47,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 202.76it/s]
2021-10-11 12:05:48,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23230167200284596
100%|██████████| 22/22 [00:00<00:00, 206.31it/s]
2021-10-11 12:05:48,851 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 209.01it/s]
2021-10-11 12:05:49,399 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 205.44it/s]
2021-10-11 12:05:49,939 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 204.68it/s]
2021-10-11 12:05:50,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 215.56it/s]
2021-10-11 12:05:51,008 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 205.02it/s]
2021-10-11 12:05:51,579 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 186.35it/s]
2021-10-11 12:05:52,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 177.01it/s]
2021-10-11 12:05:52,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 184.17it/s]
2021-10-11 12:05:53,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 214.90it/s]
2021-10-11 12:05:53,877 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 190.37it/s]
2021-10-11 12:05:54,408 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 178.36it/s]
2021-10-11 12:05:54,995 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2511561721807186
100%|██████████| 22/22 [00:00<00:00, 215.98it/s]
2021-10-11 12:05:55,536 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 201.41it/s]
2021-10-11 12:05:56,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 193.16it/s]
2021-10-11 12:05:56,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 198.76it/s]
2021-10-11 12:05:57,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37886872998932764
100%|██████████| 22/22 [00:00<00:00, 201.55it/s]
2021-10-11 12:05:57,818 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 225.33it/s]
2021-10-11 12:05:58,367 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 218.66it/s]
2021-10-11 12:05:58,882 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 221.31it/s]
2021-10-11 12:05:59,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 211.91it/s]
2021-10-11 12:05:59,924 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 222.23it/s]
2021-10-11 12:06:00,439 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 204.97it/s]
2021-10-11 12:06:00,972 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 210.27it/s]
2021-10-11 12:06:01,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 216.99it/s]
2021-10-11 12:06:02,006 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 215.13it/s]
2021-10-11 12:06:02,510 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 157.73it/s]
2021-10-11 12:06:03,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 234.67it/s]
2021-10-11 12:06:03,651 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 218.67it/s]
2021-10-11 12:06:04,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 232.26it/s]
2021-10-11 12:06:04,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 198.42it/s]
2021-10-11 12:06:05,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 201.63it/s]
2021-10-11 12:06:05,764 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 224.52it/s]
2021-10-11 12:06:06,256 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 201.66it/s]
2021-10-11 12:06:06,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 196.63it/s]
2021-10-11 12:06:07,337 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 184.71it/s]
2021-10-11 12:06:07,914 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 211.88it/s]
2021-10-11 12:06:08,449 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 218.33it/s]
2021-10-11 12:06:08,958 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 193.59it/s]
2021-10-11 12:06:09,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 222.57it/s]
2021-10-11 12:06:09,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2255425115617218
100%|██████████| 22/22 [00:00<00:00, 227.35it/s]
2021-10-11 12:06:10,529 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 213.65it/s]
2021-10-11 12:06:11,038 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 182.32it/s]
2021-10-11 12:06:11,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 171.36it/s]
2021-10-11 12:06:12,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 169.07it/s]
2021-10-11 12:06:12,827 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 204.08it/s]
2021-10-11 12:06:13,431 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2486659551760939
100%|██████████| 22/22 [00:00<00:00, 194.78it/s]
2021-10-11 12:06:14,005 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 198.29it/s]
2021-10-11 12:06:14,569 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 206.12it/s]
2021-10-11 12:06:15,132 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 213.80it/s]
2021-10-11 12:06:15,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 220.34it/s]
2021-10-11 12:06:16,172 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 216.58it/s]
2021-10-11 12:06:16,660 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 190.26it/s]
2021-10-11 12:06:17,222 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 240.00it/s]
2021-10-11 12:06:17,726 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 194.64it/s]
2021-10-11 12:06:18,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 209.05it/s]
2021-10-11 12:06:18,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24048381358946994
100%|██████████| 22/22 [00:00<00:00, 199.13it/s]
2021-10-11 12:06:19,270 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 202.98it/s]
2021-10-11 12:06:19,785 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 167.60it/s]
2021-10-11 12:06:20,398 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 211.33it/s]
2021-10-11 12:06:20,972 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 174.42it/s]
2021-10-11 12:06:21,553 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
2021-10-11 12:06:21,555 knodle.trainer.trainer INFO     Train avg loss: 0.13359620140120382
2021-10-11 12:06:21,555 knodle.trainer.trainer INFO     Train avg accuracy: 0.9405408493942686
2021-10-11 12:06:21,555 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:06:21,555 knodle.trainer.trainer INFO     Training done
2021-10-11 12:06:21,555 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 127.93it/s]
2021-10-11 12:06:21,739 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9418803418803419, 'recall': 0.2102251049217856, 'f1-score': 0.3437305053025577, 'support': 2621}, '1': {'precision': 0.07008086253369272, 'recall': 0.8210526315789474, 'f1-score': 0.1291390728476821, 'support': 190}, 'accuracy': 0.25151191746709356, 'macro avg': {'precision': 0.5059806022070172, 'recall': 0.5156388682503665, 'f1-score': 0.23643478907511992, 'support': 2811}, 'weighted avg': {'precision': 0.8829540163464167, 'recall': 0.25151191746709356, 'f1-score': 0.3292259260900261, 'support': 2811}}, Dev loss: 3.8374433517456055, denoising continues.
2021-10-11 12:06:21,739 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 12:06:21,767 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:06:22,421 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3365, samples in test set: 2369
2021-10-11 12:06:22,788 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4937, samples in test set: 797
2021-10-11 12:06:23,072 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 4025, samples in test set: 1709
2021-10-11 12:06:23,429 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5585, samples in test set: 149
2021-10-11 12:06:23,751 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5024, samples in test set: 710
5it [02:18, 27.67s/it]
2021-10-11 12:08:42,206 knodle.trainer.cleanlab.cleanlab INFO     [[0.02547307 0.97452693]
 [0.00814664 0.99185336]
 [0.12848297 0.87151703]
 [0.028      0.972     ]
 [0.93809114 0.06190886]
 [0.99290061 0.00709939]
 [0.90604027 0.09395973]
 [0.         1.        ]
 [0.02083333 0.97916667]]
2021-10-11 12:08:42,300 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 2 out of 5734
2021-10-11 12:08:42,300 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:08:42,300 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:08:42,300 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 83.07it/s]
2021-10-11 12:08:43,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 228.45it/s]
2021-10-11 12:08:43,662 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 173.36it/s]
2021-10-11 12:08:44,232 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 165.28it/s]
2021-10-11 12:08:44,840 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 215.53it/s]
2021-10-11 12:08:45,416 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 202.18it/s]
2021-10-11 12:08:45,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 205.06it/s]
2021-10-11 12:08:46,526 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 218.91it/s]
2021-10-11 12:08:47,086 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 172.41it/s]
2021-10-11 12:08:47,649 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 213.61it/s]
2021-10-11 12:08:48,200 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 193.07it/s]
2021-10-11 12:08:48,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 182.71it/s]
2021-10-11 12:08:49,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 208.19it/s]
2021-10-11 12:08:49,864 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 223.67it/s]
2021-10-11 12:08:50,384 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 223.14it/s]
2021-10-11 12:08:50,910 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 209.55it/s]
2021-10-11 12:08:51,399 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 182.47it/s]
2021-10-11 12:08:51,921 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 230.41it/s]
2021-10-11 12:08:52,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 186.50it/s]
2021-10-11 12:08:52,964 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 191.64it/s]
2021-10-11 12:08:53,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 203.72it/s]
2021-10-11 12:08:54,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 218.08it/s]
2021-10-11 12:08:54,568 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 234.86it/s]
2021-10-11 12:08:55,084 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 229.10it/s]
2021-10-11 12:08:55,628 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 230.89it/s]
2021-10-11 12:08:56,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 225.04it/s]
2021-10-11 12:08:56,602 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 226.58it/s]
2021-10-11 12:08:57,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.35005336179295626
100%|██████████| 22/22 [00:00<00:00, 223.02it/s]
2021-10-11 12:08:57,637 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 193.67it/s]
2021-10-11 12:08:58,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 223.06it/s]
2021-10-11 12:08:58,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 197.16it/s]
2021-10-11 12:08:59,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 203.81it/s]
2021-10-11 12:08:59,813 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 213.62it/s]
2021-10-11 12:09:00,368 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 216.27it/s]
2021-10-11 12:09:00,900 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 164.82it/s]
2021-10-11 12:09:01,496 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 199.88it/s]
2021-10-11 12:09:02,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 208.26it/s]
2021-10-11 12:09:02,632 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 198.86it/s]
2021-10-11 12:09:03,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23941657773034508
100%|██████████| 22/22 [00:00<00:00, 207.80it/s]
2021-10-11 12:09:03,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 204.84it/s]
2021-10-11 12:09:04,251 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 201.85it/s]
2021-10-11 12:09:04,821 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 213.63it/s]
2021-10-11 12:09:05,382 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 192.94it/s]
2021-10-11 12:09:05,948 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 191.21it/s]
2021-10-11 12:09:06,520 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 215.88it/s]
2021-10-11 12:09:07,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 228.14it/s]
2021-10-11 12:09:07,578 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 204.64it/s]
2021-10-11 12:09:08,116 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 196.64it/s]
2021-10-11 12:09:08,680 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 202.56it/s]
2021-10-11 12:09:09,216 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 207.94it/s]
2021-10-11 12:09:09,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 196.23it/s]
2021-10-11 12:09:10,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 211.18it/s]
2021-10-11 12:09:10,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 213.42it/s]
2021-10-11 12:09:11,362 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3048737104233369
100%|██████████| 22/22 [00:00<00:00, 206.70it/s]
2021-10-11 12:09:11,900 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 213.15it/s]
2021-10-11 12:09:12,441 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 232.56it/s]
2021-10-11 12:09:12,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 231.55it/s]
2021-10-11 12:09:13,465 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 222.95it/s]
2021-10-11 12:09:13,985 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 220.23it/s]
2021-10-11 12:09:14,510 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25969405905371756
100%|██████████| 22/22 [00:00<00:00, 212.18it/s]
2021-10-11 12:09:15,051 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 196.50it/s]
2021-10-11 12:09:15,600 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2611170401992174
100%|██████████| 22/22 [00:00<00:00, 224.82it/s]
2021-10-11 12:09:16,115 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 191.29it/s]
2021-10-11 12:09:16,644 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 198.41it/s]
2021-10-11 12:09:17,209 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 220.10it/s]
2021-10-11 12:09:17,754 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 175.34it/s]
2021-10-11 12:09:18,359 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 203.61it/s]
2021-10-11 12:09:18,952 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 196.13it/s]
2021-10-11 12:09:19,493 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33404482390608325
100%|██████████| 22/22 [00:00<00:00, 190.24it/s]
2021-10-11 12:09:20,069 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 199.69it/s]
2021-10-11 12:09:20,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 205.18it/s]
2021-10-11 12:09:21,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 190.17it/s]
2021-10-11 12:09:21,784 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 208.17it/s]
2021-10-11 12:09:22,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 228.93it/s]
2021-10-11 12:09:22,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 219.11it/s]
2021-10-11 12:09:23,384 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 170.39it/s]
2021-10-11 12:09:23,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 215.86it/s]
2021-10-11 12:09:24,490 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 193.71it/s]
2021-10-11 12:09:25,065 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 191.33it/s]
2021-10-11 12:09:25,627 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 208.34it/s]
2021-10-11 12:09:26,167 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 210.83it/s]
2021-10-11 12:09:26,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 175.29it/s]
2021-10-11 12:09:27,292 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2888651725364639
100%|██████████| 22/22 [00:00<00:00, 217.54it/s]
2021-10-11 12:09:27,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3219494841693348
100%|██████████| 22/22 [00:00<00:00, 220.12it/s]
2021-10-11 12:09:28,355 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 219.03it/s]
2021-10-11 12:09:28,899 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 213.59it/s]
2021-10-11 12:09:29,441 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3215937388829598
100%|██████████| 22/22 [00:00<00:00, 223.49it/s]
2021-10-11 12:09:29,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 217.67it/s]
2021-10-11 12:09:30,504 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 230.60it/s]
2021-10-11 12:09:31,017 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 184.00it/s]
2021-10-11 12:09:31,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 207.59it/s]
2021-10-11 12:09:32,103 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 209.24it/s]
2021-10-11 12:09:32,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 216.45it/s]
2021-10-11 12:09:33,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 227.48it/s]
2021-10-11 12:09:33,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 209.51it/s]
2021-10-11 12:09:34,205 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 200.54it/s]
2021-10-11 12:09:34,720 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 200.45it/s]
2021-10-11 12:09:35,286 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 201.49it/s]
2021-10-11 12:09:35,831 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 201.04it/s]
2021-10-11 12:09:36,395 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 195.28it/s]
2021-10-11 12:09:36,985 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
2021-10-11 12:09:36,987 knodle.trainer.trainer INFO     Train avg loss: 0.13099511644844375
2021-10-11 12:09:36,987 knodle.trainer.trainer INFO     Train avg accuracy: 0.9417980321248368
2021-10-11 12:09:36,987 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:09:36,987 knodle.trainer.trainer INFO     Training done
2021-10-11 12:09:36,987 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 128.73it/s]
2021-10-11 12:09:37,167 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.385004997253418). Denoising stops.
2021-10-11 12:09:37,168 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 54.11it/s]
2021-10-11 12:09:37,583 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 12:09:37,583 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 12:09:37,583 knodle.trainer.config INFO     Model will be trained on cpu
Accuracy is: 0.3047019622362088
Precision is: 0.5201048618010556
Recall is: 0.5506933385553876
F1 is: 0.28439490230202236
{'0': {'precision': 0.9494799405646359, 'recall': 0.25734997986306885, 'f1-score': 0.4049429657794677, 'support': 2483}, '1': {'precision': 0.09072978303747535, 'recall': 0.8440366972477065, 'f1-score': 0.16384683882457704, 'support': 218}, 'accuracy': 0.3047019622362088, 'macro avg': {'precision': 0.5201048618010556, 'recall': 0.5506933385553876, 'f1-score': 0.28439490230202236, 'support': 2701}, 'weighted avg': {'precision': 0.8801694872729214, 'recall': 0.30470196223620877, 'f1-score': 0.3854838929634121, 'support': 2701}}
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 12:09:38,112 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 12:09:38,140 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:09:38,264 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5244, samples in test set: 490
2021-10-11 12:09:38,414 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4222, samples in test set: 1512
2021-10-11 12:09:38,764 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5350, samples in test set: 384
2021-10-11 12:09:39,221 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3553, samples in test set: 2181
2021-10-11 12:09:39,771 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4567, samples in test set: 1167
5it [02:18, 27.68s/it]
2021-10-11 12:11:58,291 knodle.trainer.cleanlab.cleanlab INFO     [[0.20421882 0.79578118]
 [0.16989568 0.83010432]
 [0.35073628 0.64926372]
 [0.28253968 0.71746032]
 [0.74018692 0.25981308]
 [0.81313131 0.18686869]
 [0.93856655 0.06143345]
 [0.24137931 0.75862069]
 [0.25609756 0.74390244]]
2021-10-11 12:11:58,383 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 208 out of 5734
2021-10-11 12:11:58,383 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:11:58,383 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:11:58,383 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 153.78it/s]
2021-10-11 12:11:59,220 knodle.trainer.trainer INFO     Epoch development accuracy: 0.19423692636072573
100%|██████████| 22/22 [00:00<00:00, 229.20it/s]
2021-10-11 12:11:59,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23941657773034508
100%|██████████| 22/22 [00:00<00:00, 200.08it/s]
2021-10-11 12:12:00,217 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2006403415154749
100%|██████████| 22/22 [00:00<00:00, 218.43it/s]
2021-10-11 12:12:00,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24831020988971897
100%|██████████| 22/22 [00:00<00:00, 190.23it/s]
2021-10-11 12:12:01,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 184.34it/s]
2021-10-11 12:12:01,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 205.62it/s]
2021-10-11 12:12:02,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 198.46it/s]
2021-10-11 12:12:02,944 knodle.trainer.trainer INFO     Epoch development accuracy: 0.20775524724297403
100%|██████████| 22/22 [00:00<00:00, 207.83it/s]
2021-10-11 12:12:03,481 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 193.81it/s]
2021-10-11 12:12:04,019 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 189.17it/s]
2021-10-11 12:12:04,586 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 188.91it/s]
2021-10-11 12:12:05,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 207.76it/s]
2021-10-11 12:12:05,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 74.76it/s]
2021-10-11 12:12:06,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23657061543934543
100%|██████████| 22/22 [00:00<00:00, 220.75it/s]
2021-10-11 12:12:07,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 231.43it/s]
2021-10-11 12:12:07,583 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 197.71it/s]
2021-10-11 12:12:08,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 206.36it/s]
2021-10-11 12:12:08,755 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 189.95it/s]
2021-10-11 12:12:09,334 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 208.51it/s]
2021-10-11 12:12:09,864 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24226254002134473
100%|██████████| 22/22 [00:00<00:00, 190.03it/s]
2021-10-11 12:12:10,445 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 225.05it/s]
2021-10-11 12:12:10,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 195.03it/s]
2021-10-11 12:12:11,509 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 188.36it/s]
2021-10-11 12:12:12,061 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 228.15it/s]
2021-10-11 12:12:12,589 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33475631447883314
100%|██████████| 22/22 [00:00<00:00, 200.50it/s]
2021-10-11 12:12:13,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 211.12it/s]
2021-10-11 12:12:13,629 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 208.44it/s]
2021-10-11 12:12:14,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 213.36it/s]
2021-10-11 12:12:14,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34436143721095697
100%|██████████| 22/22 [00:00<00:00, 226.68it/s]
2021-10-11 12:12:15,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 233.68it/s]
2021-10-11 12:12:15,682 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 187.27it/s]
2021-10-11 12:12:16,232 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 195.81it/s]
2021-10-11 12:12:16,765 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 207.02it/s]
2021-10-11 12:12:17,309 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 233.06it/s]
2021-10-11 12:12:17,791 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 223.52it/s]
2021-10-11 12:12:18,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 189.95it/s]
2021-10-11 12:12:18,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 146.51it/s]
2021-10-11 12:12:19,424 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 208.56it/s]
2021-10-11 12:12:19,986 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 193.35it/s]
2021-10-11 12:12:20,576 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 218.13it/s]
2021-10-11 12:12:21,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 238.52it/s]
2021-10-11 12:12:21,688 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 163.18it/s]
2021-10-11 12:12:22,266 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 203.81it/s]
2021-10-11 12:12:22,793 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 187.57it/s]
2021-10-11 12:12:23,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 216.76it/s]
2021-10-11 12:12:23,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 193.05it/s]
2021-10-11 12:12:24,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 188.12it/s]
2021-10-11 12:12:24,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 201.22it/s]
2021-10-11 12:12:25,486 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 225.28it/s]
2021-10-11 12:12:26,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3272856634649591
100%|██████████| 22/22 [00:00<00:00, 173.89it/s]
2021-10-11 12:12:26,529 knodle.trainer.trainer INFO     Epoch development accuracy: 0.247954464603344
100%|██████████| 22/22 [00:00<00:00, 239.05it/s]
2021-10-11 12:12:27,043 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 184.70it/s]
2021-10-11 12:12:27,611 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 181.86it/s]
2021-10-11 12:12:28,116 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 228.38it/s]
2021-10-11 12:12:28,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 202.17it/s]
2021-10-11 12:12:29,148 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25008893632159374
100%|██████████| 22/22 [00:00<00:00, 214.20it/s]
2021-10-11 12:12:29,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 222.58it/s]
2021-10-11 12:12:30,189 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2280327285663465
100%|██████████| 22/22 [00:00<00:00, 202.66it/s]
2021-10-11 12:12:30,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.327997154037709
100%|██████████| 22/22 [00:00<00:00, 209.32it/s]
2021-10-11 12:12:31,242 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2472429740305941
100%|██████████| 22/22 [00:00<00:00, 227.33it/s]
2021-10-11 12:12:31,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 188.81it/s]
2021-10-11 12:12:32,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 226.41it/s]
2021-10-11 12:12:32,858 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 196.83it/s]
2021-10-11 12:12:33,418 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 221.53it/s]
2021-10-11 12:12:33,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 192.74it/s]
2021-10-11 12:12:34,453 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 208.03it/s]
2021-10-11 12:12:34,996 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 217.28it/s]
2021-10-11 12:12:35,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 225.53it/s]
2021-10-11 12:12:36,050 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 230.54it/s]
2021-10-11 12:12:36,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 209.89it/s]
2021-10-11 12:12:37,076 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2511561721807186
100%|██████████| 22/22 [00:00<00:00, 217.28it/s]
2021-10-11 12:12:37,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 191.39it/s]
2021-10-11 12:12:38,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 155.01it/s]
2021-10-11 12:12:38,757 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 173.54it/s]
2021-10-11 12:12:39,329 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 203.08it/s]
2021-10-11 12:12:39,916 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 163.15it/s]
2021-10-11 12:12:40,522 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 186.70it/s]
2021-10-11 12:12:41,069 knodle.trainer.trainer INFO     Epoch development accuracy: 0.264318747776592
100%|██████████| 22/22 [00:00<00:00, 202.05it/s]
2021-10-11 12:12:41,640 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2351476342938456
100%|██████████| 22/22 [00:00<00:00, 214.51it/s]
2021-10-11 12:12:42,166 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 196.15it/s]
2021-10-11 12:12:42,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 215.35it/s]
2021-10-11 12:12:43,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 229.83it/s]
2021-10-11 12:12:43,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 200.08it/s]
2021-10-11 12:12:44,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 234.56it/s]
2021-10-11 12:12:44,738 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 195.53it/s]
2021-10-11 12:12:45,243 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 196.28it/s]
2021-10-11 12:12:45,776 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 191.88it/s]
2021-10-11 12:12:46,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 212.86it/s]
2021-10-11 12:12:46,811 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22838847385272146
100%|██████████| 22/22 [00:00<00:00, 215.64it/s]
2021-10-11 12:12:47,347 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3336890786197083
100%|██████████| 22/22 [00:00<00:00, 221.84it/s]
2021-10-11 12:12:47,858 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 201.14it/s]
2021-10-11 12:12:48,407 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 180.67it/s]
2021-10-11 12:12:48,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3297758804695838
100%|██████████| 22/22 [00:00<00:00, 210.87it/s]
2021-10-11 12:12:49,462 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 203.02it/s]
2021-10-11 12:12:49,989 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2700106723585913
100%|██████████| 22/22 [00:00<00:00, 193.87it/s]
2021-10-11 12:12:50,550 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 168.42it/s]
2021-10-11 12:12:51,135 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 221.25it/s]
2021-10-11 12:12:51,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 153.26it/s]
2021-10-11 12:12:52,326 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23870508715759517
100%|██████████| 22/22 [00:00<00:00, 187.30it/s]
2021-10-11 12:12:52,874 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
2021-10-11 12:12:52,876 knodle.trainer.trainer INFO     Train avg loss: 0.13324932665253686
2021-10-11 12:12:52,876 knodle.trainer.trainer INFO     Train avg accuracy: 0.9407945599026148
2021-10-11 12:12:52,876 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:12:52,876 knodle.trainer.trainer INFO     Training done
2021-10-11 12:12:52,876 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 153.50it/s]
2021-10-11 12:12:53,028 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9388714733542319, 'recall': 0.22853872567722244, 'f1-score': 0.36759742252224614, 'support': 2621}, '1': {'precision': 0.06948918545789232, 'recall': 0.7947368421052632, 'f1-score': 0.1278036394413881, 'support': 190}, 'accuracy': 0.26680896478121663, 'macro avg': {'precision': 0.5041803294060622, 'recall': 0.5116377838912428, 'f1-score': 0.2477005309818171, 'support': 2811}, 'weighted avg': {'precision': 0.8801085296686024, 'recall': 0.26680896478121663, 'f1-score': 0.3513893759959697, 'support': 2811}}, Dev loss: 3.583913564682007, denoising continues.
2021-10-11 12:12:53,028 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 12:12:53,051 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:12:53,185 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 4912, samples in test set: 822
2021-10-11 12:12:53,380 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3794, samples in test set: 1940
2021-10-11 12:12:53,510 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5588, samples in test set: 146
2021-10-11 12:12:53,827 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5173, samples in test set: 561
2021-10-11 12:12:54,598 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 3469, samples in test set: 2265
5it [02:28, 29.61s/it]
2021-10-11 12:15:22,812 knodle.trainer.cleanlab.cleanlab INFO     [[0.02228097 0.97771903]
 [0.00739958 0.99260042]
 [0.12287105 0.87712895]
 [0.0861244  0.9138756 ]
 [0.96382429 0.03617571]
 [0.98571429 0.01428571]
 [1.         0.        ]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 12:15:22,949 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 0 out of 5734
2021-10-11 12:15:22,950 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:15:22,950 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:15:22,950 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 113.30it/s]
2021-10-11 12:15:23,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 200.87it/s]
2021-10-11 12:15:24,310 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 171.64it/s]
2021-10-11 12:15:24,883 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 197.81it/s]
2021-10-11 12:15:25,436 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 173.76it/s]
2021-10-11 12:15:26,117 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24759871931696906
100%|██████████| 22/22 [00:00<00:00, 155.85it/s]
2021-10-11 12:15:26,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24546424759871932
100%|██████████| 22/22 [00:00<00:00, 176.25it/s]
2021-10-11 12:15:27,367 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 179.07it/s]
2021-10-11 12:15:27,982 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3127001067235859
100%|██████████| 22/22 [00:00<00:00, 181.13it/s]
2021-10-11 12:15:28,532 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3141230878690857
100%|██████████| 22/22 [00:00<00:00, 127.91it/s]
2021-10-11 12:15:29,133 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 158.49it/s]
2021-10-11 12:15:29,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 222.76it/s]
2021-10-11 12:15:30,473 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 236.03it/s]
2021-10-11 12:15:30,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3233724653148346
100%|██████████| 22/22 [00:00<00:00, 208.66it/s]
2021-10-11 12:15:31,457 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 191.64it/s]
2021-10-11 12:15:32,023 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 183.73it/s]
2021-10-11 12:15:32,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 201.74it/s]
2021-10-11 12:15:33,158 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 223.17it/s]
2021-10-11 12:15:33,685 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 219.21it/s]
2021-10-11 12:15:34,183 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 221.25it/s]
2021-10-11 12:15:34,687 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 221.43it/s]
2021-10-11 12:15:35,190 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 238.10it/s]
2021-10-11 12:15:35,673 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 232.77it/s]
2021-10-11 12:15:36,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 232.68it/s]
2021-10-11 12:15:36,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 229.05it/s]
2021-10-11 12:15:37,141 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 217.61it/s]
2021-10-11 12:15:37,653 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 234.37it/s]
2021-10-11 12:15:38,144 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24439701173959444
100%|██████████| 22/22 [00:00<00:00, 233.17it/s]
2021-10-11 12:15:38,629 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 237.26it/s]
2021-10-11 12:15:39,121 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 232.20it/s]
2021-10-11 12:15:39,605 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 236.13it/s]
2021-10-11 12:15:40,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 233.82it/s]
2021-10-11 12:15:40,574 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 216.58it/s]
2021-10-11 12:15:41,063 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 118.35it/s]
2021-10-11 12:15:41,642 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3023834934187122
100%|██████████| 22/22 [00:00<00:00, 227.72it/s]
2021-10-11 12:15:42,146 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 229.93it/s]
2021-10-11 12:15:42,633 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 235.27it/s]
2021-10-11 12:15:43,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 235.25it/s]
2021-10-11 12:15:43,611 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 233.29it/s]
2021-10-11 12:15:44,106 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 229.96it/s]
2021-10-11 12:15:44,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 235.94it/s]
2021-10-11 12:15:45,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3137673425827108
100%|██████████| 22/22 [00:00<00:00, 228.35it/s]
2021-10-11 12:15:45,578 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 234.26it/s]
2021-10-11 12:15:46,063 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 212.55it/s]
2021-10-11 12:15:46,617 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 186.27it/s]
2021-10-11 12:15:47,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 230.85it/s]
2021-10-11 12:15:47,707 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 223.69it/s]
2021-10-11 12:15:48,236 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 221.23it/s]
2021-10-11 12:15:48,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 222.16it/s]
2021-10-11 12:15:49,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 192.22it/s]
2021-10-11 12:15:49,797 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 215.91it/s]
2021-10-11 12:15:50,352 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 190.59it/s]
2021-10-11 12:15:50,920 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 193.21it/s]
2021-10-11 12:15:51,493 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 188.76it/s]
2021-10-11 12:15:52,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 199.51it/s]
2021-10-11 12:15:52,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 217.46it/s]
2021-10-11 12:15:53,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 217.36it/s]
2021-10-11 12:15:53,646 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 197.82it/s]
2021-10-11 12:15:54,180 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 211.27it/s]
2021-10-11 12:15:54,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 196.41it/s]
2021-10-11 12:15:55,249 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 216.20it/s]
2021-10-11 12:15:55,753 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 223.14it/s]
2021-10-11 12:15:56,258 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2532906438989683
100%|██████████| 22/22 [00:00<00:00, 235.40it/s]
2021-10-11 12:15:56,758 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 194.02it/s]
2021-10-11 12:15:57,266 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2529348986125934
100%|██████████| 22/22 [00:00<00:00, 207.46it/s]
2021-10-11 12:15:57,767 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2564923514763429
100%|██████████| 22/22 [00:00<00:00, 229.44it/s]
2021-10-11 12:15:58,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 234.44it/s]
2021-10-11 12:15:58,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 220.34it/s]
2021-10-11 12:15:59,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 217.38it/s]
2021-10-11 12:15:59,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 211.96it/s]
2021-10-11 12:16:00,226 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 210.37it/s]
2021-10-11 12:16:00,788 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 224.05it/s]
2021-10-11 12:16:01,268 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3244397011739594
100%|██████████| 22/22 [00:00<00:00, 193.18it/s]
2021-10-11 12:16:01,807 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 223.45it/s]
2021-10-11 12:16:02,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 185.07it/s]
2021-10-11 12:16:02,888 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 203.54it/s]
2021-10-11 12:16:03,430 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 207.77it/s]
2021-10-11 12:16:03,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 185.11it/s]
2021-10-11 12:16:04,529 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 201.61it/s]
2021-10-11 12:16:05,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2568480967627179
100%|██████████| 22/22 [00:00<00:00, 191.65it/s]
2021-10-11 12:16:05,669 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 194.19it/s]
2021-10-11 12:16:06,244 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 191.25it/s]
2021-10-11 12:16:06,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 195.08it/s]
2021-10-11 12:16:07,386 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 176.89it/s]
2021-10-11 12:16:07,953 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3344005691924582
100%|██████████| 22/22 [00:00<00:00, 186.21it/s]
2021-10-11 12:16:08,516 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 197.17it/s]
2021-10-11 12:16:09,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 192.22it/s]
2021-10-11 12:16:09,658 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 239.26it/s]
2021-10-11 12:16:10,167 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 242.06it/s]
2021-10-11 12:16:10,667 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 204.00it/s]
2021-10-11 12:16:11,198 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 215.58it/s]
2021-10-11 12:16:11,719 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 218.42it/s]
2021-10-11 12:16:12,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 238.04it/s]
Accuracy is: 0.322843391336542
Precision is: 0.5179986119749712
Recall is: 0.5480071827879119
F1 is: 0.2971934708986655
{'0': {'precision': 0.9455040871934605, 'recall': 0.2795006041079339, 'f1-score': 0.43145788001243396, 'support': 2483}, '1': {'precision': 0.09049313675648195, 'recall': 0.8165137614678899, 'f1-score': 0.162929061784897, 'support': 218}, 'accuracy': 0.322843391336542, 'macro avg': {'precision': 0.5179986119749712, 'recall': 0.5480071827879119, 'f1-score': 0.2971934708986655, 'support': 2701}, 'weighted avg': {'precision': 0.8764954284762221, 'recall': 0.322843391336542, 'f1-score': 0.409784691425391, 'support': 2701}}
2021-10-11 12:16:12,732 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26289576663109215
100%|██████████| 22/22 [00:00<00:00, 226.76it/s]
2021-10-11 12:16:13,211 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 234.40it/s]
2021-10-11 12:16:13,698 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 230.45it/s]
2021-10-11 12:16:14,184 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 243.36it/s]
2021-10-11 12:16:14,659 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 239.03it/s]
2021-10-11 12:16:15,142 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 234.65it/s]
2021-10-11 12:16:15,620 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 239.98it/s]
2021-10-11 12:16:16,092 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
2021-10-11 12:16:16,093 knodle.trainer.trainer INFO     Train avg loss: 0.13071719412039967
2021-10-11 12:16:16,093 knodle.trainer.trainer INFO     Train avg accuracy: 0.9415427557097544
2021-10-11 12:16:16,093 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:16:16,093 knodle.trainer.trainer INFO     Training done
2021-10-11 12:16:16,093 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 154.19it/s]
2021-10-11 12:16:16,244 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.221026420593262). Denoising stops.
2021-10-11 12:16:16,244 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 88.01it/s]
2021-10-11 12:16:16,500 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 12:16:16,500 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 12:16:16,500 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 12:16:16,926 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 12:16:16,946 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:16:17,356 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5192, samples in test set: 542
2021-10-11 12:16:17,986 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4046, samples in test set: 1688
2021-10-11 12:16:18,379 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5248, samples in test set: 486
2021-10-11 12:16:18,616 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4159, samples in test set: 1575
2021-10-11 12:16:18,817 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4291, samples in test set: 1443
5it [02:15, 27.13s/it]
2021-10-11 12:18:34,590 knodle.trainer.cleanlab.cleanlab INFO     [[0.11553398 0.88446602]
 [0.08766859 0.91233141]
 [0.34205607 0.65794393]
 [0.06439394 0.93560606]
 [0.82191338 0.17808662]
 [0.96889952 0.03110048]
 [0.78654971 0.21345029]
 [0.04545455 0.95454545]
 [0.01515152 0.98484848]]
2021-10-11 12:18:34,714 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 206 out of 5734
2021-10-11 12:18:34,714 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:18:34,714 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:18:34,715 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 97.63it/s]
2021-10-11 12:18:35,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21558164354322304
100%|██████████| 22/22 [00:00<00:00, 207.96it/s]
2021-10-11 12:18:36,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2095339736748488
100%|██████████| 22/22 [00:00<00:00, 214.64it/s]
2021-10-11 12:18:36,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 226.74it/s]
2021-10-11 12:18:37,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.1928139452152259
100%|██████████| 22/22 [00:00<00:00, 185.81it/s]
2021-10-11 12:18:37,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 190.12it/s]
2021-10-11 12:18:38,393 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 204.78it/s]
2021-10-11 12:18:38,942 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 197.64it/s]
2021-10-11 12:18:39,489 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 214.14it/s]
2021-10-11 12:18:40,014 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23301316257559587
100%|██████████| 22/22 [00:00<00:00, 215.90it/s]
2021-10-11 12:18:40,530 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 202.01it/s]
2021-10-11 12:18:41,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 212.80it/s]
2021-10-11 12:18:41,604 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23621487015297046
100%|██████████| 22/22 [00:00<00:00, 148.43it/s]
2021-10-11 12:18:42,164 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 187.84it/s]
2021-10-11 12:18:42,779 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 178.36it/s]
2021-10-11 12:18:43,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 197.95it/s]
2021-10-11 12:18:43,878 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29882604055496265
100%|██████████| 22/22 [00:00<00:00, 208.18it/s]
2021-10-11 12:18:44,476 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 237.16it/s]
2021-10-11 12:18:44,983 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 233.71it/s]
2021-10-11 12:18:45,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23230167200284596
100%|██████████| 22/22 [00:00<00:00, 234.80it/s]
2021-10-11 12:18:45,957 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 233.87it/s]
2021-10-11 12:18:46,446 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 214.55it/s]
2021-10-11 12:18:46,980 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 182.20it/s]
2021-10-11 12:18:47,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 146.75it/s]
2021-10-11 12:18:48,346 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22660974742084666
100%|██████████| 22/22 [00:00<00:00, 156.83it/s]
2021-10-11 12:18:49,077 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 199.26it/s]
2021-10-11 12:18:49,712 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 228.01it/s]
2021-10-11 12:18:50,218 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 230.47it/s]
2021-10-11 12:18:50,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 226.92it/s]
2021-10-11 12:18:51,204 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 198.95it/s]
2021-10-11 12:18:51,761 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 223.96it/s]
2021-10-11 12:18:52,266 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 225.08it/s]
2021-10-11 12:18:52,787 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 214.22it/s]
2021-10-11 12:18:53,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 236.45it/s]
2021-10-11 12:18:53,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 196.48it/s]
2021-10-11 12:18:54,326 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 176.47it/s]
2021-10-11 12:18:54,941 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 203.03it/s]
2021-10-11 12:18:55,498 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 169.02it/s]
2021-10-11 12:18:56,068 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 195.30it/s]
2021-10-11 12:18:56,585 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 200.13it/s]
2021-10-11 12:18:57,092 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24510850231234435
100%|██████████| 22/22 [00:00<00:00, 153.51it/s]
2021-10-11 12:18:57,759 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 189.88it/s]
2021-10-11 12:18:58,329 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 232.70it/s]
2021-10-11 12:18:58,847 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 204.15it/s]
2021-10-11 12:18:59,382 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 213.05it/s]
2021-10-11 12:18:59,875 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 235.57it/s]
2021-10-11 12:19:00,383 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 184.38it/s]
2021-10-11 12:19:00,913 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23372465314834578
100%|██████████| 22/22 [00:00<00:00, 126.47it/s]
2021-10-11 12:19:01,523 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25471362504446815
100%|██████████| 22/22 [00:00<00:00, 159.39it/s]
2021-10-11 12:19:02,271 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 158.68it/s]
2021-10-11 12:19:02,925 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 173.29it/s]
2021-10-11 12:19:03,690 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 205.18it/s]
2021-10-11 12:19:04,275 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 219.51it/s]
2021-10-11 12:19:04,786 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 213.64it/s]
2021-10-11 12:19:05,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23408039843472073
100%|██████████| 22/22 [00:00<00:00, 190.94it/s]
2021-10-11 12:19:05,851 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 200.79it/s]
2021-10-11 12:19:06,423 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 206.23it/s]
2021-10-11 12:19:06,932 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 196.46it/s]
2021-10-11 12:19:07,452 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 147.72it/s]
2021-10-11 12:19:08,031 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 148.06it/s]
2021-10-11 12:19:08,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 185.84it/s]
2021-10-11 12:19:09,412 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2305229455709712
100%|██████████| 22/22 [00:00<00:00, 214.26it/s]
2021-10-11 12:19:09,971 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 203.59it/s]
2021-10-11 12:19:10,519 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 204.66it/s]
2021-10-11 12:19:11,132 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 205.13it/s]
2021-10-11 12:19:11,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 211.95it/s]
2021-10-11 12:19:12,224 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 219.85it/s]
2021-10-11 12:19:12,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 222.98it/s]
2021-10-11 12:19:13,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 199.78it/s]
2021-10-11 12:19:13,771 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2710779082177161
100%|██████████| 22/22 [00:00<00:00, 211.71it/s]
2021-10-11 12:19:14,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 222.62it/s]
2021-10-11 12:19:14,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22518676627534684
100%|██████████| 22/22 [00:00<00:00, 208.90it/s]
2021-10-11 12:19:15,363 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 144.08it/s]
2021-10-11 12:19:15,948 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 162.08it/s]
2021-10-11 12:19:16,611 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2778370686588403
100%|██████████| 22/22 [00:00<00:00, 187.19it/s]
2021-10-11 12:19:17,187 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 226.29it/s]
2021-10-11 12:19:17,698 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 214.21it/s]
2021-10-11 12:19:18,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 205.30it/s]
2021-10-11 12:19:18,844 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 166.56it/s]
2021-10-11 12:19:19,421 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 202.27it/s]
2021-10-11 12:19:19,967 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 226.77it/s]
2021-10-11 12:19:20,470 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 209.39it/s]
2021-10-11 12:19:20,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 227.08it/s]
2021-10-11 12:19:21,491 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 204.75it/s]
2021-10-11 12:19:22,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 218.27it/s]
2021-10-11 12:19:22,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 191.58it/s]
2021-10-11 12:19:23,056 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 204.56it/s]
2021-10-11 12:19:23,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2607612949128424
100%|██████████| 22/22 [00:00<00:00, 213.39it/s]
2021-10-11 12:19:24,100 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3094983991462113
100%|██████████| 22/22 [00:00<00:00, 206.33it/s]
2021-10-11 12:19:24,656 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 188.37it/s]
2021-10-11 12:19:25,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 217.29it/s]
2021-10-11 12:19:25,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 204.97it/s]
2021-10-11 12:19:26,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 219.04it/s]
2021-10-11 12:19:26,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 180.61it/s]
2021-10-11 12:19:27,415 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 170.70it/s]
2021-10-11 12:19:28,035 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 220.22it/s]
2021-10-11 12:19:28,593 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 223.92it/s]
2021-10-11 12:19:29,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 210.70it/s]
2021-10-11 12:19:29,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2902881536819637
100%|██████████| 22/22 [00:00<00:00, 240.59it/s]
2021-10-11 12:19:30,143 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 231.23it/s]
2021-10-11 12:19:30,622 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
2021-10-11 12:19:30,623 knodle.trainer.trainer INFO     Train avg loss: 0.13302264341277378
2021-10-11 12:19:30,623 knodle.trainer.trainer INFO     Train avg accuracy: 0.9406944441927803
2021-10-11 12:19:30,623 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:19:30,623 knodle.trainer.trainer INFO     Training done
2021-10-11 12:19:30,623 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 139.92it/s]
2021-10-11 12:19:30,789 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.946685878962536, 'recall': 0.250667684090042, 'f1-score': 0.39638009049773754, 'support': 2621}, '1': {'precision': 0.07227208313651394, 'recall': 0.8052631578947368, 'f1-score': 0.1326397919375813, 'support': 190}, 'accuracy': 0.288153681963714, 'macro avg': {'precision': 0.5094789810495249, 'recall': 0.5279654209923894, 'f1-score': 0.2645099412176594, 'support': 2811}, 'weighted avg': {'precision': 0.8875828475833315, 'recall': 0.288153681963714, 'f1-score': 0.37855346057015676, 'support': 2811}}, Dev loss: 3.386396884918213, denoising continues.
2021-10-11 12:19:30,789 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 12:19:30,814 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:19:31,611 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5586, samples in test set: 148
2021-10-11 12:19:31,912 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3429, samples in test set: 2305
2021-10-11 12:19:32,260 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5403, samples in test set: 331
2021-10-11 12:19:32,617 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4240, samples in test set: 1494
2021-10-11 12:19:32,916 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4278, samples in test set: 1456
5it [02:24, 28.96s/it]
2021-10-11 12:21:57,838 knodle.trainer.cleanlab.cleanlab INFO     [[0.08507671 0.91492329]
 [0.01717902 0.98282098]
 [0.115      0.885     ]
 [0.02575107 0.97424893]
 [0.90359477 0.09640523]
 [0.98047538 0.01952462]
 [0.9185022  0.0814978 ]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 12:21:57,939 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 14 out of 5734
2021-10-11 12:21:57,940 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:21:57,940 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:21:57,940 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 171.58it/s]
2021-10-11 12:21:58,403 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 217.27it/s]
2021-10-11 12:21:58,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 221.10it/s]
2021-10-11 12:21:59,412 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 217.70it/s]
2021-10-11 12:21:59,937 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 218.23it/s]
2021-10-11 12:22:00,448 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 217.26it/s]
2021-10-11 12:22:00,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 207.11it/s]
2021-10-11 12:22:01,500 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 194.27it/s]
2021-10-11 12:22:02,044 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 201.41it/s]
2021-10-11 12:22:02,598 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 175.01it/s]
2021-10-11 12:22:03,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 214.80it/s]
2021-10-11 12:22:03,739 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 206.57it/s]
2021-10-11 12:22:04,261 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 200.07it/s]
2021-10-11 12:22:04,823 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26040554962646745
100%|██████████| 22/22 [00:00<00:00, 98.82it/s]
2021-10-11 12:22:05,539 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 202.78it/s]
2021-10-11 12:22:06,088 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 222.16it/s]
2021-10-11 12:22:06,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 204.19it/s]
2021-10-11 12:22:07,138 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 199.06it/s]
2021-10-11 12:22:07,670 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3240839558875845
100%|██████████| 22/22 [00:00<00:00, 207.03it/s]
2021-10-11 12:22:08,213 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 207.39it/s]
2021-10-11 12:22:08,741 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 221.78it/s]
2021-10-11 12:22:09,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 210.33it/s]
2021-10-11 12:22:09,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 200.91it/s]
2021-10-11 12:22:10,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 211.83it/s]
2021-10-11 12:22:10,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 201.65it/s]
2021-10-11 12:22:11,385 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 204.75it/s]
2021-10-11 12:22:11,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 190.18it/s]
2021-10-11 12:22:12,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32621842760583425
100%|██████████| 22/22 [00:00<00:00, 208.45it/s]
2021-10-11 12:22:13,023 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 193.08it/s]
2021-10-11 12:22:13,572 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 183.26it/s]
2021-10-11 12:22:14,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 195.52it/s]
2021-10-11 12:22:14,702 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 204.78it/s]
2021-10-11 12:22:15,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 197.80it/s]
2021-10-11 12:22:15,789 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 200.00it/s]
2021-10-11 12:22:16,353 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32372821060120954
100%|██████████| 22/22 [00:00<00:00, 206.80it/s]
2021-10-11 12:22:16,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 204.22it/s]
2021-10-11 12:22:17,442 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 191.79it/s]
2021-10-11 12:22:17,995 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 202.41it/s]
2021-10-11 12:22:18,527 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 203.83it/s]
2021-10-11 12:22:19,076 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 211.64it/s]
2021-10-11 12:22:19,616 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 228.10it/s]
2021-10-11 12:22:20,104 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 218.34it/s]
2021-10-11 12:22:20,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 240.17it/s]
2021-10-11 12:22:21,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 223.68it/s]
2021-10-11 12:22:21,580 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 230.77it/s]
2021-10-11 12:22:22,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2742796157950907
100%|██████████| 22/22 [00:00<00:00, 232.12it/s]
2021-10-11 12:22:22,573 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 224.77it/s]
2021-10-11 12:22:23,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 240.07it/s]
2021-10-11 12:22:23,518 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 236.75it/s]
2021-10-11 12:22:23,989 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 195.69it/s]
2021-10-11 12:22:24,488 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 225.81it/s]
2021-10-11 12:22:25,027 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 200.92it/s]
2021-10-11 12:22:25,570 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 201.49it/s]
2021-10-11 12:22:26,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28850942725008893
100%|██████████| 22/22 [00:00<00:00, 222.49it/s]
2021-10-11 12:22:26,610 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 216.75it/s]
2021-10-11 12:22:27,134 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 236.85it/s]
2021-10-11 12:22:27,612 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 215.86it/s]
2021-10-11 12:22:28,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 204.45it/s]
2021-10-11 12:22:28,652 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 233.73it/s]
2021-10-11 12:22:29,152 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 209.54it/s]
2021-10-11 12:22:29,672 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 217.49it/s]
2021-10-11 12:22:30,180 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 204.34it/s]
2021-10-11 12:22:30,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24368552116684453
100%|██████████| 22/22 [00:00<00:00, 209.28it/s]
2021-10-11 12:22:31,214 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 192.32it/s]
2021-10-11 12:22:31,755 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 206.95it/s]
2021-10-11 12:22:32,296 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 185.70it/s]
2021-10-11 12:22:32,869 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 196.27it/s]
2021-10-11 12:22:33,431 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2835289932408396
100%|██████████| 22/22 [00:00<00:00, 208.81it/s]
2021-10-11 12:22:33,974 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 233.41it/s]
2021-10-11 12:22:34,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 201.38it/s]
2021-10-11 12:22:35,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26182853077196727
100%|██████████| 22/22 [00:00<00:00, 231.96it/s]
2021-10-11 12:22:35,522 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 241.40it/s]
2021-10-11 12:22:35,974 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 237.17it/s]
2021-10-11 12:22:36,491 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 234.90it/s]
2021-10-11 12:22:36,983 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 237.92it/s]
2021-10-11 12:22:37,440 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 220.18it/s]
2021-10-11 12:22:37,951 knodle.trainer.trainer INFO     Epoch development accuracy: 0.304162219850587
100%|██████████| 22/22 [00:00<00:00, 234.34it/s]
2021-10-11 12:22:38,402 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 224.16it/s]
2021-10-11 12:22:38,863 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 218.66it/s]
2021-10-11 12:22:39,342 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 218.15it/s]
2021-10-11 12:22:39,807 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 209.39it/s]
2021-10-11 12:22:40,298 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 205.72it/s]
2021-10-11 12:22:40,831 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 146.66it/s]
2021-10-11 12:22:41,571 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 157.78it/s]
2021-10-11 12:22:42,202 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 168.30it/s]
2021-10-11 12:22:42,837 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 172.94it/s]
2021-10-11 12:22:43,511 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 155.29it/s]
2021-10-11 12:22:44,109 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 162.51it/s]
2021-10-11 12:22:44,794 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 194.82it/s]
2021-10-11 12:22:45,429 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 219.75it/s]
2021-10-11 12:22:45,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 197.96it/s]
2021-10-11 12:22:46,534 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 200.68it/s]
2021-10-11 12:22:47,112 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 222.34it/s]
2021-10-11 12:22:47,592 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 218.29it/s]
2021-10-11 12:22:48,077 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 212.06it/s]
2021-10-11 12:22:48,571 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 185.52it/s]
2021-10-11 12:22:49,114 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 212.04it/s]
2021-10-11 12:22:49,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 216.20it/s]
2021-10-11 12:22:50,188 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 232.08it/s]
2021-10-11 12:22:50,687 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 220.96it/s]
2021-10-11 12:22:51,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
2021-10-11 12:22:51,210 knodle.trainer.trainer INFO     Train avg loss: 0.13090218894659642
2021-10-11 12:22:51,210 knodle.trainer.trainer INFO     Train avg accuracy: 0.9412432935635243
2021-10-11 12:22:51,210 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:22:51,210 knodle.trainer.trainer INFO     Training done
2021-10-11 12:22:51,211 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 141.77it/s]
2021-10-11 12:22:51,373 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 3.95066237449646). Denoising stops.
2021-10-11 12:22:51,373 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 60.92it/s]
Accuracy is: 0.33802295446131064
Precision is: 0.518828001960944
Recall is: 0.5520789072112383
F1 is: 0.3081779998510174
{'0': {'precision': 0.9460847240051348, 'recall': 0.2968183648811921, 'f1-score': 0.45187001839362356, 'support': 2483}, '1': {'precision': 0.09157127991675339, 'recall': 0.8073394495412844, 'f1-score': 0.16448598130841122, 'support': 218}, 'accuracy': 0.33802295446131064, 'macro avg': {'precision': 0.518828001960944, 'recall': 0.5520789072112383, 'f1-score': 0.3081779998510174, 'support': 2701}, 'weighted avg': {'precision': 0.8771162194470944, 'recall': 0.33802295446131064, 'f1-score': 0.42867500910647943, 'support': 2701}}
2021-10-11 12:22:51,750 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 12:22:51,750 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 12:22:51,750 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 12:22:53,016 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 12:22:53,040 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:22:53,353 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5601, samples in test set: 133
2021-10-11 12:22:53,659 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 4512, samples in test set: 1222
2021-10-11 12:22:53,933 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5150, samples in test set: 584
2021-10-11 12:22:54,339 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 2413, samples in test set: 3321
2021-10-11 12:22:54,591 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5260, samples in test set: 474
5it [02:13, 26.68s/it]
2021-10-11 12:25:08,133 knodle.trainer.cleanlab.cleanlab INFO     [[0.06493002 0.93506998]
 [0.0323475  0.9676525 ]
 [0.21255507 0.78744493]
 [0.07068063 0.92931937]
 [0.87692308 0.12307692]
 [0.9370229  0.0629771 ]
 [0.821875   0.178125  ]
 [0.02380952 0.97619048]
 [0.06896552 0.93103448]]
2021-10-11 12:25:08,255 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 203 out of 5734
2021-10-11 12:25:08,256 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:25:08,257 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:25:08,257 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 60.32it/s]
2021-10-11 12:25:09,458 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2408395588758449
100%|██████████| 22/22 [00:00<00:00, 152.24it/s]
2021-10-11 12:25:10,107 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21166844539309854
100%|██████████| 22/22 [00:00<00:00, 179.13it/s]
2021-10-11 12:25:10,744 knodle.trainer.trainer INFO     Epoch development accuracy: 0.263963002490217
100%|██████████| 22/22 [00:00<00:00, 206.17it/s]
2021-10-11 12:25:11,304 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25257915332621844
100%|██████████| 22/22 [00:00<00:00, 198.42it/s]
2021-10-11 12:25:11,873 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2508004268943437
100%|██████████| 22/22 [00:00<00:00, 177.59it/s]
2021-10-11 12:25:12,492 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23550337958022055
100%|██████████| 22/22 [00:00<00:00, 188.39it/s]
2021-10-11 12:25:13,098 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 211.30it/s]
2021-10-11 12:25:13,695 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 181.48it/s]
2021-10-11 12:25:14,266 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 197.77it/s]
2021-10-11 12:25:14,816 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2522234080398435
100%|██████████| 22/22 [00:00<00:00, 181.25it/s]
2021-10-11 12:25:15,387 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2390608324439701
100%|██████████| 22/22 [00:00<00:00, 215.47it/s]
2021-10-11 12:25:15,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2600498043400925
100%|██████████| 22/22 [00:00<00:00, 203.64it/s]
2021-10-11 12:25:16,518 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 194.24it/s]
2021-10-11 12:25:17,070 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25400213447171827
100%|██████████| 22/22 [00:00<00:00, 179.38it/s]
2021-10-11 12:25:17,687 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24653148345784417
100%|██████████| 22/22 [00:00<00:00, 187.83it/s]
2021-10-11 12:25:18,338 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 187.99it/s]
2021-10-11 12:25:18,924 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23728210601209535
100%|██████████| 22/22 [00:00<00:00, 200.98it/s]
2021-10-11 12:25:19,499 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24617573817146923
100%|██████████| 22/22 [00:00<00:00, 182.72it/s]
2021-10-11 12:25:20,087 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 183.29it/s]
2021-10-11 12:25:20,677 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3400924937744575
100%|██████████| 22/22 [00:00<00:00, 187.09it/s]
2021-10-11 12:25:21,240 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 166.06it/s]
2021-10-11 12:25:21,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 194.85it/s]
2021-10-11 12:25:22,491 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 215.54it/s]
2021-10-11 12:25:23,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 185.64it/s]
2021-10-11 12:25:23,581 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2586268231945927
100%|██████████| 22/22 [00:00<00:00, 190.58it/s]
2021-10-11 12:25:24,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 204.75it/s]
2021-10-11 12:25:24,721 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 204.20it/s]
2021-10-11 12:25:25,272 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22447527570259693
100%|██████████| 22/22 [00:00<00:00, 200.82it/s]
2021-10-11 12:25:25,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24155104944859482
100%|██████████| 22/22 [00:00<00:00, 219.16it/s]
2021-10-11 12:25:26,357 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 193.76it/s]
2021-10-11 12:25:26,911 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3528993240839559
100%|██████████| 22/22 [00:00<00:00, 210.04it/s]
2021-10-11 12:25:27,477 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22909996442547137
100%|██████████| 22/22 [00:00<00:00, 191.72it/s]
2021-10-11 12:25:28,050 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 96.14it/s]
2021-10-11 12:25:28,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 186.58it/s]
2021-10-11 12:25:29,299 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 180.22it/s]
2021-10-11 12:25:29,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28424048381358946
100%|██████████| 22/22 [00:00<00:00, 194.90it/s]
2021-10-11 12:25:30,489 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28281750266808964
100%|██████████| 22/22 [00:00<00:00, 196.65it/s]
2021-10-11 12:25:31,055 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 201.94it/s]
2021-10-11 12:25:31,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27392387050871575
100%|██████████| 22/22 [00:00<00:00, 203.54it/s]
2021-10-11 12:25:32,162 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27321237993596587
100%|██████████| 22/22 [00:00<00:00, 213.32it/s]
2021-10-11 12:25:32,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26609747420846674
100%|██████████| 22/22 [00:00<00:00, 200.97it/s]
2021-10-11 12:25:33,238 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 212.66it/s]
2021-10-11 12:25:33,765 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 185.78it/s]
2021-10-11 12:25:34,335 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 183.68it/s]
2021-10-11 12:25:34,922 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2280327285663465
100%|██████████| 22/22 [00:00<00:00, 201.25it/s]
2021-10-11 12:25:35,487 knodle.trainer.trainer INFO     Epoch development accuracy: 0.280327285663465
100%|██████████| 22/22 [00:00<00:00, 193.35it/s]
2021-10-11 12:25:36,049 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24902170046246888
100%|██████████| 22/22 [00:00<00:00, 198.00it/s]
2021-10-11 12:25:36,591 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 190.63it/s]
2021-10-11 12:25:37,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 187.24it/s]
2021-10-11 12:25:37,699 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 189.46it/s]
2021-10-11 12:25:38,247 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 185.57it/s]
2021-10-11 12:25:38,806 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 203.68it/s]
2021-10-11 12:25:39,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2664532194948417
100%|██████████| 22/22 [00:00<00:00, 196.68it/s]
2021-10-11 12:25:39,894 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27178939879046604
100%|██████████| 22/22 [00:00<00:00, 206.76it/s]
2021-10-11 12:25:40,432 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 201.47it/s]
2021-10-11 12:25:40,981 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31554606901458554
100%|██████████| 22/22 [00:00<00:00, 212.55it/s]
2021-10-11 12:25:41,510 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27072216293134116
100%|██████████| 22/22 [00:00<00:00, 212.34it/s]
2021-10-11 12:25:42,037 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 197.79it/s]
2021-10-11 12:25:42,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 203.00it/s]
2021-10-11 12:25:43,128 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 198.75it/s]
2021-10-11 12:25:43,684 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26147278548559233
100%|██████████| 22/22 [00:00<00:00, 184.70it/s]
2021-10-11 12:25:44,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 222.19it/s]
2021-10-11 12:25:44,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 206.60it/s]
2021-10-11 12:25:45,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 224.73it/s]
2021-10-11 12:25:45,809 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 203.07it/s]
2021-10-11 12:25:46,363 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 192.84it/s]
2021-10-11 12:25:46,890 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 164.39it/s]
2021-10-11 12:25:47,480 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25151191746709356
100%|██████████| 22/22 [00:00<00:00, 214.45it/s]
2021-10-11 12:25:48,019 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 215.64it/s]
2021-10-11 12:25:48,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24439701173959444
100%|██████████| 22/22 [00:00<00:00, 197.40it/s]
2021-10-11 12:25:49,101 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 207.59it/s]
2021-10-11 12:25:49,648 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 202.15it/s]
2021-10-11 12:25:50,217 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 197.10it/s]
2021-10-11 12:25:50,770 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32906438989683384
100%|██████████| 22/22 [00:00<00:00, 202.23it/s]
2021-10-11 12:25:51,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 196.61it/s]
2021-10-11 12:25:51,878 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28175026680896476
100%|██████████| 22/22 [00:00<00:00, 194.84it/s]
2021-10-11 12:25:52,463 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 205.84it/s]
2021-10-11 12:25:52,990 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 189.16it/s]
2021-10-11 12:25:53,538 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3287086446104589
100%|██████████| 22/22 [00:00<00:00, 202.63it/s]
2021-10-11 12:25:54,145 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 167.54it/s]
2021-10-11 12:25:54,778 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3383137673425827
100%|██████████| 22/22 [00:00<00:00, 160.12it/s]
2021-10-11 12:25:55,363 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2621842760583422
100%|██████████| 22/22 [00:00<00:00, 217.67it/s]
2021-10-11 12:25:55,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 226.49it/s]
2021-10-11 12:25:56,422 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 232.33it/s]
2021-10-11 12:25:56,887 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 210.39it/s]
2021-10-11 12:25:57,395 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2760583422269655
100%|██████████| 22/22 [00:00<00:00, 202.34it/s]
2021-10-11 12:25:57,918 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 232.12it/s]
2021-10-11 12:25:58,412 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 200.56it/s]
2021-10-11 12:25:58,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 221.93it/s]
2021-10-11 12:25:59,432 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 224.42it/s]
2021-10-11 12:25:59,931 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 214.33it/s]
2021-10-11 12:26:00,471 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 221.69it/s]
2021-10-11 12:26:00,969 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 227.52it/s]
2021-10-11 12:26:01,460 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 228.38it/s]
2021-10-11 12:26:01,965 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32017075773745995
100%|██████████| 22/22 [00:00<00:00, 183.36it/s]
2021-10-11 12:26:02,497 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 200.25it/s]
2021-10-11 12:26:03,066 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2543578797580932
100%|██████████| 22/22 [00:00<00:00, 204.84it/s]
2021-10-11 12:26:03,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30096051227321235
100%|██████████| 22/22 [00:00<00:00, 215.11it/s]
2021-10-11 12:26:04,157 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 211.69it/s]
2021-10-11 12:26:04,685 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
2021-10-11 12:26:04,687 knodle.trainer.trainer INFO     Train avg loss: 0.13327418908952837
2021-10-11 12:26:04,687 knodle.trainer.trainer INFO     Train avg accuracy: 0.9402533017794293
2021-10-11 12:26:04,687 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:26:04,687 knodle.trainer.trainer INFO     Training done
2021-10-11 12:26:04,687 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 144.32it/s]
2021-10-11 12:26:04,848 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9381578947368421, 'recall': 0.272033574971385, 'f1-score': 0.4217687074829933, 'support': 2621}, '1': {'precision': 0.0697220867869332, 'recall': 0.7526315789473684, 'f1-score': 0.1276215975011156, 'support': 190}, 'accuracy': 0.30451796513696194, 'macro avg': {'precision': 0.5039399907618877, 'recall': 0.5123325769593767, 'f1-score': 0.27469515249205445, 'support': 2811}, 'weighted avg': {'precision': 0.8794589251493349, 'recall': 0.30451796513696194, 'f1-score': 0.4018868323863882, 'support': 2811}}, Dev loss: 3.2278501987457275, denoising continues.
2021-10-11 12:26:04,849 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 12:26:04,873 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:26:05,117 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 3938, samples in test set: 1796
2021-10-11 12:26:05,235 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3756, samples in test set: 1978
2021-10-11 12:26:05,355 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5283, samples in test set: 451
2021-10-11 12:26:05,457 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 5599, samples in test set: 135
2021-10-11 12:26:05,575 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4360, samples in test set: 1374
5it [02:17, 27.52s/it]
2021-10-11 12:28:23,247 knodle.trainer.cleanlab.cleanlab INFO     [[0.03120185 0.96879815]
 [0.00956023 0.99043977]
 [0.08175559 0.91824441]
 [0.08333333 0.91666667]
 [0.93944791 0.06055209]
 [0.99718574 0.00281426]
 [0.98314607 0.01685393]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 12:28:23,346 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 48 out of 5734
2021-10-11 12:28:23,347 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:28:23,347 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:28:23,347 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 172.11it/s]
2021-10-11 12:28:23,820 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 235.27it/s]
2021-10-11 12:28:24,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3959445037353255
100%|██████████| 22/22 [00:00<00:00, 207.54it/s]
2021-10-11 12:28:24,810 knodle.trainer.trainer INFO     Epoch development accuracy: 0.37780149413020275
100%|██████████| 22/22 [00:00<00:00, 221.73it/s]
2021-10-11 12:28:25,328 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3109213802917111
100%|██████████| 22/22 [00:00<00:00, 222.91it/s]
2021-10-11 12:28:25,828 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32692991817858413
100%|██████████| 22/22 [00:00<00:00, 220.12it/s]
2021-10-11 12:28:26,328 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29099964425471364
100%|██████████| 22/22 [00:00<00:00, 219.09it/s]
2021-10-11 12:28:26,843 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36535040910707933
100%|██████████| 22/22 [00:00<00:00, 226.00it/s]
2021-10-11 12:28:27,335 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27499110636784063
100%|██████████| 22/22 [00:00<00:00, 217.81it/s]
2021-10-11 12:28:27,833 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3514763429384561
100%|██████████| 22/22 [00:00<00:00, 217.73it/s]
2021-10-11 12:28:28,351 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 212.87it/s]
2021-10-11 12:28:28,860 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3575240128068303
100%|██████████| 22/22 [00:00<00:00, 217.18it/s]
2021-10-11 12:28:29,370 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31874777659196013
100%|██████████| 22/22 [00:00<00:00, 203.15it/s]
2021-10-11 12:28:29,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32835289932408396
100%|██████████| 22/22 [00:00<00:00, 208.17it/s]
2021-10-11 12:28:30,463 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 207.99it/s]
2021-10-11 12:28:30,991 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3422269654927072
100%|██████████| 22/22 [00:00<00:00, 201.54it/s]
2021-10-11 12:28:31,548 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2671647100675916
100%|██████████| 22/22 [00:00<00:00, 212.84it/s]
2021-10-11 12:28:32,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 204.56it/s]
2021-10-11 12:28:32,547 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 204.16it/s]
2021-10-11 12:28:33,071 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2917111348274635
100%|██████████| 22/22 [00:00<00:00, 210.42it/s]
2021-10-11 12:28:33,582 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27748132337246534
100%|██████████| 22/22 [00:00<00:00, 210.53it/s]
2021-10-11 12:28:34,097 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 207.51it/s]
2021-10-11 12:28:34,632 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 201.50it/s]
2021-10-11 12:28:35,173 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 211.88it/s]
2021-10-11 12:28:35,703 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 208.00it/s]
2021-10-11 12:28:36,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 210.82it/s]
2021-10-11 12:28:36,747 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30594094628246177
100%|██████████| 22/22 [00:00<00:00, 218.41it/s]
2021-10-11 12:28:37,251 knodle.trainer.trainer INFO     Epoch development accuracy: 0.343649946638207
100%|██████████| 22/22 [00:00<00:00, 225.83it/s]
2021-10-11 12:28:37,751 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 226.74it/s]
2021-10-11 12:28:38,217 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 223.23it/s]
2021-10-11 12:28:38,698 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 220.63it/s]
2021-10-11 12:28:39,212 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 228.73it/s]
2021-10-11 12:28:39,691 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 238.17it/s]
2021-10-11 12:28:40,175 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 211.65it/s]
2021-10-11 12:28:40,700 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 220.31it/s]
2021-10-11 12:28:41,201 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 213.33it/s]
2021-10-11 12:28:41,705 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 219.14it/s]
2021-10-11 12:28:42,224 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2892209178228389
100%|██████████| 22/22 [00:00<00:00, 223.60it/s]
2021-10-11 12:28:42,718 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31732479544646036
100%|██████████| 22/22 [00:00<00:00, 214.19it/s]
2021-10-11 12:28:43,208 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 223.09it/s]
2021-10-11 12:28:43,726 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 218.92it/s]
2021-10-11 12:28:44,223 knodle.trainer.trainer INFO     Epoch development accuracy: 0.319815012451085
100%|██████████| 22/22 [00:00<00:00, 221.42it/s]
2021-10-11 12:28:44,716 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 215.95it/s]
2021-10-11 12:28:45,227 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 222.58it/s]
2021-10-11 12:28:45,725 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3557452863749555
100%|██████████| 22/22 [00:00<00:00, 217.47it/s]
2021-10-11 12:28:46,224 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3247954464603344
100%|██████████| 22/22 [00:00<00:00, 221.83it/s]
2021-10-11 12:28:46,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3130558520099609
100%|██████████| 22/22 [00:00<00:00, 222.29it/s]
2021-10-11 12:28:47,231 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33511205976520814
100%|██████████| 22/22 [00:00<00:00, 221.16it/s]
2021-10-11 12:28:47,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 223.33it/s]
2021-10-11 12:28:48,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 223.23it/s]
2021-10-11 12:28:48,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32123799359658484
100%|██████████| 22/22 [00:00<00:00, 216.18it/s]
2021-10-11 12:28:49,233 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 218.10it/s]
2021-10-11 12:28:49,755 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 220.97it/s]
2021-10-11 12:28:50,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 213.46it/s]
2021-10-11 12:28:50,771 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29064389896833864
100%|██████████| 22/22 [00:00<00:00, 217.97it/s]
2021-10-11 12:28:51,289 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 219.36it/s]
2021-10-11 12:28:51,795 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2991817858413376
100%|██████████| 22/22 [00:00<00:00, 220.03it/s]
2021-10-11 12:28:52,291 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 222.05it/s]
2021-10-11 12:28:52,799 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 214.77it/s]
2021-10-11 12:28:53,283 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34863038064745644
100%|██████████| 22/22 [00:00<00:00, 218.96it/s]
2021-10-11 12:28:53,785 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 219.31it/s]
2021-10-11 12:28:54,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3183920313055852
100%|██████████| 22/22 [00:00<00:00, 195.01it/s]
2021-10-11 12:28:54,819 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 221.49it/s]
2021-10-11 12:28:55,326 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 217.95it/s]
2021-10-11 12:28:55,846 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34293845606545714
100%|██████████| 22/22 [00:00<00:00, 214.73it/s]
2021-10-11 12:28:56,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28673070081821417
100%|██████████| 22/22 [00:00<00:00, 222.21it/s]
2021-10-11 12:28:56,849 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 215.55it/s]
2021-10-11 12:28:57,356 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3208822483102099
100%|██████████| 22/22 [00:00<00:00, 225.08it/s]
2021-10-11 12:28:57,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3468516542155816
100%|██████████| 22/22 [00:00<00:00, 223.98it/s]
2021-10-11 12:28:58,350 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 190.36it/s]
2021-10-11 12:28:58,839 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33262184276058343
100%|██████████| 22/22 [00:00<00:00, 216.40it/s]
2021-10-11 12:28:59,378 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2757025969405905
100%|██████████| 22/22 [00:00<00:00, 238.17it/s]
2021-10-11 12:28:59,827 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33617929562433296
100%|██████████| 22/22 [00:00<00:00, 215.57it/s]
2021-10-11 12:29:00,336 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 237.49it/s]
2021-10-11 12:29:00,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3105656350053362
100%|██████████| 22/22 [00:00<00:00, 236.39it/s]
2021-10-11 12:29:01,311 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28068303094983993
100%|██████████| 22/22 [00:00<00:00, 240.75it/s]
2021-10-11 12:29:01,775 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 231.51it/s]
2021-10-11 12:29:02,232 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3073639274279616
100%|██████████| 22/22 [00:00<00:00, 196.81it/s]
2021-10-11 12:29:02,780 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 206.10it/s]
2021-10-11 12:29:03,317 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 224.28it/s]
2021-10-11 12:29:03,805 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 225.43it/s]
2021-10-11 12:29:04,301 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 207.08it/s]
2021-10-11 12:29:04,789 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 191.73it/s]
2021-10-11 12:29:05,314 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 209.62it/s]
2021-10-11 12:29:05,798 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 226.77it/s]
2021-10-11 12:29:06,341 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2838847385272145
100%|██████████| 22/22 [00:00<00:00, 199.14it/s]
2021-10-11 12:29:06,853 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31020988971896124
100%|██████████| 22/22 [00:00<00:00, 201.73it/s]
2021-10-11 12:29:07,364 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 181.65it/s]
2021-10-11 12:29:07,905 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 201.06it/s]
2021-10-11 12:29:08,461 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2974030594094628
100%|██████████| 22/22 [00:00<00:00, 205.67it/s]
2021-10-11 12:29:09,002 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3084311632870864
100%|██████████| 22/22 [00:00<00:00, 196.91it/s]
2021-10-11 12:29:09,543 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 195.44it/s]
2021-10-11 12:29:10,083 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 192.92it/s]
2021-10-11 12:29:10,618 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 198.96it/s]
2021-10-11 12:29:11,150 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 225.29it/s]
2021-10-11 12:29:11,635 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
100%|██████████| 22/22 [00:00<00:00, 225.97it/s]
2021-10-11 12:29:12,099 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 208.36it/s]
2021-10-11 12:29:12,607 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 212.26it/s]
2021-10-11 12:29:13,117 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30451796513696194
100%|██████████| 22/22 [00:00<00:00, 206.97it/s]
2021-10-11 12:29:13,630 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32515119174670937
100%|██████████| 22/22 [00:00<00:00, 216.66it/s]
2021-10-11 12:29:14,119 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2870864461045891
2021-10-11 12:29:14,120 knodle.trainer.trainer INFO     Train avg loss: 0.13109437328432175
2021-10-11 12:29:14,120 knodle.trainer.trainer INFO     Train avg accuracy: 0.9415531043344072
2021-10-11 12:29:14,120 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:29:14,120 knodle.trainer.trainer INFO     Training done
2021-10-11 12:29:14,120 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 156.25it/s]
2021-10-11 12:29:14,270 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.174257278442383). Denoising stops.
2021-10-11 12:29:14,270 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 77.89it/s]
2021-10-11 12:29:14,559 knodle.trainer.config INFO     The cache will be saved to /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache folder
2021-10-11 12:29:14,559 knodle.trainer.config INFO     The trained models will be saved to the /Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cache directory.
2021-10-11 12:29:14,559 knodle.trainer.config INFO     Model will be trained on cpu
/Users/asedova/PycharmProjects/01_knodle/knodle/transformation/majority.py:58: RuntimeWarning: invalid value encountered in true_divide
  labels_probs = rule_counts / rule_counts.sum(axis=1).reshape(-1, 1)
2021-10-11 12:29:15,449 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 0
2021-10-11 12:29:15,474 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:29:15,945 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5296, samples in test set: 438
2021-10-11 12:29:16,416 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 3773, samples in test set: 1961
Accuracy is: 0.335061088485746
Precision is: 0.5199429949749828
Recall is: 0.5546523700613715
F1 is: 0.30640606233914786
{'0': {'precision': 0.9478487614080835, 'recall': 0.292790978654853, 'f1-score': 0.4473846153846154, 'support': 2483}, '1': {'precision': 0.09203722854188211, 'recall': 0.8165137614678899, 'f1-score': 0.1654275092936803, 'support': 218}, 'accuracy': 0.335061088485746, 'macro avg': {'precision': 0.5199429949749828, 'recall': 0.5546523700613715, 'f1-score': 0.30640606233914786, 'support': 2701}, 'weighted avg': {'precision': 0.8787754870042213, 'recall': 0.335061088485746, 'f1-score': 0.42462761829915674, 'support': 2701}}
2021-10-11 12:29:16,842 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 5618, samples in test set: 116
2021-10-11 12:29:17,159 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 3695, samples in test set: 2039
2021-10-11 12:29:17,502 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 4554, samples in test set: 1180
5it [02:22, 28.48s/it]
2021-10-11 12:31:40,025 knodle.trainer.cleanlab.cleanlab INFO     [[0.13958595 0.86041405]
 [0.03088481 0.96911519]
 [0.32390511 0.67609489]
 [0.08022388 0.91977612]
 [0.82123412 0.17876588]
 [0.92400691 0.07599309]
 [0.73863636 0.26136364]
 [0.06521739 0.93478261]
 [0.05882353 0.94117647]]
2021-10-11 12:31:40,134 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 198 out of 5734
2021-10-11 12:31:40,134 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:31:40,134 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:31:40,134 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 102.25it/s]
2021-10-11 12:31:41,020 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 196.47it/s]
2021-10-11 12:31:41,564 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2657417289220918
100%|██████████| 22/22 [00:00<00:00, 194.75it/s]
2021-10-11 12:31:42,103 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23585912486659552
100%|██████████| 22/22 [00:00<00:00, 195.51it/s]
2021-10-11 12:31:42,637 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22981145499822128
100%|██████████| 22/22 [00:00<00:00, 196.79it/s]
2021-10-11 12:31:43,182 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 198.39it/s]
2021-10-11 12:31:43,727 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2447527570259694
100%|██████████| 22/22 [00:00<00:00, 205.82it/s]
2021-10-11 12:31:44,252 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25791533262184274
100%|██████████| 22/22 [00:00<00:00, 194.09it/s]
2021-10-11 12:31:44,793 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 194.18it/s]
2021-10-11 12:31:45,329 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 205.70it/s]
2021-10-11 12:31:45,847 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33795802205620773
100%|██████████| 22/22 [00:00<00:00, 197.32it/s]
2021-10-11 12:31:46,378 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 193.99it/s]
2021-10-11 12:31:46,923 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 212.33it/s]
2021-10-11 12:31:47,463 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23479188900747064
100%|██████████| 22/22 [00:00<00:00, 195.92it/s]
2021-10-11 12:31:48,007 knodle.trainer.trainer INFO     Epoch development accuracy: 0.18392031305585202
100%|██████████| 22/22 [00:00<00:00, 200.53it/s]
2021-10-11 12:31:48,551 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 203.14it/s]
2021-10-11 12:31:49,096 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25933831376734257
100%|██████████| 22/22 [00:00<00:00, 197.93it/s]
2021-10-11 12:31:49,645 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 203.98it/s]
2021-10-11 12:31:50,179 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22411953041622198
100%|██████████| 22/22 [00:00<00:00, 101.55it/s]
2021-10-11 12:31:50,799 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27143365350409104
100%|██████████| 22/22 [00:00<00:00, 137.26it/s]
2021-10-11 12:31:51,413 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 137.83it/s]
2021-10-11 12:31:52,016 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 143.62it/s]
2021-10-11 12:31:52,584 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 140.47it/s]
2021-10-11 12:31:53,168 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 151.25it/s]
2021-10-11 12:31:53,715 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26823194592671645
100%|██████████| 22/22 [00:00<00:00, 136.18it/s]
2021-10-11 12:31:54,308 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2813945215225898
100%|██████████| 22/22 [00:00<00:00, 134.03it/s]
2021-10-11 12:31:54,920 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 141.44it/s]
2021-10-11 12:31:55,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30131625755958735
100%|██████████| 22/22 [00:00<00:00, 138.42it/s]
2021-10-11 12:31:56,102 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3799359658484525
100%|██████████| 22/22 [00:00<00:00, 137.11it/s]
2021-10-11 12:31:56,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 138.16it/s]
2021-10-11 12:31:57,297 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 135.33it/s]
2021-10-11 12:31:57,892 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 135.82it/s]
2021-10-11 12:31:58,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3354678050515831
100%|██████████| 22/22 [00:00<00:00, 134.79it/s]
2021-10-11 12:31:59,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2653859836357168
100%|██████████| 22/22 [00:00<00:00, 139.08it/s]
2021-10-11 12:31:59,708 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33795802205620773
100%|██████████| 22/22 [00:00<00:00, 136.58it/s]
2021-10-11 12:32:00,315 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25827107790821774
100%|██████████| 22/22 [00:00<00:00, 136.19it/s]
2021-10-11 12:32:00,926 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2753468516542156
100%|██████████| 22/22 [00:00<00:00, 139.75it/s]
2021-10-11 12:32:01,531 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24190679473496976
100%|██████████| 22/22 [00:00<00:00, 139.74it/s]
2021-10-11 12:32:02,132 knodle.trainer.trainer INFO     Epoch development accuracy: 0.256136606189968
100%|██████████| 22/22 [00:00<00:00, 137.18it/s]
2021-10-11 12:32:02,737 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 137.85it/s]
2021-10-11 12:32:03,327 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25364638918534327
100%|██████████| 22/22 [00:00<00:00, 139.72it/s]
2021-10-11 12:32:03,917 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2554251156172181
100%|██████████| 22/22 [00:00<00:00, 139.95it/s]
2021-10-11 12:32:04,510 knodle.trainer.trainer INFO     Epoch development accuracy: 0.23799359658484526
100%|██████████| 22/22 [00:00<00:00, 137.73it/s]
2021-10-11 12:32:05,108 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 146.07it/s]
2021-10-11 12:32:05,731 knodle.trainer.trainer INFO     Epoch development accuracy: 0.22198505869797225
100%|██████████| 22/22 [00:00<00:00, 142.93it/s]
2021-10-11 12:32:06,304 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31483457844183566
100%|██████████| 22/22 [00:00<00:00, 145.11it/s]
2021-10-11 12:32:06,890 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2781928139452152
100%|██████████| 22/22 [00:00<00:00, 139.97it/s]
2021-10-11 12:32:07,472 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27890430451796516
100%|██████████| 22/22 [00:00<00:00, 134.35it/s]
2021-10-11 12:32:08,054 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2792600498043401
100%|██████████| 22/22 [00:00<00:00, 150.21it/s]
2021-10-11 12:32:08,619 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 144.56it/s]
2021-10-11 12:32:09,176 knodle.trainer.trainer INFO     Epoch development accuracy: 0.288153681963714
100%|██████████| 22/22 [00:00<00:00, 151.82it/s]
2021-10-11 12:32:09,724 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 152.19it/s]
2021-10-11 12:32:10,263 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2575595873354678
100%|██████████| 22/22 [00:00<00:00, 142.31it/s]
2021-10-11 12:32:10,817 knodle.trainer.trainer INFO     Epoch development accuracy: 0.240128068303095
100%|██████████| 22/22 [00:00<00:00, 140.30it/s]
2021-10-11 12:32:11,403 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3176805407328353
100%|██████████| 22/22 [00:00<00:00, 142.59it/s]
2021-10-11 12:32:11,971 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2589825684809676
100%|██████████| 22/22 [00:00<00:00, 145.39it/s]
2021-10-11 12:32:12,560 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2550693703308431
100%|██████████| 22/22 [00:00<00:00, 151.14it/s]
2021-10-11 12:32:13,130 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27641408751334046
100%|██████████| 22/22 [00:00<00:00, 142.47it/s]
2021-10-11 12:32:13,696 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24581999288509426
100%|██████████| 22/22 [00:00<00:00, 151.24it/s]
2021-10-11 12:32:14,265 knodle.trainer.trainer INFO     Epoch development accuracy: 0.34044823906083244
100%|██████████| 22/22 [00:00<00:00, 142.57it/s]
2021-10-11 12:32:14,830 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26360725720384204
100%|██████████| 22/22 [00:00<00:00, 145.72it/s]
2021-10-11 12:32:15,389 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 151.16it/s]
2021-10-11 12:32:15,943 knodle.trainer.trainer INFO     Epoch development accuracy: 0.21949484169334757
100%|██████████| 22/22 [00:00<00:00, 145.85it/s]
2021-10-11 12:32:16,517 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 152.77it/s]
2021-10-11 12:32:17,089 knodle.trainer.trainer INFO     Epoch development accuracy: 0.36784062611170404
100%|██████████| 22/22 [00:00<00:00, 141.34it/s]
2021-10-11 12:32:17,665 knodle.trainer.trainer INFO     Epoch development accuracy: 0.272145144076841
100%|██████████| 22/22 [00:00<00:00, 143.78it/s]
2021-10-11 12:32:18,237 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 149.00it/s]
2021-10-11 12:32:18,792 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30771967271433653
100%|██████████| 22/22 [00:00<00:00, 152.97it/s]
2021-10-11 12:32:19,331 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 154.47it/s]
2021-10-11 12:32:19,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3062966915688367
100%|██████████| 22/22 [00:00<00:00, 144.32it/s]
2021-10-11 12:32:20,406 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 155.60it/s]
2021-10-11 12:32:20,939 knodle.trainer.trainer INFO     Epoch development accuracy: 0.335823550337958
100%|██████████| 22/22 [00:00<00:00, 150.58it/s]
2021-10-11 12:32:21,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 149.58it/s]
2021-10-11 12:32:22,021 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 145.39it/s]
2021-10-11 12:32:22,587 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2927783706865884
100%|██████████| 22/22 [00:00<00:00, 142.55it/s]
2021-10-11 12:32:23,161 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 154.51it/s]
2021-10-11 12:32:23,704 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3030949839914621
100%|██████████| 22/22 [00:00<00:00, 150.32it/s]
2021-10-11 12:32:24,241 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 132.99it/s]
2021-10-11 12:32:24,826 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2255425115617218
100%|██████████| 22/22 [00:00<00:00, 139.15it/s]
2021-10-11 12:32:25,405 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 146.51it/s]
2021-10-11 12:32:25,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29811454998221276
100%|██████████| 22/22 [00:00<00:00, 141.48it/s]
2021-10-11 12:32:26,536 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 141.95it/s]
2021-10-11 12:32:27,120 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31341159729633583
100%|██████████| 22/22 [00:00<00:00, 137.99it/s]
2021-10-11 12:32:27,715 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28779793667733905
100%|██████████| 22/22 [00:00<00:00, 29.53it/s]
2021-10-11 12:32:28,884 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3006047669868374
100%|██████████| 22/22 [00:00<00:00, 191.26it/s]
2021-10-11 12:32:29,431 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 217.45it/s]
2021-10-11 12:32:29,935 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28530771967271434
100%|██████████| 22/22 [00:00<00:00, 208.80it/s]
2021-10-11 12:32:30,454 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 218.67it/s]
2021-10-11 12:32:30,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.24688722874421914
100%|██████████| 22/22 [00:00<00:00, 191.52it/s]
2021-10-11 12:32:31,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29420135183208823
100%|██████████| 22/22 [00:00<00:00, 207.66it/s]
2021-10-11 12:32:31,975 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2497331910352188
100%|██████████| 22/22 [00:00<00:00, 191.70it/s]
2021-10-11 12:32:32,501 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3311988616150836
100%|██████████| 22/22 [00:00<00:00, 193.74it/s]
2021-10-11 12:32:33,038 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2746353610814657
100%|██████████| 22/22 [00:00<00:00, 197.16it/s]
2021-10-11 12:32:33,565 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2518676627534685
100%|██████████| 22/22 [00:00<00:00, 201.43it/s]
2021-10-11 12:32:34,092 knodle.trainer.trainer INFO     Epoch development accuracy: 0.33404482390608325
100%|██████████| 22/22 [00:00<00:00, 194.01it/s]
2021-10-11 12:32:34,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 192.59it/s]
2021-10-11 12:32:35,149 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 197.94it/s]
2021-10-11 12:32:35,686 knodle.trainer.trainer INFO     Epoch development accuracy: 0.25578086090359303
100%|██████████| 22/22 [00:00<00:00, 188.37it/s]
2021-10-11 12:32:36,203 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 205.14it/s]
2021-10-11 12:32:36,714 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2863749555318392
100%|██████████| 22/22 [00:00<00:00, 204.87it/s]
2021-10-11 12:32:37,239 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
2021-10-11 12:32:37,241 knodle.trainer.trainer INFO     Train avg loss: 0.13366083500285939
2021-10-11 12:32:37,241 knodle.trainer.trainer INFO     Train avg accuracy: 0.9403361926211248
2021-10-11 12:32:37,241 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:32:37,241 knodle.trainer.trainer INFO     Training done
2021-10-11 12:32:37,241 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 194.65it/s]
2021-10-11 12:32:37,362 knodle.trainer.cleanlab.cleanlab INFO     Clf_report: {'0': {'precision': 0.9328358208955224, 'recall': 0.28615032430370085, 'f1-score': 0.437956204379562, 'support': 2621}, '1': {'precision': 0.06776283009466866, 'recall': 0.7157894736842105, 'f1-score': 0.12380518889394629, 'support': 190}, 'accuracy': 0.3151903237282106, 'macro avg': {'precision': 0.5002993254950956, 'recall': 0.5009698989939557, 'f1-score': 0.28088069663675413, 'support': 2811}, 'weighted avg': {'precision': 0.8743641495144615, 'recall': 0.31519032372821054, 'f1-score': 0.4167222332154685, 'support': 2811}}, Dev loss: 3.146404266357422, denoising continues.
2021-10-11 12:32:37,362 knodle.trainer.cleanlab.cleanlab INFO     Iteration: 1
2021-10-11 12:32:37,384 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Partition 1/1:
2021-10-11 12:32:37,499 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 0     Rules in training set: 56, rules in test set: 14, samples in training set: 5635, samples in test set: 99
2021-10-11 12:32:37,611 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 1     Rules in training set: 56, rules in test set: 14, samples in training set: 5472, samples in test set: 262
2021-10-11 12:32:37,730 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 2     Rules in training set: 56, rules in test set: 14, samples in training set: 1952, samples in test set: 3782
2021-10-11 12:32:38,022 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 3     Rules in training set: 56, rules in test set: 14, samples in training set: 4542, samples in test set: 1192
2021-10-11 12:32:38,364 knodle.trainer.wscrossweigh.data_splitting_by_rules INFO     Fold 4     Rules in training set: 56, rules in test set: 14, samples in training set: 5335, samples in test set: 399
5it [02:10, 26.13s/it]
2021-10-11 12:34:49,131 knodle.trainer.cleanlab.cleanlab INFO     [[0.02637444 0.97362556]
 [0.0120614  0.9879386 ]
 [0.09925558 0.90074442]
 [0.00938967 0.99061033]
 [0.96333639 0.03666361]
 [0.99887892 0.00112108]
 [0.965625   0.034375  ]
 [0.         1.        ]
 [0.         1.        ]]
2021-10-11 12:34:49,240 knodle.trainer.cleanlab.cleanlab INFO     Labels changed: 7 out of 5734
2021-10-11 12:34:49,241 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:34:49,241 knodle.trainer.trainer INFO     Training starts
2021-10-11 12:34:49,241 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 188.29it/s]
2021-10-11 12:34:49,694 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 174.07it/s]
2021-10-11 12:34:50,265 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
100%|██████████| 22/22 [00:00<00:00, 195.41it/s]
2021-10-11 12:34:50,723 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31945926716471007
100%|██████████| 22/22 [00:00<00:00, 195.27it/s]
2021-10-11 12:34:51,163 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 208.12it/s]
2021-10-11 12:34:51,605 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 200.85it/s]
2021-10-11 12:34:52,038 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2938456065457133
100%|██████████| 22/22 [00:00<00:00, 204.21it/s]
2021-10-11 12:34:52,467 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 180.22it/s]
2021-10-11 12:34:52,924 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3151903237282106
100%|██████████| 22/22 [00:00<00:00, 204.08it/s]
2021-10-11 12:34:53,443 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3265741728922092
100%|██████████| 22/22 [00:00<00:00, 213.86it/s]
2021-10-11 12:34:53,885 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26858769121309145
100%|██████████| 22/22 [00:00<00:00, 204.22it/s]
2021-10-11 12:34:54,316 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29953753112771253
100%|██████████| 22/22 [00:00<00:00, 173.15it/s]
2021-10-11 12:34:54,788 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3144788331554607
100%|██████████| 22/22 [00:00<00:00, 191.24it/s]
2021-10-11 12:34:55,242 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 211.91it/s]
2021-10-11 12:34:55,668 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2678762006403415
100%|██████████| 22/22 [00:00<00:00, 210.46it/s]
2021-10-11 12:34:56,085 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 212.19it/s]
2021-10-11 12:34:56,511 knodle.trainer.trainer INFO     Epoch development accuracy: 0.32942013518320884
100%|██████████| 22/22 [00:00<00:00, 206.11it/s]
2021-10-11 12:34:56,934 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26254002134471716
100%|██████████| 22/22 [00:00<00:00, 211.98it/s]
2021-10-11 12:34:57,349 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3255069370330843
100%|██████████| 22/22 [00:00<00:00, 199.46it/s]
2021-10-11 12:34:57,766 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30345072927783706
100%|██████████| 22/22 [00:00<00:00, 215.85it/s]
2021-10-11 12:34:58,206 knodle.trainer.trainer INFO     Epoch development accuracy: 0.295980078263963
100%|██████████| 22/22 [00:00<00:00, 212.05it/s]
2021-10-11 12:34:58,615 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 200.43it/s]
2021-10-11 12:34:59,039 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31696905016008536
100%|██████████| 22/22 [00:00<00:00, 213.52it/s]
2021-10-11 12:34:59,456 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29313411597296335
100%|██████████| 22/22 [00:00<00:00, 176.82it/s]
2021-10-11 12:34:59,902 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 210.00it/s]
2021-10-11 12:35:00,337 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31803628601921025
100%|██████████| 22/22 [00:00<00:00, 212.52it/s]
2021-10-11 12:35:00,745 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3080754180007115
100%|██████████| 22/22 [00:00<00:00, 199.51it/s]
2021-10-11 12:35:01,180 knodle.trainer.trainer INFO     Epoch development accuracy: 0.303806474564212
100%|██████████| 22/22 [00:00<00:00, 209.82it/s]
2021-10-11 12:35:01,605 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28744219139096405
100%|██████████| 22/22 [00:00<00:00, 195.30it/s]
2021-10-11 12:35:02,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 193.44it/s]
2021-10-11 12:35:02,508 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 182.05it/s]
2021-10-11 12:35:03,009 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 162.70it/s]
2021-10-11 12:35:03,536 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2735681252223408
100%|██████████| 22/22 [00:00<00:00, 196.32it/s]
2021-10-11 12:35:04,047 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3561010316613305
100%|██████████| 22/22 [00:00<00:00, 194.28it/s]
2021-10-11 12:35:04,503 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2689434364994664
100%|██████████| 22/22 [00:00<00:00, 197.92it/s]
2021-10-11 12:35:04,962 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 188.89it/s]
2021-10-11 12:35:05,401 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2849519743863394
100%|██████████| 22/22 [00:00<00:00, 191.78it/s]
2021-10-11 12:35:05,851 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29562433297758806
100%|██████████| 22/22 [00:00<00:00, 198.45it/s]
2021-10-11 12:35:06,305 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 194.22it/s]
2021-10-11 12:35:06,757 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2934898612593383
100%|██████████| 22/22 [00:00<00:00, 213.23it/s]
2021-10-11 12:35:07,190 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31127712557808607
100%|██████████| 22/22 [00:00<00:00, 201.13it/s]
2021-10-11 12:35:07,639 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 199.07it/s]
2021-10-11 12:35:08,075 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3166133048737104
100%|██████████| 22/22 [00:00<00:00, 202.66it/s]
2021-10-11 12:35:08,506 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27961579509071505
100%|██████████| 22/22 [00:00<00:00, 205.62it/s]
2021-10-11 12:35:08,924 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3016720028459623
100%|██████████| 22/22 [00:00<00:00, 195.00it/s]
2021-10-11 12:35:09,356 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 215.85it/s]
2021-10-11 12:35:09,790 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26680896478121663
100%|██████████| 22/22 [00:00<00:00, 198.50it/s]
2021-10-11 12:35:10,230 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 194.83it/s]
2021-10-11 12:35:10,676 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28993240839558876
100%|██████████| 22/22 [00:00<00:00, 191.78it/s]
2021-10-11 12:35:11,111 knodle.trainer.trainer INFO     Epoch development accuracy: 0.247954464603344
100%|██████████| 22/22 [00:00<00:00, 199.28it/s]
2021-10-11 12:35:11,545 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26929918178584134
100%|██████████| 22/22 [00:00<00:00, 199.71it/s]
2021-10-11 12:35:11,984 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 199.77it/s]
2021-10-11 12:35:12,431 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2725008893632159
100%|██████████| 22/22 [00:00<00:00, 202.76it/s]
2021-10-11 12:35:12,865 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 190.81it/s]
2021-10-11 12:35:13,313 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3027392387050872
100%|██████████| 22/22 [00:00<00:00, 201.29it/s]
2021-10-11 12:35:13,750 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2913553895410886
100%|██████████| 22/22 [00:00<00:00, 190.60it/s]
2021-10-11 12:35:14,192 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2895766631092138
100%|██████████| 22/22 [00:00<00:00, 202.39it/s]
2021-10-11 12:35:14,625 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31910352187833513
100%|██████████| 22/22 [00:00<00:00, 198.87it/s]
2021-10-11 12:35:15,060 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2703664176449662
100%|██████████| 22/22 [00:00<00:00, 213.15it/s]
2021-10-11 12:35:15,485 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 198.08it/s]
2021-10-11 12:35:15,928 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2856634649590893
100%|██████████| 22/22 [00:00<00:00, 198.26it/s]
2021-10-11 12:35:16,372 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2945570971184632
100%|██████████| 22/22 [00:00<00:00, 199.90it/s]
2021-10-11 12:35:16,818 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27997154037709
100%|██████████| 22/22 [00:00<00:00, 202.13it/s]
2021-10-11 12:35:17,257 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3230167200284596
100%|██████████| 22/22 [00:00<00:00, 199.81it/s]
2021-10-11 12:35:17,697 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 201.68it/s]
2021-10-11 12:35:18,143 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2949128424048381
100%|██████████| 22/22 [00:00<00:00, 197.27it/s]
2021-10-11 12:35:18,600 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2984702952685877
100%|██████████| 22/22 [00:00<00:00, 210.55it/s]
2021-10-11 12:35:19,035 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30985414443258624
100%|██████████| 22/22 [00:00<00:00, 211.13it/s]
2021-10-11 12:35:19,457 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30665243685521165
100%|██████████| 22/22 [00:00<00:00, 197.33it/s]
2021-10-11 12:35:19,899 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2696549270722163
100%|██████████| 22/22 [00:00<00:00, 192.83it/s]
2021-10-11 12:35:20,340 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3422269654927072
100%|██████████| 22/22 [00:00<00:00, 199.43it/s]
2021-10-11 12:35:20,783 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3052294557097118
100%|██████████| 22/22 [00:00<00:00, 213.88it/s]
2021-10-11 12:35:21,186 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29633582355033794
100%|██████████| 22/22 [00:00<00:00, 216.55it/s]
2021-10-11 12:35:21,601 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2952685876912131
100%|██████████| 22/22 [00:00<00:00, 189.85it/s]
2021-10-11 12:35:22,048 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 214.58it/s]
2021-10-11 12:35:22,479 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29242262540021347
100%|██████████| 22/22 [00:00<00:00, 193.39it/s]
2021-10-11 12:35:22,938 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31590181430096054
100%|██████████| 22/22 [00:00<00:00, 193.73it/s]
2021-10-11 12:35:23,393 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2845962290999644
100%|██████████| 22/22 [00:00<00:00, 195.81it/s]
2021-10-11 12:35:23,836 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2831732479544646
100%|██████████| 22/22 [00:00<00:00, 194.98it/s]
2021-10-11 12:35:24,285 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30024902170046247
100%|██████████| 22/22 [00:00<00:00, 184.57it/s]
2021-10-11 12:35:24,752 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2632515119174671
100%|██████████| 22/22 [00:00<00:00, 189.38it/s]
2021-10-11 12:35:25,217 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29206688011383847
100%|██████████| 22/22 [00:00<00:00, 197.06it/s]
2021-10-11 12:35:25,671 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3376022767698328
100%|██████████| 22/22 [00:00<00:00, 192.83it/s]
2021-10-11 12:35:26,122 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29989327641408753
100%|██████████| 22/22 [00:00<00:00, 187.98it/s]
2021-10-11 12:35:26,577 knodle.trainer.trainer INFO     Epoch development accuracy: 0.31234436143721095
100%|██████████| 22/22 [00:00<00:00, 196.94it/s]
2021-10-11 12:35:27,026 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3322660974742085
100%|██████████| 22/22 [00:00<00:00, 192.87it/s]
2021-10-11 12:35:27,488 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28210601209533975
100%|██████████| 22/22 [00:00<00:00, 194.11it/s]
2021-10-11 12:35:27,949 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29775880469583776
100%|██████████| 22/22 [00:00<00:00, 191.71it/s]
2021-10-11 12:35:28,404 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28103877623621487
100%|██████████| 22/22 [00:00<00:00, 190.38it/s]
2021-10-11 12:35:28,859 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3162575595873355
100%|██████████| 22/22 [00:00<00:00, 197.22it/s]
2021-10-11 12:35:29,318 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2767698327997154
100%|██████████| 22/22 [00:00<00:00, 195.04it/s]
2021-10-11 12:35:29,774 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2970473141230879
100%|██████████| 22/22 [00:00<00:00, 190.12it/s]
2021-10-11 12:35:30,234 knodle.trainer.trainer INFO     Epoch development accuracy: 0.2824617573817147
100%|██████████| 22/22 [00:00<00:00, 194.69it/s]
2021-10-11 12:35:30,689 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27712557808609034
100%|██████████| 22/22 [00:00<00:00, 194.05it/s]
2021-10-11 12:35:31,147 knodle.trainer.trainer INFO     Epoch development accuracy: 0.29669156883671294
100%|██████████| 22/22 [00:00<00:00, 191.56it/s]
2021-10-11 12:35:31,606 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27285663464959087
100%|██████████| 22/22 [00:00<00:00, 204.82it/s]
2021-10-11 12:35:32,037 knodle.trainer.trainer INFO     Epoch development accuracy: 0.26752045535396657
100%|██████████| 22/22 [00:00<00:00, 214.15it/s]
2021-10-11 12:35:32,443 knodle.trainer.trainer INFO     Epoch development accuracy: 0.28601921024546423
100%|██████████| 22/22 [00:00<00:00, 200.26it/s]
2021-10-11 12:35:32,861 knodle.trainer.trainer INFO     Epoch development accuracy: 0.30700818214158665
100%|██████████| 22/22 [00:00<00:00, 208.28it/s]
2021-10-11 12:35:33,288 knodle.trainer.trainer INFO     Epoch development accuracy: 0.27854855923159016
100%|██████████| 22/22 [00:00<00:00, 203.17it/s]
2021-10-11 12:35:33,710 knodle.trainer.trainer INFO     Epoch development accuracy: 0.3055852009960868
2021-10-11 12:35:33,712 knodle.trainer.trainer INFO     Train avg loss: 0.13086246879367777
2021-10-11 12:35:33,712 knodle.trainer.trainer INFO     Train avg accuracy: 0.9414143515957728
2021-10-11 12:35:33,712 knodle.trainer.trainer INFO     ======================================
2021-10-11 12:35:33,712 knodle.trainer.trainer INFO     Training done
2021-10-11 12:35:33,712 knodle.trainer.trainer INFO     ======================================
100%|██████████| 22/22 [00:00<00:00, 204.47it/s]
2021-10-11 12:35:33,827 knodle.trainer.cleanlab.cleanlab INFO     The model does not improve on the dev set (dev loss: 4.109938144683838). Denoising stops.
2021-10-11 12:35:33,827 root         INFO     Training is done.
100%|██████████| 22/22 [00:00<00:00, 55.78it/s]
Traceback (most recent call last):
  File "/Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cleanlab_training_tutorial.py", line 138, in <module>
    parser.add_argument("--path_to_data", help="")
  File "/Users/asedova/PycharmProjects/01_knodle/examples/trainer/cleanlab/cleanlab_training_tutorial.py", line 129, in train_cleanlab
    print(f"Result: {result}")
FileNotFoundError: [Errno 2] No such file or directory: '/Users/asedova/PycharmProjects/01_knodle/data_from_minio/spouse/processed/cl_results_spouse_w/o_prior_30exp.json'
Accuracy is: 0.322843391336542
Precision is: 0.5179986119749712
Recall is: 0.5480071827879119
F1 is: 0.2971934708986655
{'0': {'precision': 0.9455040871934605, 'recall': 0.2795006041079339, 'f1-score': 0.43145788001243396, 'support': 2483}, '1': {'precision': 0.09049313675648195, 'recall': 0.8165137614678899, 'f1-score': 0.162929061784897, 'support': 218}, 'accuracy': 0.322843391336542, 'macro avg': {'precision': 0.5179986119749712, 'recall': 0.5480071827879119, 'f1-score': 0.2971934708986655, 'support': 2701}, 'weighted avg': {'precision': 0.8764954284762221, 'recall': 0.322843391336542, 'f1-score': 0.409784691425391, 'support': 2701}}
======================================
Result: {'lr': 0.1, 'cv_n_folds': 5, 'prune_method': 'prune_by_noise_rate', 'epochs': 100, 'batch_size': 128, 'psx_calculation_method': 'signatures', 'accuracy': [0.3232136245834876, 0.33469085523880043, 0.35690485005553496, 0.3746760459089226, 0.359496482784154, 0.29359496482784153, 0.332469455757127, 0.33469085523880043, 0.3646797482413921, 0.31617919289152163, 0.32395409107737877, 0.322843391336542, 0.3683820807108478, 0.3383931877082562, 0.3920770085153647, 0.32395409107737877, 0.3661606812291744, 0.33024805627545356, 0.2987782302850796, 0.32432432432432434, 0.3320992225101814, 0.3250647908182155, 0.3261754905590522, 0.3546834505738615, 0.30322102924842653, 0.3047019622362088, 0.322843391336542, 0.33802295446131064, 0.335061088485746, 0.322843391336542], 'mean_accuracy': 0.33481426632111566, 'std_accuracy': 0.023303170433785537, 'precision': [0.5188746409121663, 0.5190910474866357, 0.520219924756499, 0.5236187035095602, 0.5221206946944175, 0.5173721081048472, 0.5195368637978253, 0.5198851714669311, 0.5206545179800393, 0.517731853687625, 0.5173668441939475, 0.5155660377358491, 0.5212131103002494, 0.5173221870907988, 0.5232808061966678, 0.5214546866000551, 0.5216200945725088, 0.51441833478387, 0.5147665842594926, 0.522337615501579, 0.5178847009590896, 0.516740979445168, 0.5193474758324382, 0.5168682735354105, 0.5164014105475797, 0.5201048618010556, 0.5179986119749712, 0.518828001960944, 0.5199429949749828, 0.5179986119749712], 'mean_precision': 0.5190189250212726, 'std_precision': 0.0023924515218776404, 'recall': [0.5503007607695632, 0.55235879207972, 0.5581643247477341, 0.5699222603612824, 0.5637583272676217, 0.5425600505455446, 0.5532427848821527, 0.5544510007500545, 0.5603008716150558, 0.5464747438545412, 0.5465190820515284, 0.5417305567769086, 0.5623145647282253, 0.5480958591818863, 0.5710177833118416, 0.5569801254032005, 0.563198557530658, 0.5394813169922446, 0.5370103862226443, 0.5592737033848518, 0.548856998230167, 0.5450309813151448, 0.551911715260099, 0.5485872741984947, 0.5415190266287822, 0.5506933385553876, 0.5480071827879119, 0.5520789072112383, 0.5546523700613715, 0.5480071827879119], 'mean_recall': 0.5522166943164589, 'std_recall': 0.00854821406179133, 'f1-score': [0.29768074085200713, 0.3059108086901273, 0.32162025580018344, 0.33471130965792384, 0.3239919331504693, 0.2754877217607245, 0.30446222790470284, 0.30612870700720807, 0.32701289951619555, 0.29231457779650283, 0.29782829059391, 0.2965702143425588, 0.3296811265310873, 0.30800632827458463, 0.34599056937654543, 0.2988584474885845, 0.32833196795128783, 0.30149517583530294, 0.278849981674138, 0.29934412187907805, 0.30375218479258614, 0.29845905061104405, 0.29992742676027134, 0.3190339680019186, 0.2825006492846577, 0.28439490230202236, 0.2971934708986655, 0.3081779998510174, 0.30640606233914786, 0.2971934708986655], 'mean_f1': 0.3057105530607706, 'std_f1': 0.016753648160521207}
======================================

Process finished with exit code 1
